(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&n(u)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();var ai=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function uo(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Pp={exports:{}},ll={},Op={exports:{}},Ot={};var A_;function UA(){if(A_)return Ot;A_=1;var r=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),u=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),g=Symbol.iterator;function E(Q){return Q===null||typeof Q!="object"?null:(Q=g&&Q[g]||Q["@@iterator"],typeof Q=="function"?Q:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},M=Object.assign,D={};function w(Q,se,Ce){this.props=Q,this.context=se,this.refs=D,this.updater=Ce||b}w.prototype.isReactComponent={},w.prototype.setState=function(Q,se){if(typeof Q!="object"&&typeof Q!="function"&&Q!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Q,se,"setState")},w.prototype.forceUpdate=function(Q){this.updater.enqueueForceUpdate(this,Q,"forceUpdate")};function A(){}A.prototype=w.prototype;function I(Q,se,Ce){this.props=Q,this.context=se,this.refs=D,this.updater=Ce||b}var V=I.prototype=new A;V.constructor=I,M(V,w.prototype),V.isPureReactComponent=!0;var q=Array.isArray,P=Object.prototype.hasOwnProperty,U={current:null},R={key:!0,ref:!0,__self:!0,__source:!0};function S(Q,se,Ce){var Ie,He={},Ke=null,et=null;if(se!=null)for(Ie in se.ref!==void 0&&(et=se.ref),se.key!==void 0&&(Ke=""+se.key),se)P.call(se,Ie)&&!R.hasOwnProperty(Ie)&&(He[Ie]=se[Ie]);var Fe=arguments.length-2;if(Fe===1)He.children=Ce;else if(1<Fe){for(var Je=Array(Fe),Xe=0;Xe<Fe;Xe++)Je[Xe]=arguments[Xe+2];He.children=Je}if(Q&&Q.defaultProps)for(Ie in Fe=Q.defaultProps,Fe)He[Ie]===void 0&&(He[Ie]=Fe[Ie]);return{$$typeof:r,type:Q,key:Ke,ref:et,props:He,_owner:U.current}}function C(Q,se){return{$$typeof:r,type:Q.type,key:se,ref:Q.ref,props:Q.props,_owner:Q._owner}}function N(Q){return typeof Q=="object"&&Q!==null&&Q.$$typeof===r}function z(Q){var se={"=":"=0",":":"=2"};return"$"+Q.replace(/[=:]/g,function(Ce){return se[Ce]})}var j=/\/+/g;function L(Q,se){return typeof Q=="object"&&Q!==null&&Q.key!=null?z(""+Q.key):se.toString(36)}function he(Q,se,Ce,Ie,He){var Ke=typeof Q;(Ke==="undefined"||Ke==="boolean")&&(Q=null);var et=!1;if(Q===null)et=!0;else switch(Ke){case"string":case"number":et=!0;break;case"object":switch(Q.$$typeof){case r:case e:et=!0}}if(et)return et=Q,He=He(et),Q=Ie===""?"."+L(et,0):Ie,q(He)?(Ce="",Q!=null&&(Ce=Q.replace(j,"$&/")+"/"),he(He,se,Ce,"",function(Xe){return Xe})):He!=null&&(N(He)&&(He=C(He,Ce+(!He.key||et&&et.key===He.key?"":(""+He.key).replace(j,"$&/")+"/")+Q)),se.push(He)),1;if(et=0,Ie=Ie===""?".":Ie+":",q(Q))for(var Fe=0;Fe<Q.length;Fe++){Ke=Q[Fe];var Je=Ie+L(Ke,Fe);et+=he(Ke,se,Ce,Je,He)}else if(Je=E(Q),typeof Je=="function")for(Q=Je.call(Q),Fe=0;!(Ke=Q.next()).done;)Ke=Ke.value,Je=Ie+L(Ke,Fe++),et+=he(Ke,se,Ce,Je,He);else if(Ke==="object")throw se=String(Q),Error("Objects are not valid as a React child (found: "+(se==="[object Object]"?"object with keys {"+Object.keys(Q).join(", ")+"}":se)+"). If you meant to render a collection of children, use an array instead.");return et}function _e(Q,se,Ce){if(Q==null)return Q;var Ie=[],He=0;return he(Q,Ie,"","",function(Ke){return se.call(Ce,Ke,He++)}),Ie}function De(Q){if(Q._status===-1){var se=Q._result;se=se(),se.then(function(Ce){(Q._status===0||Q._status===-1)&&(Q._status=1,Q._result=Ce)},function(Ce){(Q._status===0||Q._status===-1)&&(Q._status=2,Q._result=Ce)}),Q._status===-1&&(Q._status=0,Q._result=se)}if(Q._status===1)return Q._result.default;throw Q._result}var de={current:null},J={transition:null},ce={ReactCurrentDispatcher:de,ReactCurrentBatchConfig:J,ReactCurrentOwner:U};function xe(){throw Error("act(...) is not supported in production builds of React.")}return Ot.Children={map:_e,forEach:function(Q,se,Ce){_e(Q,function(){se.apply(this,arguments)},Ce)},count:function(Q){var se=0;return _e(Q,function(){se++}),se},toArray:function(Q){return _e(Q,function(se){return se})||[]},only:function(Q){if(!N(Q))throw Error("React.Children.only expected to receive a single React element child.");return Q}},Ot.Component=w,Ot.Fragment=t,Ot.Profiler=i,Ot.PureComponent=I,Ot.StrictMode=n,Ot.Suspense=c,Ot.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ce,Ot.act=xe,Ot.cloneElement=function(Q,se,Ce){if(Q==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+Q+".");var Ie=M({},Q.props),He=Q.key,Ke=Q.ref,et=Q._owner;if(se!=null){if(se.ref!==void 0&&(Ke=se.ref,et=U.current),se.key!==void 0&&(He=""+se.key),Q.type&&Q.type.defaultProps)var Fe=Q.type.defaultProps;for(Je in se)P.call(se,Je)&&!R.hasOwnProperty(Je)&&(Ie[Je]=se[Je]===void 0&&Fe!==void 0?Fe[Je]:se[Je])}var Je=arguments.length-2;if(Je===1)Ie.children=Ce;else if(1<Je){Fe=Array(Je);for(var Xe=0;Xe<Je;Xe++)Fe[Xe]=arguments[Xe+2];Ie.children=Fe}return{$$typeof:r,type:Q.type,key:He,ref:Ke,props:Ie,_owner:et}},Ot.createContext=function(Q){return Q={$$typeof:u,_currentValue:Q,_currentValue2:Q,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},Q.Provider={$$typeof:o,_context:Q},Q.Consumer=Q},Ot.createElement=S,Ot.createFactory=function(Q){var se=S.bind(null,Q);return se.type=Q,se},Ot.createRef=function(){return{current:null}},Ot.forwardRef=function(Q){return{$$typeof:l,render:Q}},Ot.isValidElement=N,Ot.lazy=function(Q){return{$$typeof:m,_payload:{_status:-1,_result:Q},_init:De}},Ot.memo=function(Q,se){return{$$typeof:d,type:Q,compare:se===void 0?null:se}},Ot.startTransition=function(Q){var se=J.transition;J.transition={};try{Q()}finally{J.transition=se}},Ot.unstable_act=xe,Ot.useCallback=function(Q,se){return de.current.useCallback(Q,se)},Ot.useContext=function(Q){return de.current.useContext(Q)},Ot.useDebugValue=function(){},Ot.useDeferredValue=function(Q){return de.current.useDeferredValue(Q)},Ot.useEffect=function(Q,se){return de.current.useEffect(Q,se)},Ot.useId=function(){return de.current.useId()},Ot.useImperativeHandle=function(Q,se,Ce){return de.current.useImperativeHandle(Q,se,Ce)},Ot.useInsertionEffect=function(Q,se){return de.current.useInsertionEffect(Q,se)},Ot.useLayoutEffect=function(Q,se){return de.current.useLayoutEffect(Q,se)},Ot.useMemo=function(Q,se){return de.current.useMemo(Q,se)},Ot.useReducer=function(Q,se,Ce){return de.current.useReducer(Q,se,Ce)},Ot.useRef=function(Q){return de.current.useRef(Q)},Ot.useState=function(Q){return de.current.useState(Q)},Ot.useSyncExternalStore=function(Q,se,Ce){return de.current.useSyncExternalStore(Q,se,Ce)},Ot.useTransition=function(){return de.current.useTransition()},Ot.version="18.3.1",Ot}var S_;function $g(){return S_||(S_=1,Op.exports=UA()),Op.exports}var I_;function jA(){if(I_)return ll;I_=1;var r=$g(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function u(l,c,d){var m,g={},E=null,b=null;d!==void 0&&(E=""+d),c.key!==void 0&&(E=""+c.key),c.ref!==void 0&&(b=c.ref);for(m in c)n.call(c,m)&&!o.hasOwnProperty(m)&&(g[m]=c[m]);if(l&&l.defaultProps)for(m in c=l.defaultProps,c)g[m]===void 0&&(g[m]=c[m]);return{$$typeof:e,type:l,key:E,ref:b,props:g,_owner:i.current}}return ll.Fragment=t,ll.jsx=u,ll.jsxs=u,ll}var C_;function qA(){return C_||(C_=1,Pp.exports=jA()),Pp.exports}var ye=qA(),ge=$g();const br=uo(ge);var bh={},Lp={exports:{}},Rr={},Vp={exports:{}},Fp={};var D_;function WA(){return D_||(D_=1,(function(r){function e(J,ce){var xe=J.length;J.push(ce);e:for(;0<xe;){var Q=xe-1>>>1,se=J[Q];if(0<i(se,ce))J[Q]=ce,J[xe]=se,xe=Q;else break e}}function t(J){return J.length===0?null:J[0]}function n(J){if(J.length===0)return null;var ce=J[0],xe=J.pop();if(xe!==ce){J[0]=xe;e:for(var Q=0,se=J.length,Ce=se>>>1;Q<Ce;){var Ie=2*(Q+1)-1,He=J[Ie],Ke=Ie+1,et=J[Ke];if(0>i(He,xe))Ke<se&&0>i(et,He)?(J[Q]=et,J[Ke]=xe,Q=Ke):(J[Q]=He,J[Ie]=xe,Q=Ie);else if(Ke<se&&0>i(et,xe))J[Q]=et,J[Ke]=xe,Q=Ke;else break e}}return ce}function i(J,ce){var xe=J.sortIndex-ce.sortIndex;return xe!==0?xe:J.id-ce.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;r.unstable_now=function(){return o.now()}}else{var u=Date,l=u.now();r.unstable_now=function(){return u.now()-l}}var c=[],d=[],m=1,g=null,E=3,b=!1,M=!1,D=!1,w=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function V(J){for(var ce=t(d);ce!==null;){if(ce.callback===null)n(d);else if(ce.startTime<=J)n(d),ce.sortIndex=ce.expirationTime,e(c,ce);else break;ce=t(d)}}function q(J){if(D=!1,V(J),!M)if(t(c)!==null)M=!0,De(P);else{var ce=t(d);ce!==null&&de(q,ce.startTime-J)}}function P(J,ce){M=!1,D&&(D=!1,A(S),S=-1),b=!0;var xe=E;try{for(V(ce),g=t(c);g!==null&&(!(g.expirationTime>ce)||J&&!z());){var Q=g.callback;if(typeof Q=="function"){g.callback=null,E=g.priorityLevel;var se=Q(g.expirationTime<=ce);ce=r.unstable_now(),typeof se=="function"?g.callback=se:g===t(c)&&n(c),V(ce)}else n(c);g=t(c)}if(g!==null)var Ce=!0;else{var Ie=t(d);Ie!==null&&de(q,Ie.startTime-ce),Ce=!1}return Ce}finally{g=null,E=xe,b=!1}}var U=!1,R=null,S=-1,C=5,N=-1;function z(){return!(r.unstable_now()-N<C)}function j(){if(R!==null){var J=r.unstable_now();N=J;var ce=!0;try{ce=R(!0,J)}finally{ce?L():(U=!1,R=null)}}else U=!1}var L;if(typeof I=="function")L=function(){I(j)};else if(typeof MessageChannel<"u"){var he=new MessageChannel,_e=he.port2;he.port1.onmessage=j,L=function(){_e.postMessage(null)}}else L=function(){w(j,0)};function De(J){R=J,U||(U=!0,L())}function de(J,ce){S=w(function(){J(r.unstable_now())},ce)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(J){J.callback=null},r.unstable_continueExecution=function(){M||b||(M=!0,De(P))},r.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<J?Math.floor(1e3/J):5},r.unstable_getCurrentPriorityLevel=function(){return E},r.unstable_getFirstCallbackNode=function(){return t(c)},r.unstable_next=function(J){switch(E){case 1:case 2:case 3:var ce=3;break;default:ce=E}var xe=E;E=ce;try{return J()}finally{E=xe}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(J,ce){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var xe=E;E=J;try{return ce()}finally{E=xe}},r.unstable_scheduleCallback=function(J,ce,xe){var Q=r.unstable_now();switch(typeof xe=="object"&&xe!==null?(xe=xe.delay,xe=typeof xe=="number"&&0<xe?Q+xe:Q):xe=Q,J){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=xe+se,J={id:m++,callback:ce,priorityLevel:J,startTime:xe,expirationTime:se,sortIndex:-1},xe>Q?(J.sortIndex=xe,e(d,J),t(c)===null&&J===t(d)&&(D?(A(S),S=-1):D=!0,de(q,xe-Q))):(J.sortIndex=se,e(c,J),M||b||(M=!0,De(P))),J},r.unstable_shouldYield=z,r.unstable_wrapCallback=function(J){var ce=E;return function(){var xe=E;E=ce;try{return J.apply(this,arguments)}finally{E=xe}}}})(Fp)),Fp}var R_;function $A(){return R_||(R_=1,Vp.exports=WA()),Vp.exports}var k_;function HA(){if(k_)return Rr;k_=1;var r=$g(),e=$A();function t(s){for(var a="https://reactjs.org/docs/error-decoder.html?invariant="+s,h=1;h<arguments.length;h++)a+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+s+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,i={};function o(s,a){u(s,a),u(s+"Capture",a)}function u(s,a){for(i[s]=a,s=0;s<a.length;s++)n.add(a[s])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),c=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},g={};function E(s){return c.call(g,s)?!0:c.call(m,s)?!1:d.test(s)?g[s]=!0:(m[s]=!0,!1)}function b(s,a,h,p){if(h!==null&&h.type===0)return!1;switch(typeof a){case"function":case"symbol":return!0;case"boolean":return p?!1:h!==null?!h.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function M(s,a,h,p){if(a===null||typeof a>"u"||b(s,a,h,p))return!0;if(p)return!1;if(h!==null)switch(h.type){case 3:return!a;case 4:return a===!1;case 5:return isNaN(a);case 6:return isNaN(a)||1>a}return!1}function D(s,a,h,p,_,x,B){this.acceptsBooleans=a===2||a===3||a===4,this.attributeName=p,this.attributeNamespace=_,this.mustUseProperty=h,this.propertyName=s,this.type=a,this.sanitizeURL=x,this.removeEmptyString=B}var w={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){w[s]=new D(s,0,!1,s,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var a=s[0];w[a]=new D(a,1,!1,s[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(s){w[s]=new D(s,2,!1,s.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){w[s]=new D(s,2,!1,s,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){w[s]=new D(s,3,!1,s.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(s){w[s]=new D(s,3,!0,s,null,!1,!1)}),["capture","download"].forEach(function(s){w[s]=new D(s,4,!1,s,null,!1,!1)}),["cols","rows","size","span"].forEach(function(s){w[s]=new D(s,6,!1,s,null,!1,!1)}),["rowSpan","start"].forEach(function(s){w[s]=new D(s,5,!1,s.toLowerCase(),null,!1,!1)});var A=/[\-:]([a-z])/g;function I(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var a=s.replace(A,I);w[a]=new D(a,1,!1,s,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var a=s.replace(A,I);w[a]=new D(a,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(s){var a=s.replace(A,I);w[a]=new D(a,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(s){w[s]=new D(s,1,!1,s.toLowerCase(),null,!1,!1)}),w.xlinkHref=new D("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(s){w[s]=new D(s,1,!1,s.toLowerCase(),null,!0,!0)});function V(s,a,h,p){var _=w.hasOwnProperty(a)?w[a]:null;(_!==null?_.type!==0:p||!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(M(a,h,_,p)&&(h=null),p||_===null?E(a)&&(h===null?s.removeAttribute(a):s.setAttribute(a,""+h)):_.mustUseProperty?s[_.propertyName]=h===null?_.type===3?!1:"":h:(a=_.attributeName,p=_.attributeNamespace,h===null?s.removeAttribute(a):(_=_.type,h=_===3||_===4&&h===!0?"":""+h,p?s.setAttributeNS(p,a,h):s.setAttribute(a,h))))}var q=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,P=Symbol.for("react.element"),U=Symbol.for("react.portal"),R=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),N=Symbol.for("react.provider"),z=Symbol.for("react.context"),j=Symbol.for("react.forward_ref"),L=Symbol.for("react.suspense"),he=Symbol.for("react.suspense_list"),_e=Symbol.for("react.memo"),De=Symbol.for("react.lazy"),de=Symbol.for("react.offscreen"),J=Symbol.iterator;function ce(s){return s===null||typeof s!="object"?null:(s=J&&s[J]||s["@@iterator"],typeof s=="function"?s:null)}var xe=Object.assign,Q;function se(s){if(Q===void 0)try{throw Error()}catch(h){var a=h.stack.trim().match(/\n( *(at )?)/);Q=a&&a[1]||""}return`
`+Q+s}var Ce=!1;function Ie(s,a){if(!s||Ce)return"";Ce=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(a)if(a=function(){throw Error()},Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(a,[])}catch(we){var p=we}Reflect.construct(s,[],a)}else{try{a.call()}catch(we){p=we}s.call(a.prototype)}else{try{throw Error()}catch(we){p=we}s()}}catch(we){if(we&&p&&typeof we.stack=="string"){for(var _=we.stack.split(`
`),x=p.stack.split(`
`),B=_.length-1,Y=x.length-1;1<=B&&0<=Y&&_[B]!==x[Y];)Y--;for(;1<=B&&0<=Y;B--,Y--)if(_[B]!==x[Y]){if(B!==1||Y!==1)do if(B--,Y--,0>Y||_[B]!==x[Y]){var re=`
`+_[B].replace(" at new "," at ");return s.displayName&&re.includes("<anonymous>")&&(re=re.replace("<anonymous>",s.displayName)),re}while(1<=B&&0<=Y);break}}}finally{Ce=!1,Error.prepareStackTrace=h}return(s=s?s.displayName||s.name:"")?se(s):""}function He(s){switch(s.tag){case 5:return se(s.type);case 16:return se("Lazy");case 13:return se("Suspense");case 19:return se("SuspenseList");case 0:case 2:case 15:return s=Ie(s.type,!1),s;case 11:return s=Ie(s.type.render,!1),s;case 1:return s=Ie(s.type,!0),s;default:return""}}function Ke(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case R:return"Fragment";case U:return"Portal";case C:return"Profiler";case S:return"StrictMode";case L:return"Suspense";case he:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case z:return(s.displayName||"Context")+".Consumer";case N:return(s._context.displayName||"Context")+".Provider";case j:var a=s.render;return s=s.displayName,s||(s=a.displayName||a.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case _e:return a=s.displayName||null,a!==null?a:Ke(s.type)||"Memo";case De:a=s._payload,s=s._init;try{return Ke(s(a))}catch{}}return null}function et(s){var a=s.type;switch(s.tag){case 24:return"Cache";case 9:return(a.displayName||"Context")+".Consumer";case 10:return(a._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=a.render,s=s.displayName||s.name||"",a.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return a;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ke(a);case 8:return a===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a}return null}function Fe(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Je(s){var a=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function Xe(s){var a=Je(s)?"checked":"value",h=Object.getOwnPropertyDescriptor(s.constructor.prototype,a),p=""+s[a];if(!s.hasOwnProperty(a)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var _=h.get,x=h.set;return Object.defineProperty(s,a,{configurable:!0,get:function(){return _.call(this)},set:function(B){p=""+B,x.call(this,B)}}),Object.defineProperty(s,a,{enumerable:h.enumerable}),{getValue:function(){return p},setValue:function(B){p=""+B},stopTracking:function(){s._valueTracker=null,delete s[a]}}}}function ft(s){s._valueTracker||(s._valueTracker=Xe(s))}function yt(s){if(!s)return!1;var a=s._valueTracker;if(!a)return!0;var h=a.getValue(),p="";return s&&(p=Je(s)?s.checked?"true":"false":s.value),s=p,s!==h?(a.setValue(s),!0):!1}function mt(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function _t(s,a){var h=a.checked;return xe({},a,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:h??s._wrapperState.initialChecked})}function kt(s,a){var h=a.defaultValue==null?"":a.defaultValue,p=a.checked!=null?a.checked:a.defaultChecked;h=Fe(a.value!=null?a.value:h),s._wrapperState={initialChecked:p,initialValue:h,controlled:a.type==="checkbox"||a.type==="radio"?a.checked!=null:a.value!=null}}function St(s,a){a=a.checked,a!=null&&V(s,"checked",a,!1)}function Tt(s,a){St(s,a);var h=Fe(a.value),p=a.type;if(h!=null)p==="number"?(h===0&&s.value===""||s.value!=h)&&(s.value=""+h):s.value!==""+h&&(s.value=""+h);else if(p==="submit"||p==="reset"){s.removeAttribute("value");return}a.hasOwnProperty("value")?Dt(s,a.type,h):a.hasOwnProperty("defaultValue")&&Dt(s,a.type,Fe(a.defaultValue)),a.checked==null&&a.defaultChecked!=null&&(s.defaultChecked=!!a.defaultChecked)}function Ht(s,a,h){if(a.hasOwnProperty("value")||a.hasOwnProperty("defaultValue")){var p=a.type;if(!(p!=="submit"&&p!=="reset"||a.value!==void 0&&a.value!==null))return;a=""+s._wrapperState.initialValue,h||a===s.value||(s.value=a),s.defaultValue=a}h=s.name,h!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,h!==""&&(s.name=h)}function Dt(s,a,h){(a!=="number"||mt(s.ownerDocument)!==s)&&(h==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+h&&(s.defaultValue=""+h))}var wt=Array.isArray;function it(s,a,h,p){if(s=s.options,a){a={};for(var _=0;_<h.length;_++)a["$"+h[_]]=!0;for(h=0;h<s.length;h++)_=a.hasOwnProperty("$"+s[h].value),s[h].selected!==_&&(s[h].selected=_),_&&p&&(s[h].defaultSelected=!0)}else{for(h=""+Fe(h),a=null,_=0;_<s.length;_++){if(s[_].value===h){s[_].selected=!0,p&&(s[_].defaultSelected=!0);return}a!==null||s[_].disabled||(a=s[_])}a!==null&&(a.selected=!0)}}function gt(s,a){if(a.dangerouslySetInnerHTML!=null)throw Error(t(91));return xe({},a,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function dt(s,a){var h=a.value;if(h==null){if(h=a.children,a=a.defaultValue,h!=null){if(a!=null)throw Error(t(92));if(wt(h)){if(1<h.length)throw Error(t(93));h=h[0]}a=h}a==null&&(a=""),h=a}s._wrapperState={initialValue:Fe(h)}}function an(s,a){var h=Fe(a.value),p=Fe(a.defaultValue);h!=null&&(h=""+h,h!==s.value&&(s.value=h),a.defaultValue==null&&s.defaultValue!==h&&(s.defaultValue=h)),p!=null&&(s.defaultValue=""+p)}function _n(s){var a=s.textContent;a===s._wrapperState.initialValue&&a!==""&&a!==null&&(s.value=a)}function xn(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function jt(s,a){return s==null||s==="http://www.w3.org/1999/xhtml"?xn(a):s==="http://www.w3.org/2000/svg"&&a==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var on,pn=(function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(a,h,p,_){MSApp.execUnsafeLocalFunction(function(){return s(a,h,p,_)})}:s})(function(s,a){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=a;else{for(on=on||document.createElement("div"),on.innerHTML="<svg>"+a.valueOf().toString()+"</svg>",a=on.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;a.firstChild;)s.appendChild(a.firstChild)}});function en(s,a){if(a){var h=s.firstChild;if(h&&h===s.lastChild&&h.nodeType===3){h.nodeValue=a;return}}s.textContent=a}var Qt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Tn=["Webkit","ms","Moz","O"];Object.keys(Qt).forEach(function(s){Tn.forEach(function(a){a=a+s.charAt(0).toUpperCase()+s.substring(1),Qt[a]=Qt[s]})});function Gt(s,a,h){return a==null||typeof a=="boolean"||a===""?"":h||typeof a!="number"||a===0||Qt.hasOwnProperty(s)&&Qt[s]?(""+a).trim():a+"px"}function hn(s,a){s=s.style;for(var h in a)if(a.hasOwnProperty(h)){var p=h.indexOf("--")===0,_=Gt(h,a[h],p);h==="float"&&(h="cssFloat"),p?s.setProperty(h,_):s[h]=_}}var Pn=xe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function $(s,a){if(a){if(Pn[s]&&(a.children!=null||a.dangerouslySetInnerHTML!=null))throw Error(t(137,s));if(a.dangerouslySetInnerHTML!=null){if(a.children!=null)throw Error(t(60));if(typeof a.dangerouslySetInnerHTML!="object"||!("__html"in a.dangerouslySetInnerHTML))throw Error(t(61))}if(a.style!=null&&typeof a.style!="object")throw Error(t(62))}}function Se(s,a){if(s.indexOf("-")===-1)return typeof a.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Re=null;function Ge(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var ne=null,be=null,v=null;function O(s){if(s=Ku(s)){if(typeof ne!="function")throw Error(t(280));var a=s.stateNode;a&&(a=Fc(a),ne(s.stateNode,s.type,a))}}function G(s){be?v?v.push(s):v=[s]:be=s}function y(){if(be){var s=be,a=v;if(v=be=null,O(s),a)for(s=0;s<a.length;s++)O(a[s])}}function X(s,a){return s(a)}function ie(){}var F=!1;function Z(s,a,h){if(F)return s(a,h);F=!0;try{return X(s,a,h)}finally{F=!1,(be!==null||v!==null)&&(ie(),y())}}function ue(s,a){var h=s.stateNode;if(h===null)return null;var p=Fc(h);if(p===null)return null;h=p[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(s=s.type,p=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!p;break e;default:s=!1}if(s)return null;if(h&&typeof h!="function")throw Error(t(231,a,typeof h));return h}var Ue=!1;if(l)try{var Ne={};Object.defineProperty(Ne,"passive",{get:function(){Ue=!0}}),window.addEventListener("test",Ne,Ne),window.removeEventListener("test",Ne,Ne)}catch{Ue=!1}function ze(s,a,h,p,_,x,B,Y,re){var we=Array.prototype.slice.call(arguments,3);try{a.apply(h,we)}catch(Le){this.onError(Le)}}var lt=!1,Lt=null,xt=!1,at=null,Vt={onError:function(s){lt=!0,Lt=s}};function Nt(s,a,h,p,_,x,B,Y,re){lt=!1,Lt=null,ze.apply(Vt,arguments)}function mn(s,a,h,p,_,x,B,Y,re){if(Nt.apply(this,arguments),lt){if(lt){var we=Lt;lt=!1,Lt=null}else throw Error(t(198));xt||(xt=!0,at=we)}}function gn(s){var a=s,h=s;if(s.alternate)for(;a.return;)a=a.return;else{s=a;do a=s,(a.flags&4098)!==0&&(h=a.return),s=a.return;while(s)}return a.tag===3?h:null}function yr(s){if(s.tag===13){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function un(s){if(gn(s)!==s)throw Error(t(188))}function jn(s){var a=s.alternate;if(!a){if(a=gn(s),a===null)throw Error(t(188));return a!==s?null:s}for(var h=s,p=a;;){var _=h.return;if(_===null)break;var x=_.alternate;if(x===null){if(p=_.return,p!==null){h=p;continue}break}if(_.child===x.child){for(x=_.child;x;){if(x===h)return un(_),s;if(x===p)return un(_),a;x=x.sibling}throw Error(t(188))}if(h.return!==p.return)h=_,p=x;else{for(var B=!1,Y=_.child;Y;){if(Y===h){B=!0,h=_,p=x;break}if(Y===p){B=!0,p=_,h=x;break}Y=Y.sibling}if(!B){for(Y=x.child;Y;){if(Y===h){B=!0,h=x,p=_;break}if(Y===p){B=!0,p=x,h=_;break}Y=Y.sibling}if(!B)throw Error(t(189))}}if(h.alternate!==p)throw Error(t(190))}if(h.tag!==3)throw Error(t(188));return h.stateNode.current===h?s:a}function wn(s){return s=jn(s),s!==null?qn(s):null}function qn(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var a=qn(s);if(a!==null)return a;s=s.sibling}return null}var Kn=e.unstable_scheduleCallback,ui=e.unstable_cancelCallback,Ki=e.unstable_shouldYield,Qr=e.unstable_requestPaint,Zt=e.unstable_now,sa=e.unstable_getCurrentPriorityLevel,Or=e.unstable_ImmediatePriority,go=e.unstable_UserBlockingPriority,Yr=e.unstable_NormalPriority,Qi=e.unstable_LowPriority,xs=e.unstable_IdlePriority,Yi=null,tr=null;function oa(s){if(tr&&typeof tr.onCommitFiberRoot=="function")try{tr.onCommitFiberRoot(Yi,s,void 0,(s.current.flags&128)===128)}catch{}}var _r=Math.clz32?Math.clz32:K,W=Math.log,ee=Math.LN2;function K(s){return s>>>=0,s===0?32:31-(W(s)/ee|0)|0}var oe=64,le=4194304;function te(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function Ae(s,a){var h=s.pendingLanes;if(h===0)return 0;var p=0,_=s.suspendedLanes,x=s.pingedLanes,B=h&268435455;if(B!==0){var Y=B&~_;Y!==0?p=te(Y):(x&=B,x!==0&&(p=te(x)))}else B=h&~_,B!==0?p=te(B):x!==0&&(p=te(x));if(p===0)return 0;if(a!==0&&a!==p&&(a&_)===0&&(_=p&-p,x=a&-a,_>=x||_===16&&(x&4194240)!==0))return a;if((p&4)!==0&&(p|=h&16),a=s.entangledLanes,a!==0)for(s=s.entanglements,a&=p;0<a;)h=31-_r(a),_=1<<h,p|=s[h],a&=~_;return p}function ke(s,a){switch(s){case 1:case 2:case 4:return a+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ve(s,a){for(var h=s.suspendedLanes,p=s.pingedLanes,_=s.expirationTimes,x=s.pendingLanes;0<x;){var B=31-_r(x),Y=1<<B,re=_[B];re===-1?((Y&h)===0||(Y&p)!==0)&&(_[B]=ke(Y,a)):re<=a&&(s.expiredLanes|=Y),x&=~Y}}function Be(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function je(){var s=oe;return oe<<=1,(oe&4194240)===0&&(oe=64),s}function tt(s){for(var a=[],h=0;31>h;h++)a.push(s);return a}function It(s,a,h){s.pendingLanes|=a,a!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,a=31-_r(a),s[a]=h}function qt(s,a){var h=s.pendingLanes&~a;s.pendingLanes=a,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=a,s.mutableReadLanes&=a,s.entangledLanes&=a,a=s.entanglements;var p=s.eventTimes;for(s=s.expirationTimes;0<h;){var _=31-_r(h),x=1<<_;a[_]=0,p[_]=-1,s[_]=-1,h&=~x}}function Mt(s,a){var h=s.entangledLanes|=a;for(s=s.entanglements;h;){var p=31-_r(h),_=1<<p;_&a|s[p]&a&&(s[p]|=a),h&=~_}}var pt=0;function Yt(s){return s&=-s,1<s?4<s?(s&268435455)!==0?16:536870912:4:1}var Qn,Xr,Xi,vo,Zi,li=!1,Ts=[],Zr=null,Lr=null,nr=null,yo=new Map,Ji=new Map,Vr=[],Ec="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function As(s,a){switch(s){case"focusin":case"focusout":Zr=null;break;case"dragenter":case"dragleave":Lr=null;break;case"mouseover":case"mouseout":nr=null;break;case"pointerover":case"pointerout":yo.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ji.delete(a.pointerId)}}function ci(s,a,h,p,_,x){return s===null||s.nativeEvent!==x?(s={blockedOn:a,domEventName:h,eventSystemFlags:p,nativeEvent:x,targetContainers:[_]},a!==null&&(a=Ku(a),a!==null&&Xr(a)),s):(s.eventSystemFlags|=p,a=s.targetContainers,_!==null&&a.indexOf(_)===-1&&a.push(_),s)}function bc(s,a,h,p,_){switch(a){case"focusin":return Zr=ci(Zr,s,a,h,p,_),!0;case"dragenter":return Lr=ci(Lr,s,a,h,p,_),!0;case"mouseover":return nr=ci(nr,s,a,h,p,_),!0;case"pointerover":var x=_.pointerId;return yo.set(x,ci(yo.get(x)||null,s,a,h,p,_)),!0;case"gotpointercapture":return x=_.pointerId,Ji.set(x,ci(Ji.get(x)||null,s,a,h,p,_)),!0}return!1}function aa(s){var a=bo(s.target);if(a!==null){var h=gn(a);if(h!==null){if(a=h.tag,a===13){if(a=yr(h),a!==null){s.blockedOn=a,Zi(s.priority,function(){Xi(h)});return}}else if(a===3&&h.stateNode.current.memoizedState.isDehydrated){s.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}s.blockedOn=null}function ln(s){if(s.blockedOn!==null)return!1;for(var a=s.targetContainers;0<a.length;){var h=ua(s.domEventName,s.eventSystemFlags,a[0],s.nativeEvent);if(h===null){h=s.nativeEvent;var p=new h.constructor(h.type,h);Re=p,h.target.dispatchEvent(p),Re=null}else return a=Ku(h),a!==null&&Xr(a),s.blockedOn=h,!1;a.shift()}return!0}function xc(s,a,h){ln(s)&&h.delete(a)}function df(){li=!1,Zr!==null&&ln(Zr)&&(Zr=null),Lr!==null&&ln(Lr)&&(Lr=null),nr!==null&&ln(nr)&&(nr=null),yo.forEach(xc),Ji.forEach(xc)}function Ss(s,a){s.blockedOn===a&&(s.blockedOn=null,li||(li=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,df)))}function Is(s){function a(_){return Ss(_,s)}if(0<Ts.length){Ss(Ts[0],s);for(var h=1;h<Ts.length;h++){var p=Ts[h];p.blockedOn===s&&(p.blockedOn=null)}}for(Zr!==null&&Ss(Zr,s),Lr!==null&&Ss(Lr,s),nr!==null&&Ss(nr,s),yo.forEach(a),Ji.forEach(a),h=0;h<Vr.length;h++)p=Vr[h],p.blockedOn===s&&(p.blockedOn=null);for(;0<Vr.length&&(h=Vr[0],h.blockedOn===null);)aa(h),h.blockedOn===null&&Vr.shift()}var es=q.ReactCurrentBatchConfig,ts=!0;function Si(s,a,h,p){var _=pt,x=es.transition;es.transition=null;try{pt=1,Lu(s,a,h,p)}finally{pt=_,es.transition=x}}function Tc(s,a,h,p){var _=pt,x=es.transition;es.transition=null;try{pt=4,Lu(s,a,h,p)}finally{pt=_,es.transition=x}}function Lu(s,a,h,p){if(ts){var _=ua(s,a,h,p);if(_===null)xf(s,a,p,Ii,h),As(s,p);else if(bc(_,s,a,h,p))p.stopPropagation();else if(As(s,p),a&4&&-1<Ec.indexOf(s)){for(;_!==null;){var x=Ku(_);if(x!==null&&Qn(x),x=ua(s,a,h,p),x===null&&xf(s,a,p,Ii,h),x===_)break;_=x}_!==null&&p.stopPropagation()}else xf(s,a,p,null,h)}}var Ii=null;function ua(s,a,h,p){if(Ii=null,s=Ge(p),s=bo(s),s!==null)if(a=gn(s),a===null)s=null;else if(h=a.tag,h===13){if(s=yr(a),s!==null)return s;s=null}else if(h===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;s=null}else a!==s&&(s=null);return Ii=s,null}function la(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(sa()){case Or:return 1;case go:return 4;case Yr:case Qi:return 16;case xs:return 536870912;default:return 16}default:return 16}}var Fr=null,ca=null,ns=null;function Ac(){if(ns)return ns;var s,a=ca,h=a.length,p,_="value"in Fr?Fr.value:Fr.textContent,x=_.length;for(s=0;s<h&&a[s]===_[s];s++);var B=h-s;for(p=1;p<=B&&a[h-p]===_[x-p];p++);return ns=_.slice(s,1<p?1-p:void 0)}function _o(s){var a=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&a===13&&(s=13)):s=a,s===10&&(s=13),32<=s||s===13?s:0}function Ci(){return!0}function Vu(){return!1}function ur(s){function a(h,p,_,x,B){this._reactName=h,this._targetInst=_,this.type=p,this.nativeEvent=x,this.target=B,this.currentTarget=null;for(var Y in s)s.hasOwnProperty(Y)&&(h=s[Y],this[Y]=h?h(x):x[Y]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?Ci:Vu,this.isPropagationStopped=Vu,this}return xe(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=Ci)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=Ci)},persist:function(){},isPersistent:Ci}),a}var Di={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},wo=ur(Di),Cs=xe({},Di,{view:0,detail:0}),ha=ur(Cs),da,fa,Mr,Eo=xe({},Cs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Rt,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Mr&&(Mr&&s.type==="mousemove"?(da=s.screenX-Mr.screenX,fa=s.screenY-Mr.screenY):fa=da=0,Mr=s),da)},movementY:function(s){return"movementY"in s?s.movementY:fa}}),Fu=ur(Eo),Sc=xe({},Eo,{dataTransfer:0}),Ic=ur(Sc),pa=xe({},Cs,{relatedTarget:0}),rr=ur(pa),Cc=xe({},Di,{animationName:0,elapsedTime:0,pseudoElement:0}),Dc=ur(Cc),Ds=xe({},Di,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),f=ur(Ds),T=xe({},Di,{data:0}),k=ur(T),H={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},me={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ee={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function $e(s){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(s):(s=Ee[s])?!!a[s]:!1}function Rt(){return $e}var On=xe({},Cs,{key:function(s){if(s.key){var a=H[s.key]||s.key;if(a!=="Unidentified")return a}return s.type==="keypress"?(s=_o(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?me[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Rt,charCode:function(s){return s.type==="keypress"?_o(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?_o(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),tn=ur(On),Mn=xe({},Eo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Br=ur(Mn),rs=xe({},Cs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Rt}),Ri=ur(rs),ki=xe({},Di,{propertyName:0,elapsedTime:0,pseudoElement:0}),ma=ur(ki),Mu=xe({},Eo,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),LT=ur(Mu),VT=[9,13,27,32],ff=l&&"CompositionEvent"in window,Bu=null;l&&"documentMode"in document&&(Bu=document.documentMode);var FT=l&&"TextEvent"in window&&!Bu,vy=l&&(!ff||Bu&&8<Bu&&11>=Bu),yy=" ",_y=!1;function wy(s,a){switch(s){case"keyup":return VT.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ey(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var ga=!1;function MT(s,a){switch(s){case"compositionend":return Ey(a);case"keypress":return a.which!==32?null:(_y=!0,yy);case"textInput":return s=a.data,s===yy&&_y?null:s;default:return null}}function BT(s,a){if(ga)return s==="compositionend"||!ff&&wy(s,a)?(s=Ac(),ns=ca=Fr=null,ga=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return vy&&a.locale!=="ko"?null:a.data;default:return null}}var zT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function by(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a==="input"?!!zT[s.type]:a==="textarea"}function xy(s,a,h,p){G(p),a=Oc(a,"onChange"),0<a.length&&(h=new wo("onChange","change",null,h,p),s.push({event:h,listeners:a}))}var zu=null,Uu=null;function UT(s){Uy(s,0)}function Rc(s){var a=Ea(s);if(yt(a))return s}function jT(s,a){if(s==="change")return a}var Ty=!1;if(l){var pf;if(l){var mf="oninput"in document;if(!mf){var Ay=document.createElement("div");Ay.setAttribute("oninput","return;"),mf=typeof Ay.oninput=="function"}pf=mf}else pf=!1;Ty=pf&&(!document.documentMode||9<document.documentMode)}function Sy(){zu&&(zu.detachEvent("onpropertychange",Iy),Uu=zu=null)}function Iy(s){if(s.propertyName==="value"&&Rc(Uu)){var a=[];xy(a,Uu,s,Ge(s)),Z(UT,a)}}function qT(s,a,h){s==="focusin"?(Sy(),zu=a,Uu=h,zu.attachEvent("onpropertychange",Iy)):s==="focusout"&&Sy()}function WT(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Rc(Uu)}function $T(s,a){if(s==="click")return Rc(a)}function HT(s,a){if(s==="input"||s==="change")return Rc(a)}function GT(s,a){return s===a&&(s!==0||1/s===1/a)||s!==s&&a!==a}var hi=typeof Object.is=="function"?Object.is:GT;function ju(s,a){if(hi(s,a))return!0;if(typeof s!="object"||s===null||typeof a!="object"||a===null)return!1;var h=Object.keys(s),p=Object.keys(a);if(h.length!==p.length)return!1;for(p=0;p<h.length;p++){var _=h[p];if(!c.call(a,_)||!hi(s[_],a[_]))return!1}return!0}function Cy(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Dy(s,a){var h=Cy(s);s=0;for(var p;h;){if(h.nodeType===3){if(p=s+h.textContent.length,s<=a&&p>=a)return{node:h,offset:a-s};s=p}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=Cy(h)}}function Ry(s,a){return s&&a?s===a?!0:s&&s.nodeType===3?!1:a&&a.nodeType===3?Ry(s,a.parentNode):"contains"in s?s.contains(a):s.compareDocumentPosition?!!(s.compareDocumentPosition(a)&16):!1:!1}function ky(){for(var s=window,a=mt();a instanceof s.HTMLIFrameElement;){try{var h=typeof a.contentWindow.location.href=="string"}catch{h=!1}if(h)s=a.contentWindow;else break;a=mt(s.document)}return a}function gf(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a&&(a==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||a==="textarea"||s.contentEditable==="true")}function KT(s){var a=ky(),h=s.focusedElem,p=s.selectionRange;if(a!==h&&h&&h.ownerDocument&&Ry(h.ownerDocument.documentElement,h)){if(p!==null&&gf(h)){if(a=p.start,s=p.end,s===void 0&&(s=a),"selectionStart"in h)h.selectionStart=a,h.selectionEnd=Math.min(s,h.value.length);else if(s=(a=h.ownerDocument||document)&&a.defaultView||window,s.getSelection){s=s.getSelection();var _=h.textContent.length,x=Math.min(p.start,_);p=p.end===void 0?x:Math.min(p.end,_),!s.extend&&x>p&&(_=p,p=x,x=_),_=Dy(h,x);var B=Dy(h,p);_&&B&&(s.rangeCount!==1||s.anchorNode!==_.node||s.anchorOffset!==_.offset||s.focusNode!==B.node||s.focusOffset!==B.offset)&&(a=a.createRange(),a.setStart(_.node,_.offset),s.removeAllRanges(),x>p?(s.addRange(a),s.extend(B.node,B.offset)):(a.setEnd(B.node,B.offset),s.addRange(a)))}}for(a=[],s=h;s=s.parentNode;)s.nodeType===1&&a.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof h.focus=="function"&&h.focus(),h=0;h<a.length;h++)s=a[h],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var QT=l&&"documentMode"in document&&11>=document.documentMode,va=null,vf=null,qu=null,yf=!1;function Ny(s,a,h){var p=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;yf||va==null||va!==mt(p)||(p=va,"selectionStart"in p&&gf(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),qu&&ju(qu,p)||(qu=p,p=Oc(vf,"onSelect"),0<p.length&&(a=new wo("onSelect","select",null,a,h),s.push({event:a,listeners:p}),a.target=va)))}function kc(s,a){var h={};return h[s.toLowerCase()]=a.toLowerCase(),h["Webkit"+s]="webkit"+a,h["Moz"+s]="moz"+a,h}var ya={animationend:kc("Animation","AnimationEnd"),animationiteration:kc("Animation","AnimationIteration"),animationstart:kc("Animation","AnimationStart"),transitionend:kc("Transition","TransitionEnd")},_f={},Py={};l&&(Py=document.createElement("div").style,"AnimationEvent"in window||(delete ya.animationend.animation,delete ya.animationiteration.animation,delete ya.animationstart.animation),"TransitionEvent"in window||delete ya.transitionend.transition);function Nc(s){if(_f[s])return _f[s];if(!ya[s])return s;var a=ya[s],h;for(h in a)if(a.hasOwnProperty(h)&&h in Py)return _f[s]=a[h];return s}var Oy=Nc("animationend"),Ly=Nc("animationiteration"),Vy=Nc("animationstart"),Fy=Nc("transitionend"),My=new Map,By="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Rs(s,a){My.set(s,a),o(a,[s])}for(var wf=0;wf<By.length;wf++){var Ef=By[wf],YT=Ef.toLowerCase(),XT=Ef[0].toUpperCase()+Ef.slice(1);Rs(YT,"on"+XT)}Rs(Oy,"onAnimationEnd"),Rs(Ly,"onAnimationIteration"),Rs(Vy,"onAnimationStart"),Rs("dblclick","onDoubleClick"),Rs("focusin","onFocus"),Rs("focusout","onBlur"),Rs(Fy,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ZT=new Set("cancel close invalid load scroll toggle".split(" ").concat(Wu));function zy(s,a,h){var p=s.type||"unknown-event";s.currentTarget=h,mn(p,a,void 0,s),s.currentTarget=null}function Uy(s,a){a=(a&4)!==0;for(var h=0;h<s.length;h++){var p=s[h],_=p.event;p=p.listeners;e:{var x=void 0;if(a)for(var B=p.length-1;0<=B;B--){var Y=p[B],re=Y.instance,we=Y.currentTarget;if(Y=Y.listener,re!==x&&_.isPropagationStopped())break e;zy(_,Y,we),x=re}else for(B=0;B<p.length;B++){if(Y=p[B],re=Y.instance,we=Y.currentTarget,Y=Y.listener,re!==x&&_.isPropagationStopped())break e;zy(_,Y,we),x=re}}}if(xt)throw s=at,xt=!1,at=null,s}function vn(s,a){var h=a[Df];h===void 0&&(h=a[Df]=new Set);var p=s+"__bubble";h.has(p)||(jy(a,s,2,!1),h.add(p))}function bf(s,a,h){var p=0;a&&(p|=4),jy(h,s,p,a)}var Pc="_reactListening"+Math.random().toString(36).slice(2);function $u(s){if(!s[Pc]){s[Pc]=!0,n.forEach(function(h){h!=="selectionchange"&&(ZT.has(h)||bf(h,!1,s),bf(h,!0,s))});var a=s.nodeType===9?s:s.ownerDocument;a===null||a[Pc]||(a[Pc]=!0,bf("selectionchange",!1,a))}}function jy(s,a,h,p){switch(la(a)){case 1:var _=Si;break;case 4:_=Tc;break;default:_=Lu}h=_.bind(null,a,h,s),_=void 0,!Ue||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(_=!0),p?_!==void 0?s.addEventListener(a,h,{capture:!0,passive:_}):s.addEventListener(a,h,!0):_!==void 0?s.addEventListener(a,h,{passive:_}):s.addEventListener(a,h,!1)}function xf(s,a,h,p,_){var x=p;if((a&1)===0&&(a&2)===0&&p!==null)e:for(;;){if(p===null)return;var B=p.tag;if(B===3||B===4){var Y=p.stateNode.containerInfo;if(Y===_||Y.nodeType===8&&Y.parentNode===_)break;if(B===4)for(B=p.return;B!==null;){var re=B.tag;if((re===3||re===4)&&(re=B.stateNode.containerInfo,re===_||re.nodeType===8&&re.parentNode===_))return;B=B.return}for(;Y!==null;){if(B=bo(Y),B===null)return;if(re=B.tag,re===5||re===6){p=x=B;continue e}Y=Y.parentNode}}p=p.return}Z(function(){var we=x,Le=Ge(h),Me=[];e:{var Pe=My.get(s);if(Pe!==void 0){var Ze=wo,st=s;switch(s){case"keypress":if(_o(h)===0)break e;case"keydown":case"keyup":Ze=tn;break;case"focusin":st="focus",Ze=rr;break;case"focusout":st="blur",Ze=rr;break;case"beforeblur":case"afterblur":Ze=rr;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ze=Fu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ze=Ic;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ze=Ri;break;case Oy:case Ly:case Vy:Ze=Dc;break;case Fy:Ze=ma;break;case"scroll":Ze=ha;break;case"wheel":Ze=LT;break;case"copy":case"cut":case"paste":Ze=f;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ze=Br}var ut=(a&4)!==0,Ln=!ut&&s==="scroll",pe=ut?Pe!==null?Pe+"Capture":null:Pe;ut=[];for(var ae=we,ve;ae!==null;){ve=ae;var qe=ve.stateNode;if(ve.tag===5&&qe!==null&&(ve=qe,pe!==null&&(qe=ue(ae,pe),qe!=null&&ut.push(Hu(ae,qe,ve)))),Ln)break;ae=ae.return}0<ut.length&&(Pe=new Ze(Pe,st,null,h,Le),Me.push({event:Pe,listeners:ut}))}}if((a&7)===0){e:{if(Pe=s==="mouseover"||s==="pointerover",Ze=s==="mouseout"||s==="pointerout",Pe&&h!==Re&&(st=h.relatedTarget||h.fromElement)&&(bo(st)||st[is]))break e;if((Ze||Pe)&&(Pe=Le.window===Le?Le:(Pe=Le.ownerDocument)?Pe.defaultView||Pe.parentWindow:window,Ze?(st=h.relatedTarget||h.toElement,Ze=we,st=st?bo(st):null,st!==null&&(Ln=gn(st),st!==Ln||st.tag!==5&&st.tag!==6)&&(st=null)):(Ze=null,st=we),Ze!==st)){if(ut=Fu,qe="onMouseLeave",pe="onMouseEnter",ae="mouse",(s==="pointerout"||s==="pointerover")&&(ut=Br,qe="onPointerLeave",pe="onPointerEnter",ae="pointer"),Ln=Ze==null?Pe:Ea(Ze),ve=st==null?Pe:Ea(st),Pe=new ut(qe,ae+"leave",Ze,h,Le),Pe.target=Ln,Pe.relatedTarget=ve,qe=null,bo(Le)===we&&(ut=new ut(pe,ae+"enter",st,h,Le),ut.target=ve,ut.relatedTarget=Ln,qe=ut),Ln=qe,Ze&&st)t:{for(ut=Ze,pe=st,ae=0,ve=ut;ve;ve=_a(ve))ae++;for(ve=0,qe=pe;qe;qe=_a(qe))ve++;for(;0<ae-ve;)ut=_a(ut),ae--;for(;0<ve-ae;)pe=_a(pe),ve--;for(;ae--;){if(ut===pe||pe!==null&&ut===pe.alternate)break t;ut=_a(ut),pe=_a(pe)}ut=null}else ut=null;Ze!==null&&qy(Me,Pe,Ze,ut,!1),st!==null&&Ln!==null&&qy(Me,Ln,st,ut,!0)}}e:{if(Pe=we?Ea(we):window,Ze=Pe.nodeName&&Pe.nodeName.toLowerCase(),Ze==="select"||Ze==="input"&&Pe.type==="file")var ct=jT;else if(by(Pe))if(Ty)ct=HT;else{ct=WT;var Et=qT}else(Ze=Pe.nodeName)&&Ze.toLowerCase()==="input"&&(Pe.type==="checkbox"||Pe.type==="radio")&&(ct=$T);if(ct&&(ct=ct(s,we))){xy(Me,ct,h,Le);break e}Et&&Et(s,Pe,we),s==="focusout"&&(Et=Pe._wrapperState)&&Et.controlled&&Pe.type==="number"&&Dt(Pe,"number",Pe.value)}switch(Et=we?Ea(we):window,s){case"focusin":(by(Et)||Et.contentEditable==="true")&&(va=Et,vf=we,qu=null);break;case"focusout":qu=vf=va=null;break;case"mousedown":yf=!0;break;case"contextmenu":case"mouseup":case"dragend":yf=!1,Ny(Me,h,Le);break;case"selectionchange":if(QT)break;case"keydown":case"keyup":Ny(Me,h,Le)}var bt;if(ff)e:{switch(s){case"compositionstart":var At="onCompositionStart";break e;case"compositionend":At="onCompositionEnd";break e;case"compositionupdate":At="onCompositionUpdate";break e}At=void 0}else ga?wy(s,h)&&(At="onCompositionEnd"):s==="keydown"&&h.keyCode===229&&(At="onCompositionStart");At&&(vy&&h.locale!=="ko"&&(ga||At!=="onCompositionStart"?At==="onCompositionEnd"&&ga&&(bt=Ac()):(Fr=Le,ca="value"in Fr?Fr.value:Fr.textContent,ga=!0)),Et=Oc(we,At),0<Et.length&&(At=new k(At,s,null,h,Le),Me.push({event:At,listeners:Et}),bt?At.data=bt:(bt=Ey(h),bt!==null&&(At.data=bt)))),(bt=FT?MT(s,h):BT(s,h))&&(we=Oc(we,"onBeforeInput"),0<we.length&&(Le=new k("onBeforeInput","beforeinput",null,h,Le),Me.push({event:Le,listeners:we}),Le.data=bt))}Uy(Me,a)})}function Hu(s,a,h){return{instance:s,listener:a,currentTarget:h}}function Oc(s,a){for(var h=a+"Capture",p=[];s!==null;){var _=s,x=_.stateNode;_.tag===5&&x!==null&&(_=x,x=ue(s,h),x!=null&&p.unshift(Hu(s,x,_)),x=ue(s,a),x!=null&&p.push(Hu(s,x,_))),s=s.return}return p}function _a(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function qy(s,a,h,p,_){for(var x=a._reactName,B=[];h!==null&&h!==p;){var Y=h,re=Y.alternate,we=Y.stateNode;if(re!==null&&re===p)break;Y.tag===5&&we!==null&&(Y=we,_?(re=ue(h,x),re!=null&&B.unshift(Hu(h,re,Y))):_||(re=ue(h,x),re!=null&&B.push(Hu(h,re,Y)))),h=h.return}B.length!==0&&s.push({event:a,listeners:B})}var JT=/\r\n?/g,eA=/\u0000|\uFFFD/g;function Wy(s){return(typeof s=="string"?s:""+s).replace(JT,`
`).replace(eA,"")}function Lc(s,a,h){if(a=Wy(a),Wy(s)!==a&&h)throw Error(t(425))}function Vc(){}var Tf=null,Af=null;function Sf(s,a){return s==="textarea"||s==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var If=typeof setTimeout=="function"?setTimeout:void 0,tA=typeof clearTimeout=="function"?clearTimeout:void 0,$y=typeof Promise=="function"?Promise:void 0,nA=typeof queueMicrotask=="function"?queueMicrotask:typeof $y<"u"?function(s){return $y.resolve(null).then(s).catch(rA)}:If;function rA(s){setTimeout(function(){throw s})}function Cf(s,a){var h=a,p=0;do{var _=h.nextSibling;if(s.removeChild(h),_&&_.nodeType===8)if(h=_.data,h==="/$"){if(p===0){s.removeChild(_),Is(a);return}p--}else h!=="$"&&h!=="$?"&&h!=="$!"||p++;h=_}while(h);Is(a)}function ks(s){for(;s!=null;s=s.nextSibling){var a=s.nodeType;if(a===1||a===3)break;if(a===8){if(a=s.data,a==="$"||a==="$!"||a==="$?")break;if(a==="/$")return null}}return s}function Hy(s){s=s.previousSibling;for(var a=0;s;){if(s.nodeType===8){var h=s.data;if(h==="$"||h==="$!"||h==="$?"){if(a===0)return s;a--}else h==="/$"&&a++}s=s.previousSibling}return null}var wa=Math.random().toString(36).slice(2),Ni="__reactFiber$"+wa,Gu="__reactProps$"+wa,is="__reactContainer$"+wa,Df="__reactEvents$"+wa,iA="__reactListeners$"+wa,sA="__reactHandles$"+wa;function bo(s){var a=s[Ni];if(a)return a;for(var h=s.parentNode;h;){if(a=h[is]||h[Ni]){if(h=a.alternate,a.child!==null||h!==null&&h.child!==null)for(s=Hy(s);s!==null;){if(h=s[Ni])return h;s=Hy(s)}return a}s=h,h=s.parentNode}return null}function Ku(s){return s=s[Ni]||s[is],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function Ea(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(t(33))}function Fc(s){return s[Gu]||null}var Rf=[],ba=-1;function Ns(s){return{current:s}}function yn(s){0>ba||(s.current=Rf[ba],Rf[ba]=null,ba--)}function dn(s,a){ba++,Rf[ba]=s.current,s.current=a}var Ps={},lr=Ns(Ps),Ar=Ns(!1),xo=Ps;function xa(s,a){var h=s.type.contextTypes;if(!h)return Ps;var p=s.stateNode;if(p&&p.__reactInternalMemoizedUnmaskedChildContext===a)return p.__reactInternalMemoizedMaskedChildContext;var _={},x;for(x in h)_[x]=a[x];return p&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=a,s.__reactInternalMemoizedMaskedChildContext=_),_}function Sr(s){return s=s.childContextTypes,s!=null}function Mc(){yn(Ar),yn(lr)}function Gy(s,a,h){if(lr.current!==Ps)throw Error(t(168));dn(lr,a),dn(Ar,h)}function Ky(s,a,h){var p=s.stateNode;if(a=a.childContextTypes,typeof p.getChildContext!="function")return h;p=p.getChildContext();for(var _ in p)if(!(_ in a))throw Error(t(108,et(s)||"Unknown",_));return xe({},h,p)}function Bc(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||Ps,xo=lr.current,dn(lr,s),dn(Ar,Ar.current),!0}function Qy(s,a,h){var p=s.stateNode;if(!p)throw Error(t(169));h?(s=Ky(s,a,xo),p.__reactInternalMemoizedMergedChildContext=s,yn(Ar),yn(lr),dn(lr,s)):yn(Ar),dn(Ar,h)}var ss=null,zc=!1,kf=!1;function Yy(s){ss===null?ss=[s]:ss.push(s)}function oA(s){zc=!0,Yy(s)}function Os(){if(!kf&&ss!==null){kf=!0;var s=0,a=pt;try{var h=ss;for(pt=1;s<h.length;s++){var p=h[s];do p=p(!0);while(p!==null)}ss=null,zc=!1}catch(_){throw ss!==null&&(ss=ss.slice(s+1)),Kn(Or,Os),_}finally{pt=a,kf=!1}}return null}var Ta=[],Aa=0,Uc=null,jc=0,Jr=[],ei=0,To=null,os=1,as="";function Ao(s,a){Ta[Aa++]=jc,Ta[Aa++]=Uc,Uc=s,jc=a}function Xy(s,a,h){Jr[ei++]=os,Jr[ei++]=as,Jr[ei++]=To,To=s;var p=os;s=as;var _=32-_r(p)-1;p&=~(1<<_),h+=1;var x=32-_r(a)+_;if(30<x){var B=_-_%5;x=(p&(1<<B)-1).toString(32),p>>=B,_-=B,os=1<<32-_r(a)+_|h<<_|p,as=x+s}else os=1<<x|h<<_|p,as=s}function Nf(s){s.return!==null&&(Ao(s,1),Xy(s,1,0))}function Pf(s){for(;s===Uc;)Uc=Ta[--Aa],Ta[Aa]=null,jc=Ta[--Aa],Ta[Aa]=null;for(;s===To;)To=Jr[--ei],Jr[ei]=null,as=Jr[--ei],Jr[ei]=null,os=Jr[--ei],Jr[ei]=null}var zr=null,Ur=null,En=!1,di=null;function Zy(s,a){var h=ii(5,null,null,0);h.elementType="DELETED",h.stateNode=a,h.return=s,a=s.deletions,a===null?(s.deletions=[h],s.flags|=16):a.push(h)}function Jy(s,a){switch(s.tag){case 5:var h=s.type;return a=a.nodeType!==1||h.toLowerCase()!==a.nodeName.toLowerCase()?null:a,a!==null?(s.stateNode=a,zr=s,Ur=ks(a.firstChild),!0):!1;case 6:return a=s.pendingProps===""||a.nodeType!==3?null:a,a!==null?(s.stateNode=a,zr=s,Ur=null,!0):!1;case 13:return a=a.nodeType!==8?null:a,a!==null?(h=To!==null?{id:os,overflow:as}:null,s.memoizedState={dehydrated:a,treeContext:h,retryLane:1073741824},h=ii(18,null,null,0),h.stateNode=a,h.return=s,s.child=h,zr=s,Ur=null,!0):!1;default:return!1}}function Of(s){return(s.mode&1)!==0&&(s.flags&128)===0}function Lf(s){if(En){var a=Ur;if(a){var h=a;if(!Jy(s,a)){if(Of(s))throw Error(t(418));a=ks(h.nextSibling);var p=zr;a&&Jy(s,a)?Zy(p,h):(s.flags=s.flags&-4097|2,En=!1,zr=s)}}else{if(Of(s))throw Error(t(418));s.flags=s.flags&-4097|2,En=!1,zr=s}}}function e0(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;zr=s}function qc(s){if(s!==zr)return!1;if(!En)return e0(s),En=!0,!1;var a;if((a=s.tag!==3)&&!(a=s.tag!==5)&&(a=s.type,a=a!=="head"&&a!=="body"&&!Sf(s.type,s.memoizedProps)),a&&(a=Ur)){if(Of(s))throw t0(),Error(t(418));for(;a;)Zy(s,a),a=ks(a.nextSibling)}if(e0(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(t(317));e:{for(s=s.nextSibling,a=0;s;){if(s.nodeType===8){var h=s.data;if(h==="/$"){if(a===0){Ur=ks(s.nextSibling);break e}a--}else h!=="$"&&h!=="$!"&&h!=="$?"||a++}s=s.nextSibling}Ur=null}}else Ur=zr?ks(s.stateNode.nextSibling):null;return!0}function t0(){for(var s=Ur;s;)s=ks(s.nextSibling)}function Sa(){Ur=zr=null,En=!1}function Vf(s){di===null?di=[s]:di.push(s)}var aA=q.ReactCurrentBatchConfig;function Qu(s,a,h){if(s=h.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(t(309));var p=h.stateNode}if(!p)throw Error(t(147,s));var _=p,x=""+s;return a!==null&&a.ref!==null&&typeof a.ref=="function"&&a.ref._stringRef===x?a.ref:(a=function(B){var Y=_.refs;B===null?delete Y[x]:Y[x]=B},a._stringRef=x,a)}if(typeof s!="string")throw Error(t(284));if(!h._owner)throw Error(t(290,s))}return s}function Wc(s,a){throw s=Object.prototype.toString.call(a),Error(t(31,s==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":s))}function n0(s){var a=s._init;return a(s._payload)}function r0(s){function a(pe,ae){if(s){var ve=pe.deletions;ve===null?(pe.deletions=[ae],pe.flags|=16):ve.push(ae)}}function h(pe,ae){if(!s)return null;for(;ae!==null;)a(pe,ae),ae=ae.sibling;return null}function p(pe,ae){for(pe=new Map;ae!==null;)ae.key!==null?pe.set(ae.key,ae):pe.set(ae.index,ae),ae=ae.sibling;return pe}function _(pe,ae){return pe=js(pe,ae),pe.index=0,pe.sibling=null,pe}function x(pe,ae,ve){return pe.index=ve,s?(ve=pe.alternate,ve!==null?(ve=ve.index,ve<ae?(pe.flags|=2,ae):ve):(pe.flags|=2,ae)):(pe.flags|=1048576,ae)}function B(pe){return s&&pe.alternate===null&&(pe.flags|=2),pe}function Y(pe,ae,ve,qe){return ae===null||ae.tag!==6?(ae=Ip(ve,pe.mode,qe),ae.return=pe,ae):(ae=_(ae,ve),ae.return=pe,ae)}function re(pe,ae,ve,qe){var ct=ve.type;return ct===R?Le(pe,ae,ve.props.children,qe,ve.key):ae!==null&&(ae.elementType===ct||typeof ct=="object"&&ct!==null&&ct.$$typeof===De&&n0(ct)===ae.type)?(qe=_(ae,ve.props),qe.ref=Qu(pe,ae,ve),qe.return=pe,qe):(qe=ph(ve.type,ve.key,ve.props,null,pe.mode,qe),qe.ref=Qu(pe,ae,ve),qe.return=pe,qe)}function we(pe,ae,ve,qe){return ae===null||ae.tag!==4||ae.stateNode.containerInfo!==ve.containerInfo||ae.stateNode.implementation!==ve.implementation?(ae=Cp(ve,pe.mode,qe),ae.return=pe,ae):(ae=_(ae,ve.children||[]),ae.return=pe,ae)}function Le(pe,ae,ve,qe,ct){return ae===null||ae.tag!==7?(ae=Po(ve,pe.mode,qe,ct),ae.return=pe,ae):(ae=_(ae,ve),ae.return=pe,ae)}function Me(pe,ae,ve){if(typeof ae=="string"&&ae!==""||typeof ae=="number")return ae=Ip(""+ae,pe.mode,ve),ae.return=pe,ae;if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case P:return ve=ph(ae.type,ae.key,ae.props,null,pe.mode,ve),ve.ref=Qu(pe,null,ae),ve.return=pe,ve;case U:return ae=Cp(ae,pe.mode,ve),ae.return=pe,ae;case De:var qe=ae._init;return Me(pe,qe(ae._payload),ve)}if(wt(ae)||ce(ae))return ae=Po(ae,pe.mode,ve,null),ae.return=pe,ae;Wc(pe,ae)}return null}function Pe(pe,ae,ve,qe){var ct=ae!==null?ae.key:null;if(typeof ve=="string"&&ve!==""||typeof ve=="number")return ct!==null?null:Y(pe,ae,""+ve,qe);if(typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case P:return ve.key===ct?re(pe,ae,ve,qe):null;case U:return ve.key===ct?we(pe,ae,ve,qe):null;case De:return ct=ve._init,Pe(pe,ae,ct(ve._payload),qe)}if(wt(ve)||ce(ve))return ct!==null?null:Le(pe,ae,ve,qe,null);Wc(pe,ve)}return null}function Ze(pe,ae,ve,qe,ct){if(typeof qe=="string"&&qe!==""||typeof qe=="number")return pe=pe.get(ve)||null,Y(ae,pe,""+qe,ct);if(typeof qe=="object"&&qe!==null){switch(qe.$$typeof){case P:return pe=pe.get(qe.key===null?ve:qe.key)||null,re(ae,pe,qe,ct);case U:return pe=pe.get(qe.key===null?ve:qe.key)||null,we(ae,pe,qe,ct);case De:var Et=qe._init;return Ze(pe,ae,ve,Et(qe._payload),ct)}if(wt(qe)||ce(qe))return pe=pe.get(ve)||null,Le(ae,pe,qe,ct,null);Wc(ae,qe)}return null}function st(pe,ae,ve,qe){for(var ct=null,Et=null,bt=ae,At=ae=0,Zn=null;bt!==null&&At<ve.length;At++){bt.index>At?(Zn=bt,bt=null):Zn=bt.sibling;var Xt=Pe(pe,bt,ve[At],qe);if(Xt===null){bt===null&&(bt=Zn);break}s&&bt&&Xt.alternate===null&&a(pe,bt),ae=x(Xt,ae,At),Et===null?ct=Xt:Et.sibling=Xt,Et=Xt,bt=Zn}if(At===ve.length)return h(pe,bt),En&&Ao(pe,At),ct;if(bt===null){for(;At<ve.length;At++)bt=Me(pe,ve[At],qe),bt!==null&&(ae=x(bt,ae,At),Et===null?ct=bt:Et.sibling=bt,Et=bt);return En&&Ao(pe,At),ct}for(bt=p(pe,bt);At<ve.length;At++)Zn=Ze(bt,pe,At,ve[At],qe),Zn!==null&&(s&&Zn.alternate!==null&&bt.delete(Zn.key===null?At:Zn.key),ae=x(Zn,ae,At),Et===null?ct=Zn:Et.sibling=Zn,Et=Zn);return s&&bt.forEach(function(qs){return a(pe,qs)}),En&&Ao(pe,At),ct}function ut(pe,ae,ve,qe){var ct=ce(ve);if(typeof ct!="function")throw Error(t(150));if(ve=ct.call(ve),ve==null)throw Error(t(151));for(var Et=ct=null,bt=ae,At=ae=0,Zn=null,Xt=ve.next();bt!==null&&!Xt.done;At++,Xt=ve.next()){bt.index>At?(Zn=bt,bt=null):Zn=bt.sibling;var qs=Pe(pe,bt,Xt.value,qe);if(qs===null){bt===null&&(bt=Zn);break}s&&bt&&qs.alternate===null&&a(pe,bt),ae=x(qs,ae,At),Et===null?ct=qs:Et.sibling=qs,Et=qs,bt=Zn}if(Xt.done)return h(pe,bt),En&&Ao(pe,At),ct;if(bt===null){for(;!Xt.done;At++,Xt=ve.next())Xt=Me(pe,Xt.value,qe),Xt!==null&&(ae=x(Xt,ae,At),Et===null?ct=Xt:Et.sibling=Xt,Et=Xt);return En&&Ao(pe,At),ct}for(bt=p(pe,bt);!Xt.done;At++,Xt=ve.next())Xt=Ze(bt,pe,At,Xt.value,qe),Xt!==null&&(s&&Xt.alternate!==null&&bt.delete(Xt.key===null?At:Xt.key),ae=x(Xt,ae,At),Et===null?ct=Xt:Et.sibling=Xt,Et=Xt);return s&&bt.forEach(function(zA){return a(pe,zA)}),En&&Ao(pe,At),ct}function Ln(pe,ae,ve,qe){if(typeof ve=="object"&&ve!==null&&ve.type===R&&ve.key===null&&(ve=ve.props.children),typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case P:e:{for(var ct=ve.key,Et=ae;Et!==null;){if(Et.key===ct){if(ct=ve.type,ct===R){if(Et.tag===7){h(pe,Et.sibling),ae=_(Et,ve.props.children),ae.return=pe,pe=ae;break e}}else if(Et.elementType===ct||typeof ct=="object"&&ct!==null&&ct.$$typeof===De&&n0(ct)===Et.type){h(pe,Et.sibling),ae=_(Et,ve.props),ae.ref=Qu(pe,Et,ve),ae.return=pe,pe=ae;break e}h(pe,Et);break}else a(pe,Et);Et=Et.sibling}ve.type===R?(ae=Po(ve.props.children,pe.mode,qe,ve.key),ae.return=pe,pe=ae):(qe=ph(ve.type,ve.key,ve.props,null,pe.mode,qe),qe.ref=Qu(pe,ae,ve),qe.return=pe,pe=qe)}return B(pe);case U:e:{for(Et=ve.key;ae!==null;){if(ae.key===Et)if(ae.tag===4&&ae.stateNode.containerInfo===ve.containerInfo&&ae.stateNode.implementation===ve.implementation){h(pe,ae.sibling),ae=_(ae,ve.children||[]),ae.return=pe,pe=ae;break e}else{h(pe,ae);break}else a(pe,ae);ae=ae.sibling}ae=Cp(ve,pe.mode,qe),ae.return=pe,pe=ae}return B(pe);case De:return Et=ve._init,Ln(pe,ae,Et(ve._payload),qe)}if(wt(ve))return st(pe,ae,ve,qe);if(ce(ve))return ut(pe,ae,ve,qe);Wc(pe,ve)}return typeof ve=="string"&&ve!==""||typeof ve=="number"?(ve=""+ve,ae!==null&&ae.tag===6?(h(pe,ae.sibling),ae=_(ae,ve),ae.return=pe,pe=ae):(h(pe,ae),ae=Ip(ve,pe.mode,qe),ae.return=pe,pe=ae),B(pe)):h(pe,ae)}return Ln}var Ia=r0(!0),i0=r0(!1),$c=Ns(null),Hc=null,Ca=null,Ff=null;function Mf(){Ff=Ca=Hc=null}function Bf(s){var a=$c.current;yn($c),s._currentValue=a}function zf(s,a,h){for(;s!==null;){var p=s.alternate;if((s.childLanes&a)!==a?(s.childLanes|=a,p!==null&&(p.childLanes|=a)):p!==null&&(p.childLanes&a)!==a&&(p.childLanes|=a),s===h)break;s=s.return}}function Da(s,a){Hc=s,Ff=Ca=null,s=s.dependencies,s!==null&&s.firstContext!==null&&((s.lanes&a)!==0&&(Ir=!0),s.firstContext=null)}function ti(s){var a=s._currentValue;if(Ff!==s)if(s={context:s,memoizedValue:a,next:null},Ca===null){if(Hc===null)throw Error(t(308));Ca=s,Hc.dependencies={lanes:0,firstContext:s}}else Ca=Ca.next=s;return a}var So=null;function Uf(s){So===null?So=[s]:So.push(s)}function s0(s,a,h,p){var _=a.interleaved;return _===null?(h.next=h,Uf(a)):(h.next=_.next,_.next=h),a.interleaved=h,us(s,p)}function us(s,a){s.lanes|=a;var h=s.alternate;for(h!==null&&(h.lanes|=a),h=s,s=s.return;s!==null;)s.childLanes|=a,h=s.alternate,h!==null&&(h.childLanes|=a),h=s,s=s.return;return h.tag===3?h.stateNode:null}var Ls=!1;function jf(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function o0(s,a){s=s.updateQueue,a.updateQueue===s&&(a.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function ls(s,a){return{eventTime:s,lane:a,tag:0,payload:null,callback:null,next:null}}function Vs(s,a,h){var p=s.updateQueue;if(p===null)return null;if(p=p.shared,(Kt&2)!==0){var _=p.pending;return _===null?a.next=a:(a.next=_.next,_.next=a),p.pending=a,us(s,h)}return _=p.interleaved,_===null?(a.next=a,Uf(p)):(a.next=_.next,_.next=a),p.interleaved=a,us(s,h)}function Gc(s,a,h){if(a=a.updateQueue,a!==null&&(a=a.shared,(h&4194240)!==0)){var p=a.lanes;p&=s.pendingLanes,h|=p,a.lanes=h,Mt(s,h)}}function a0(s,a){var h=s.updateQueue,p=s.alternate;if(p!==null&&(p=p.updateQueue,h===p)){var _=null,x=null;if(h=h.firstBaseUpdate,h!==null){do{var B={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};x===null?_=x=B:x=x.next=B,h=h.next}while(h!==null);x===null?_=x=a:x=x.next=a}else _=x=a;h={baseState:p.baseState,firstBaseUpdate:_,lastBaseUpdate:x,shared:p.shared,effects:p.effects},s.updateQueue=h;return}s=h.lastBaseUpdate,s===null?h.firstBaseUpdate=a:s.next=a,h.lastBaseUpdate=a}function Kc(s,a,h,p){var _=s.updateQueue;Ls=!1;var x=_.firstBaseUpdate,B=_.lastBaseUpdate,Y=_.shared.pending;if(Y!==null){_.shared.pending=null;var re=Y,we=re.next;re.next=null,B===null?x=we:B.next=we,B=re;var Le=s.alternate;Le!==null&&(Le=Le.updateQueue,Y=Le.lastBaseUpdate,Y!==B&&(Y===null?Le.firstBaseUpdate=we:Y.next=we,Le.lastBaseUpdate=re))}if(x!==null){var Me=_.baseState;B=0,Le=we=re=null,Y=x;do{var Pe=Y.lane,Ze=Y.eventTime;if((p&Pe)===Pe){Le!==null&&(Le=Le.next={eventTime:Ze,lane:0,tag:Y.tag,payload:Y.payload,callback:Y.callback,next:null});e:{var st=s,ut=Y;switch(Pe=a,Ze=h,ut.tag){case 1:if(st=ut.payload,typeof st=="function"){Me=st.call(Ze,Me,Pe);break e}Me=st;break e;case 3:st.flags=st.flags&-65537|128;case 0:if(st=ut.payload,Pe=typeof st=="function"?st.call(Ze,Me,Pe):st,Pe==null)break e;Me=xe({},Me,Pe);break e;case 2:Ls=!0}}Y.callback!==null&&Y.lane!==0&&(s.flags|=64,Pe=_.effects,Pe===null?_.effects=[Y]:Pe.push(Y))}else Ze={eventTime:Ze,lane:Pe,tag:Y.tag,payload:Y.payload,callback:Y.callback,next:null},Le===null?(we=Le=Ze,re=Me):Le=Le.next=Ze,B|=Pe;if(Y=Y.next,Y===null){if(Y=_.shared.pending,Y===null)break;Pe=Y,Y=Pe.next,Pe.next=null,_.lastBaseUpdate=Pe,_.shared.pending=null}}while(!0);if(Le===null&&(re=Me),_.baseState=re,_.firstBaseUpdate=we,_.lastBaseUpdate=Le,a=_.shared.interleaved,a!==null){_=a;do B|=_.lane,_=_.next;while(_!==a)}else x===null&&(_.shared.lanes=0);Do|=B,s.lanes=B,s.memoizedState=Me}}function u0(s,a,h){if(s=a.effects,a.effects=null,s!==null)for(a=0;a<s.length;a++){var p=s[a],_=p.callback;if(_!==null){if(p.callback=null,p=h,typeof _!="function")throw Error(t(191,_));_.call(p)}}}var Yu={},Pi=Ns(Yu),Xu=Ns(Yu),Zu=Ns(Yu);function Io(s){if(s===Yu)throw Error(t(174));return s}function qf(s,a){switch(dn(Zu,a),dn(Xu,s),dn(Pi,Yu),s=a.nodeType,s){case 9:case 11:a=(a=a.documentElement)?a.namespaceURI:jt(null,"");break;default:s=s===8?a.parentNode:a,a=s.namespaceURI||null,s=s.tagName,a=jt(a,s)}yn(Pi),dn(Pi,a)}function Ra(){yn(Pi),yn(Xu),yn(Zu)}function l0(s){Io(Zu.current);var a=Io(Pi.current),h=jt(a,s.type);a!==h&&(dn(Xu,s),dn(Pi,h))}function Wf(s){Xu.current===s&&(yn(Pi),yn(Xu))}var An=Ns(0);function Qc(s){for(var a=s;a!==null;){if(a.tag===13){var h=a.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||h.data==="$!"))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var $f=[];function Hf(){for(var s=0;s<$f.length;s++)$f[s]._workInProgressVersionPrimary=null;$f.length=0}var Yc=q.ReactCurrentDispatcher,Gf=q.ReactCurrentBatchConfig,Co=0,Sn=null,Wn=null,Yn=null,Xc=!1,Ju=!1,el=0,uA=0;function cr(){throw Error(t(321))}function Kf(s,a){if(a===null)return!1;for(var h=0;h<a.length&&h<s.length;h++)if(!hi(s[h],a[h]))return!1;return!0}function Qf(s,a,h,p,_,x){if(Co=x,Sn=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,Yc.current=s===null||s.memoizedState===null?dA:fA,s=h(p,_),Ju){x=0;do{if(Ju=!1,el=0,25<=x)throw Error(t(301));x+=1,Yn=Wn=null,a.updateQueue=null,Yc.current=pA,s=h(p,_)}while(Ju)}if(Yc.current=eh,a=Wn!==null&&Wn.next!==null,Co=0,Yn=Wn=Sn=null,Xc=!1,a)throw Error(t(300));return s}function Yf(){var s=el!==0;return el=0,s}function Oi(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yn===null?Sn.memoizedState=Yn=s:Yn=Yn.next=s,Yn}function ni(){if(Wn===null){var s=Sn.alternate;s=s!==null?s.memoizedState:null}else s=Wn.next;var a=Yn===null?Sn.memoizedState:Yn.next;if(a!==null)Yn=a,Wn=s;else{if(s===null)throw Error(t(310));Wn=s,s={memoizedState:Wn.memoizedState,baseState:Wn.baseState,baseQueue:Wn.baseQueue,queue:Wn.queue,next:null},Yn===null?Sn.memoizedState=Yn=s:Yn=Yn.next=s}return Yn}function tl(s,a){return typeof a=="function"?a(s):a}function Xf(s){var a=ni(),h=a.queue;if(h===null)throw Error(t(311));h.lastRenderedReducer=s;var p=Wn,_=p.baseQueue,x=h.pending;if(x!==null){if(_!==null){var B=_.next;_.next=x.next,x.next=B}p.baseQueue=_=x,h.pending=null}if(_!==null){x=_.next,p=p.baseState;var Y=B=null,re=null,we=x;do{var Le=we.lane;if((Co&Le)===Le)re!==null&&(re=re.next={lane:0,action:we.action,hasEagerState:we.hasEagerState,eagerState:we.eagerState,next:null}),p=we.hasEagerState?we.eagerState:s(p,we.action);else{var Me={lane:Le,action:we.action,hasEagerState:we.hasEagerState,eagerState:we.eagerState,next:null};re===null?(Y=re=Me,B=p):re=re.next=Me,Sn.lanes|=Le,Do|=Le}we=we.next}while(we!==null&&we!==x);re===null?B=p:re.next=Y,hi(p,a.memoizedState)||(Ir=!0),a.memoizedState=p,a.baseState=B,a.baseQueue=re,h.lastRenderedState=p}if(s=h.interleaved,s!==null){_=s;do x=_.lane,Sn.lanes|=x,Do|=x,_=_.next;while(_!==s)}else _===null&&(h.lanes=0);return[a.memoizedState,h.dispatch]}function Zf(s){var a=ni(),h=a.queue;if(h===null)throw Error(t(311));h.lastRenderedReducer=s;var p=h.dispatch,_=h.pending,x=a.memoizedState;if(_!==null){h.pending=null;var B=_=_.next;do x=s(x,B.action),B=B.next;while(B!==_);hi(x,a.memoizedState)||(Ir=!0),a.memoizedState=x,a.baseQueue===null&&(a.baseState=x),h.lastRenderedState=x}return[x,p]}function c0(){}function h0(s,a){var h=Sn,p=ni(),_=a(),x=!hi(p.memoizedState,_);if(x&&(p.memoizedState=_,Ir=!0),p=p.queue,Jf(p0.bind(null,h,p,s),[s]),p.getSnapshot!==a||x||Yn!==null&&Yn.memoizedState.tag&1){if(h.flags|=2048,nl(9,f0.bind(null,h,p,_,a),void 0,null),Xn===null)throw Error(t(349));(Co&30)!==0||d0(h,a,_)}return _}function d0(s,a,h){s.flags|=16384,s={getSnapshot:a,value:h},a=Sn.updateQueue,a===null?(a={lastEffect:null,stores:null},Sn.updateQueue=a,a.stores=[s]):(h=a.stores,h===null?a.stores=[s]:h.push(s))}function f0(s,a,h,p){a.value=h,a.getSnapshot=p,m0(a)&&g0(s)}function p0(s,a,h){return h(function(){m0(a)&&g0(s)})}function m0(s){var a=s.getSnapshot;s=s.value;try{var h=a();return!hi(s,h)}catch{return!0}}function g0(s){var a=us(s,1);a!==null&&gi(a,s,1,-1)}function v0(s){var a=Oi();return typeof s=="function"&&(s=s()),a.memoizedState=a.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:tl,lastRenderedState:s},a.queue=s,s=s.dispatch=hA.bind(null,Sn,s),[a.memoizedState,s]}function nl(s,a,h,p){return s={tag:s,create:a,destroy:h,deps:p,next:null},a=Sn.updateQueue,a===null?(a={lastEffect:null,stores:null},Sn.updateQueue=a,a.lastEffect=s.next=s):(h=a.lastEffect,h===null?a.lastEffect=s.next=s:(p=h.next,h.next=s,s.next=p,a.lastEffect=s)),s}function y0(){return ni().memoizedState}function Zc(s,a,h,p){var _=Oi();Sn.flags|=s,_.memoizedState=nl(1|a,h,void 0,p===void 0?null:p)}function Jc(s,a,h,p){var _=ni();p=p===void 0?null:p;var x=void 0;if(Wn!==null){var B=Wn.memoizedState;if(x=B.destroy,p!==null&&Kf(p,B.deps)){_.memoizedState=nl(a,h,x,p);return}}Sn.flags|=s,_.memoizedState=nl(1|a,h,x,p)}function _0(s,a){return Zc(8390656,8,s,a)}function Jf(s,a){return Jc(2048,8,s,a)}function w0(s,a){return Jc(4,2,s,a)}function E0(s,a){return Jc(4,4,s,a)}function b0(s,a){if(typeof a=="function")return s=s(),a(s),function(){a(null)};if(a!=null)return s=s(),a.current=s,function(){a.current=null}}function x0(s,a,h){return h=h!=null?h.concat([s]):null,Jc(4,4,b0.bind(null,a,s),h)}function ep(){}function T0(s,a){var h=ni();a=a===void 0?null:a;var p=h.memoizedState;return p!==null&&a!==null&&Kf(a,p[1])?p[0]:(h.memoizedState=[s,a],s)}function A0(s,a){var h=ni();a=a===void 0?null:a;var p=h.memoizedState;return p!==null&&a!==null&&Kf(a,p[1])?p[0]:(s=s(),h.memoizedState=[s,a],s)}function S0(s,a,h){return(Co&21)===0?(s.baseState&&(s.baseState=!1,Ir=!0),s.memoizedState=h):(hi(h,a)||(h=je(),Sn.lanes|=h,Do|=h,s.baseState=!0),a)}function lA(s,a){var h=pt;pt=h!==0&&4>h?h:4,s(!0);var p=Gf.transition;Gf.transition={};try{s(!1),a()}finally{pt=h,Gf.transition=p}}function I0(){return ni().memoizedState}function cA(s,a,h){var p=zs(s);if(h={lane:p,action:h,hasEagerState:!1,eagerState:null,next:null},C0(s))D0(a,h);else if(h=s0(s,a,h,p),h!==null){var _=Er();gi(h,s,p,_),R0(h,a,p)}}function hA(s,a,h){var p=zs(s),_={lane:p,action:h,hasEagerState:!1,eagerState:null,next:null};if(C0(s))D0(a,_);else{var x=s.alternate;if(s.lanes===0&&(x===null||x.lanes===0)&&(x=a.lastRenderedReducer,x!==null))try{var B=a.lastRenderedState,Y=x(B,h);if(_.hasEagerState=!0,_.eagerState=Y,hi(Y,B)){var re=a.interleaved;re===null?(_.next=_,Uf(a)):(_.next=re.next,re.next=_),a.interleaved=_;return}}catch{}h=s0(s,a,_,p),h!==null&&(_=Er(),gi(h,s,p,_),R0(h,a,p))}}function C0(s){var a=s.alternate;return s===Sn||a!==null&&a===Sn}function D0(s,a){Ju=Xc=!0;var h=s.pending;h===null?a.next=a:(a.next=h.next,h.next=a),s.pending=a}function R0(s,a,h){if((h&4194240)!==0){var p=a.lanes;p&=s.pendingLanes,h|=p,a.lanes=h,Mt(s,h)}}var eh={readContext:ti,useCallback:cr,useContext:cr,useEffect:cr,useImperativeHandle:cr,useInsertionEffect:cr,useLayoutEffect:cr,useMemo:cr,useReducer:cr,useRef:cr,useState:cr,useDebugValue:cr,useDeferredValue:cr,useTransition:cr,useMutableSource:cr,useSyncExternalStore:cr,useId:cr,unstable_isNewReconciler:!1},dA={readContext:ti,useCallback:function(s,a){return Oi().memoizedState=[s,a===void 0?null:a],s},useContext:ti,useEffect:_0,useImperativeHandle:function(s,a,h){return h=h!=null?h.concat([s]):null,Zc(4194308,4,b0.bind(null,a,s),h)},useLayoutEffect:function(s,a){return Zc(4194308,4,s,a)},useInsertionEffect:function(s,a){return Zc(4,2,s,a)},useMemo:function(s,a){var h=Oi();return a=a===void 0?null:a,s=s(),h.memoizedState=[s,a],s},useReducer:function(s,a,h){var p=Oi();return a=h!==void 0?h(a):a,p.memoizedState=p.baseState=a,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:a},p.queue=s,s=s.dispatch=cA.bind(null,Sn,s),[p.memoizedState,s]},useRef:function(s){var a=Oi();return s={current:s},a.memoizedState=s},useState:v0,useDebugValue:ep,useDeferredValue:function(s){return Oi().memoizedState=s},useTransition:function(){var s=v0(!1),a=s[0];return s=lA.bind(null,s[1]),Oi().memoizedState=s,[a,s]},useMutableSource:function(){},useSyncExternalStore:function(s,a,h){var p=Sn,_=Oi();if(En){if(h===void 0)throw Error(t(407));h=h()}else{if(h=a(),Xn===null)throw Error(t(349));(Co&30)!==0||d0(p,a,h)}_.memoizedState=h;var x={value:h,getSnapshot:a};return _.queue=x,_0(p0.bind(null,p,x,s),[s]),p.flags|=2048,nl(9,f0.bind(null,p,x,h,a),void 0,null),h},useId:function(){var s=Oi(),a=Xn.identifierPrefix;if(En){var h=as,p=os;h=(p&~(1<<32-_r(p)-1)).toString(32)+h,a=":"+a+"R"+h,h=el++,0<h&&(a+="H"+h.toString(32)),a+=":"}else h=uA++,a=":"+a+"r"+h.toString(32)+":";return s.memoizedState=a},unstable_isNewReconciler:!1},fA={readContext:ti,useCallback:T0,useContext:ti,useEffect:Jf,useImperativeHandle:x0,useInsertionEffect:w0,useLayoutEffect:E0,useMemo:A0,useReducer:Xf,useRef:y0,useState:function(){return Xf(tl)},useDebugValue:ep,useDeferredValue:function(s){var a=ni();return S0(a,Wn.memoizedState,s)},useTransition:function(){var s=Xf(tl)[0],a=ni().memoizedState;return[s,a]},useMutableSource:c0,useSyncExternalStore:h0,useId:I0,unstable_isNewReconciler:!1},pA={readContext:ti,useCallback:T0,useContext:ti,useEffect:Jf,useImperativeHandle:x0,useInsertionEffect:w0,useLayoutEffect:E0,useMemo:A0,useReducer:Zf,useRef:y0,useState:function(){return Zf(tl)},useDebugValue:ep,useDeferredValue:function(s){var a=ni();return Wn===null?a.memoizedState=s:S0(a,Wn.memoizedState,s)},useTransition:function(){var s=Zf(tl)[0],a=ni().memoizedState;return[s,a]},useMutableSource:c0,useSyncExternalStore:h0,useId:I0,unstable_isNewReconciler:!1};function fi(s,a){if(s&&s.defaultProps){a=xe({},a),s=s.defaultProps;for(var h in s)a[h]===void 0&&(a[h]=s[h]);return a}return a}function tp(s,a,h,p){a=s.memoizedState,h=h(p,a),h=h==null?a:xe({},a,h),s.memoizedState=h,s.lanes===0&&(s.updateQueue.baseState=h)}var th={isMounted:function(s){return(s=s._reactInternals)?gn(s)===s:!1},enqueueSetState:function(s,a,h){s=s._reactInternals;var p=Er(),_=zs(s),x=ls(p,_);x.payload=a,h!=null&&(x.callback=h),a=Vs(s,x,_),a!==null&&(gi(a,s,_,p),Gc(a,s,_))},enqueueReplaceState:function(s,a,h){s=s._reactInternals;var p=Er(),_=zs(s),x=ls(p,_);x.tag=1,x.payload=a,h!=null&&(x.callback=h),a=Vs(s,x,_),a!==null&&(gi(a,s,_,p),Gc(a,s,_))},enqueueForceUpdate:function(s,a){s=s._reactInternals;var h=Er(),p=zs(s),_=ls(h,p);_.tag=2,a!=null&&(_.callback=a),a=Vs(s,_,p),a!==null&&(gi(a,s,p,h),Gc(a,s,p))}};function k0(s,a,h,p,_,x,B){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(p,x,B):a.prototype&&a.prototype.isPureReactComponent?!ju(h,p)||!ju(_,x):!0}function N0(s,a,h){var p=!1,_=Ps,x=a.contextType;return typeof x=="object"&&x!==null?x=ti(x):(_=Sr(a)?xo:lr.current,p=a.contextTypes,x=(p=p!=null)?xa(s,_):Ps),a=new a(h,x),s.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a.updater=th,s.stateNode=a,a._reactInternals=s,p&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=_,s.__reactInternalMemoizedMaskedChildContext=x),a}function P0(s,a,h,p){s=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(h,p),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(h,p),a.state!==s&&th.enqueueReplaceState(a,a.state,null)}function np(s,a,h,p){var _=s.stateNode;_.props=h,_.state=s.memoizedState,_.refs={},jf(s);var x=a.contextType;typeof x=="object"&&x!==null?_.context=ti(x):(x=Sr(a)?xo:lr.current,_.context=xa(s,x)),_.state=s.memoizedState,x=a.getDerivedStateFromProps,typeof x=="function"&&(tp(s,a,x,h),_.state=s.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(a=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),a!==_.state&&th.enqueueReplaceState(_,_.state,null),Kc(s,h,_,p),_.state=s.memoizedState),typeof _.componentDidMount=="function"&&(s.flags|=4194308)}function ka(s,a){try{var h="",p=a;do h+=He(p),p=p.return;while(p);var _=h}catch(x){_=`
Error generating stack: `+x.message+`
`+x.stack}return{value:s,source:a,stack:_,digest:null}}function rp(s,a,h){return{value:s,source:null,stack:h??null,digest:a??null}}function ip(s,a){try{console.error(a.value)}catch(h){setTimeout(function(){throw h})}}var mA=typeof WeakMap=="function"?WeakMap:Map;function O0(s,a,h){h=ls(-1,h),h.tag=3,h.payload={element:null};var p=a.value;return h.callback=function(){uh||(uh=!0,_p=p),ip(s,a)},h}function L0(s,a,h){h=ls(-1,h),h.tag=3;var p=s.type.getDerivedStateFromError;if(typeof p=="function"){var _=a.value;h.payload=function(){return p(_)},h.callback=function(){ip(s,a)}}var x=s.stateNode;return x!==null&&typeof x.componentDidCatch=="function"&&(h.callback=function(){ip(s,a),typeof p!="function"&&(Ms===null?Ms=new Set([this]):Ms.add(this));var B=a.stack;this.componentDidCatch(a.value,{componentStack:B!==null?B:""})}),h}function V0(s,a,h){var p=s.pingCache;if(p===null){p=s.pingCache=new mA;var _=new Set;p.set(a,_)}else _=p.get(a),_===void 0&&(_=new Set,p.set(a,_));_.has(h)||(_.add(h),s=DA.bind(null,s,a,h),a.then(s,s))}function F0(s){do{var a;if((a=s.tag===13)&&(a=s.memoizedState,a=a!==null?a.dehydrated!==null:!0),a)return s;s=s.return}while(s!==null);return null}function M0(s,a,h,p,_){return(s.mode&1)===0?(s===a?s.flags|=65536:(s.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(a=ls(-1,1),a.tag=2,Vs(h,a,1))),h.lanes|=1),s):(s.flags|=65536,s.lanes=_,s)}var gA=q.ReactCurrentOwner,Ir=!1;function wr(s,a,h,p){a.child=s===null?i0(a,null,h,p):Ia(a,s.child,h,p)}function B0(s,a,h,p,_){h=h.render;var x=a.ref;return Da(a,_),p=Qf(s,a,h,p,x,_),h=Yf(),s!==null&&!Ir?(a.updateQueue=s.updateQueue,a.flags&=-2053,s.lanes&=~_,cs(s,a,_)):(En&&h&&Nf(a),a.flags|=1,wr(s,a,p,_),a.child)}function z0(s,a,h,p,_){if(s===null){var x=h.type;return typeof x=="function"&&!Sp(x)&&x.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(a.tag=15,a.type=x,U0(s,a,x,p,_)):(s=ph(h.type,null,p,a,a.mode,_),s.ref=a.ref,s.return=a,a.child=s)}if(x=s.child,(s.lanes&_)===0){var B=x.memoizedProps;if(h=h.compare,h=h!==null?h:ju,h(B,p)&&s.ref===a.ref)return cs(s,a,_)}return a.flags|=1,s=js(x,p),s.ref=a.ref,s.return=a,a.child=s}function U0(s,a,h,p,_){if(s!==null){var x=s.memoizedProps;if(ju(x,p)&&s.ref===a.ref)if(Ir=!1,a.pendingProps=p=x,(s.lanes&_)!==0)(s.flags&131072)!==0&&(Ir=!0);else return a.lanes=s.lanes,cs(s,a,_)}return sp(s,a,h,p,_)}function j0(s,a,h){var p=a.pendingProps,_=p.children,x=s!==null?s.memoizedState:null;if(p.mode==="hidden")if((a.mode&1)===0)a.memoizedState={baseLanes:0,cachePool:null,transitions:null},dn(Pa,jr),jr|=h;else{if((h&1073741824)===0)return s=x!==null?x.baseLanes|h:h,a.lanes=a.childLanes=1073741824,a.memoizedState={baseLanes:s,cachePool:null,transitions:null},a.updateQueue=null,dn(Pa,jr),jr|=s,null;a.memoizedState={baseLanes:0,cachePool:null,transitions:null},p=x!==null?x.baseLanes:h,dn(Pa,jr),jr|=p}else x!==null?(p=x.baseLanes|h,a.memoizedState=null):p=h,dn(Pa,jr),jr|=p;return wr(s,a,_,h),a.child}function q0(s,a){var h=a.ref;(s===null&&h!==null||s!==null&&s.ref!==h)&&(a.flags|=512,a.flags|=2097152)}function sp(s,a,h,p,_){var x=Sr(h)?xo:lr.current;return x=xa(a,x),Da(a,_),h=Qf(s,a,h,p,x,_),p=Yf(),s!==null&&!Ir?(a.updateQueue=s.updateQueue,a.flags&=-2053,s.lanes&=~_,cs(s,a,_)):(En&&p&&Nf(a),a.flags|=1,wr(s,a,h,_),a.child)}function W0(s,a,h,p,_){if(Sr(h)){var x=!0;Bc(a)}else x=!1;if(Da(a,_),a.stateNode===null)rh(s,a),N0(a,h,p),np(a,h,p,_),p=!0;else if(s===null){var B=a.stateNode,Y=a.memoizedProps;B.props=Y;var re=B.context,we=h.contextType;typeof we=="object"&&we!==null?we=ti(we):(we=Sr(h)?xo:lr.current,we=xa(a,we));var Le=h.getDerivedStateFromProps,Me=typeof Le=="function"||typeof B.getSnapshotBeforeUpdate=="function";Me||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(Y!==p||re!==we)&&P0(a,B,p,we),Ls=!1;var Pe=a.memoizedState;B.state=Pe,Kc(a,p,B,_),re=a.memoizedState,Y!==p||Pe!==re||Ar.current||Ls?(typeof Le=="function"&&(tp(a,h,Le,p),re=a.memoizedState),(Y=Ls||k0(a,h,Y,p,Pe,re,we))?(Me||typeof B.UNSAFE_componentWillMount!="function"&&typeof B.componentWillMount!="function"||(typeof B.componentWillMount=="function"&&B.componentWillMount(),typeof B.UNSAFE_componentWillMount=="function"&&B.UNSAFE_componentWillMount()),typeof B.componentDidMount=="function"&&(a.flags|=4194308)):(typeof B.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=p,a.memoizedState=re),B.props=p,B.state=re,B.context=we,p=Y):(typeof B.componentDidMount=="function"&&(a.flags|=4194308),p=!1)}else{B=a.stateNode,o0(s,a),Y=a.memoizedProps,we=a.type===a.elementType?Y:fi(a.type,Y),B.props=we,Me=a.pendingProps,Pe=B.context,re=h.contextType,typeof re=="object"&&re!==null?re=ti(re):(re=Sr(h)?xo:lr.current,re=xa(a,re));var Ze=h.getDerivedStateFromProps;(Le=typeof Ze=="function"||typeof B.getSnapshotBeforeUpdate=="function")||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(Y!==Me||Pe!==re)&&P0(a,B,p,re),Ls=!1,Pe=a.memoizedState,B.state=Pe,Kc(a,p,B,_);var st=a.memoizedState;Y!==Me||Pe!==st||Ar.current||Ls?(typeof Ze=="function"&&(tp(a,h,Ze,p),st=a.memoizedState),(we=Ls||k0(a,h,we,p,Pe,st,re)||!1)?(Le||typeof B.UNSAFE_componentWillUpdate!="function"&&typeof B.componentWillUpdate!="function"||(typeof B.componentWillUpdate=="function"&&B.componentWillUpdate(p,st,re),typeof B.UNSAFE_componentWillUpdate=="function"&&B.UNSAFE_componentWillUpdate(p,st,re)),typeof B.componentDidUpdate=="function"&&(a.flags|=4),typeof B.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof B.componentDidUpdate!="function"||Y===s.memoizedProps&&Pe===s.memoizedState||(a.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||Y===s.memoizedProps&&Pe===s.memoizedState||(a.flags|=1024),a.memoizedProps=p,a.memoizedState=st),B.props=p,B.state=st,B.context=re,p=we):(typeof B.componentDidUpdate!="function"||Y===s.memoizedProps&&Pe===s.memoizedState||(a.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||Y===s.memoizedProps&&Pe===s.memoizedState||(a.flags|=1024),p=!1)}return op(s,a,h,p,x,_)}function op(s,a,h,p,_,x){q0(s,a);var B=(a.flags&128)!==0;if(!p&&!B)return _&&Qy(a,h,!1),cs(s,a,x);p=a.stateNode,gA.current=a;var Y=B&&typeof h.getDerivedStateFromError!="function"?null:p.render();return a.flags|=1,s!==null&&B?(a.child=Ia(a,s.child,null,x),a.child=Ia(a,null,Y,x)):wr(s,a,Y,x),a.memoizedState=p.state,_&&Qy(a,h,!0),a.child}function $0(s){var a=s.stateNode;a.pendingContext?Gy(s,a.pendingContext,a.pendingContext!==a.context):a.context&&Gy(s,a.context,!1),qf(s,a.containerInfo)}function H0(s,a,h,p,_){return Sa(),Vf(_),a.flags|=256,wr(s,a,h,p),a.child}var ap={dehydrated:null,treeContext:null,retryLane:0};function up(s){return{baseLanes:s,cachePool:null,transitions:null}}function G0(s,a,h){var p=a.pendingProps,_=An.current,x=!1,B=(a.flags&128)!==0,Y;if((Y=B)||(Y=s!==null&&s.memoizedState===null?!1:(_&2)!==0),Y?(x=!0,a.flags&=-129):(s===null||s.memoizedState!==null)&&(_|=1),dn(An,_&1),s===null)return Lf(a),s=a.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?((a.mode&1)===0?a.lanes=1:s.data==="$!"?a.lanes=8:a.lanes=1073741824,null):(B=p.children,s=p.fallback,x?(p=a.mode,x=a.child,B={mode:"hidden",children:B},(p&1)===0&&x!==null?(x.childLanes=0,x.pendingProps=B):x=mh(B,p,0,null),s=Po(s,p,h,null),x.return=a,s.return=a,x.sibling=s,a.child=x,a.child.memoizedState=up(h),a.memoizedState=ap,s):lp(a,B));if(_=s.memoizedState,_!==null&&(Y=_.dehydrated,Y!==null))return vA(s,a,B,p,Y,_,h);if(x){x=p.fallback,B=a.mode,_=s.child,Y=_.sibling;var re={mode:"hidden",children:p.children};return(B&1)===0&&a.child!==_?(p=a.child,p.childLanes=0,p.pendingProps=re,a.deletions=null):(p=js(_,re),p.subtreeFlags=_.subtreeFlags&14680064),Y!==null?x=js(Y,x):(x=Po(x,B,h,null),x.flags|=2),x.return=a,p.return=a,p.sibling=x,a.child=p,p=x,x=a.child,B=s.child.memoizedState,B=B===null?up(h):{baseLanes:B.baseLanes|h,cachePool:null,transitions:B.transitions},x.memoizedState=B,x.childLanes=s.childLanes&~h,a.memoizedState=ap,p}return x=s.child,s=x.sibling,p=js(x,{mode:"visible",children:p.children}),(a.mode&1)===0&&(p.lanes=h),p.return=a,p.sibling=null,s!==null&&(h=a.deletions,h===null?(a.deletions=[s],a.flags|=16):h.push(s)),a.child=p,a.memoizedState=null,p}function lp(s,a){return a=mh({mode:"visible",children:a},s.mode,0,null),a.return=s,s.child=a}function nh(s,a,h,p){return p!==null&&Vf(p),Ia(a,s.child,null,h),s=lp(a,a.pendingProps.children),s.flags|=2,a.memoizedState=null,s}function vA(s,a,h,p,_,x,B){if(h)return a.flags&256?(a.flags&=-257,p=rp(Error(t(422))),nh(s,a,B,p)):a.memoizedState!==null?(a.child=s.child,a.flags|=128,null):(x=p.fallback,_=a.mode,p=mh({mode:"visible",children:p.children},_,0,null),x=Po(x,_,B,null),x.flags|=2,p.return=a,x.return=a,p.sibling=x,a.child=p,(a.mode&1)!==0&&Ia(a,s.child,null,B),a.child.memoizedState=up(B),a.memoizedState=ap,x);if((a.mode&1)===0)return nh(s,a,B,null);if(_.data==="$!"){if(p=_.nextSibling&&_.nextSibling.dataset,p)var Y=p.dgst;return p=Y,x=Error(t(419)),p=rp(x,p,void 0),nh(s,a,B,p)}if(Y=(B&s.childLanes)!==0,Ir||Y){if(p=Xn,p!==null){switch(B&-B){case 4:_=2;break;case 16:_=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:_=32;break;case 536870912:_=268435456;break;default:_=0}_=(_&(p.suspendedLanes|B))!==0?0:_,_!==0&&_!==x.retryLane&&(x.retryLane=_,us(s,_),gi(p,s,_,-1))}return Ap(),p=rp(Error(t(421))),nh(s,a,B,p)}return _.data==="$?"?(a.flags|=128,a.child=s.child,a=RA.bind(null,s),_._reactRetry=a,null):(s=x.treeContext,Ur=ks(_.nextSibling),zr=a,En=!0,di=null,s!==null&&(Jr[ei++]=os,Jr[ei++]=as,Jr[ei++]=To,os=s.id,as=s.overflow,To=a),a=lp(a,p.children),a.flags|=4096,a)}function K0(s,a,h){s.lanes|=a;var p=s.alternate;p!==null&&(p.lanes|=a),zf(s.return,a,h)}function cp(s,a,h,p,_){var x=s.memoizedState;x===null?s.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:p,tail:h,tailMode:_}:(x.isBackwards=a,x.rendering=null,x.renderingStartTime=0,x.last=p,x.tail=h,x.tailMode=_)}function Q0(s,a,h){var p=a.pendingProps,_=p.revealOrder,x=p.tail;if(wr(s,a,p.children,h),p=An.current,(p&2)!==0)p=p&1|2,a.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=a.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&K0(s,h,a);else if(s.tag===19)K0(s,h,a);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}p&=1}if(dn(An,p),(a.mode&1)===0)a.memoizedState=null;else switch(_){case"forwards":for(h=a.child,_=null;h!==null;)s=h.alternate,s!==null&&Qc(s)===null&&(_=h),h=h.sibling;h=_,h===null?(_=a.child,a.child=null):(_=h.sibling,h.sibling=null),cp(a,!1,_,h,x);break;case"backwards":for(h=null,_=a.child,a.child=null;_!==null;){if(s=_.alternate,s!==null&&Qc(s)===null){a.child=_;break}s=_.sibling,_.sibling=h,h=_,_=s}cp(a,!0,h,null,x);break;case"together":cp(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function rh(s,a){(a.mode&1)===0&&s!==null&&(s.alternate=null,a.alternate=null,a.flags|=2)}function cs(s,a,h){if(s!==null&&(a.dependencies=s.dependencies),Do|=a.lanes,(h&a.childLanes)===0)return null;if(s!==null&&a.child!==s.child)throw Error(t(153));if(a.child!==null){for(s=a.child,h=js(s,s.pendingProps),a.child=h,h.return=a;s.sibling!==null;)s=s.sibling,h=h.sibling=js(s,s.pendingProps),h.return=a;h.sibling=null}return a.child}function yA(s,a,h){switch(a.tag){case 3:$0(a),Sa();break;case 5:l0(a);break;case 1:Sr(a.type)&&Bc(a);break;case 4:qf(a,a.stateNode.containerInfo);break;case 10:var p=a.type._context,_=a.memoizedProps.value;dn($c,p._currentValue),p._currentValue=_;break;case 13:if(p=a.memoizedState,p!==null)return p.dehydrated!==null?(dn(An,An.current&1),a.flags|=128,null):(h&a.child.childLanes)!==0?G0(s,a,h):(dn(An,An.current&1),s=cs(s,a,h),s!==null?s.sibling:null);dn(An,An.current&1);break;case 19:if(p=(h&a.childLanes)!==0,(s.flags&128)!==0){if(p)return Q0(s,a,h);a.flags|=128}if(_=a.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),dn(An,An.current),p)break;return null;case 22:case 23:return a.lanes=0,j0(s,a,h)}return cs(s,a,h)}var Y0,hp,X0,Z0;Y0=function(s,a){for(var h=a.child;h!==null;){if(h.tag===5||h.tag===6)s.appendChild(h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===a)break;for(;h.sibling===null;){if(h.return===null||h.return===a)return;h=h.return}h.sibling.return=h.return,h=h.sibling}},hp=function(){},X0=function(s,a,h,p){var _=s.memoizedProps;if(_!==p){s=a.stateNode,Io(Pi.current);var x=null;switch(h){case"input":_=_t(s,_),p=_t(s,p),x=[];break;case"select":_=xe({},_,{value:void 0}),p=xe({},p,{value:void 0}),x=[];break;case"textarea":_=gt(s,_),p=gt(s,p),x=[];break;default:typeof _.onClick!="function"&&typeof p.onClick=="function"&&(s.onclick=Vc)}$(h,p);var B;h=null;for(we in _)if(!p.hasOwnProperty(we)&&_.hasOwnProperty(we)&&_[we]!=null)if(we==="style"){var Y=_[we];for(B in Y)Y.hasOwnProperty(B)&&(h||(h={}),h[B]="")}else we!=="dangerouslySetInnerHTML"&&we!=="children"&&we!=="suppressContentEditableWarning"&&we!=="suppressHydrationWarning"&&we!=="autoFocus"&&(i.hasOwnProperty(we)?x||(x=[]):(x=x||[]).push(we,null));for(we in p){var re=p[we];if(Y=_?.[we],p.hasOwnProperty(we)&&re!==Y&&(re!=null||Y!=null))if(we==="style")if(Y){for(B in Y)!Y.hasOwnProperty(B)||re&&re.hasOwnProperty(B)||(h||(h={}),h[B]="");for(B in re)re.hasOwnProperty(B)&&Y[B]!==re[B]&&(h||(h={}),h[B]=re[B])}else h||(x||(x=[]),x.push(we,h)),h=re;else we==="dangerouslySetInnerHTML"?(re=re?re.__html:void 0,Y=Y?Y.__html:void 0,re!=null&&Y!==re&&(x=x||[]).push(we,re)):we==="children"?typeof re!="string"&&typeof re!="number"||(x=x||[]).push(we,""+re):we!=="suppressContentEditableWarning"&&we!=="suppressHydrationWarning"&&(i.hasOwnProperty(we)?(re!=null&&we==="onScroll"&&vn("scroll",s),x||Y===re||(x=[])):(x=x||[]).push(we,re))}h&&(x=x||[]).push("style",h);var we=x;(a.updateQueue=we)&&(a.flags|=4)}},Z0=function(s,a,h,p){h!==p&&(a.flags|=4)};function rl(s,a){if(!En)switch(s.tailMode){case"hidden":a=s.tail;for(var h=null;a!==null;)a.alternate!==null&&(h=a),a=a.sibling;h===null?s.tail=null:h.sibling=null;break;case"collapsed":h=s.tail;for(var p=null;h!==null;)h.alternate!==null&&(p=h),h=h.sibling;p===null?a||s.tail===null?s.tail=null:s.tail.sibling=null:p.sibling=null}}function hr(s){var a=s.alternate!==null&&s.alternate.child===s.child,h=0,p=0;if(a)for(var _=s.child;_!==null;)h|=_.lanes|_.childLanes,p|=_.subtreeFlags&14680064,p|=_.flags&14680064,_.return=s,_=_.sibling;else for(_=s.child;_!==null;)h|=_.lanes|_.childLanes,p|=_.subtreeFlags,p|=_.flags,_.return=s,_=_.sibling;return s.subtreeFlags|=p,s.childLanes=h,a}function _A(s,a,h){var p=a.pendingProps;switch(Pf(a),a.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return hr(a),null;case 1:return Sr(a.type)&&Mc(),hr(a),null;case 3:return p=a.stateNode,Ra(),yn(Ar),yn(lr),Hf(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(s===null||s.child===null)&&(qc(a)?a.flags|=4:s===null||s.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,di!==null&&(bp(di),di=null))),hp(s,a),hr(a),null;case 5:Wf(a);var _=Io(Zu.current);if(h=a.type,s!==null&&a.stateNode!=null)X0(s,a,h,p,_),s.ref!==a.ref&&(a.flags|=512,a.flags|=2097152);else{if(!p){if(a.stateNode===null)throw Error(t(166));return hr(a),null}if(s=Io(Pi.current),qc(a)){p=a.stateNode,h=a.type;var x=a.memoizedProps;switch(p[Ni]=a,p[Gu]=x,s=(a.mode&1)!==0,h){case"dialog":vn("cancel",p),vn("close",p);break;case"iframe":case"object":case"embed":vn("load",p);break;case"video":case"audio":for(_=0;_<Wu.length;_++)vn(Wu[_],p);break;case"source":vn("error",p);break;case"img":case"image":case"link":vn("error",p),vn("load",p);break;case"details":vn("toggle",p);break;case"input":kt(p,x),vn("invalid",p);break;case"select":p._wrapperState={wasMultiple:!!x.multiple},vn("invalid",p);break;case"textarea":dt(p,x),vn("invalid",p)}$(h,x),_=null;for(var B in x)if(x.hasOwnProperty(B)){var Y=x[B];B==="children"?typeof Y=="string"?p.textContent!==Y&&(x.suppressHydrationWarning!==!0&&Lc(p.textContent,Y,s),_=["children",Y]):typeof Y=="number"&&p.textContent!==""+Y&&(x.suppressHydrationWarning!==!0&&Lc(p.textContent,Y,s),_=["children",""+Y]):i.hasOwnProperty(B)&&Y!=null&&B==="onScroll"&&vn("scroll",p)}switch(h){case"input":ft(p),Ht(p,x,!0);break;case"textarea":ft(p),_n(p);break;case"select":case"option":break;default:typeof x.onClick=="function"&&(p.onclick=Vc)}p=_,a.updateQueue=p,p!==null&&(a.flags|=4)}else{B=_.nodeType===9?_:_.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=xn(h)),s==="http://www.w3.org/1999/xhtml"?h==="script"?(s=B.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof p.is=="string"?s=B.createElement(h,{is:p.is}):(s=B.createElement(h),h==="select"&&(B=s,p.multiple?B.multiple=!0:p.size&&(B.size=p.size))):s=B.createElementNS(s,h),s[Ni]=a,s[Gu]=p,Y0(s,a,!1,!1),a.stateNode=s;e:{switch(B=Se(h,p),h){case"dialog":vn("cancel",s),vn("close",s),_=p;break;case"iframe":case"object":case"embed":vn("load",s),_=p;break;case"video":case"audio":for(_=0;_<Wu.length;_++)vn(Wu[_],s);_=p;break;case"source":vn("error",s),_=p;break;case"img":case"image":case"link":vn("error",s),vn("load",s),_=p;break;case"details":vn("toggle",s),_=p;break;case"input":kt(s,p),_=_t(s,p),vn("invalid",s);break;case"option":_=p;break;case"select":s._wrapperState={wasMultiple:!!p.multiple},_=xe({},p,{value:void 0}),vn("invalid",s);break;case"textarea":dt(s,p),_=gt(s,p),vn("invalid",s);break;default:_=p}$(h,_),Y=_;for(x in Y)if(Y.hasOwnProperty(x)){var re=Y[x];x==="style"?hn(s,re):x==="dangerouslySetInnerHTML"?(re=re?re.__html:void 0,re!=null&&pn(s,re)):x==="children"?typeof re=="string"?(h!=="textarea"||re!=="")&&en(s,re):typeof re=="number"&&en(s,""+re):x!=="suppressContentEditableWarning"&&x!=="suppressHydrationWarning"&&x!=="autoFocus"&&(i.hasOwnProperty(x)?re!=null&&x==="onScroll"&&vn("scroll",s):re!=null&&V(s,x,re,B))}switch(h){case"input":ft(s),Ht(s,p,!1);break;case"textarea":ft(s),_n(s);break;case"option":p.value!=null&&s.setAttribute("value",""+Fe(p.value));break;case"select":s.multiple=!!p.multiple,x=p.value,x!=null?it(s,!!p.multiple,x,!1):p.defaultValue!=null&&it(s,!!p.multiple,p.defaultValue,!0);break;default:typeof _.onClick=="function"&&(s.onclick=Vc)}switch(h){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}}p&&(a.flags|=4)}a.ref!==null&&(a.flags|=512,a.flags|=2097152)}return hr(a),null;case 6:if(s&&a.stateNode!=null)Z0(s,a,s.memoizedProps,p);else{if(typeof p!="string"&&a.stateNode===null)throw Error(t(166));if(h=Io(Zu.current),Io(Pi.current),qc(a)){if(p=a.stateNode,h=a.memoizedProps,p[Ni]=a,(x=p.nodeValue!==h)&&(s=zr,s!==null))switch(s.tag){case 3:Lc(p.nodeValue,h,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&Lc(p.nodeValue,h,(s.mode&1)!==0)}x&&(a.flags|=4)}else p=(h.nodeType===9?h:h.ownerDocument).createTextNode(p),p[Ni]=a,a.stateNode=p}return hr(a),null;case 13:if(yn(An),p=a.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(En&&Ur!==null&&(a.mode&1)!==0&&(a.flags&128)===0)t0(),Sa(),a.flags|=98560,x=!1;else if(x=qc(a),p!==null&&p.dehydrated!==null){if(s===null){if(!x)throw Error(t(318));if(x=a.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(t(317));x[Ni]=a}else Sa(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;hr(a),x=!1}else di!==null&&(bp(di),di=null),x=!0;if(!x)return a.flags&65536?a:null}return(a.flags&128)!==0?(a.lanes=h,a):(p=p!==null,p!==(s!==null&&s.memoizedState!==null)&&p&&(a.child.flags|=8192,(a.mode&1)!==0&&(s===null||(An.current&1)!==0?$n===0&&($n=3):Ap())),a.updateQueue!==null&&(a.flags|=4),hr(a),null);case 4:return Ra(),hp(s,a),s===null&&$u(a.stateNode.containerInfo),hr(a),null;case 10:return Bf(a.type._context),hr(a),null;case 17:return Sr(a.type)&&Mc(),hr(a),null;case 19:if(yn(An),x=a.memoizedState,x===null)return hr(a),null;if(p=(a.flags&128)!==0,B=x.rendering,B===null)if(p)rl(x,!1);else{if($n!==0||s!==null&&(s.flags&128)!==0)for(s=a.child;s!==null;){if(B=Qc(s),B!==null){for(a.flags|=128,rl(x,!1),p=B.updateQueue,p!==null&&(a.updateQueue=p,a.flags|=4),a.subtreeFlags=0,p=h,h=a.child;h!==null;)x=h,s=p,x.flags&=14680066,B=x.alternate,B===null?(x.childLanes=0,x.lanes=s,x.child=null,x.subtreeFlags=0,x.memoizedProps=null,x.memoizedState=null,x.updateQueue=null,x.dependencies=null,x.stateNode=null):(x.childLanes=B.childLanes,x.lanes=B.lanes,x.child=B.child,x.subtreeFlags=0,x.deletions=null,x.memoizedProps=B.memoizedProps,x.memoizedState=B.memoizedState,x.updateQueue=B.updateQueue,x.type=B.type,s=B.dependencies,x.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),h=h.sibling;return dn(An,An.current&1|2),a.child}s=s.sibling}x.tail!==null&&Zt()>Oa&&(a.flags|=128,p=!0,rl(x,!1),a.lanes=4194304)}else{if(!p)if(s=Qc(B),s!==null){if(a.flags|=128,p=!0,h=s.updateQueue,h!==null&&(a.updateQueue=h,a.flags|=4),rl(x,!0),x.tail===null&&x.tailMode==="hidden"&&!B.alternate&&!En)return hr(a),null}else 2*Zt()-x.renderingStartTime>Oa&&h!==1073741824&&(a.flags|=128,p=!0,rl(x,!1),a.lanes=4194304);x.isBackwards?(B.sibling=a.child,a.child=B):(h=x.last,h!==null?h.sibling=B:a.child=B,x.last=B)}return x.tail!==null?(a=x.tail,x.rendering=a,x.tail=a.sibling,x.renderingStartTime=Zt(),a.sibling=null,h=An.current,dn(An,p?h&1|2:h&1),a):(hr(a),null);case 22:case 23:return Tp(),p=a.memoizedState!==null,s!==null&&s.memoizedState!==null!==p&&(a.flags|=8192),p&&(a.mode&1)!==0?(jr&1073741824)!==0&&(hr(a),a.subtreeFlags&6&&(a.flags|=8192)):hr(a),null;case 24:return null;case 25:return null}throw Error(t(156,a.tag))}function wA(s,a){switch(Pf(a),a.tag){case 1:return Sr(a.type)&&Mc(),s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 3:return Ra(),yn(Ar),yn(lr),Hf(),s=a.flags,(s&65536)!==0&&(s&128)===0?(a.flags=s&-65537|128,a):null;case 5:return Wf(a),null;case 13:if(yn(An),s=a.memoizedState,s!==null&&s.dehydrated!==null){if(a.alternate===null)throw Error(t(340));Sa()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 19:return yn(An),null;case 4:return Ra(),null;case 10:return Bf(a.type._context),null;case 22:case 23:return Tp(),null;case 24:return null;default:return null}}var ih=!1,dr=!1,EA=typeof WeakSet=="function"?WeakSet:Set,nt=null;function Na(s,a){var h=s.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(p){Cn(s,a,p)}else h.current=null}function dp(s,a,h){try{h()}catch(p){Cn(s,a,p)}}var J0=!1;function bA(s,a){if(Tf=ts,s=ky(),gf(s)){if("selectionStart"in s)var h={start:s.selectionStart,end:s.selectionEnd};else e:{h=(h=s.ownerDocument)&&h.defaultView||window;var p=h.getSelection&&h.getSelection();if(p&&p.rangeCount!==0){h=p.anchorNode;var _=p.anchorOffset,x=p.focusNode;p=p.focusOffset;try{h.nodeType,x.nodeType}catch{h=null;break e}var B=0,Y=-1,re=-1,we=0,Le=0,Me=s,Pe=null;t:for(;;){for(var Ze;Me!==h||_!==0&&Me.nodeType!==3||(Y=B+_),Me!==x||p!==0&&Me.nodeType!==3||(re=B+p),Me.nodeType===3&&(B+=Me.nodeValue.length),(Ze=Me.firstChild)!==null;)Pe=Me,Me=Ze;for(;;){if(Me===s)break t;if(Pe===h&&++we===_&&(Y=B),Pe===x&&++Le===p&&(re=B),(Ze=Me.nextSibling)!==null)break;Me=Pe,Pe=Me.parentNode}Me=Ze}h=Y===-1||re===-1?null:{start:Y,end:re}}else h=null}h=h||{start:0,end:0}}else h=null;for(Af={focusedElem:s,selectionRange:h},ts=!1,nt=a;nt!==null;)if(a=nt,s=a.child,(a.subtreeFlags&1028)!==0&&s!==null)s.return=a,nt=s;else for(;nt!==null;){a=nt;try{var st=a.alternate;if((a.flags&1024)!==0)switch(a.tag){case 0:case 11:case 15:break;case 1:if(st!==null){var ut=st.memoizedProps,Ln=st.memoizedState,pe=a.stateNode,ae=pe.getSnapshotBeforeUpdate(a.elementType===a.type?ut:fi(a.type,ut),Ln);pe.__reactInternalSnapshotBeforeUpdate=ae}break;case 3:var ve=a.stateNode.containerInfo;ve.nodeType===1?ve.textContent="":ve.nodeType===9&&ve.documentElement&&ve.removeChild(ve.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(qe){Cn(a,a.return,qe)}if(s=a.sibling,s!==null){s.return=a.return,nt=s;break}nt=a.return}return st=J0,J0=!1,st}function il(s,a,h){var p=a.updateQueue;if(p=p!==null?p.lastEffect:null,p!==null){var _=p=p.next;do{if((_.tag&s)===s){var x=_.destroy;_.destroy=void 0,x!==void 0&&dp(a,h,x)}_=_.next}while(_!==p)}}function sh(s,a){if(a=a.updateQueue,a=a!==null?a.lastEffect:null,a!==null){var h=a=a.next;do{if((h.tag&s)===s){var p=h.create;h.destroy=p()}h=h.next}while(h!==a)}}function fp(s){var a=s.ref;if(a!==null){var h=s.stateNode;s.tag,s=h,typeof a=="function"?a(s):a.current=s}}function e_(s){var a=s.alternate;a!==null&&(s.alternate=null,e_(a)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(a=s.stateNode,a!==null&&(delete a[Ni],delete a[Gu],delete a[Df],delete a[iA],delete a[sA])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function t_(s){return s.tag===5||s.tag===3||s.tag===4}function n_(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||t_(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function pp(s,a,h){var p=s.tag;if(p===5||p===6)s=s.stateNode,a?h.nodeType===8?h.parentNode.insertBefore(s,a):h.insertBefore(s,a):(h.nodeType===8?(a=h.parentNode,a.insertBefore(s,h)):(a=h,a.appendChild(s)),h=h._reactRootContainer,h!=null||a.onclick!==null||(a.onclick=Vc));else if(p!==4&&(s=s.child,s!==null))for(pp(s,a,h),s=s.sibling;s!==null;)pp(s,a,h),s=s.sibling}function mp(s,a,h){var p=s.tag;if(p===5||p===6)s=s.stateNode,a?h.insertBefore(s,a):h.appendChild(s);else if(p!==4&&(s=s.child,s!==null))for(mp(s,a,h),s=s.sibling;s!==null;)mp(s,a,h),s=s.sibling}var ir=null,pi=!1;function Fs(s,a,h){for(h=h.child;h!==null;)r_(s,a,h),h=h.sibling}function r_(s,a,h){if(tr&&typeof tr.onCommitFiberUnmount=="function")try{tr.onCommitFiberUnmount(Yi,h)}catch{}switch(h.tag){case 5:dr||Na(h,a);case 6:var p=ir,_=pi;ir=null,Fs(s,a,h),ir=p,pi=_,ir!==null&&(pi?(s=ir,h=h.stateNode,s.nodeType===8?s.parentNode.removeChild(h):s.removeChild(h)):ir.removeChild(h.stateNode));break;case 18:ir!==null&&(pi?(s=ir,h=h.stateNode,s.nodeType===8?Cf(s.parentNode,h):s.nodeType===1&&Cf(s,h),Is(s)):Cf(ir,h.stateNode));break;case 4:p=ir,_=pi,ir=h.stateNode.containerInfo,pi=!0,Fs(s,a,h),ir=p,pi=_;break;case 0:case 11:case 14:case 15:if(!dr&&(p=h.updateQueue,p!==null&&(p=p.lastEffect,p!==null))){_=p=p.next;do{var x=_,B=x.destroy;x=x.tag,B!==void 0&&((x&2)!==0||(x&4)!==0)&&dp(h,a,B),_=_.next}while(_!==p)}Fs(s,a,h);break;case 1:if(!dr&&(Na(h,a),p=h.stateNode,typeof p.componentWillUnmount=="function"))try{p.props=h.memoizedProps,p.state=h.memoizedState,p.componentWillUnmount()}catch(Y){Cn(h,a,Y)}Fs(s,a,h);break;case 21:Fs(s,a,h);break;case 22:h.mode&1?(dr=(p=dr)||h.memoizedState!==null,Fs(s,a,h),dr=p):Fs(s,a,h);break;default:Fs(s,a,h)}}function i_(s){var a=s.updateQueue;if(a!==null){s.updateQueue=null;var h=s.stateNode;h===null&&(h=s.stateNode=new EA),a.forEach(function(p){var _=kA.bind(null,s,p);h.has(p)||(h.add(p),p.then(_,_))})}}function mi(s,a){var h=a.deletions;if(h!==null)for(var p=0;p<h.length;p++){var _=h[p];try{var x=s,B=a,Y=B;e:for(;Y!==null;){switch(Y.tag){case 5:ir=Y.stateNode,pi=!1;break e;case 3:ir=Y.stateNode.containerInfo,pi=!0;break e;case 4:ir=Y.stateNode.containerInfo,pi=!0;break e}Y=Y.return}if(ir===null)throw Error(t(160));r_(x,B,_),ir=null,pi=!1;var re=_.alternate;re!==null&&(re.return=null),_.return=null}catch(we){Cn(_,a,we)}}if(a.subtreeFlags&12854)for(a=a.child;a!==null;)s_(a,s),a=a.sibling}function s_(s,a){var h=s.alternate,p=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(mi(a,s),Li(s),p&4){try{il(3,s,s.return),sh(3,s)}catch(ut){Cn(s,s.return,ut)}try{il(5,s,s.return)}catch(ut){Cn(s,s.return,ut)}}break;case 1:mi(a,s),Li(s),p&512&&h!==null&&Na(h,h.return);break;case 5:if(mi(a,s),Li(s),p&512&&h!==null&&Na(h,h.return),s.flags&32){var _=s.stateNode;try{en(_,"")}catch(ut){Cn(s,s.return,ut)}}if(p&4&&(_=s.stateNode,_!=null)){var x=s.memoizedProps,B=h!==null?h.memoizedProps:x,Y=s.type,re=s.updateQueue;if(s.updateQueue=null,re!==null)try{Y==="input"&&x.type==="radio"&&x.name!=null&&St(_,x),Se(Y,B);var we=Se(Y,x);for(B=0;B<re.length;B+=2){var Le=re[B],Me=re[B+1];Le==="style"?hn(_,Me):Le==="dangerouslySetInnerHTML"?pn(_,Me):Le==="children"?en(_,Me):V(_,Le,Me,we)}switch(Y){case"input":Tt(_,x);break;case"textarea":an(_,x);break;case"select":var Pe=_._wrapperState.wasMultiple;_._wrapperState.wasMultiple=!!x.multiple;var Ze=x.value;Ze!=null?it(_,!!x.multiple,Ze,!1):Pe!==!!x.multiple&&(x.defaultValue!=null?it(_,!!x.multiple,x.defaultValue,!0):it(_,!!x.multiple,x.multiple?[]:"",!1))}_[Gu]=x}catch(ut){Cn(s,s.return,ut)}}break;case 6:if(mi(a,s),Li(s),p&4){if(s.stateNode===null)throw Error(t(162));_=s.stateNode,x=s.memoizedProps;try{_.nodeValue=x}catch(ut){Cn(s,s.return,ut)}}break;case 3:if(mi(a,s),Li(s),p&4&&h!==null&&h.memoizedState.isDehydrated)try{Is(a.containerInfo)}catch(ut){Cn(s,s.return,ut)}break;case 4:mi(a,s),Li(s);break;case 13:mi(a,s),Li(s),_=s.child,_.flags&8192&&(x=_.memoizedState!==null,_.stateNode.isHidden=x,!x||_.alternate!==null&&_.alternate.memoizedState!==null||(yp=Zt())),p&4&&i_(s);break;case 22:if(Le=h!==null&&h.memoizedState!==null,s.mode&1?(dr=(we=dr)||Le,mi(a,s),dr=we):mi(a,s),Li(s),p&8192){if(we=s.memoizedState!==null,(s.stateNode.isHidden=we)&&!Le&&(s.mode&1)!==0)for(nt=s,Le=s.child;Le!==null;){for(Me=nt=Le;nt!==null;){switch(Pe=nt,Ze=Pe.child,Pe.tag){case 0:case 11:case 14:case 15:il(4,Pe,Pe.return);break;case 1:Na(Pe,Pe.return);var st=Pe.stateNode;if(typeof st.componentWillUnmount=="function"){p=Pe,h=Pe.return;try{a=p,st.props=a.memoizedProps,st.state=a.memoizedState,st.componentWillUnmount()}catch(ut){Cn(p,h,ut)}}break;case 5:Na(Pe,Pe.return);break;case 22:if(Pe.memoizedState!==null){u_(Me);continue}}Ze!==null?(Ze.return=Pe,nt=Ze):u_(Me)}Le=Le.sibling}e:for(Le=null,Me=s;;){if(Me.tag===5){if(Le===null){Le=Me;try{_=Me.stateNode,we?(x=_.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none"):(Y=Me.stateNode,re=Me.memoizedProps.style,B=re!=null&&re.hasOwnProperty("display")?re.display:null,Y.style.display=Gt("display",B))}catch(ut){Cn(s,s.return,ut)}}}else if(Me.tag===6){if(Le===null)try{Me.stateNode.nodeValue=we?"":Me.memoizedProps}catch(ut){Cn(s,s.return,ut)}}else if((Me.tag!==22&&Me.tag!==23||Me.memoizedState===null||Me===s)&&Me.child!==null){Me.child.return=Me,Me=Me.child;continue}if(Me===s)break e;for(;Me.sibling===null;){if(Me.return===null||Me.return===s)break e;Le===Me&&(Le=null),Me=Me.return}Le===Me&&(Le=null),Me.sibling.return=Me.return,Me=Me.sibling}}break;case 19:mi(a,s),Li(s),p&4&&i_(s);break;case 21:break;default:mi(a,s),Li(s)}}function Li(s){var a=s.flags;if(a&2){try{e:{for(var h=s.return;h!==null;){if(t_(h)){var p=h;break e}h=h.return}throw Error(t(160))}switch(p.tag){case 5:var _=p.stateNode;p.flags&32&&(en(_,""),p.flags&=-33);var x=n_(s);mp(s,x,_);break;case 3:case 4:var B=p.stateNode.containerInfo,Y=n_(s);pp(s,Y,B);break;default:throw Error(t(161))}}catch(re){Cn(s,s.return,re)}s.flags&=-3}a&4096&&(s.flags&=-4097)}function xA(s,a,h){nt=s,o_(s)}function o_(s,a,h){for(var p=(s.mode&1)!==0;nt!==null;){var _=nt,x=_.child;if(_.tag===22&&p){var B=_.memoizedState!==null||ih;if(!B){var Y=_.alternate,re=Y!==null&&Y.memoizedState!==null||dr;Y=ih;var we=dr;if(ih=B,(dr=re)&&!we)for(nt=_;nt!==null;)B=nt,re=B.child,B.tag===22&&B.memoizedState!==null?l_(_):re!==null?(re.return=B,nt=re):l_(_);for(;x!==null;)nt=x,o_(x),x=x.sibling;nt=_,ih=Y,dr=we}a_(s)}else(_.subtreeFlags&8772)!==0&&x!==null?(x.return=_,nt=x):a_(s)}}function a_(s){for(;nt!==null;){var a=nt;if((a.flags&8772)!==0){var h=a.alternate;try{if((a.flags&8772)!==0)switch(a.tag){case 0:case 11:case 15:dr||sh(5,a);break;case 1:var p=a.stateNode;if(a.flags&4&&!dr)if(h===null)p.componentDidMount();else{var _=a.elementType===a.type?h.memoizedProps:fi(a.type,h.memoizedProps);p.componentDidUpdate(_,h.memoizedState,p.__reactInternalSnapshotBeforeUpdate)}var x=a.updateQueue;x!==null&&u0(a,x,p);break;case 3:var B=a.updateQueue;if(B!==null){if(h=null,a.child!==null)switch(a.child.tag){case 5:h=a.child.stateNode;break;case 1:h=a.child.stateNode}u0(a,B,h)}break;case 5:var Y=a.stateNode;if(h===null&&a.flags&4){h=Y;var re=a.memoizedProps;switch(a.type){case"button":case"input":case"select":case"textarea":re.autoFocus&&h.focus();break;case"img":re.src&&(h.src=re.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(a.memoizedState===null){var we=a.alternate;if(we!==null){var Le=we.memoizedState;if(Le!==null){var Me=Le.dehydrated;Me!==null&&Is(Me)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}dr||a.flags&512&&fp(a)}catch(Pe){Cn(a,a.return,Pe)}}if(a===s){nt=null;break}if(h=a.sibling,h!==null){h.return=a.return,nt=h;break}nt=a.return}}function u_(s){for(;nt!==null;){var a=nt;if(a===s){nt=null;break}var h=a.sibling;if(h!==null){h.return=a.return,nt=h;break}nt=a.return}}function l_(s){for(;nt!==null;){var a=nt;try{switch(a.tag){case 0:case 11:case 15:var h=a.return;try{sh(4,a)}catch(re){Cn(a,h,re)}break;case 1:var p=a.stateNode;if(typeof p.componentDidMount=="function"){var _=a.return;try{p.componentDidMount()}catch(re){Cn(a,_,re)}}var x=a.return;try{fp(a)}catch(re){Cn(a,x,re)}break;case 5:var B=a.return;try{fp(a)}catch(re){Cn(a,B,re)}}}catch(re){Cn(a,a.return,re)}if(a===s){nt=null;break}var Y=a.sibling;if(Y!==null){Y.return=a.return,nt=Y;break}nt=a.return}}var TA=Math.ceil,oh=q.ReactCurrentDispatcher,gp=q.ReactCurrentOwner,ri=q.ReactCurrentBatchConfig,Kt=0,Xn=null,Bn=null,sr=0,jr=0,Pa=Ns(0),$n=0,sl=null,Do=0,ah=0,vp=0,ol=null,Cr=null,yp=0,Oa=1/0,hs=null,uh=!1,_p=null,Ms=null,lh=!1,Bs=null,ch=0,al=0,wp=null,hh=-1,dh=0;function Er(){return(Kt&6)!==0?Zt():hh!==-1?hh:hh=Zt()}function zs(s){return(s.mode&1)===0?1:(Kt&2)!==0&&sr!==0?sr&-sr:aA.transition!==null?(dh===0&&(dh=je()),dh):(s=pt,s!==0||(s=window.event,s=s===void 0?16:la(s.type)),s)}function gi(s,a,h,p){if(50<al)throw al=0,wp=null,Error(t(185));It(s,h,p),((Kt&2)===0||s!==Xn)&&(s===Xn&&((Kt&2)===0&&(ah|=h),$n===4&&Us(s,sr)),Dr(s,p),h===1&&Kt===0&&(a.mode&1)===0&&(Oa=Zt()+500,zc&&Os()))}function Dr(s,a){var h=s.callbackNode;Ve(s,a);var p=Ae(s,s===Xn?sr:0);if(p===0)h!==null&&ui(h),s.callbackNode=null,s.callbackPriority=0;else if(a=p&-p,s.callbackPriority!==a){if(h!=null&&ui(h),a===1)s.tag===0?oA(h_.bind(null,s)):Yy(h_.bind(null,s)),nA(function(){(Kt&6)===0&&Os()}),h=null;else{switch(Yt(p)){case 1:h=Or;break;case 4:h=go;break;case 16:h=Yr;break;case 536870912:h=xs;break;default:h=Yr}h=__(h,c_.bind(null,s))}s.callbackPriority=a,s.callbackNode=h}}function c_(s,a){if(hh=-1,dh=0,(Kt&6)!==0)throw Error(t(327));var h=s.callbackNode;if(La()&&s.callbackNode!==h)return null;var p=Ae(s,s===Xn?sr:0);if(p===0)return null;if((p&30)!==0||(p&s.expiredLanes)!==0||a)a=fh(s,p);else{a=p;var _=Kt;Kt|=2;var x=f_();(Xn!==s||sr!==a)&&(hs=null,Oa=Zt()+500,ko(s,a));do try{IA();break}catch(Y){d_(s,Y)}while(!0);Mf(),oh.current=x,Kt=_,Bn!==null?a=0:(Xn=null,sr=0,a=$n)}if(a!==0){if(a===2&&(_=Be(s),_!==0&&(p=_,a=Ep(s,_))),a===1)throw h=sl,ko(s,0),Us(s,p),Dr(s,Zt()),h;if(a===6)Us(s,p);else{if(_=s.current.alternate,(p&30)===0&&!AA(_)&&(a=fh(s,p),a===2&&(x=Be(s),x!==0&&(p=x,a=Ep(s,x))),a===1))throw h=sl,ko(s,0),Us(s,p),Dr(s,Zt()),h;switch(s.finishedWork=_,s.finishedLanes=p,a){case 0:case 1:throw Error(t(345));case 2:No(s,Cr,hs);break;case 3:if(Us(s,p),(p&130023424)===p&&(a=yp+500-Zt(),10<a)){if(Ae(s,0)!==0)break;if(_=s.suspendedLanes,(_&p)!==p){Er(),s.pingedLanes|=s.suspendedLanes&_;break}s.timeoutHandle=If(No.bind(null,s,Cr,hs),a);break}No(s,Cr,hs);break;case 4:if(Us(s,p),(p&4194240)===p)break;for(a=s.eventTimes,_=-1;0<p;){var B=31-_r(p);x=1<<B,B=a[B],B>_&&(_=B),p&=~x}if(p=_,p=Zt()-p,p=(120>p?120:480>p?480:1080>p?1080:1920>p?1920:3e3>p?3e3:4320>p?4320:1960*TA(p/1960))-p,10<p){s.timeoutHandle=If(No.bind(null,s,Cr,hs),p);break}No(s,Cr,hs);break;case 5:No(s,Cr,hs);break;default:throw Error(t(329))}}}return Dr(s,Zt()),s.callbackNode===h?c_.bind(null,s):null}function Ep(s,a){var h=ol;return s.current.memoizedState.isDehydrated&&(ko(s,a).flags|=256),s=fh(s,a),s!==2&&(a=Cr,Cr=h,a!==null&&bp(a)),s}function bp(s){Cr===null?Cr=s:Cr.push.apply(Cr,s)}function AA(s){for(var a=s;;){if(a.flags&16384){var h=a.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var p=0;p<h.length;p++){var _=h[p],x=_.getSnapshot;_=_.value;try{if(!hi(x(),_))return!1}catch{return!1}}}if(h=a.child,a.subtreeFlags&16384&&h!==null)h.return=a,a=h;else{if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Us(s,a){for(a&=~vp,a&=~ah,s.suspendedLanes|=a,s.pingedLanes&=~a,s=s.expirationTimes;0<a;){var h=31-_r(a),p=1<<h;s[h]=-1,a&=~p}}function h_(s){if((Kt&6)!==0)throw Error(t(327));La();var a=Ae(s,0);if((a&1)===0)return Dr(s,Zt()),null;var h=fh(s,a);if(s.tag!==0&&h===2){var p=Be(s);p!==0&&(a=p,h=Ep(s,p))}if(h===1)throw h=sl,ko(s,0),Us(s,a),Dr(s,Zt()),h;if(h===6)throw Error(t(345));return s.finishedWork=s.current.alternate,s.finishedLanes=a,No(s,Cr,hs),Dr(s,Zt()),null}function xp(s,a){var h=Kt;Kt|=1;try{return s(a)}finally{Kt=h,Kt===0&&(Oa=Zt()+500,zc&&Os())}}function Ro(s){Bs!==null&&Bs.tag===0&&(Kt&6)===0&&La();var a=Kt;Kt|=1;var h=ri.transition,p=pt;try{if(ri.transition=null,pt=1,s)return s()}finally{pt=p,ri.transition=h,Kt=a,(Kt&6)===0&&Os()}}function Tp(){jr=Pa.current,yn(Pa)}function ko(s,a){s.finishedWork=null,s.finishedLanes=0;var h=s.timeoutHandle;if(h!==-1&&(s.timeoutHandle=-1,tA(h)),Bn!==null)for(h=Bn.return;h!==null;){var p=h;switch(Pf(p),p.tag){case 1:p=p.type.childContextTypes,p!=null&&Mc();break;case 3:Ra(),yn(Ar),yn(lr),Hf();break;case 5:Wf(p);break;case 4:Ra();break;case 13:yn(An);break;case 19:yn(An);break;case 10:Bf(p.type._context);break;case 22:case 23:Tp()}h=h.return}if(Xn=s,Bn=s=js(s.current,null),sr=jr=a,$n=0,sl=null,vp=ah=Do=0,Cr=ol=null,So!==null){for(a=0;a<So.length;a++)if(h=So[a],p=h.interleaved,p!==null){h.interleaved=null;var _=p.next,x=h.pending;if(x!==null){var B=x.next;x.next=_,p.next=B}h.pending=p}So=null}return s}function d_(s,a){do{var h=Bn;try{if(Mf(),Yc.current=eh,Xc){for(var p=Sn.memoizedState;p!==null;){var _=p.queue;_!==null&&(_.pending=null),p=p.next}Xc=!1}if(Co=0,Yn=Wn=Sn=null,Ju=!1,el=0,gp.current=null,h===null||h.return===null){$n=1,sl=a,Bn=null;break}e:{var x=s,B=h.return,Y=h,re=a;if(a=sr,Y.flags|=32768,re!==null&&typeof re=="object"&&typeof re.then=="function"){var we=re,Le=Y,Me=Le.tag;if((Le.mode&1)===0&&(Me===0||Me===11||Me===15)){var Pe=Le.alternate;Pe?(Le.updateQueue=Pe.updateQueue,Le.memoizedState=Pe.memoizedState,Le.lanes=Pe.lanes):(Le.updateQueue=null,Le.memoizedState=null)}var Ze=F0(B);if(Ze!==null){Ze.flags&=-257,M0(Ze,B,Y,x,a),Ze.mode&1&&V0(x,we,a),a=Ze,re=we;var st=a.updateQueue;if(st===null){var ut=new Set;ut.add(re),a.updateQueue=ut}else st.add(re);break e}else{if((a&1)===0){V0(x,we,a),Ap();break e}re=Error(t(426))}}else if(En&&Y.mode&1){var Ln=F0(B);if(Ln!==null){(Ln.flags&65536)===0&&(Ln.flags|=256),M0(Ln,B,Y,x,a),Vf(ka(re,Y));break e}}x=re=ka(re,Y),$n!==4&&($n=2),ol===null?ol=[x]:ol.push(x),x=B;do{switch(x.tag){case 3:x.flags|=65536,a&=-a,x.lanes|=a;var pe=O0(x,re,a);a0(x,pe);break e;case 1:Y=re;var ae=x.type,ve=x.stateNode;if((x.flags&128)===0&&(typeof ae.getDerivedStateFromError=="function"||ve!==null&&typeof ve.componentDidCatch=="function"&&(Ms===null||!Ms.has(ve)))){x.flags|=65536,a&=-a,x.lanes|=a;var qe=L0(x,Y,a);a0(x,qe);break e}}x=x.return}while(x!==null)}m_(h)}catch(ct){a=ct,Bn===h&&h!==null&&(Bn=h=h.return);continue}break}while(!0)}function f_(){var s=oh.current;return oh.current=eh,s===null?eh:s}function Ap(){($n===0||$n===3||$n===2)&&($n=4),Xn===null||(Do&268435455)===0&&(ah&268435455)===0||Us(Xn,sr)}function fh(s,a){var h=Kt;Kt|=2;var p=f_();(Xn!==s||sr!==a)&&(hs=null,ko(s,a));do try{SA();break}catch(_){d_(s,_)}while(!0);if(Mf(),Kt=h,oh.current=p,Bn!==null)throw Error(t(261));return Xn=null,sr=0,$n}function SA(){for(;Bn!==null;)p_(Bn)}function IA(){for(;Bn!==null&&!Ki();)p_(Bn)}function p_(s){var a=y_(s.alternate,s,jr);s.memoizedProps=s.pendingProps,a===null?m_(s):Bn=a,gp.current=null}function m_(s){var a=s;do{var h=a.alternate;if(s=a.return,(a.flags&32768)===0){if(h=_A(h,a,jr),h!==null){Bn=h;return}}else{if(h=wA(h,a),h!==null){h.flags&=32767,Bn=h;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{$n=6,Bn=null;return}}if(a=a.sibling,a!==null){Bn=a;return}Bn=a=s}while(a!==null);$n===0&&($n=5)}function No(s,a,h){var p=pt,_=ri.transition;try{ri.transition=null,pt=1,CA(s,a,h,p)}finally{ri.transition=_,pt=p}return null}function CA(s,a,h,p){do La();while(Bs!==null);if((Kt&6)!==0)throw Error(t(327));h=s.finishedWork;var _=s.finishedLanes;if(h===null)return null;if(s.finishedWork=null,s.finishedLanes=0,h===s.current)throw Error(t(177));s.callbackNode=null,s.callbackPriority=0;var x=h.lanes|h.childLanes;if(qt(s,x),s===Xn&&(Bn=Xn=null,sr=0),(h.subtreeFlags&2064)===0&&(h.flags&2064)===0||lh||(lh=!0,__(Yr,function(){return La(),null})),x=(h.flags&15990)!==0,(h.subtreeFlags&15990)!==0||x){x=ri.transition,ri.transition=null;var B=pt;pt=1;var Y=Kt;Kt|=4,gp.current=null,bA(s,h),s_(h,s),KT(Af),ts=!!Tf,Af=Tf=null,s.current=h,xA(h),Qr(),Kt=Y,pt=B,ri.transition=x}else s.current=h;if(lh&&(lh=!1,Bs=s,ch=_),x=s.pendingLanes,x===0&&(Ms=null),oa(h.stateNode),Dr(s,Zt()),a!==null)for(p=s.onRecoverableError,h=0;h<a.length;h++)_=a[h],p(_.value,{componentStack:_.stack,digest:_.digest});if(uh)throw uh=!1,s=_p,_p=null,s;return(ch&1)!==0&&s.tag!==0&&La(),x=s.pendingLanes,(x&1)!==0?s===wp?al++:(al=0,wp=s):al=0,Os(),null}function La(){if(Bs!==null){var s=Yt(ch),a=ri.transition,h=pt;try{if(ri.transition=null,pt=16>s?16:s,Bs===null)var p=!1;else{if(s=Bs,Bs=null,ch=0,(Kt&6)!==0)throw Error(t(331));var _=Kt;for(Kt|=4,nt=s.current;nt!==null;){var x=nt,B=x.child;if((nt.flags&16)!==0){var Y=x.deletions;if(Y!==null){for(var re=0;re<Y.length;re++){var we=Y[re];for(nt=we;nt!==null;){var Le=nt;switch(Le.tag){case 0:case 11:case 15:il(8,Le,x)}var Me=Le.child;if(Me!==null)Me.return=Le,nt=Me;else for(;nt!==null;){Le=nt;var Pe=Le.sibling,Ze=Le.return;if(e_(Le),Le===we){nt=null;break}if(Pe!==null){Pe.return=Ze,nt=Pe;break}nt=Ze}}}var st=x.alternate;if(st!==null){var ut=st.child;if(ut!==null){st.child=null;do{var Ln=ut.sibling;ut.sibling=null,ut=Ln}while(ut!==null)}}nt=x}}if((x.subtreeFlags&2064)!==0&&B!==null)B.return=x,nt=B;else e:for(;nt!==null;){if(x=nt,(x.flags&2048)!==0)switch(x.tag){case 0:case 11:case 15:il(9,x,x.return)}var pe=x.sibling;if(pe!==null){pe.return=x.return,nt=pe;break e}nt=x.return}}var ae=s.current;for(nt=ae;nt!==null;){B=nt;var ve=B.child;if((B.subtreeFlags&2064)!==0&&ve!==null)ve.return=B,nt=ve;else e:for(B=ae;nt!==null;){if(Y=nt,(Y.flags&2048)!==0)try{switch(Y.tag){case 0:case 11:case 15:sh(9,Y)}}catch(ct){Cn(Y,Y.return,ct)}if(Y===B){nt=null;break e}var qe=Y.sibling;if(qe!==null){qe.return=Y.return,nt=qe;break e}nt=Y.return}}if(Kt=_,Os(),tr&&typeof tr.onPostCommitFiberRoot=="function")try{tr.onPostCommitFiberRoot(Yi,s)}catch{}p=!0}return p}finally{pt=h,ri.transition=a}}return!1}function g_(s,a,h){a=ka(h,a),a=O0(s,a,1),s=Vs(s,a,1),a=Er(),s!==null&&(It(s,1,a),Dr(s,a))}function Cn(s,a,h){if(s.tag===3)g_(s,s,h);else for(;a!==null;){if(a.tag===3){g_(a,s,h);break}else if(a.tag===1){var p=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(Ms===null||!Ms.has(p))){s=ka(h,s),s=L0(a,s,1),a=Vs(a,s,1),s=Er(),a!==null&&(It(a,1,s),Dr(a,s));break}}a=a.return}}function DA(s,a,h){var p=s.pingCache;p!==null&&p.delete(a),a=Er(),s.pingedLanes|=s.suspendedLanes&h,Xn===s&&(sr&h)===h&&($n===4||$n===3&&(sr&130023424)===sr&&500>Zt()-yp?ko(s,0):vp|=h),Dr(s,a)}function v_(s,a){a===0&&((s.mode&1)===0?a=1:(a=le,le<<=1,(le&130023424)===0&&(le=4194304)));var h=Er();s=us(s,a),s!==null&&(It(s,a,h),Dr(s,h))}function RA(s){var a=s.memoizedState,h=0;a!==null&&(h=a.retryLane),v_(s,h)}function kA(s,a){var h=0;switch(s.tag){case 13:var p=s.stateNode,_=s.memoizedState;_!==null&&(h=_.retryLane);break;case 19:p=s.stateNode;break;default:throw Error(t(314))}p!==null&&p.delete(a),v_(s,h)}var y_;y_=function(s,a,h){if(s!==null)if(s.memoizedProps!==a.pendingProps||Ar.current)Ir=!0;else{if((s.lanes&h)===0&&(a.flags&128)===0)return Ir=!1,yA(s,a,h);Ir=(s.flags&131072)!==0}else Ir=!1,En&&(a.flags&1048576)!==0&&Xy(a,jc,a.index);switch(a.lanes=0,a.tag){case 2:var p=a.type;rh(s,a),s=a.pendingProps;var _=xa(a,lr.current);Da(a,h),_=Qf(null,a,p,s,_,h);var x=Yf();return a.flags|=1,typeof _=="object"&&_!==null&&typeof _.render=="function"&&_.$$typeof===void 0?(a.tag=1,a.memoizedState=null,a.updateQueue=null,Sr(p)?(x=!0,Bc(a)):x=!1,a.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,jf(a),_.updater=th,a.stateNode=_,_._reactInternals=a,np(a,p,s,h),a=op(null,a,p,!0,x,h)):(a.tag=0,En&&x&&Nf(a),wr(null,a,_,h),a=a.child),a;case 16:p=a.elementType;e:{switch(rh(s,a),s=a.pendingProps,_=p._init,p=_(p._payload),a.type=p,_=a.tag=PA(p),s=fi(p,s),_){case 0:a=sp(null,a,p,s,h);break e;case 1:a=W0(null,a,p,s,h);break e;case 11:a=B0(null,a,p,s,h);break e;case 14:a=z0(null,a,p,fi(p.type,s),h);break e}throw Error(t(306,p,""))}return a;case 0:return p=a.type,_=a.pendingProps,_=a.elementType===p?_:fi(p,_),sp(s,a,p,_,h);case 1:return p=a.type,_=a.pendingProps,_=a.elementType===p?_:fi(p,_),W0(s,a,p,_,h);case 3:e:{if($0(a),s===null)throw Error(t(387));p=a.pendingProps,x=a.memoizedState,_=x.element,o0(s,a),Kc(a,p,null,h);var B=a.memoizedState;if(p=B.element,x.isDehydrated)if(x={element:p,isDehydrated:!1,cache:B.cache,pendingSuspenseBoundaries:B.pendingSuspenseBoundaries,transitions:B.transitions},a.updateQueue.baseState=x,a.memoizedState=x,a.flags&256){_=ka(Error(t(423)),a),a=H0(s,a,p,h,_);break e}else if(p!==_){_=ka(Error(t(424)),a),a=H0(s,a,p,h,_);break e}else for(Ur=ks(a.stateNode.containerInfo.firstChild),zr=a,En=!0,di=null,h=i0(a,null,p,h),a.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(Sa(),p===_){a=cs(s,a,h);break e}wr(s,a,p,h)}a=a.child}return a;case 5:return l0(a),s===null&&Lf(a),p=a.type,_=a.pendingProps,x=s!==null?s.memoizedProps:null,B=_.children,Sf(p,_)?B=null:x!==null&&Sf(p,x)&&(a.flags|=32),q0(s,a),wr(s,a,B,h),a.child;case 6:return s===null&&Lf(a),null;case 13:return G0(s,a,h);case 4:return qf(a,a.stateNode.containerInfo),p=a.pendingProps,s===null?a.child=Ia(a,null,p,h):wr(s,a,p,h),a.child;case 11:return p=a.type,_=a.pendingProps,_=a.elementType===p?_:fi(p,_),B0(s,a,p,_,h);case 7:return wr(s,a,a.pendingProps,h),a.child;case 8:return wr(s,a,a.pendingProps.children,h),a.child;case 12:return wr(s,a,a.pendingProps.children,h),a.child;case 10:e:{if(p=a.type._context,_=a.pendingProps,x=a.memoizedProps,B=_.value,dn($c,p._currentValue),p._currentValue=B,x!==null)if(hi(x.value,B)){if(x.children===_.children&&!Ar.current){a=cs(s,a,h);break e}}else for(x=a.child,x!==null&&(x.return=a);x!==null;){var Y=x.dependencies;if(Y!==null){B=x.child;for(var re=Y.firstContext;re!==null;){if(re.context===p){if(x.tag===1){re=ls(-1,h&-h),re.tag=2;var we=x.updateQueue;if(we!==null){we=we.shared;var Le=we.pending;Le===null?re.next=re:(re.next=Le.next,Le.next=re),we.pending=re}}x.lanes|=h,re=x.alternate,re!==null&&(re.lanes|=h),zf(x.return,h,a),Y.lanes|=h;break}re=re.next}}else if(x.tag===10)B=x.type===a.type?null:x.child;else if(x.tag===18){if(B=x.return,B===null)throw Error(t(341));B.lanes|=h,Y=B.alternate,Y!==null&&(Y.lanes|=h),zf(B,h,a),B=x.sibling}else B=x.child;if(B!==null)B.return=x;else for(B=x;B!==null;){if(B===a){B=null;break}if(x=B.sibling,x!==null){x.return=B.return,B=x;break}B=B.return}x=B}wr(s,a,_.children,h),a=a.child}return a;case 9:return _=a.type,p=a.pendingProps.children,Da(a,h),_=ti(_),p=p(_),a.flags|=1,wr(s,a,p,h),a.child;case 14:return p=a.type,_=fi(p,a.pendingProps),_=fi(p.type,_),z0(s,a,p,_,h);case 15:return U0(s,a,a.type,a.pendingProps,h);case 17:return p=a.type,_=a.pendingProps,_=a.elementType===p?_:fi(p,_),rh(s,a),a.tag=1,Sr(p)?(s=!0,Bc(a)):s=!1,Da(a,h),N0(a,p,_),np(a,p,_,h),op(null,a,p,!0,s,h);case 19:return Q0(s,a,h);case 22:return j0(s,a,h)}throw Error(t(156,a.tag))};function __(s,a){return Kn(s,a)}function NA(s,a,h,p){this.tag=s,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ii(s,a,h,p){return new NA(s,a,h,p)}function Sp(s){return s=s.prototype,!(!s||!s.isReactComponent)}function PA(s){if(typeof s=="function")return Sp(s)?1:0;if(s!=null){if(s=s.$$typeof,s===j)return 11;if(s===_e)return 14}return 2}function js(s,a){var h=s.alternate;return h===null?(h=ii(s.tag,a,s.key,s.mode),h.elementType=s.elementType,h.type=s.type,h.stateNode=s.stateNode,h.alternate=s,s.alternate=h):(h.pendingProps=a,h.type=s.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=s.flags&14680064,h.childLanes=s.childLanes,h.lanes=s.lanes,h.child=s.child,h.memoizedProps=s.memoizedProps,h.memoizedState=s.memoizedState,h.updateQueue=s.updateQueue,a=s.dependencies,h.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},h.sibling=s.sibling,h.index=s.index,h.ref=s.ref,h}function ph(s,a,h,p,_,x){var B=2;if(p=s,typeof s=="function")Sp(s)&&(B=1);else if(typeof s=="string")B=5;else e:switch(s){case R:return Po(h.children,_,x,a);case S:B=8,_|=8;break;case C:return s=ii(12,h,a,_|2),s.elementType=C,s.lanes=x,s;case L:return s=ii(13,h,a,_),s.elementType=L,s.lanes=x,s;case he:return s=ii(19,h,a,_),s.elementType=he,s.lanes=x,s;case de:return mh(h,_,x,a);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case N:B=10;break e;case z:B=9;break e;case j:B=11;break e;case _e:B=14;break e;case De:B=16,p=null;break e}throw Error(t(130,s==null?s:typeof s,""))}return a=ii(B,h,a,_),a.elementType=s,a.type=p,a.lanes=x,a}function Po(s,a,h,p){return s=ii(7,s,p,a),s.lanes=h,s}function mh(s,a,h,p){return s=ii(22,s,p,a),s.elementType=de,s.lanes=h,s.stateNode={isHidden:!1},s}function Ip(s,a,h){return s=ii(6,s,null,a),s.lanes=h,s}function Cp(s,a,h){return a=ii(4,s.children!==null?s.children:[],s.key,a),a.lanes=h,a.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},a}function OA(s,a,h,p,_){this.tag=a,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=tt(0),this.expirationTimes=tt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=tt(0),this.identifierPrefix=p,this.onRecoverableError=_,this.mutableSourceEagerHydrationData=null}function Dp(s,a,h,p,_,x,B,Y,re){return s=new OA(s,a,h,Y,re),a===1?(a=1,x===!0&&(a|=8)):a=0,x=ii(3,null,null,a),s.current=x,x.stateNode=s,x.memoizedState={element:p,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},jf(x),s}function LA(s,a,h){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:U,key:p==null?null:""+p,children:s,containerInfo:a,implementation:h}}function w_(s){if(!s)return Ps;s=s._reactInternals;e:{if(gn(s)!==s||s.tag!==1)throw Error(t(170));var a=s;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(Sr(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(a!==null);throw Error(t(171))}if(s.tag===1){var h=s.type;if(Sr(h))return Ky(s,h,a)}return a}function E_(s,a,h,p,_,x,B,Y,re){return s=Dp(h,p,!0,s,_,x,B,Y,re),s.context=w_(null),h=s.current,p=Er(),_=zs(h),x=ls(p,_),x.callback=a??null,Vs(h,x,_),s.current.lanes=_,It(s,_,p),Dr(s,p),s}function gh(s,a,h,p){var _=a.current,x=Er(),B=zs(_);return h=w_(h),a.context===null?a.context=h:a.pendingContext=h,a=ls(x,B),a.payload={element:s},p=p===void 0?null:p,p!==null&&(a.callback=p),s=Vs(_,a,B),s!==null&&(gi(s,_,B,x),Gc(s,_,B)),B}function vh(s){return s=s.current,s.child?(s.child.tag===5,s.child.stateNode):null}function b_(s,a){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var h=s.retryLane;s.retryLane=h!==0&&h<a?h:a}}function Rp(s,a){b_(s,a),(s=s.alternate)&&b_(s,a)}function VA(){return null}var x_=typeof reportError=="function"?reportError:function(s){console.error(s)};function kp(s){this._internalRoot=s}yh.prototype.render=kp.prototype.render=function(s){var a=this._internalRoot;if(a===null)throw Error(t(409));gh(s,a,null,null)},yh.prototype.unmount=kp.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var a=s.containerInfo;Ro(function(){gh(null,s,null,null)}),a[is]=null}};function yh(s){this._internalRoot=s}yh.prototype.unstable_scheduleHydration=function(s){if(s){var a=vo();s={blockedOn:null,target:s,priority:a};for(var h=0;h<Vr.length&&a!==0&&a<Vr[h].priority;h++);Vr.splice(h,0,s),h===0&&aa(s)}};function Np(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function _h(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function T_(){}function FA(s,a,h,p,_){if(_){if(typeof p=="function"){var x=p;p=function(){var we=vh(B);x.call(we)}}var B=E_(a,p,s,0,null,!1,!1,"",T_);return s._reactRootContainer=B,s[is]=B.current,$u(s.nodeType===8?s.parentNode:s),Ro(),B}for(;_=s.lastChild;)s.removeChild(_);if(typeof p=="function"){var Y=p;p=function(){var we=vh(re);Y.call(we)}}var re=Dp(s,0,!1,null,null,!1,!1,"",T_);return s._reactRootContainer=re,s[is]=re.current,$u(s.nodeType===8?s.parentNode:s),Ro(function(){gh(a,re,h,p)}),re}function wh(s,a,h,p,_){var x=h._reactRootContainer;if(x){var B=x;if(typeof _=="function"){var Y=_;_=function(){var re=vh(B);Y.call(re)}}gh(a,B,s,_)}else B=FA(h,a,s,_,p);return vh(B)}Qn=function(s){switch(s.tag){case 3:var a=s.stateNode;if(a.current.memoizedState.isDehydrated){var h=te(a.pendingLanes);h!==0&&(Mt(a,h|1),Dr(a,Zt()),(Kt&6)===0&&(Oa=Zt()+500,Os()))}break;case 13:Ro(function(){var p=us(s,1);if(p!==null){var _=Er();gi(p,s,1,_)}}),Rp(s,1)}},Xr=function(s){if(s.tag===13){var a=us(s,134217728);if(a!==null){var h=Er();gi(a,s,134217728,h)}Rp(s,134217728)}},Xi=function(s){if(s.tag===13){var a=zs(s),h=us(s,a);if(h!==null){var p=Er();gi(h,s,a,p)}Rp(s,a)}},vo=function(){return pt},Zi=function(s,a){var h=pt;try{return pt=s,a()}finally{pt=h}},ne=function(s,a,h){switch(a){case"input":if(Tt(s,h),a=h.name,h.type==="radio"&&a!=null){for(h=s;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll("input[name="+JSON.stringify(""+a)+'][type="radio"]'),a=0;a<h.length;a++){var p=h[a];if(p!==s&&p.form===s.form){var _=Fc(p);if(!_)throw Error(t(90));yt(p),Tt(p,_)}}}break;case"textarea":an(s,h);break;case"select":a=h.value,a!=null&&it(s,!!h.multiple,a,!1)}},X=xp,ie=Ro;var MA={usingClientEntryPoint:!1,Events:[Ku,Ea,Fc,G,y,xp]},ul={findFiberByHostInstance:bo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},BA={bundleType:ul.bundleType,version:ul.version,rendererPackageName:ul.rendererPackageName,rendererConfig:ul.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:q.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=wn(s),s===null?null:s.stateNode},findFiberByHostInstance:ul.findFiberByHostInstance||VA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Eh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Eh.isDisabled&&Eh.supportsFiber)try{Yi=Eh.inject(BA),tr=Eh}catch{}}return Rr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=MA,Rr.createPortal=function(s,a){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Np(a))throw Error(t(200));return LA(s,a,null,h)},Rr.createRoot=function(s,a){if(!Np(s))throw Error(t(299));var h=!1,p="",_=x_;return a!=null&&(a.unstable_strictMode===!0&&(h=!0),a.identifierPrefix!==void 0&&(p=a.identifierPrefix),a.onRecoverableError!==void 0&&(_=a.onRecoverableError)),a=Dp(s,1,!1,null,null,h,!1,p,_),s[is]=a.current,$u(s.nodeType===8?s.parentNode:s),new kp(a)},Rr.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var a=s._reactInternals;if(a===void 0)throw typeof s.render=="function"?Error(t(188)):(s=Object.keys(s).join(","),Error(t(268,s)));return s=wn(a),s=s===null?null:s.stateNode,s},Rr.flushSync=function(s){return Ro(s)},Rr.hydrate=function(s,a,h){if(!_h(a))throw Error(t(200));return wh(null,s,a,!0,h)},Rr.hydrateRoot=function(s,a,h){if(!Np(s))throw Error(t(405));var p=h!=null&&h.hydratedSources||null,_=!1,x="",B=x_;if(h!=null&&(h.unstable_strictMode===!0&&(_=!0),h.identifierPrefix!==void 0&&(x=h.identifierPrefix),h.onRecoverableError!==void 0&&(B=h.onRecoverableError)),a=E_(a,null,s,1,h??null,_,!1,x,B),s[is]=a.current,$u(s),p)for(s=0;s<p.length;s++)h=p[s],_=h._getVersion,_=_(h._source),a.mutableSourceEagerHydrationData==null?a.mutableSourceEagerHydrationData=[h,_]:a.mutableSourceEagerHydrationData.push(h,_);return new yh(a)},Rr.render=function(s,a,h){if(!_h(a))throw Error(t(200));return wh(null,s,a,!1,h)},Rr.unmountComponentAtNode=function(s){if(!_h(s))throw Error(t(40));return s._reactRootContainer?(Ro(function(){wh(null,null,s,!1,function(){s._reactRootContainer=null,s[is]=null})}),!0):!1},Rr.unstable_batchedUpdates=xp,Rr.unstable_renderSubtreeIntoContainer=function(s,a,h,p){if(!_h(h))throw Error(t(200));if(s==null||s._reactInternals===void 0)throw Error(t(38));return wh(s,a,h,!1,p)},Rr.version="18.3.1-next-f1338f8080-20240426",Rr}var N_;function zE(){if(N_)return Lp.exports;N_=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),Lp.exports=HA(),Lp.exports}var P_;function GA(){if(P_)return bh;P_=1;var r=zE();return bh.createRoot=r.createRoot,bh.hydrateRoot=r.hydrateRoot,bh}var KA=GA();const QA=uo(KA);var YA={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const XA=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Nn=(r,e)=>{const t=ge.forwardRef(({color:n="currentColor",size:i=24,strokeWidth:o=2,absoluteStrokeWidth:u,className:l="",children:c,...d},m)=>ge.createElement("svg",{ref:m,...YA,width:i,height:i,stroke:n,strokeWidth:u?Number(o)*24/Number(i):o,className:["lucide",`lucide-${XA(r)}`,l].join(" "),...d},[...e.map(([g,E])=>ge.createElement(g,E)),...Array.isArray(c)?c:[c]]));return t.displayName=`${r}`,t};const ZA=Nn("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);const UE=Nn("Book",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20",key:"t4utmx"}]]);const Mp=Nn("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);const JA=Nn("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);const jE=Nn("Coffee",[["path",{d:"M17 8h1a4 4 0 1 1 0 8h-1",key:"jx4kbh"}],["path",{d:"M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z",key:"1bxrl0"}],["line",{x1:"6",x2:"6",y1:"2",y2:"4",key:"1cr9l3"}],["line",{x1:"10",x2:"10",y1:"2",y2:"4",key:"170wym"}],["line",{x1:"14",x2:"14",y1:"2",y2:"4",key:"1c5f70"}]]);const eS=Nn("DownloadCloud",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M12 12v9",key:"192myk"}],["path",{d:"m8 17 4 4 4-4",key:"1ul180"}]]);const tS=Nn("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);const nS=Nn("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);const Vh=Nn("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);const rS=Nn("Maximize",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]]);const iS=Nn("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);const O_=Nn("Minimize",[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3",key:"hohbtr"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3",key:"5jw1f3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3",key:"198tvr"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3",key:"ph8mxp"}]]);const sS=Nn("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);const qE=Nn("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);const WE=Nn("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);const oS=Nn("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);const $E=Nn("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);const aS=Nn("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);const HE=Nn("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);const uS=Nn("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);const lS=Nn("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);const GE=Nn("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var xh={exports:{}},Bp={exports:{}},zp,L_;function KE(){if(L_)return zp;L_=1;var r=void 0;return zp=function(e){return e!==r&&e!==null},zp}var Up,V_;function cS(){if(V_)return Up;V_=1;var r=KE(),e={object:!0,function:!0,undefined:!0};return Up=function(t){return r(t)?hasOwnProperty.call(e,typeof t):!1},Up}var jp,F_;function hS(){if(F_)return jp;F_=1;var r=cS();return jp=function(e){if(!r(e))return!1;try{return e.constructor?e.constructor.prototype===e:!1}catch{return!1}},jp}var qp,M_;function dS(){if(M_)return qp;M_=1;var r=hS();return qp=function(e){if(typeof e!="function"||!hasOwnProperty.call(e,"length"))return!1;try{if(typeof e.length!="number"||typeof e.call!="function"||typeof e.apply!="function")return!1}catch{return!1}return!r(e)},qp}var Wp,B_;function fS(){if(B_)return Wp;B_=1;var r=dS(),e=/^\s*class[\s{/}]/,t=Function.prototype.toString;return Wp=function(n){return!(!r(n)||e.test(t.call(n)))},Wp}var $p,z_;function pS(){return z_||(z_=1,$p=function(){var r=Object.assign,e;return typeof r!="function"?!1:(e={foo:"raz"},r(e,{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")}),$p}var Hp,U_;function mS(){return U_||(U_=1,Hp=function(){try{return Object.keys("primitive"),!0}catch{return!1}}),Hp}var Gp,j_;function gS(){return j_||(j_=1,Gp=function(){}),Gp}var Kp,q_;function Hg(){if(q_)return Kp;q_=1;var r=gS()();return Kp=function(e){return e!==r&&e!==null},Kp}var Qp,W_;function vS(){if(W_)return Qp;W_=1;var r=Hg(),e=Object.keys;return Qp=function(t){return e(r(t)?Object(t):t)},Qp}var Yp,$_;function yS(){return $_||($_=1,Yp=mS()()?Object.keys:vS()),Yp}var Xp,H_;function _S(){if(H_)return Xp;H_=1;var r=Hg();return Xp=function(e){if(!r(e))throw new TypeError("Cannot use null or undefined");return e},Xp}var Zp,G_;function wS(){if(G_)return Zp;G_=1;var r=yS(),e=_S(),t=Math.max;return Zp=function(n,i){var o,u,l=t(arguments.length,2),c;for(n=Object(e(n)),c=function(d){try{n[d]=i[d]}catch(m){o||(o=m)}},u=1;u<l;++u)i=arguments[u],r(i).forEach(c);if(o!==void 0)throw o;return n},Zp}var Jp,K_;function ES(){return K_||(K_=1,Jp=pS()()?Object.assign:wS()),Jp}var em,Q_;function bS(){if(Q_)return em;Q_=1;var r=Hg(),e=Array.prototype.forEach,t=Object.create,n=function(i,o){var u;for(u in i)o[u]=i[u]};return em=function(i){var o=t(null);return e.call(arguments,function(u){r(u)&&n(Object(u),o)}),o},em}var tm,Y_;function xS(){if(Y_)return tm;Y_=1;var r="razdwatrzy";return tm=function(){return typeof r.contains!="function"?!1:r.contains("dwa")===!0&&r.contains("foo")===!1},tm}var nm,X_;function TS(){if(X_)return nm;X_=1;var r=String.prototype.indexOf;return nm=function(e){return r.call(this,e,arguments[1])>-1},nm}var rm,Z_;function AS(){return Z_||(Z_=1,rm=xS()()?String.prototype.contains:TS()),rm}var J_;function SS(){if(J_)return Bp.exports;J_=1;var r=KE(),e=fS(),t=ES(),n=bS(),i=AS(),o=Bp.exports=function(u,l){var c,d,m,g,E;return arguments.length<2||typeof u!="string"?(g=l,l=u,u=null):g=arguments[2],r(u)?(c=i.call(u,"c"),d=i.call(u,"e"),m=i.call(u,"w")):(c=m=!0,d=!1),E={value:l,configurable:c,enumerable:d,writable:m},g?t(n(g),E):E};return o.gs=function(u,l,c){var d,m,g,E;return typeof u!="string"?(g=c,c=l,l=u,u=null):g=arguments[3],r(l)?e(l)?r(c)?e(c)||(g=c,c=void 0):c=void 0:(g=l,l=c=void 0):l=void 0,r(u)?(d=i.call(u,"c"),m=i.call(u,"e")):(d=!0,m=!1),E={get:l,set:c,configurable:d,enumerable:m},g?t(n(g),E):E},Bp.exports}var im,ew;function IS(){return ew||(ew=1,im=function(r){if(typeof r!="function")throw new TypeError(r+" is not a function");return r}),im}var tw;function CS(){return tw||(tw=1,(function(r,e){var t=SS(),n=IS(),i=Function.prototype.apply,o=Function.prototype.call,u=Object.create,l=Object.defineProperty,c=Object.defineProperties,d=Object.prototype.hasOwnProperty,m={configurable:!0,enumerable:!1,writable:!0},g,E,b,M,D,w,A;g=function(I,V){var q;return n(V),d.call(this,"__ee__")?q=this.__ee__:(q=m.value=u(null),l(this,"__ee__",m),m.value=null),q[I]?typeof q[I]=="object"?q[I].push(V):q[I]=[q[I],V]:q[I]=V,this},E=function(I,V){var q,P;return n(V),P=this,g.call(this,I,q=function(){b.call(P,I,q),i.call(V,this,arguments)}),q.__eeOnceListener__=V,this},b=function(I,V){var q,P,U,R;if(n(V),!d.call(this,"__ee__"))return this;if(q=this.__ee__,!q[I])return this;if(P=q[I],typeof P=="object")for(R=0;U=P[R];++R)(U===V||U.__eeOnceListener__===V)&&(P.length===2?q[I]=P[R?0:1]:P.splice(R,1));else(P===V||P.__eeOnceListener__===V)&&delete q[I];return this},M=function(I){var V,q,P,U,R;if(d.call(this,"__ee__")&&(U=this.__ee__[I],!!U))if(typeof U=="object"){for(q=arguments.length,R=new Array(q-1),V=1;V<q;++V)R[V-1]=arguments[V];for(U=U.slice(),V=0;P=U[V];++V)i.call(P,this,R)}else switch(arguments.length){case 1:o.call(U,this);break;case 2:o.call(U,this,arguments[1]);break;case 3:o.call(U,this,arguments[1],arguments[2]);break;default:for(q=arguments.length,R=new Array(q-1),V=1;V<q;++V)R[V-1]=arguments[V];i.call(U,this,R)}},D={on:g,once:E,off:b,emit:M},w={on:t(g),once:t(E),off:t(b),emit:t(M)},A=c({},w),r.exports=e=function(I){return I==null?u(A):c(Object(I),w)},e.methods=D})(xh,xh.exports)),xh.exports}var DS=CS();const Hi=uo(DS);var cl={},ds={},Va={},nw;function Ld(){if(nw)return Va;nw=1;function r(i,o,u){if(u===void 0&&(u=Array.prototype),i&&typeof u.find=="function")return u.find.call(i,o);for(var l=0;l<i.length;l++)if(Object.prototype.hasOwnProperty.call(i,l)){var c=i[l];if(o.call(void 0,c,l,i))return c}}function e(i,o){return o===void 0&&(o=Object),o&&typeof o.freeze=="function"?o.freeze(i):i}var t=e({HTML:"text/html",isHTML:function(i){return i===t.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),n=e({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(i){return i===n.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});return Va.find=r,Va.freeze=e,Va.MIME_TYPE=t,Va.NAMESPACE=n,Va}var rw;function QE(){if(rw)return ds;rw=1;var r=Ld(),e=r.find,t=r.NAMESPACE;function n(v){return v!==""}function i(v){return v?v.split(/[\t\n\f\r ]+/).filter(n):[]}function o(v,O){return v.hasOwnProperty(O)||(v[O]=!0),v}function u(v){if(!v)return[];var O=i(v);return Object.keys(O.reduce(o,{}))}function l(v){return function(O){return v&&v.indexOf(O)!==-1}}function c(v,O){for(var G in v)Object.prototype.hasOwnProperty.call(v,G)&&(O[G]=v[G])}function d(v,O){var G=v.prototype;if(!(G instanceof O)){let X=function(){};var y=X;X.prototype=O.prototype,X=new X,c(G,X),v.prototype=G=X}G.constructor!=v&&(typeof v!="function"&&console.error("unknown Class:"+v),G.constructor=v)}var m={},g=m.ELEMENT_NODE=1,E=m.ATTRIBUTE_NODE=2,b=m.TEXT_NODE=3,M=m.CDATA_SECTION_NODE=4,D=m.ENTITY_REFERENCE_NODE=5,w=m.ENTITY_NODE=6,A=m.PROCESSING_INSTRUCTION_NODE=7,I=m.COMMENT_NODE=8,V=m.DOCUMENT_NODE=9,q=m.DOCUMENT_TYPE_NODE=10,P=m.DOCUMENT_FRAGMENT_NODE=11,U=m.NOTATION_NODE=12,R={},S={};R.INDEX_SIZE_ERR=(S[1]="Index size error",1),R.DOMSTRING_SIZE_ERR=(S[2]="DOMString size error",2);var C=R.HIERARCHY_REQUEST_ERR=(S[3]="Hierarchy request error",3);R.WRONG_DOCUMENT_ERR=(S[4]="Wrong document",4),R.INVALID_CHARACTER_ERR=(S[5]="Invalid character",5),R.NO_DATA_ALLOWED_ERR=(S[6]="No data allowed",6),R.NO_MODIFICATION_ALLOWED_ERR=(S[7]="No modification allowed",7);var N=R.NOT_FOUND_ERR=(S[8]="Not found",8);R.NOT_SUPPORTED_ERR=(S[9]="Not supported",9);var z=R.INUSE_ATTRIBUTE_ERR=(S[10]="Attribute in use",10);R.INVALID_STATE_ERR=(S[11]="Invalid state",11),R.SYNTAX_ERR=(S[12]="Syntax error",12),R.INVALID_MODIFICATION_ERR=(S[13]="Invalid modification",13),R.NAMESPACE_ERR=(S[14]="Invalid namespace",14),R.INVALID_ACCESS_ERR=(S[15]="Invalid access",15);function j(v,O){if(O instanceof Error)var G=O;else G=this,Error.call(this,S[v]),this.message=S[v],Error.captureStackTrace&&Error.captureStackTrace(this,j);return G.code=v,O&&(this.message=this.message+": "+O),G}j.prototype=Error.prototype,c(R,j);function L(){}L.prototype={length:0,item:function(v){return v>=0&&v<this.length?this[v]:null},toString:function(v,O){for(var G=[],y=0;y<this.length;y++)Se(this[y],G,v,O);return G.join("")},filter:function(v){return Array.prototype.filter.call(this,v)},indexOf:function(v){return Array.prototype.indexOf.call(this,v)}};function he(v,O){this._node=v,this._refresh=O,_e(this)}function _e(v){var O=v._node._inc||v._node.ownerDocument._inc;if(v._inc!==O){var G=v._refresh(v._node);if(ne(v,"length",G.length),!v.$$length||G.length<v.$$length)for(var y=G.length;y in v;y++)Object.prototype.hasOwnProperty.call(v,y)&&delete v[y];c(G,v),v._inc=O}}he.prototype.item=function(v){return _e(this),this[v]||null},d(he,L);function De(){}function de(v,O){for(var G=v.length;G--;)if(v[G]===O)return G}function J(v,O,G,y){if(y?O[de(O,y)]=G:O[O.length++]=G,v){G.ownerElement=v;var X=v.ownerDocument;X&&(y&&Ke(X,v,y),He(X,v,G))}}function ce(v,O,G){var y=de(O,G);if(y>=0){for(var X=O.length-1;y<X;)O[y]=O[++y];if(O.length=X,v){var ie=v.ownerDocument;ie&&(Ke(ie,v,G),G.ownerElement=null)}}else throw new j(N,new Error(v.tagName+"@"+G))}De.prototype={length:0,item:L.prototype.item,getNamedItem:function(v){for(var O=this.length;O--;){var G=this[O];if(G.nodeName==v)return G}},setNamedItem:function(v){var O=v.ownerElement;if(O&&O!=this._ownerElement)throw new j(z);var G=this.getNamedItem(v.nodeName);return J(this._ownerElement,this,v,G),G},setNamedItemNS:function(v){var O=v.ownerElement,G;if(O&&O!=this._ownerElement)throw new j(z);return G=this.getNamedItemNS(v.namespaceURI,v.localName),J(this._ownerElement,this,v,G),G},removeNamedItem:function(v){var O=this.getNamedItem(v);return ce(this._ownerElement,this,O),O},removeNamedItemNS:function(v,O){var G=this.getNamedItemNS(v,O);return ce(this._ownerElement,this,G),G},getNamedItemNS:function(v,O){for(var G=this.length;G--;){var y=this[G];if(y.localName==O&&y.namespaceURI==v)return y}return null}};function xe(){}xe.prototype={hasFeature:function(v,O){return!0},createDocument:function(v,O,G){var y=new Ie;if(y.implementation=this,y.childNodes=new L,y.doctype=G||null,G&&y.appendChild(G),O){var X=y.createElementNS(v,O);y.appendChild(X)}return y},createDocumentType:function(v,O,G){var y=new jt;return y.name=v,y.nodeName=v,y.publicId=O||"",y.systemId=G||"",y}};function Q(){}Q.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(v,O){return Dt(this,v,O)},replaceChild:function(v,O){Dt(this,v,O,Ht),O&&this.removeChild(O)},removeChild:function(v){return Fe(this,v)},appendChild:function(v){return this.insertBefore(v,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(v){return Ge(this.ownerDocument||this,this,v)},normalize:function(){for(var v=this.firstChild;v;){var O=v.nextSibling;O&&O.nodeType==b&&v.nodeType==b?(this.removeChild(O),v.appendData(O.data)):(v.normalize(),v=O)}},isSupported:function(v,O){return this.ownerDocument.implementation.hasFeature(v,O)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(v){for(var O=this;O;){var G=O._nsMap;if(G){for(var y in G)if(Object.prototype.hasOwnProperty.call(G,y)&&G[y]===v)return y}O=O.nodeType==E?O.ownerDocument:O.parentNode}return null},lookupNamespaceURI:function(v){for(var O=this;O;){var G=O._nsMap;if(G&&v in G&&Object.prototype.hasOwnProperty.call(G,v))return G[v];O=O.nodeType==E?O.ownerDocument:O.parentNode}return null},isDefaultNamespace:function(v){var O=this.lookupPrefix(v);return O==null}};function se(v){return v=="<"&&"&lt;"||v==">"&&"&gt;"||v=="&"&&"&amp;"||v=='"'&&"&quot;"||"&#"+v.charCodeAt()+";"}c(m,Q),c(m,Q.prototype);function Ce(v,O){if(O(v))return!0;if(v=v.firstChild)do if(Ce(v,O))return!0;while(v=v.nextSibling)}function Ie(){this.ownerDocument=this}function He(v,O,G){v&&v._inc++;var y=G.namespaceURI;y===t.XMLNS&&(O._nsMap[G.prefix?G.localName:""]=G.value)}function Ke(v,O,G,y){v&&v._inc++;var X=G.namespaceURI;X===t.XMLNS&&delete O._nsMap[G.prefix?G.localName:""]}function et(v,O,G){if(v&&v._inc){v._inc++;var y=O.childNodes;if(G)y[y.length++]=G;else{for(var X=O.firstChild,ie=0;X;)y[ie++]=X,X=X.nextSibling;y.length=ie,delete y[y.length]}}}function Fe(v,O){var G=O.previousSibling,y=O.nextSibling;return G?G.nextSibling=y:v.firstChild=y,y?y.previousSibling=G:v.lastChild=G,O.parentNode=null,O.previousSibling=null,O.nextSibling=null,et(v.ownerDocument,v),O}function Je(v){return v&&(v.nodeType===Q.DOCUMENT_NODE||v.nodeType===Q.DOCUMENT_FRAGMENT_NODE||v.nodeType===Q.ELEMENT_NODE)}function Xe(v){return v&&(yt(v)||mt(v)||ft(v)||v.nodeType===Q.DOCUMENT_FRAGMENT_NODE||v.nodeType===Q.COMMENT_NODE||v.nodeType===Q.PROCESSING_INSTRUCTION_NODE)}function ft(v){return v&&v.nodeType===Q.DOCUMENT_TYPE_NODE}function yt(v){return v&&v.nodeType===Q.ELEMENT_NODE}function mt(v){return v&&v.nodeType===Q.TEXT_NODE}function _t(v,O){var G=v.childNodes||[];if(e(G,yt)||ft(O))return!1;var y=e(G,ft);return!(O&&y&&G.indexOf(y)>G.indexOf(O))}function kt(v,O){var G=v.childNodes||[];function y(ie){return yt(ie)&&ie!==O}if(e(G,y))return!1;var X=e(G,ft);return!(O&&X&&G.indexOf(X)>G.indexOf(O))}function St(v,O,G){if(!Je(v))throw new j(C,"Unexpected parent node type "+v.nodeType);if(G&&G.parentNode!==v)throw new j(N,"child not in parent");if(!Xe(O)||ft(O)&&v.nodeType!==Q.DOCUMENT_NODE)throw new j(C,"Unexpected node type "+O.nodeType+" for parent node type "+v.nodeType)}function Tt(v,O,G){var y=v.childNodes||[],X=O.childNodes||[];if(O.nodeType===Q.DOCUMENT_FRAGMENT_NODE){var ie=X.filter(yt);if(ie.length>1||e(X,mt))throw new j(C,"More than one element or text in fragment");if(ie.length===1&&!_t(v,G))throw new j(C,"Element in fragment can not be inserted before doctype")}if(yt(O)&&!_t(v,G))throw new j(C,"Only one element can be added and only after doctype");if(ft(O)){if(e(y,ft))throw new j(C,"Only one doctype is allowed");var F=e(y,yt);if(G&&y.indexOf(F)<y.indexOf(G))throw new j(C,"Doctype can only be inserted before an element");if(!G&&F)throw new j(C,"Doctype can not be appended since element is present")}}function Ht(v,O,G){var y=v.childNodes||[],X=O.childNodes||[];if(O.nodeType===Q.DOCUMENT_FRAGMENT_NODE){var ie=X.filter(yt);if(ie.length>1||e(X,mt))throw new j(C,"More than one element or text in fragment");if(ie.length===1&&!kt(v,G))throw new j(C,"Element in fragment can not be inserted before doctype")}if(yt(O)&&!kt(v,G))throw new j(C,"Only one element can be added and only after doctype");if(ft(O)){let ue=function(Ue){return ft(Ue)&&Ue!==G};var Z=ue;if(e(y,ue))throw new j(C,"Only one doctype is allowed");var F=e(y,yt);if(G&&y.indexOf(F)<y.indexOf(G))throw new j(C,"Doctype can only be inserted before an element")}}function Dt(v,O,G,y){St(v,O,G),v.nodeType===Q.DOCUMENT_NODE&&(y||Tt)(v,O,G);var X=O.parentNode;if(X&&X.removeChild(O),O.nodeType===P){var ie=O.firstChild;if(ie==null)return O;var F=O.lastChild}else ie=F=O;var Z=G?G.previousSibling:v.lastChild;ie.previousSibling=Z,F.nextSibling=G,Z?Z.nextSibling=ie:v.firstChild=ie,G==null?v.lastChild=F:G.previousSibling=F;do ie.parentNode=v;while(ie!==F&&(ie=ie.nextSibling));return et(v.ownerDocument||v,v),O.nodeType==P&&(O.firstChild=O.lastChild=null),O}function wt(v,O){return O.parentNode&&O.parentNode.removeChild(O),O.parentNode=v,O.previousSibling=v.lastChild,O.nextSibling=null,O.previousSibling?O.previousSibling.nextSibling=O:v.firstChild=O,v.lastChild=O,et(v.ownerDocument,v,O),O}Ie.prototype={nodeName:"#document",nodeType:V,doctype:null,documentElement:null,_inc:1,insertBefore:function(v,O){if(v.nodeType==P){for(var G=v.firstChild;G;){var y=G.nextSibling;this.insertBefore(G,O),G=y}return v}return Dt(this,v,O),v.ownerDocument=this,this.documentElement===null&&v.nodeType===g&&(this.documentElement=v),v},removeChild:function(v){return this.documentElement==v&&(this.documentElement=null),Fe(this,v)},replaceChild:function(v,O){Dt(this,v,O,Ht),v.ownerDocument=this,O&&this.removeChild(O),yt(v)&&(this.documentElement=v)},importNode:function(v,O){return Re(this,v,O)},getElementById:function(v){var O=null;return Ce(this.documentElement,function(G){if(G.nodeType==g&&G.getAttribute("id")==v)return O=G,!0}),O},getElementsByClassName:function(v){var O=u(v);return new he(this,function(G){var y=[];return O.length>0&&Ce(G.documentElement,function(X){if(X!==G&&X.nodeType===g){var ie=X.getAttribute("class");if(ie){var F=v===ie;if(!F){var Z=u(ie);F=O.every(l(Z))}F&&y.push(X)}}}),y})},createElement:function(v){var O=new it;O.ownerDocument=this,O.nodeName=v,O.tagName=v,O.localName=v,O.childNodes=new L;var G=O.attributes=new De;return G._ownerElement=O,O},createDocumentFragment:function(){var v=new Qt;return v.ownerDocument=this,v.childNodes=new L,v},createTextNode:function(v){var O=new an;return O.ownerDocument=this,O.appendData(v),O},createComment:function(v){var O=new _n;return O.ownerDocument=this,O.appendData(v),O},createCDATASection:function(v){var O=new xn;return O.ownerDocument=this,O.appendData(v),O},createProcessingInstruction:function(v,O){var G=new Tn;return G.ownerDocument=this,G.tagName=G.nodeName=G.target=v,G.nodeValue=G.data=O,G},createAttribute:function(v){var O=new gt;return O.ownerDocument=this,O.name=v,O.nodeName=v,O.localName=v,O.specified=!0,O},createEntityReference:function(v){var O=new en;return O.ownerDocument=this,O.nodeName=v,O},createElementNS:function(v,O){var G=new it,y=O.split(":"),X=G.attributes=new De;return G.childNodes=new L,G.ownerDocument=this,G.nodeName=O,G.tagName=O,G.namespaceURI=v,y.length==2?(G.prefix=y[0],G.localName=y[1]):G.localName=O,X._ownerElement=G,G},createAttributeNS:function(v,O){var G=new gt,y=O.split(":");return G.ownerDocument=this,G.nodeName=O,G.name=O,G.namespaceURI=v,G.specified=!0,y.length==2?(G.prefix=y[0],G.localName=y[1]):G.localName=O,G}},d(Ie,Q);function it(){this._nsMap={}}it.prototype={nodeType:g,hasAttribute:function(v){return this.getAttributeNode(v)!=null},getAttribute:function(v){var O=this.getAttributeNode(v);return O&&O.value||""},getAttributeNode:function(v){return this.attributes.getNamedItem(v)},setAttribute:function(v,O){var G=this.ownerDocument.createAttribute(v);G.value=G.nodeValue=""+O,this.setAttributeNode(G)},removeAttribute:function(v){var O=this.getAttributeNode(v);O&&this.removeAttributeNode(O)},appendChild:function(v){return v.nodeType===P?this.insertBefore(v,null):wt(this,v)},setAttributeNode:function(v){return this.attributes.setNamedItem(v)},setAttributeNodeNS:function(v){return this.attributes.setNamedItemNS(v)},removeAttributeNode:function(v){return this.attributes.removeNamedItem(v.nodeName)},removeAttributeNS:function(v,O){var G=this.getAttributeNodeNS(v,O);G&&this.removeAttributeNode(G)},hasAttributeNS:function(v,O){return this.getAttributeNodeNS(v,O)!=null},getAttributeNS:function(v,O){var G=this.getAttributeNodeNS(v,O);return G&&G.value||""},setAttributeNS:function(v,O,G){var y=this.ownerDocument.createAttributeNS(v,O);y.value=y.nodeValue=""+G,this.setAttributeNode(y)},getAttributeNodeNS:function(v,O){return this.attributes.getNamedItemNS(v,O)},getElementsByTagName:function(v){return new he(this,function(O){var G=[];return Ce(O,function(y){y!==O&&y.nodeType==g&&(v==="*"||y.tagName==v)&&G.push(y)}),G})},getElementsByTagNameNS:function(v,O){return new he(this,function(G){var y=[];return Ce(G,function(X){X!==G&&X.nodeType===g&&(v==="*"||X.namespaceURI===v)&&(O==="*"||X.localName==O)&&y.push(X)}),y})}},Ie.prototype.getElementsByTagName=it.prototype.getElementsByTagName,Ie.prototype.getElementsByTagNameNS=it.prototype.getElementsByTagNameNS,d(it,Q);function gt(){}gt.prototype.nodeType=E,d(gt,Q);function dt(){}dt.prototype={data:"",substringData:function(v,O){return this.data.substring(v,v+O)},appendData:function(v){v=this.data+v,this.nodeValue=this.data=v,this.length=v.length},insertData:function(v,O){this.replaceData(v,0,O)},appendChild:function(v){throw new Error(S[C])},deleteData:function(v,O){this.replaceData(v,O,"")},replaceData:function(v,O,G){var y=this.data.substring(0,v),X=this.data.substring(v+O);G=y+G+X,this.nodeValue=this.data=G,this.length=G.length}},d(dt,Q);function an(){}an.prototype={nodeName:"#text",nodeType:b,splitText:function(v){var O=this.data,G=O.substring(v);O=O.substring(0,v),this.data=this.nodeValue=O,this.length=O.length;var y=this.ownerDocument.createTextNode(G);return this.parentNode&&this.parentNode.insertBefore(y,this.nextSibling),y}},d(an,dt);function _n(){}_n.prototype={nodeName:"#comment",nodeType:I},d(_n,dt);function xn(){}xn.prototype={nodeName:"#cdata-section",nodeType:M},d(xn,dt);function jt(){}jt.prototype.nodeType=q,d(jt,Q);function on(){}on.prototype.nodeType=U,d(on,Q);function pn(){}pn.prototype.nodeType=w,d(pn,Q);function en(){}en.prototype.nodeType=D,d(en,Q);function Qt(){}Qt.prototype.nodeName="#document-fragment",Qt.prototype.nodeType=P,d(Qt,Q);function Tn(){}Tn.prototype.nodeType=A,d(Tn,Q);function Gt(){}Gt.prototype.serializeToString=function(v,O,G){return hn.call(v,O,G)},Q.prototype.toString=hn;function hn(v,O){var G=[],y=this.nodeType==9&&this.documentElement||this,X=y.prefix,ie=y.namespaceURI;if(ie&&X==null){var X=y.lookupPrefix(ie);if(X==null)var F=[{namespace:ie,prefix:null}]}return Se(this,G,v,O,F),G.join("")}function Pn(v,O,G){var y=v.prefix||"",X=v.namespaceURI;if(!X||y==="xml"&&X===t.XML||X===t.XMLNS)return!1;for(var ie=G.length;ie--;){var F=G[ie];if(F.prefix===y)return F.namespace!==X}return!0}function $(v,O,G){v.push(" ",O,'="',G.replace(/[<&"]/g,se),'"')}function Se(v,O,G,y,X){if(X||(X=[]),y)if(v=y(v),v){if(typeof v=="string"){O.push(v);return}}else return;switch(v.nodeType){case g:var ie=v.attributes,F=ie.length,Nt=v.firstChild,Z=v.tagName;G=t.isHTML(v.namespaceURI)||G;var ue=Z;if(!G&&!v.prefix&&v.namespaceURI){for(var Ue,Ne=0;Ne<ie.length;Ne++)if(ie.item(Ne).name==="xmlns"){Ue=ie.item(Ne).value;break}if(!Ue)for(var ze=X.length-1;ze>=0;ze--){var lt=X[ze];if(lt.prefix===""&&lt.namespace===v.namespaceURI){Ue=lt.namespace;break}}if(Ue!==v.namespaceURI)for(var ze=X.length-1;ze>=0;ze--){var lt=X[ze];if(lt.namespace===v.namespaceURI){lt.prefix&&(ue=lt.prefix+":"+Z);break}}}O.push("<",ue);for(var Lt=0;Lt<F;Lt++){var xt=ie.item(Lt);xt.prefix=="xmlns"?X.push({prefix:xt.localName,namespace:xt.value}):xt.nodeName=="xmlns"&&X.push({prefix:"",namespace:xt.value})}for(var Lt=0;Lt<F;Lt++){var xt=ie.item(Lt);if(Pn(xt,G,X)){var at=xt.prefix||"",Vt=xt.namespaceURI;$(O,at?"xmlns:"+at:"xmlns",Vt),X.push({prefix:at,namespace:Vt})}Se(xt,O,G,y,X)}if(Z===ue&&Pn(v,G,X)){var at=v.prefix||"",Vt=v.namespaceURI;$(O,at?"xmlns:"+at:"xmlns",Vt),X.push({prefix:at,namespace:Vt})}if(Nt||G&&!/^(?:meta|link|img|br|hr|input)$/i.test(Z)){if(O.push(">"),G&&/^script$/i.test(Z))for(;Nt;)Nt.data?O.push(Nt.data):Se(Nt,O,G,y,X.slice()),Nt=Nt.nextSibling;else for(;Nt;)Se(Nt,O,G,y,X.slice()),Nt=Nt.nextSibling;O.push("</",ue,">")}else O.push("/>");return;case V:case P:for(var Nt=v.firstChild;Nt;)Se(Nt,O,G,y,X.slice()),Nt=Nt.nextSibling;return;case E:return $(O,v.name,v.value);case b:return O.push(v.data.replace(/[<&]/g,se).replace(/]]>/g,"]]&gt;"));case M:return O.push("<![CDATA[",v.data,"]]>");case I:return O.push("<!--",v.data,"-->");case q:var mn=v.publicId,gn=v.systemId;if(O.push("<!DOCTYPE ",v.name),mn)O.push(" PUBLIC ",mn),gn&&gn!="."&&O.push(" ",gn),O.push(">");else if(gn&&gn!=".")O.push(" SYSTEM ",gn,">");else{var yr=v.internalSubset;yr&&O.push(" [",yr,"]"),O.push(">")}return;case A:return O.push("<?",v.target," ",v.data,"?>");case D:return O.push("&",v.nodeName,";");default:O.push("??",v.nodeName)}}function Re(v,O,G){var y;switch(O.nodeType){case g:y=O.cloneNode(!1),y.ownerDocument=v;case P:break;case E:G=!0;break}if(y||(y=O.cloneNode(!1)),y.ownerDocument=v,y.parentNode=null,G)for(var X=O.firstChild;X;)y.appendChild(Re(v,X,G)),X=X.nextSibling;return y}function Ge(v,O,G){var y=new O.constructor;for(var X in O)if(Object.prototype.hasOwnProperty.call(O,X)){var ie=O[X];typeof ie!="object"&&ie!=y[X]&&(y[X]=ie)}switch(O.childNodes&&(y.childNodes=new L),y.ownerDocument=v,y.nodeType){case g:var F=O.attributes,Z=y.attributes=new De,ue=F.length;Z._ownerElement=y;for(var Ue=0;Ue<ue;Ue++)y.setAttributeNode(Ge(v,F.item(Ue),!0));break;case E:G=!0}if(G)for(var Ne=O.firstChild;Ne;)y.appendChild(Ge(v,Ne,G)),Ne=Ne.nextSibling;return y}function ne(v,O,G){v[O]=G}try{if(Object.defineProperty){let v=function(O){switch(O.nodeType){case g:case P:var G=[];for(O=O.firstChild;O;)O.nodeType!==7&&O.nodeType!==8&&G.push(v(O)),O=O.nextSibling;return G.join("");default:return O.nodeValue}};var be=v;Object.defineProperty(he.prototype,"length",{get:function(){return _e(this),this.$$length}}),Object.defineProperty(Q.prototype,"textContent",{get:function(){return v(this)},set:function(O){switch(this.nodeType){case g:case P:for(;this.firstChild;)this.removeChild(this.firstChild);(O||String(O))&&this.appendChild(this.ownerDocument.createTextNode(O));break;default:this.data=O,this.value=O,this.nodeValue=O}}}),ne=function(O,G,y){O["$$"+G]=y}}}catch{}return ds.DocumentType=jt,ds.DOMException=j,ds.DOMImplementation=xe,ds.Element=it,ds.Node=Q,ds.NodeList=L,ds.XMLSerializer=Gt,ds}var Fa={},sm={},iw;function RS(){return iw||(iw=1,(function(r){var e=Ld().freeze;r.XML_ENTITIES=e({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),r.HTML_ENTITIES=e({Aacute:"",aacute:"",Abreve:"",abreve:"",ac:"",acd:"",acE:"",Acirc:"",acirc:"",acute:"",Acy:"",acy:"",AElig:"",aelig:"",af:"",Afr:"",afr:"",Agrave:"",agrave:"",alefsym:"",aleph:"",Alpha:"",alpha:"",Amacr:"",amacr:"",amalg:"",AMP:"&",amp:"&",And:"",and:"",andand:"",andd:"",andslope:"",andv:"",ang:"",ange:"",angle:"",angmsd:"",angmsdaa:"",angmsdab:"",angmsdac:"",angmsdad:"",angmsdae:"",angmsdaf:"",angmsdag:"",angmsdah:"",angrt:"",angrtvb:"",angrtvbd:"",angsph:"",angst:"",angzarr:"",Aogon:"",aogon:"",Aopf:"",aopf:"",ap:"",apacir:"",apE:"",ape:"",apid:"",apos:"'",ApplyFunction:"",approx:"",approxeq:"",Aring:"",aring:"",Ascr:"",ascr:"",Assign:"",ast:"*",asymp:"",asympeq:"",Atilde:"",atilde:"",Auml:"",auml:"",awconint:"",awint:"",backcong:"",backepsilon:"",backprime:"",backsim:"",backsimeq:"",Backslash:"",Barv:"",barvee:"",Barwed:"",barwed:"",barwedge:"",bbrk:"",bbrktbrk:"",bcong:"",Bcy:"",bcy:"",bdquo:"",becaus:"",Because:"",because:"",bemptyv:"",bepsi:"",bernou:"",Bernoullis:"",Beta:"",beta:"",beth:"",between:"",Bfr:"",bfr:"",bigcap:"",bigcirc:"",bigcup:"",bigodot:"",bigoplus:"",bigotimes:"",bigsqcup:"",bigstar:"",bigtriangledown:"",bigtriangleup:"",biguplus:"",bigvee:"",bigwedge:"",bkarow:"",blacklozenge:"",blacksquare:"",blacktriangle:"",blacktriangledown:"",blacktriangleleft:"",blacktriangleright:"",blank:"",blk12:"",blk14:"",blk34:"",block:"",bne:"=",bnequiv:"",bNot:"",bnot:"",Bopf:"",bopf:"",bot:"",bottom:"",bowtie:"",boxbox:"",boxDL:"",boxDl:"",boxdL:"",boxdl:"",boxDR:"",boxDr:"",boxdR:"",boxdr:"",boxH:"",boxh:"",boxHD:"",boxHd:"",boxhD:"",boxhd:"",boxHU:"",boxHu:"",boxhU:"",boxhu:"",boxminus:"",boxplus:"",boxtimes:"",boxUL:"",boxUl:"",boxuL:"",boxul:"",boxUR:"",boxUr:"",boxuR:"",boxur:"",boxV:"",boxv:"",boxVH:"",boxVh:"",boxvH:"",boxvh:"",boxVL:"",boxVl:"",boxvL:"",boxvl:"",boxVR:"",boxVr:"",boxvR:"",boxvr:"",bprime:"",Breve:"",breve:"",brvbar:"",Bscr:"",bscr:"",bsemi:"",bsim:"",bsime:"",bsol:"\\",bsolb:"",bsolhsub:"",bull:"",bullet:"",bump:"",bumpE:"",bumpe:"",Bumpeq:"",bumpeq:"",Cacute:"",cacute:"",Cap:"",cap:"",capand:"",capbrcup:"",capcap:"",capcup:"",capdot:"",CapitalDifferentialD:"",caps:"",caret:"",caron:"",Cayleys:"",ccaps:"",Ccaron:"",ccaron:"",Ccedil:"",ccedil:"",Ccirc:"",ccirc:"",Cconint:"",ccups:"",ccupssm:"",Cdot:"",cdot:"",cedil:"",Cedilla:"",cemptyv:"",cent:"",CenterDot:"",centerdot:"",Cfr:"",cfr:"",CHcy:"",chcy:"",check:"",checkmark:"",Chi:"",chi:"",cir:"",circ:"",circeq:"",circlearrowleft:"",circlearrowright:"",circledast:"",circledcirc:"",circleddash:"",CircleDot:"",circledR:"",circledS:"",CircleMinus:"",CirclePlus:"",CircleTimes:"",cirE:"",cire:"",cirfnint:"",cirmid:"",cirscir:"",ClockwiseContourIntegral:"",CloseCurlyDoubleQuote:"",CloseCurlyQuote:"",clubs:"",clubsuit:"",Colon:"",colon:":",Colone:"",colone:"",coloneq:"",comma:",",commat:"@",comp:"",compfn:"",complement:"",complexes:"",cong:"",congdot:"",Congruent:"",Conint:"",conint:"",ContourIntegral:"",Copf:"",copf:"",coprod:"",Coproduct:"",COPY:"",copy:"",copysr:"",CounterClockwiseContourIntegral:"",crarr:"",Cross:"",cross:"",Cscr:"",cscr:"",csub:"",csube:"",csup:"",csupe:"",ctdot:"",cudarrl:"",cudarrr:"",cuepr:"",cuesc:"",cularr:"",cularrp:"",Cup:"",cup:"",cupbrcap:"",CupCap:"",cupcap:"",cupcup:"",cupdot:"",cupor:"",cups:"",curarr:"",curarrm:"",curlyeqprec:"",curlyeqsucc:"",curlyvee:"",curlywedge:"",curren:"",curvearrowleft:"",curvearrowright:"",cuvee:"",cuwed:"",cwconint:"",cwint:"",cylcty:"",Dagger:"",dagger:"",daleth:"",Darr:"",dArr:"",darr:"",dash:"",Dashv:"",dashv:"",dbkarow:"",dblac:"",Dcaron:"",dcaron:"",Dcy:"",dcy:"",DD:"",dd:"",ddagger:"",ddarr:"",DDotrahd:"",ddotseq:"",deg:"",Del:"",Delta:"",delta:"",demptyv:"",dfisht:"",Dfr:"",dfr:"",dHar:"",dharl:"",dharr:"",DiacriticalAcute:"",DiacriticalDot:"",DiacriticalDoubleAcute:"",DiacriticalGrave:"`",DiacriticalTilde:"",diam:"",Diamond:"",diamond:"",diamondsuit:"",diams:"",die:"",DifferentialD:"",digamma:"",disin:"",div:"",divide:"",divideontimes:"",divonx:"",DJcy:"",djcy:"",dlcorn:"",dlcrop:"",dollar:"$",Dopf:"",dopf:"",Dot:"",dot:"",DotDot:"",doteq:"",doteqdot:"",DotEqual:"",dotminus:"",dotplus:"",dotsquare:"",doublebarwedge:"",DoubleContourIntegral:"",DoubleDot:"",DoubleDownArrow:"",DoubleLeftArrow:"",DoubleLeftRightArrow:"",DoubleLeftTee:"",DoubleLongLeftArrow:"",DoubleLongLeftRightArrow:"",DoubleLongRightArrow:"",DoubleRightArrow:"",DoubleRightTee:"",DoubleUpArrow:"",DoubleUpDownArrow:"",DoubleVerticalBar:"",DownArrow:"",Downarrow:"",downarrow:"",DownArrowBar:"",DownArrowUpArrow:"",DownBreve:"",downdownarrows:"",downharpoonleft:"",downharpoonright:"",DownLeftRightVector:"",DownLeftTeeVector:"",DownLeftVector:"",DownLeftVectorBar:"",DownRightTeeVector:"",DownRightVector:"",DownRightVectorBar:"",DownTee:"",DownTeeArrow:"",drbkarow:"",drcorn:"",drcrop:"",Dscr:"",dscr:"",DScy:"",dscy:"",dsol:"",Dstrok:"",dstrok:"",dtdot:"",dtri:"",dtrif:"",duarr:"",duhar:"",dwangle:"",DZcy:"",dzcy:"",dzigrarr:"",Eacute:"",eacute:"",easter:"",Ecaron:"",ecaron:"",ecir:"",Ecirc:"",ecirc:"",ecolon:"",Ecy:"",ecy:"",eDDot:"",Edot:"",eDot:"",edot:"",ee:"",efDot:"",Efr:"",efr:"",eg:"",Egrave:"",egrave:"",egs:"",egsdot:"",el:"",Element:"",elinters:"",ell:"",els:"",elsdot:"",Emacr:"",emacr:"",empty:"",emptyset:"",EmptySmallSquare:"",emptyv:"",EmptyVerySmallSquare:"",emsp:"",emsp13:"",emsp14:"",ENG:"",eng:"",ensp:"",Eogon:"",eogon:"",Eopf:"",eopf:"",epar:"",eparsl:"",eplus:"",epsi:"",Epsilon:"",epsilon:"",epsiv:"",eqcirc:"",eqcolon:"",eqsim:"",eqslantgtr:"",eqslantless:"",Equal:"",equals:"=",EqualTilde:"",equest:"",Equilibrium:"",equiv:"",equivDD:"",eqvparsl:"",erarr:"",erDot:"",Escr:"",escr:"",esdot:"",Esim:"",esim:"",Eta:"",eta:"",ETH:"",eth:"",Euml:"",euml:"",euro:"",excl:"!",exist:"",Exists:"",expectation:"",ExponentialE:"",exponentiale:"",fallingdotseq:"",Fcy:"",fcy:"",female:"",ffilig:"",fflig:"",ffllig:"",Ffr:"",ffr:"",filig:"",FilledSmallSquare:"",FilledVerySmallSquare:"",fjlig:"fj",flat:"",fllig:"",fltns:"",fnof:"",Fopf:"",fopf:"",ForAll:"",forall:"",fork:"",forkv:"",Fouriertrf:"",fpartint:"",frac12:"",frac13:"",frac14:"",frac15:"",frac16:"",frac18:"",frac23:"",frac25:"",frac34:"",frac35:"",frac38:"",frac45:"",frac56:"",frac58:"",frac78:"",frasl:"",frown:"",Fscr:"",fscr:"",gacute:"",Gamma:"",gamma:"",Gammad:"",gammad:"",gap:"",Gbreve:"",gbreve:"",Gcedil:"",Gcirc:"",gcirc:"",Gcy:"",gcy:"",Gdot:"",gdot:"",gE:"",ge:"",gEl:"",gel:"",geq:"",geqq:"",geqslant:"",ges:"",gescc:"",gesdot:"",gesdoto:"",gesdotol:"",gesl:"",gesles:"",Gfr:"",gfr:"",Gg:"",gg:"",ggg:"",gimel:"",GJcy:"",gjcy:"",gl:"",gla:"",glE:"",glj:"",gnap:"",gnapprox:"",gnE:"",gne:"",gneq:"",gneqq:"",gnsim:"",Gopf:"",gopf:"",grave:"`",GreaterEqual:"",GreaterEqualLess:"",GreaterFullEqual:"",GreaterGreater:"",GreaterLess:"",GreaterSlantEqual:"",GreaterTilde:"",Gscr:"",gscr:"",gsim:"",gsime:"",gsiml:"",Gt:"",GT:">",gt:">",gtcc:"",gtcir:"",gtdot:"",gtlPar:"",gtquest:"",gtrapprox:"",gtrarr:"",gtrdot:"",gtreqless:"",gtreqqless:"",gtrless:"",gtrsim:"",gvertneqq:"",gvnE:"",Hacek:"",hairsp:"",half:"",hamilt:"",HARDcy:"",hardcy:"",hArr:"",harr:"",harrcir:"",harrw:"",Hat:"^",hbar:"",Hcirc:"",hcirc:"",hearts:"",heartsuit:"",hellip:"",hercon:"",Hfr:"",hfr:"",HilbertSpace:"",hksearow:"",hkswarow:"",hoarr:"",homtht:"",hookleftarrow:"",hookrightarrow:"",Hopf:"",hopf:"",horbar:"",HorizontalLine:"",Hscr:"",hscr:"",hslash:"",Hstrok:"",hstrok:"",HumpDownHump:"",HumpEqual:"",hybull:"",hyphen:"",Iacute:"",iacute:"",ic:"",Icirc:"",icirc:"",Icy:"",icy:"",Idot:"",IEcy:"",iecy:"",iexcl:"",iff:"",Ifr:"",ifr:"",Igrave:"",igrave:"",ii:"",iiiint:"",iiint:"",iinfin:"",iiota:"",IJlig:"",ijlig:"",Im:"",Imacr:"",imacr:"",image:"",ImaginaryI:"",imagline:"",imagpart:"",imath:"",imof:"",imped:"",Implies:"",in:"",incare:"",infin:"",infintie:"",inodot:"",Int:"",int:"",intcal:"",integers:"",Integral:"",intercal:"",Intersection:"",intlarhk:"",intprod:"",InvisibleComma:"",InvisibleTimes:"",IOcy:"",iocy:"",Iogon:"",iogon:"",Iopf:"",iopf:"",Iota:"",iota:"",iprod:"",iquest:"",Iscr:"",iscr:"",isin:"",isindot:"",isinE:"",isins:"",isinsv:"",isinv:"",it:"",Itilde:"",itilde:"",Iukcy:"",iukcy:"",Iuml:"",iuml:"",Jcirc:"",jcirc:"",Jcy:"",jcy:"",Jfr:"",jfr:"",jmath:"",Jopf:"",jopf:"",Jscr:"",jscr:"",Jsercy:"",jsercy:"",Jukcy:"",jukcy:"",Kappa:"",kappa:"",kappav:"",Kcedil:"",kcedil:"",Kcy:"",kcy:"",Kfr:"",kfr:"",kgreen:"",KHcy:"",khcy:"",KJcy:"",kjcy:"",Kopf:"",kopf:"",Kscr:"",kscr:"",lAarr:"",Lacute:"",lacute:"",laemptyv:"",lagran:"",Lambda:"",lambda:"",Lang:"",lang:"",langd:"",langle:"",lap:"",Laplacetrf:"",laquo:"",Larr:"",lArr:"",larr:"",larrb:"",larrbfs:"",larrfs:"",larrhk:"",larrlp:"",larrpl:"",larrsim:"",larrtl:"",lat:"",lAtail:"",latail:"",late:"",lates:"",lBarr:"",lbarr:"",lbbrk:"",lbrace:"{",lbrack:"[",lbrke:"",lbrksld:"",lbrkslu:"",Lcaron:"",lcaron:"",Lcedil:"",lcedil:"",lceil:"",lcub:"{",Lcy:"",lcy:"",ldca:"",ldquo:"",ldquor:"",ldrdhar:"",ldrushar:"",ldsh:"",lE:"",le:"",LeftAngleBracket:"",LeftArrow:"",Leftarrow:"",leftarrow:"",LeftArrowBar:"",LeftArrowRightArrow:"",leftarrowtail:"",LeftCeiling:"",LeftDoubleBracket:"",LeftDownTeeVector:"",LeftDownVector:"",LeftDownVectorBar:"",LeftFloor:"",leftharpoondown:"",leftharpoonup:"",leftleftarrows:"",LeftRightArrow:"",Leftrightarrow:"",leftrightarrow:"",leftrightarrows:"",leftrightharpoons:"",leftrightsquigarrow:"",LeftRightVector:"",LeftTee:"",LeftTeeArrow:"",LeftTeeVector:"",leftthreetimes:"",LeftTriangle:"",LeftTriangleBar:"",LeftTriangleEqual:"",LeftUpDownVector:"",LeftUpTeeVector:"",LeftUpVector:"",LeftUpVectorBar:"",LeftVector:"",LeftVectorBar:"",lEg:"",leg:"",leq:"",leqq:"",leqslant:"",les:"",lescc:"",lesdot:"",lesdoto:"",lesdotor:"",lesg:"",lesges:"",lessapprox:"",lessdot:"",lesseqgtr:"",lesseqqgtr:"",LessEqualGreater:"",LessFullEqual:"",LessGreater:"",lessgtr:"",LessLess:"",lesssim:"",LessSlantEqual:"",LessTilde:"",lfisht:"",lfloor:"",Lfr:"",lfr:"",lg:"",lgE:"",lHar:"",lhard:"",lharu:"",lharul:"",lhblk:"",LJcy:"",ljcy:"",Ll:"",ll:"",llarr:"",llcorner:"",Lleftarrow:"",llhard:"",lltri:"",Lmidot:"",lmidot:"",lmoust:"",lmoustache:"",lnap:"",lnapprox:"",lnE:"",lne:"",lneq:"",lneqq:"",lnsim:"",loang:"",loarr:"",lobrk:"",LongLeftArrow:"",Longleftarrow:"",longleftarrow:"",LongLeftRightArrow:"",Longleftrightarrow:"",longleftrightarrow:"",longmapsto:"",LongRightArrow:"",Longrightarrow:"",longrightarrow:"",looparrowleft:"",looparrowright:"",lopar:"",Lopf:"",lopf:"",loplus:"",lotimes:"",lowast:"",lowbar:"_",LowerLeftArrow:"",LowerRightArrow:"",loz:"",lozenge:"",lozf:"",lpar:"(",lparlt:"",lrarr:"",lrcorner:"",lrhar:"",lrhard:"",lrm:"",lrtri:"",lsaquo:"",Lscr:"",lscr:"",Lsh:"",lsh:"",lsim:"",lsime:"",lsimg:"",lsqb:"[",lsquo:"",lsquor:"",Lstrok:"",lstrok:"",Lt:"",LT:"<",lt:"<",ltcc:"",ltcir:"",ltdot:"",lthree:"",ltimes:"",ltlarr:"",ltquest:"",ltri:"",ltrie:"",ltrif:"",ltrPar:"",lurdshar:"",luruhar:"",lvertneqq:"",lvnE:"",macr:"",male:"",malt:"",maltese:"",Map:"",map:"",mapsto:"",mapstodown:"",mapstoleft:"",mapstoup:"",marker:"",mcomma:"",Mcy:"",mcy:"",mdash:"",mDDot:"",measuredangle:"",MediumSpace:"",Mellintrf:"",Mfr:"",mfr:"",mho:"",micro:"",mid:"",midast:"*",midcir:"",middot:"",minus:"",minusb:"",minusd:"",minusdu:"",MinusPlus:"",mlcp:"",mldr:"",mnplus:"",models:"",Mopf:"",mopf:"",mp:"",Mscr:"",mscr:"",mstpos:"",Mu:"",mu:"",multimap:"",mumap:"",nabla:"",Nacute:"",nacute:"",nang:"",nap:"",napE:"",napid:"",napos:"",napprox:"",natur:"",natural:"",naturals:"",nbsp:"",nbump:"",nbumpe:"",ncap:"",Ncaron:"",ncaron:"",Ncedil:"",ncedil:"",ncong:"",ncongdot:"",ncup:"",Ncy:"",ncy:"",ndash:"",ne:"",nearhk:"",neArr:"",nearr:"",nearrow:"",nedot:"",NegativeMediumSpace:"",NegativeThickSpace:"",NegativeThinSpace:"",NegativeVeryThinSpace:"",nequiv:"",nesear:"",nesim:"",NestedGreaterGreater:"",NestedLessLess:"",NewLine:`
`,nexist:"",nexists:"",Nfr:"",nfr:"",ngE:"",nge:"",ngeq:"",ngeqq:"",ngeqslant:"",nges:"",nGg:"",ngsim:"",nGt:"",ngt:"",ngtr:"",nGtv:"",nhArr:"",nharr:"",nhpar:"",ni:"",nis:"",nisd:"",niv:"",NJcy:"",njcy:"",nlArr:"",nlarr:"",nldr:"",nlE:"",nle:"",nLeftarrow:"",nleftarrow:"",nLeftrightarrow:"",nleftrightarrow:"",nleq:"",nleqq:"",nleqslant:"",nles:"",nless:"",nLl:"",nlsim:"",nLt:"",nlt:"",nltri:"",nltrie:"",nLtv:"",nmid:"",NoBreak:"",NonBreakingSpace:"",Nopf:"",nopf:"",Not:"",not:"",NotCongruent:"",NotCupCap:"",NotDoubleVerticalBar:"",NotElement:"",NotEqual:"",NotEqualTilde:"",NotExists:"",NotGreater:"",NotGreaterEqual:"",NotGreaterFullEqual:"",NotGreaterGreater:"",NotGreaterLess:"",NotGreaterSlantEqual:"",NotGreaterTilde:"",NotHumpDownHump:"",NotHumpEqual:"",notin:"",notindot:"",notinE:"",notinva:"",notinvb:"",notinvc:"",NotLeftTriangle:"",NotLeftTriangleBar:"",NotLeftTriangleEqual:"",NotLess:"",NotLessEqual:"",NotLessGreater:"",NotLessLess:"",NotLessSlantEqual:"",NotLessTilde:"",NotNestedGreaterGreater:"",NotNestedLessLess:"",notni:"",notniva:"",notnivb:"",notnivc:"",NotPrecedes:"",NotPrecedesEqual:"",NotPrecedesSlantEqual:"",NotReverseElement:"",NotRightTriangle:"",NotRightTriangleBar:"",NotRightTriangleEqual:"",NotSquareSubset:"",NotSquareSubsetEqual:"",NotSquareSuperset:"",NotSquareSupersetEqual:"",NotSubset:"",NotSubsetEqual:"",NotSucceeds:"",NotSucceedsEqual:"",NotSucceedsSlantEqual:"",NotSucceedsTilde:"",NotSuperset:"",NotSupersetEqual:"",NotTilde:"",NotTildeEqual:"",NotTildeFullEqual:"",NotTildeTilde:"",NotVerticalBar:"",npar:"",nparallel:"",nparsl:"",npart:"",npolint:"",npr:"",nprcue:"",npre:"",nprec:"",npreceq:"",nrArr:"",nrarr:"",nrarrc:"",nrarrw:"",nRightarrow:"",nrightarrow:"",nrtri:"",nrtrie:"",nsc:"",nsccue:"",nsce:"",Nscr:"",nscr:"",nshortmid:"",nshortparallel:"",nsim:"",nsime:"",nsimeq:"",nsmid:"",nspar:"",nsqsube:"",nsqsupe:"",nsub:"",nsubE:"",nsube:"",nsubset:"",nsubseteq:"",nsubseteqq:"",nsucc:"",nsucceq:"",nsup:"",nsupE:"",nsupe:"",nsupset:"",nsupseteq:"",nsupseteqq:"",ntgl:"",Ntilde:"",ntilde:"",ntlg:"",ntriangleleft:"",ntrianglelefteq:"",ntriangleright:"",ntrianglerighteq:"",Nu:"",nu:"",num:"#",numero:"",numsp:"",nvap:"",nVDash:"",nVdash:"",nvDash:"",nvdash:"",nvge:"",nvgt:">",nvHarr:"",nvinfin:"",nvlArr:"",nvle:"",nvlt:"<",nvltrie:"",nvrArr:"",nvrtrie:"",nvsim:"",nwarhk:"",nwArr:"",nwarr:"",nwarrow:"",nwnear:"",Oacute:"",oacute:"",oast:"",ocir:"",Ocirc:"",ocirc:"",Ocy:"",ocy:"",odash:"",Odblac:"",odblac:"",odiv:"",odot:"",odsold:"",OElig:"",oelig:"",ofcir:"",Ofr:"",ofr:"",ogon:"",Ograve:"",ograve:"",ogt:"",ohbar:"",ohm:"",oint:"",olarr:"",olcir:"",olcross:"",oline:"",olt:"",Omacr:"",omacr:"",Omega:"",omega:"",Omicron:"",omicron:"",omid:"",ominus:"",Oopf:"",oopf:"",opar:"",OpenCurlyDoubleQuote:"",OpenCurlyQuote:"",operp:"",oplus:"",Or:"",or:"",orarr:"",ord:"",order:"",orderof:"",ordf:"",ordm:"",origof:"",oror:"",orslope:"",orv:"",oS:"",Oscr:"",oscr:"",Oslash:"",oslash:"",osol:"",Otilde:"",otilde:"",Otimes:"",otimes:"",otimesas:"",Ouml:"",ouml:"",ovbar:"",OverBar:"",OverBrace:"",OverBracket:"",OverParenthesis:"",par:"",para:"",parallel:"",parsim:"",parsl:"",part:"",PartialD:"",Pcy:"",pcy:"",percnt:"%",period:".",permil:"",perp:"",pertenk:"",Pfr:"",pfr:"",Phi:"",phi:"",phiv:"",phmmat:"",phone:"",Pi:"",pi:"",pitchfork:"",piv:"",planck:"",planckh:"",plankv:"",plus:"+",plusacir:"",plusb:"",pluscir:"",plusdo:"",plusdu:"",pluse:"",PlusMinus:"",plusmn:"",plussim:"",plustwo:"",pm:"",Poincareplane:"",pointint:"",Popf:"",popf:"",pound:"",Pr:"",pr:"",prap:"",prcue:"",prE:"",pre:"",prec:"",precapprox:"",preccurlyeq:"",Precedes:"",PrecedesEqual:"",PrecedesSlantEqual:"",PrecedesTilde:"",preceq:"",precnapprox:"",precneqq:"",precnsim:"",precsim:"",Prime:"",prime:"",primes:"",prnap:"",prnE:"",prnsim:"",prod:"",Product:"",profalar:"",profline:"",profsurf:"",prop:"",Proportion:"",Proportional:"",propto:"",prsim:"",prurel:"",Pscr:"",pscr:"",Psi:"",psi:"",puncsp:"",Qfr:"",qfr:"",qint:"",Qopf:"",qopf:"",qprime:"",Qscr:"",qscr:"",quaternions:"",quatint:"",quest:"?",questeq:"",QUOT:'"',quot:'"',rAarr:"",race:"",Racute:"",racute:"",radic:"",raemptyv:"",Rang:"",rang:"",rangd:"",range:"",rangle:"",raquo:"",Rarr:"",rArr:"",rarr:"",rarrap:"",rarrb:"",rarrbfs:"",rarrc:"",rarrfs:"",rarrhk:"",rarrlp:"",rarrpl:"",rarrsim:"",Rarrtl:"",rarrtl:"",rarrw:"",rAtail:"",ratail:"",ratio:"",rationals:"",RBarr:"",rBarr:"",rbarr:"",rbbrk:"",rbrace:"}",rbrack:"]",rbrke:"",rbrksld:"",rbrkslu:"",Rcaron:"",rcaron:"",Rcedil:"",rcedil:"",rceil:"",rcub:"}",Rcy:"",rcy:"",rdca:"",rdldhar:"",rdquo:"",rdquor:"",rdsh:"",Re:"",real:"",realine:"",realpart:"",reals:"",rect:"",REG:"",reg:"",ReverseElement:"",ReverseEquilibrium:"",ReverseUpEquilibrium:"",rfisht:"",rfloor:"",Rfr:"",rfr:"",rHar:"",rhard:"",rharu:"",rharul:"",Rho:"",rho:"",rhov:"",RightAngleBracket:"",RightArrow:"",Rightarrow:"",rightarrow:"",RightArrowBar:"",RightArrowLeftArrow:"",rightarrowtail:"",RightCeiling:"",RightDoubleBracket:"",RightDownTeeVector:"",RightDownVector:"",RightDownVectorBar:"",RightFloor:"",rightharpoondown:"",rightharpoonup:"",rightleftarrows:"",rightleftharpoons:"",rightrightarrows:"",rightsquigarrow:"",RightTee:"",RightTeeArrow:"",RightTeeVector:"",rightthreetimes:"",RightTriangle:"",RightTriangleBar:"",RightTriangleEqual:"",RightUpDownVector:"",RightUpTeeVector:"",RightUpVector:"",RightUpVectorBar:"",RightVector:"",RightVectorBar:"",ring:"",risingdotseq:"",rlarr:"",rlhar:"",rlm:"",rmoust:"",rmoustache:"",rnmid:"",roang:"",roarr:"",robrk:"",ropar:"",Ropf:"",ropf:"",roplus:"",rotimes:"",RoundImplies:"",rpar:")",rpargt:"",rppolint:"",rrarr:"",Rrightarrow:"",rsaquo:"",Rscr:"",rscr:"",Rsh:"",rsh:"",rsqb:"]",rsquo:"",rsquor:"",rthree:"",rtimes:"",rtri:"",rtrie:"",rtrif:"",rtriltri:"",RuleDelayed:"",ruluhar:"",rx:"",Sacute:"",sacute:"",sbquo:"",Sc:"",sc:"",scap:"",Scaron:"",scaron:"",sccue:"",scE:"",sce:"",Scedil:"",scedil:"",Scirc:"",scirc:"",scnap:"",scnE:"",scnsim:"",scpolint:"",scsim:"",Scy:"",scy:"",sdot:"",sdotb:"",sdote:"",searhk:"",seArr:"",searr:"",searrow:"",sect:"",semi:";",seswar:"",setminus:"",setmn:"",sext:"",Sfr:"",sfr:"",sfrown:"",sharp:"",SHCHcy:"",shchcy:"",SHcy:"",shcy:"",ShortDownArrow:"",ShortLeftArrow:"",shortmid:"",shortparallel:"",ShortRightArrow:"",ShortUpArrow:"",shy:"",Sigma:"",sigma:"",sigmaf:"",sigmav:"",sim:"",simdot:"",sime:"",simeq:"",simg:"",simgE:"",siml:"",simlE:"",simne:"",simplus:"",simrarr:"",slarr:"",SmallCircle:"",smallsetminus:"",smashp:"",smeparsl:"",smid:"",smile:"",smt:"",smte:"",smtes:"",SOFTcy:"",softcy:"",sol:"/",solb:"",solbar:"",Sopf:"",sopf:"",spades:"",spadesuit:"",spar:"",sqcap:"",sqcaps:"",sqcup:"",sqcups:"",Sqrt:"",sqsub:"",sqsube:"",sqsubset:"",sqsubseteq:"",sqsup:"",sqsupe:"",sqsupset:"",sqsupseteq:"",squ:"",Square:"",square:"",SquareIntersection:"",SquareSubset:"",SquareSubsetEqual:"",SquareSuperset:"",SquareSupersetEqual:"",SquareUnion:"",squarf:"",squf:"",srarr:"",Sscr:"",sscr:"",ssetmn:"",ssmile:"",sstarf:"",Star:"",star:"",starf:"",straightepsilon:"",straightphi:"",strns:"",Sub:"",sub:"",subdot:"",subE:"",sube:"",subedot:"",submult:"",subnE:"",subne:"",subplus:"",subrarr:"",Subset:"",subset:"",subseteq:"",subseteqq:"",SubsetEqual:"",subsetneq:"",subsetneqq:"",subsim:"",subsub:"",subsup:"",succ:"",succapprox:"",succcurlyeq:"",Succeeds:"",SucceedsEqual:"",SucceedsSlantEqual:"",SucceedsTilde:"",succeq:"",succnapprox:"",succneqq:"",succnsim:"",succsim:"",SuchThat:"",Sum:"",sum:"",sung:"",Sup:"",sup:"",sup1:"",sup2:"",sup3:"",supdot:"",supdsub:"",supE:"",supe:"",supedot:"",Superset:"",SupersetEqual:"",suphsol:"",suphsub:"",suplarr:"",supmult:"",supnE:"",supne:"",supplus:"",Supset:"",supset:"",supseteq:"",supseteqq:"",supsetneq:"",supsetneqq:"",supsim:"",supsub:"",supsup:"",swarhk:"",swArr:"",swarr:"",swarrow:"",swnwar:"",szlig:"",Tab:"	",target:"",Tau:"",tau:"",tbrk:"",Tcaron:"",tcaron:"",Tcedil:"",tcedil:"",Tcy:"",tcy:"",tdot:"",telrec:"",Tfr:"",tfr:"",there4:"",Therefore:"",therefore:"",Theta:"",theta:"",thetasym:"",thetav:"",thickapprox:"",thicksim:"",ThickSpace:"",thinsp:"",ThinSpace:"",thkap:"",thksim:"",THORN:"",thorn:"",Tilde:"",tilde:"",TildeEqual:"",TildeFullEqual:"",TildeTilde:"",times:"",timesb:"",timesbar:"",timesd:"",tint:"",toea:"",top:"",topbot:"",topcir:"",Topf:"",topf:"",topfork:"",tosa:"",tprime:"",TRADE:"",trade:"",triangle:"",triangledown:"",triangleleft:"",trianglelefteq:"",triangleq:"",triangleright:"",trianglerighteq:"",tridot:"",trie:"",triminus:"",TripleDot:"",triplus:"",trisb:"",tritime:"",trpezium:"",Tscr:"",tscr:"",TScy:"",tscy:"",TSHcy:"",tshcy:"",Tstrok:"",tstrok:"",twixt:"",twoheadleftarrow:"",twoheadrightarrow:"",Uacute:"",uacute:"",Uarr:"",uArr:"",uarr:"",Uarrocir:"",Ubrcy:"",ubrcy:"",Ubreve:"",ubreve:"",Ucirc:"",ucirc:"",Ucy:"",ucy:"",udarr:"",Udblac:"",udblac:"",udhar:"",ufisht:"",Ufr:"",ufr:"",Ugrave:"",ugrave:"",uHar:"",uharl:"",uharr:"",uhblk:"",ulcorn:"",ulcorner:"",ulcrop:"",ultri:"",Umacr:"",umacr:"",uml:"",UnderBar:"_",UnderBrace:"",UnderBracket:"",UnderParenthesis:"",Union:"",UnionPlus:"",Uogon:"",uogon:"",Uopf:"",uopf:"",UpArrow:"",Uparrow:"",uparrow:"",UpArrowBar:"",UpArrowDownArrow:"",UpDownArrow:"",Updownarrow:"",updownarrow:"",UpEquilibrium:"",upharpoonleft:"",upharpoonright:"",uplus:"",UpperLeftArrow:"",UpperRightArrow:"",Upsi:"",upsi:"",upsih:"",Upsilon:"",upsilon:"",UpTee:"",UpTeeArrow:"",upuparrows:"",urcorn:"",urcorner:"",urcrop:"",Uring:"",uring:"",urtri:"",Uscr:"",uscr:"",utdot:"",Utilde:"",utilde:"",utri:"",utrif:"",uuarr:"",Uuml:"",uuml:"",uwangle:"",vangrt:"",varepsilon:"",varkappa:"",varnothing:"",varphi:"",varpi:"",varpropto:"",vArr:"",varr:"",varrho:"",varsigma:"",varsubsetneq:"",varsubsetneqq:"",varsupsetneq:"",varsupsetneqq:"",vartheta:"",vartriangleleft:"",vartriangleright:"",Vbar:"",vBar:"",vBarv:"",Vcy:"",vcy:"",VDash:"",Vdash:"",vDash:"",vdash:"",Vdashl:"",Vee:"",vee:"",veebar:"",veeeq:"",vellip:"",Verbar:"",verbar:"|",Vert:"",vert:"|",VerticalBar:"",VerticalLine:"|",VerticalSeparator:"",VerticalTilde:"",VeryThinSpace:"",Vfr:"",vfr:"",vltri:"",vnsub:"",vnsup:"",Vopf:"",vopf:"",vprop:"",vrtri:"",Vscr:"",vscr:"",vsubnE:"",vsubne:"",vsupnE:"",vsupne:"",Vvdash:"",vzigzag:"",Wcirc:"",wcirc:"",wedbar:"",Wedge:"",wedge:"",wedgeq:"",weierp:"",Wfr:"",wfr:"",Wopf:"",wopf:"",wp:"",wr:"",wreath:"",Wscr:"",wscr:"",xcap:"",xcirc:"",xcup:"",xdtri:"",Xfr:"",xfr:"",xhArr:"",xharr:"",Xi:"",xi:"",xlArr:"",xlarr:"",xmap:"",xnis:"",xodot:"",Xopf:"",xopf:"",xoplus:"",xotime:"",xrArr:"",xrarr:"",Xscr:"",xscr:"",xsqcup:"",xuplus:"",xutri:"",xvee:"",xwedge:"",Yacute:"",yacute:"",YAcy:"",yacy:"",Ycirc:"",ycirc:"",Ycy:"",ycy:"",yen:"",Yfr:"",yfr:"",YIcy:"",yicy:"",Yopf:"",yopf:"",Yscr:"",yscr:"",YUcy:"",yucy:"",Yuml:"",yuml:"",Zacute:"",zacute:"",Zcaron:"",zcaron:"",Zcy:"",zcy:"",Zdot:"",zdot:"",zeetrf:"",ZeroWidthSpace:"",Zeta:"",zeta:"",Zfr:"",zfr:"",ZHcy:"",zhcy:"",zigrarr:"",Zopf:"",zopf:"",Zscr:"",zscr:"",zwj:"",zwnj:""}),r.entityMap=r.HTML_ENTITIES})(sm)),sm}var Th={},sw;function kS(){if(sw)return Th;sw=1;var r=Ld().NAMESPACE,e=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,t=new RegExp("[\\-\\.0-9"+e.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),n=new RegExp("^"+e.source+t.source+"*(?::"+e.source+t.source+"*)?$"),i=0,o=1,u=2,l=3,c=4,d=5,m=6,g=7;function E(C,N){this.message=C,this.locator=N,Error.captureStackTrace&&Error.captureStackTrace(this,E)}E.prototype=new Error,E.prototype.name=E.name;function b(){}b.prototype={parse:function(C,N,z){var j=this.domBuilder;j.startDocument(),q(N,N={}),M(C,N,z,j,this.errorHandler),j.endDocument()}};function M(C,N,z,j,L){function he(it){if(it>65535){it-=65536;var gt=55296+(it>>10),dt=56320+(it&1023);return String.fromCharCode(gt,dt)}else return String.fromCharCode(it)}function _e(it){var gt=it.slice(1,-1);return gt in z?z[gt]:gt.charAt(0)==="#"?he(parseInt(gt.substr(1).replace("x","0x"))):(L.error("entity not found:"+it),it)}function De(it){if(it>Ie){var gt=C.substring(Ie,it).replace(/&#?\w+;/g,_e);Q&&de(Ie),j.characters(gt,0,it-Ie),Ie=it}}function de(it,gt){for(;it>=ce&&(gt=xe.exec(C));)J=gt.index,ce=J+gt[0].length,Q.lineNumber++;Q.columnNumber=it-J+1}for(var J=0,ce=0,xe=/.*(?:\r\n?|\n)|.*$/g,Q=j.locator,se=[{currentNSMap:N}],Ce={},Ie=0;;){try{var He=C.indexOf("<",Ie);if(He<0){if(!C.substr(Ie).match(/^\s*$/)){var Ke=j.doc,et=Ke.createTextNode(C.substr(Ie));Ke.appendChild(et),j.currentElement=et}return}switch(He>Ie&&De(He),C.charAt(He+1)){case"/":var St=C.indexOf(">",He+3),Fe=C.substring(He+2,St).replace(/[ \t\n\r]+$/g,""),Je=se.pop();St<0?(Fe=C.substring(He+2).replace(/[\s<].*/,""),L.error("end tag name: "+Fe+" is not complete:"+Je.tagName),St=He+1+Fe.length):Fe.match(/\s</)&&(Fe=Fe.replace(/[\s<].*/,""),L.error("end tag name: "+Fe+" maybe not complete"),St=He+1+Fe.length);var Xe=Je.localNSMap,ft=Je.tagName==Fe,yt=ft||Je.tagName&&Je.tagName.toLowerCase()==Fe.toLowerCase();if(yt){if(j.endElement(Je.uri,Je.localName,Fe),Xe)for(var mt in Xe)Object.prototype.hasOwnProperty.call(Xe,mt)&&j.endPrefixMapping(mt);ft||L.fatalError("end tag name: "+Fe+" is not match the current start tagName:"+Je.tagName)}else se.push(Je);St++;break;case"?":Q&&de(He),St=U(C,He,j);break;case"!":Q&&de(He),St=P(C,He,j,L);break;default:Q&&de(He);var _t=new R,kt=se[se.length-1].currentNSMap,St=w(C,He,_t,kt,_e,L),Tt=_t.length;if(!_t.closed&&V(C,St,_t.tagName,Ce)&&(_t.closed=!0,z.nbsp||L.warning("unclosed xml attribute")),Q&&Tt){for(var Ht=D(Q,{}),Dt=0;Dt<Tt;Dt++){var wt=_t[Dt];de(wt.offset),wt.locator=D(Q,{})}j.locator=Ht,A(_t,j,kt)&&se.push(_t),j.locator=Q}else A(_t,j,kt)&&se.push(_t);r.isHTML(_t.uri)&&!_t.closed?St=I(C,St,_t.tagName,_e,j):St++}}catch(it){if(it instanceof E)throw it;L.error("element parse error: "+it),St=-1}St>Ie?Ie=St:De(Math.max(He,Ie)+1)}}function D(C,N){return N.lineNumber=C.lineNumber,N.columnNumber=C.columnNumber,N}function w(C,N,z,j,L,he){function _e(Q,se,Ce){z.attributeNames.hasOwnProperty(Q)&&he.fatalError("Attribute "+Q+" redefined"),z.addValue(Q,se,Ce)}for(var De,de,J=++N,ce=i;;){var xe=C.charAt(J);switch(xe){case"=":if(ce===o)De=C.slice(N,J),ce=l;else if(ce===u)ce=l;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(ce===l||ce===o)if(ce===o&&(he.warning('attribute value must after "="'),De=C.slice(N,J)),N=J+1,J=C.indexOf(xe,N),J>0)de=C.slice(N,J).replace(/&#?\w+;/g,L),_e(De,de,N-1),ce=d;else throw new Error("attribute value no end '"+xe+"' match");else if(ce==c)de=C.slice(N,J).replace(/&#?\w+;/g,L),_e(De,de,N),he.warning('attribute "'+De+'" missed start quot('+xe+")!!"),N=J+1,ce=d;else throw new Error('attribute value must after "="');break;case"/":switch(ce){case i:z.setTagName(C.slice(N,J));case d:case m:case g:ce=g,z.closed=!0;case c:case o:break;case u:z.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return he.error("unexpected end of input"),ce==i&&z.setTagName(C.slice(N,J)),J;case">":switch(ce){case i:z.setTagName(C.slice(N,J));case d:case m:case g:break;case c:case o:de=C.slice(N,J),de.slice(-1)==="/"&&(z.closed=!0,de=de.slice(0,-1));case u:ce===u&&(de=De),ce==c?(he.warning('attribute "'+de+'" missed quot(")!'),_e(De,de.replace(/&#?\w+;/g,L),N)):((!r.isHTML(j[""])||!de.match(/^(?:disabled|checked|selected)$/i))&&he.warning('attribute "'+de+'" missed value!! "'+de+'" instead!!'),_e(de,de,N));break;case l:throw new Error("attribute value missed!!")}return J;case"":xe=" ";default:if(xe<=" ")switch(ce){case i:z.setTagName(C.slice(N,J)),ce=m;break;case o:De=C.slice(N,J),ce=u;break;case c:var de=C.slice(N,J).replace(/&#?\w+;/g,L);he.warning('attribute "'+de+'" missed quot(")!!'),_e(De,de,N);case d:ce=m;break}else switch(ce){case u:z.tagName,(!r.isHTML(j[""])||!De.match(/^(?:disabled|checked|selected)$/i))&&he.warning('attribute "'+De+'" missed value!! "'+De+'" instead2!!'),_e(De,De,N),N=J,ce=o;break;case d:he.warning('attribute space is required"'+De+'"!!');case m:ce=o,N=J;break;case l:ce=c,N=J;break;case g:throw new Error("elements closed character '/' and '>' must be connected to")}}J++}}function A(C,N,z){for(var j=C.tagName,L=null,xe=C.length;xe--;){var he=C[xe],_e=he.qName,De=he.value,Q=_e.indexOf(":");if(Q>0)var de=he.prefix=_e.slice(0,Q),J=_e.slice(Q+1),ce=de==="xmlns"&&J;else J=_e,de=null,ce=_e==="xmlns"&&"";he.localName=J,ce!==!1&&(L==null&&(L={},q(z,z={})),z[ce]=L[ce]=De,he.uri=r.XMLNS,N.startPrefixMapping(ce,De))}for(var xe=C.length;xe--;){he=C[xe];var de=he.prefix;de&&(de==="xml"&&(he.uri=r.XML),de!=="xmlns"&&(he.uri=z[de||""]))}var Q=j.indexOf(":");Q>0?(de=C.prefix=j.slice(0,Q),J=C.localName=j.slice(Q+1)):(de=null,J=C.localName=j);var se=C.uri=z[de||""];if(N.startElement(se,J,j,C),C.closed){if(N.endElement(se,J,j),L)for(de in L)Object.prototype.hasOwnProperty.call(L,de)&&N.endPrefixMapping(de)}else return C.currentNSMap=z,C.localNSMap=L,!0}function I(C,N,z,j,L){if(/^(?:script|textarea)$/i.test(z)){var he=C.indexOf("</"+z+">",N),_e=C.substring(N+1,he);if(/[&<]/.test(_e))return/^script$/i.test(z)?(L.characters(_e,0,_e.length),he):(_e=_e.replace(/&#?\w+;/g,j),L.characters(_e,0,_e.length),he)}return N+1}function V(C,N,z,j){var L=j[z];return L==null&&(L=C.lastIndexOf("</"+z+">"),L<N&&(L=C.lastIndexOf("</"+z)),j[z]=L),L<N}function q(C,N){for(var z in C)Object.prototype.hasOwnProperty.call(C,z)&&(N[z]=C[z])}function P(C,N,z,j){var L=C.charAt(N+2);switch(L){case"-":if(C.charAt(N+3)==="-"){var he=C.indexOf("-->",N+4);return he>N?(z.comment(C,N+4,he-N-4),he+3):(j.error("Unclosed comment"),-1)}else return-1;default:if(C.substr(N+3,6)=="CDATA["){var he=C.indexOf("]]>",N+9);return z.startCDATA(),z.characters(C,N+9,he-N-9),z.endCDATA(),he+3}var _e=S(C,N),De=_e.length;if(De>1&&/!doctype/i.test(_e[0][0])){var de=_e[1][0],J=!1,ce=!1;De>3&&(/^public$/i.test(_e[2][0])?(J=_e[3][0],ce=De>4&&_e[4][0]):/^system$/i.test(_e[2][0])&&(ce=_e[3][0]));var xe=_e[De-1];return z.startDTD(de,J,ce),z.endDTD(),xe.index+xe[0].length}}return-1}function U(C,N,z){var j=C.indexOf("?>",N);if(j){var L=C.substring(N,j).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return L?(L[0].length,z.processingInstruction(L[1],L[2]),j+2):-1}return-1}function R(){this.attributeNames={}}R.prototype={setTagName:function(C){if(!n.test(C))throw new Error("invalid tagName:"+C);this.tagName=C},addValue:function(C,N,z){if(!n.test(C))throw new Error("invalid attribute:"+C);this.attributeNames[C]=this.length,this[this.length++]={qName:C,value:N,offset:z}},length:0,getLocalName:function(C){return this[C].localName},getLocator:function(C){return this[C].locator},getQName:function(C){return this[C].qName},getURI:function(C){return this[C].uri},getValue:function(C){return this[C].value}};function S(C,N){var z,j=[],L=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(L.lastIndex=N,L.exec(C);z=L.exec(C);)if(j.push(z),z[1])return j}return Th.XMLReader=b,Th.ParseError=E,Th}var ow;function NS(){if(ow)return Fa;ow=1;var r=Ld(),e=QE(),t=RS(),n=kS(),i=e.DOMImplementation,o=r.NAMESPACE,u=n.ParseError,l=n.XMLReader;function c(D){this.options=D||{locator:{}}}c.prototype.parseFromString=function(D,w){var A=this.options,I=new l,V=A.domBuilder||new m,q=A.errorHandler,P=A.locator,U=A.xmlns||{},R=/\/x?html?$/.test(w),S=R?t.HTML_ENTITIES:t.XML_ENTITIES;return P&&V.setDocumentLocator(P),I.errorHandler=d(q,V,P),I.domBuilder=A.domBuilder||V,R&&(U[""]=o.HTML),U.xml=U.xml||o.XML,D&&typeof D=="string"?I.parse(D,U,S):I.errorHandler.error("invalid doc source"),V.doc};function d(D,w,A){if(!D){if(w instanceof m)return w;D=w}var I={},V=D instanceof Function;A=A||{};function q(P){var U=D[P];!U&&V&&(U=D.length==2?function(R){D(P,R)}:D),I[P]=U&&function(R){U("[xmldom "+P+"]	"+R+E(A))}||function(){}}return q("warning"),q("error"),q("fatalError"),I}function m(){this.cdata=!1}function g(D,w){w.lineNumber=D.lineNumber,w.columnNumber=D.columnNumber}m.prototype={startDocument:function(){this.doc=new i().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(D,w,A,I){var V=this.doc,q=V.createElementNS(D,A||w),P=I.length;M(this,q),this.currentElement=q,this.locator&&g(this.locator,q);for(var U=0;U<P;U++){var D=I.getURI(U),R=I.getValue(U),A=I.getQName(U),S=V.createAttributeNS(D,A);this.locator&&g(I.getLocator(U),S),S.value=S.nodeValue=R,q.setAttributeNode(S)}},endElement:function(D,w,A){var I=this.currentElement;I.tagName,this.currentElement=I.parentNode},startPrefixMapping:function(D,w){},endPrefixMapping:function(D){},processingInstruction:function(D,w){var A=this.doc.createProcessingInstruction(D,w);this.locator&&g(this.locator,A),M(this,A)},ignorableWhitespace:function(D,w,A){},characters:function(D,w,A){if(D=b.apply(this,arguments),D){if(this.cdata)var I=this.doc.createCDATASection(D);else var I=this.doc.createTextNode(D);this.currentElement?this.currentElement.appendChild(I):/^\s*$/.test(D)&&this.doc.appendChild(I),this.locator&&g(this.locator,I)}},skippedEntity:function(D){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(D){(this.locator=D)&&(D.lineNumber=0)},comment:function(D,w,A){D=b.apply(this,arguments);var I=this.doc.createComment(D);this.locator&&g(this.locator,I),M(this,I)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(D,w,A){var I=this.doc.implementation;if(I&&I.createDocumentType){var V=I.createDocumentType(D,w,A);this.locator&&g(this.locator,V),M(this,V),this.doc.doctype=V}},warning:function(D){console.warn("[xmldom warning]	"+D,E(this.locator))},error:function(D){console.error("[xmldom error]	"+D,E(this.locator))},fatalError:function(D){throw new u(D,this.locator)}};function E(D){if(D)return`
@`+(D.systemId||"")+"#[line:"+D.lineNumber+",col:"+D.columnNumber+"]"}function b(D,w,A){return typeof D=="string"?D.substr(w,A):D.length>=w+A||w?new java.lang.String(D,w,A)+"":D}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(D){m.prototype[D]=function(){return null}});function M(D,w){D.currentElement?D.currentElement.appendChild(w):D.doc.appendChild(w)}return Fa.__DOMHandler=m,Fa.DOMParser=c,Fa.DOMImplementation=e.DOMImplementation,Fa.XMLSerializer=e.XMLSerializer,Fa}var aw;function PS(){if(aw)return cl;aw=1;var r=QE();return cl.DOMImplementation=r.DOMImplementation,cl.XMLSerializer=r.XMLSerializer,cl.DOMParser=NS().DOMParser,cl}var YE=PS();const Gg=typeof window<"u"?window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame:!1,OS=1,LS=3,XE=typeof URL<"u"?URL:typeof window<"u"?window.URL||window.webkitURL||window.mozURL:void 0;function Vd(){var r=new Date().getTime(),e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(r+Math.random()*16)%16|0;return r=Math.floor(r/16),(t=="x"?n:n&7|8).toString(16)});return e}function VS(){return Math.max(document.documentElement.clientHeight,document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight)}function ZE(r){return!!(r&&r.nodeType==1)}function Dn(r){return!isNaN(parseFloat(r))&&isFinite(r)}function JE(r){let e=parseFloat(r);return Dn(r)===!1?!1:typeof r=="string"&&r.indexOf(".")>-1?!0:Math.floor(e)!==e}function Ha(r){var e=["Webkit","webkit","Moz","O","ms"],t=["-webkit-","-webkit-","-moz-","-o-","-ms-"],n=r.toLowerCase(),i=e.length;if(typeof document>"u"||typeof document.body.style[n]<"u")return r;for(var o=0;o<i;o++)if(typeof document.body.style[t[o]+n]<"u")return t[o]+n;return r}function e1(r){for(var e=1,t=arguments.length;e<t;e++){var n=arguments[e];for(var i in n)r[i]===void 0&&(r[i]=n[i])}return r}function ar(r){var e=[].slice.call(arguments,1);return e.forEach(function(t){t&&Object.getOwnPropertyNames(t).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}),r}function FS(r,e,t){var n=iu(r,e,t);return e.splice(n,0,r),n}function iu(r,e,t,n,i){var o=n||0,u=i||e.length,l=parseInt(o+(u-o)/2),c;return t||(t=function(d,m){if(d>m)return 1;if(d<m)return-1;if(d==m)return 0}),u-o<=0?l:(c=t(e[l],r),u-o===1?c>=0?l:l+1:c===0?l:c===-1?iu(r,e,t,l,u):iu(r,e,t,o,l))}function Zh(r,e,t,n,i){var o=n||0,u=i||e.length,l=parseInt(o+(u-o)/2),c;return t||(t=function(d,m){if(d>m)return 1;if(d<m)return-1;if(d==m)return 0}),u-o<=0?-1:(c=t(e[l],r),u-o===1?c===0?l:-1:c===0?l:c===-1?Zh(r,e,t,l,u):Zh(r,e,t,o,l))}function Fh(r){var e=window.getComputedStyle(r),t=["width","paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"],n=["height","paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"],i=0,o=0;return t.forEach(function(u){i+=parseFloat(e[u])||0}),n.forEach(function(u){o+=parseFloat(e[u])||0}),{height:o,width:i}}function Jh(r){var e=window.getComputedStyle(r),t=["paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"],n=["paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"],i=0,o=0;return t.forEach(function(u){i+=parseFloat(e[u])||0}),n.forEach(function(u){o+=parseFloat(e[u])||0}),{height:o,width:i}}function Xm(r){let e,t=r.ownerDocument;if(r.nodeType==Node.TEXT_NODE){let n=t.createRange();n.selectNodeContents(r),e=n.getBoundingClientRect()}else e=r.getBoundingClientRect();return e}function ed(){var r=window.innerWidth,e=window.innerHeight;return{top:0,left:0,right:r,bottom:e,width:r,height:e}}function Kg(r,e){for(var t=r.parentNode,n=t.childNodes,i,o=-1,u=0;u<n.length&&(i=n[u],i.nodeType===e&&o++,i!=r);u++);return o}function MS(r){return Kg(r,LS)}function t1(r){return Kg(r,OS)}function Ml(r){return["xml","opf","ncx"].indexOf(r)>-1}function n1(r,e){return new Blob([r],{type:e})}function td(r,e){var t,n=n1(r,e);return t=XE.createObjectURL(n),t}function r1(r){return XE.revokeObjectURL(r)}function Zm(r,e){var t,n;if(typeof r=="string")return t=btoa(r),n="data:"+e+";base64,"+t,n}function i1(r){return Object.prototype.toString.call(r).slice(8,-1)}function zi(r,e,t){var n,i;return typeof DOMParser>"u"||t?i=YE.DOMParser:i=DOMParser,r.charCodeAt(0)===65279&&(r=r.slice(1)),n=new i().parseFromString(r,e),n}function cn(r,e){var t;if(!r)throw new Error("No Element Provided");if(typeof r.querySelector<"u")return r.querySelector(e);if(t=r.getElementsByTagName(e),t.length)return t[0]}function ms(r,e){return typeof r.querySelector<"u"?r.querySelectorAll(e):r.getElementsByTagName(e)}function Ga(r,e,t){var n,i;if(typeof r.querySelector<"u"){e+="[";for(var o in t)e+=o+"~='"+t[o]+"'";return e+="]",r.querySelector(e)}else if(n=r.getElementsByTagName(e),i=Array.prototype.slice.call(n,0).filter(function(u){for(var l in t)if(u.getAttribute(l)===t[l])return!0;return!1}),i)return i[0]}function nd(r,e){var t=r.ownerDocument||r;typeof t.createTreeWalker<"u"?s1(r,e,NodeFilter.SHOW_TEXT):Qg(r,function(n){n&&n.nodeType===3&&e(n)})}function s1(r,e,t){var n=document.createTreeWalker(r,t,null,!1);let i;for(;i=n.nextNode();)e(i)}function Qg(r,e){if(e(r))return!0;if(r=r.firstChild,r)do{if(Qg(r,e))return!0;r=r.nextSibling}while(r)}function o1(r){return new Promise(function(e,t){var n=new FileReader;n.readAsDataURL(r),n.onloadend=function(){e(n.result)}})}function zt(){this.resolve=null,this.reject=null,this.id=Vd(),this.promise=new Promise((r,e)=>{this.resolve=r,this.reject=e}),Object.freeze(this)}function rd(r,e,t){var n;if(typeof r.querySelector<"u"&&(n=r.querySelector(`${e}[*|type="${t}"]`)),!n||n.length===0){n=ms(r,e);for(var i=0;i<n.length;i++)if(n[i].getAttributeNS("http://www.idpf.org/2007/ops","type")===t||n[i].getAttribute("epub:type")===t)return n[i]}else return n}function Jm(r){for(var e=[],t=r.childNodes,n=0;n<t.length;n++){let i=t[n];i.nodeType===1&&e.push(i)}return e}function eg(r){for(var e=[r];r;r=r.parentNode)e.unshift(r);return e}function Ka(r,e,t){for(var n=[],i=r.childNodes,o=0;o<i.length;o++){let u=i[o];if(u.nodeType===1&&u.nodeName.toLowerCase()===e){if(t)return u;n.push(u)}}if(!t)return n}function BS(r,e){let t;if(!(r===null||e===""))for(t=r.parentNode;t.nodeType===1;){if(t.tagName.toLowerCase()===e)return t;t=t.parentNode}}class a1{constructor(){this.collapsed=!1,this.commonAncestorContainer=void 0,this.endContainer=void 0,this.endOffset=void 0,this.startContainer=void 0,this.startOffset=void 0}setStart(e,t){this.startContainer=e,this.startOffset=t,this.endContainer?this.commonAncestorContainer=this._commonAncestorContainer():this.collapse(!0),this._checkCollapsed()}setEnd(e,t){this.endContainer=e,this.endOffset=t,this.startContainer?(this.collapsed=!1,this.commonAncestorContainer=this._commonAncestorContainer()):this.collapse(!1),this._checkCollapsed()}collapse(e){this.collapsed=!0,e?(this.endContainer=this.startContainer,this.endOffset=this.startOffset,this.commonAncestorContainer=this.startContainer.parentNode):(this.startContainer=this.endContainer,this.startOffset=this.endOffset,this.commonAncestorContainer=this.endOffset.parentNode)}selectNode(e){let t=e.parentNode,n=Array.prototype.indexOf.call(t.childNodes,e);this.setStart(t,n),this.setEnd(t,n+1)}selectNodeContents(e){e.childNodes[e.childNodes-1];let t=e.nodeType===3?e.textContent.length:parent.childNodes.length;this.setStart(e,0),this.setEnd(e,t)}_commonAncestorContainer(e,t){var n=eg(e||this.startContainer),i=eg(t||this.endContainer);if(n[0]==i[0]){for(var o=0;o<n.length;o++)if(n[o]!=i[o])return n[o-1]}}_checkCollapsed(){this.startContainer===this.endContainer&&this.startOffset===this.endOffset?this.collapsed=!0:this.collapsed=!1}toString(){}}const zS=Object.freeze(Object.defineProperty({__proto__:null,RangeObject:a1,blob2base64:o1,borders:Jh,bounds:Fh,createBase64Url:Zm,createBlob:n1,createBlobUrl:td,defaults:e1,defer:zt,documentHeight:VS,extend:ar,filterChildren:Ka,findChildren:Jm,getParentByTagName:BS,indexOfElementNode:t1,indexOfNode:Kg,indexOfSorted:Zh,indexOfTextNode:MS,insert:FS,isElement:ZE,isFloat:JE,isNumber:Dn,isXml:Ml,locationOf:iu,nodeBounds:Xm,parents:eg,parse:zi,prefixed:Ha,qs:cn,qsa:ms,qsp:Ga,querySelectorByType:rd,requestAnimationFrame:Gg,revokeBlobUrl:r1,sprint:nd,treeWalker:s1,type:i1,uuid:Vd,walk:Qg,windowBounds:ed},Symbol.toStringTag,{value:"Module"}));var om,uw;function US(){if(uw)return om;if(uw=1,!r)var r={cwd:function(){return"/"}};function e(o){if(typeof o!="string")throw new TypeError("Path must be a string. Received "+o)}function t(o,u){for(var l="",c=-1,d=0,m,g=0;g<=o.length;++g){if(g<o.length)m=o.charCodeAt(g);else{if(m===47)break;m=47}if(m===47){if(!(c===g-1||d===1))if(c!==g-1&&d===2){if(l.length<2||l.charCodeAt(l.length-1)!==46||l.charCodeAt(l.length-2)!==46){if(l.length>2){for(var E=l.length-1,b=E;b>=0&&l.charCodeAt(b)!==47;--b);if(b!==E){b===-1?l="":l=l.slice(0,b),c=g,d=0;continue}}else if(l.length===2||l.length===1){l="",c=g,d=0;continue}}u&&(l.length>0?l+="/..":l="..")}else l.length>0?l+="/"+o.slice(c+1,g):l=o.slice(c+1,g);c=g,d=0}else m===46&&d!==-1?++d:d=-1}return l}function n(o,u){var l=u.dir||u.root,c=u.base||(u.name||"")+(u.ext||"");return l?l===u.root?l+c:l+o+c:c}var i={resolve:function(){for(var u="",l=!1,c,d=arguments.length-1;d>=-1&&!l;d--){var m;d>=0?m=arguments[d]:(c===void 0&&(c=r.cwd()),m=c),e(m),m.length!==0&&(u=m+"/"+u,l=m.charCodeAt(0)===47)}return u=t(u,!l),l?u.length>0?"/"+u:"/":u.length>0?u:"."},normalize:function(u){if(e(u),u.length===0)return".";var l=u.charCodeAt(0)===47,c=u.charCodeAt(u.length-1)===47;return u=t(u,!l),u.length===0&&!l&&(u="."),u.length>0&&c&&(u+="/"),l?"/"+u:u},isAbsolute:function(u){return e(u),u.length>0&&u.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var u,l=0;l<arguments.length;++l){var c=arguments[l];e(c),c.length>0&&(u===void 0?u=c:u+="/"+c)}return u===void 0?".":i.normalize(u)},relative:function(u,l){if(e(u),e(l),u===l||(u=i.resolve(u),l=i.resolve(l),u===l))return"";for(var c=1;c<u.length&&u.charCodeAt(c)===47;++c);for(var d=u.length,m=d-c,g=1;g<l.length&&l.charCodeAt(g)===47;++g);for(var E=l.length,b=E-g,M=m<b?m:b,D=-1,w=0;w<=M;++w){if(w===M){if(b>M){if(l.charCodeAt(g+w)===47)return l.slice(g+w+1);if(w===0)return l.slice(g+w)}else m>M&&(u.charCodeAt(c+w)===47?D=w:w===0&&(D=0));break}var A=u.charCodeAt(c+w),I=l.charCodeAt(g+w);if(A!==I)break;A===47&&(D=w)}var V="";for(w=c+D+1;w<=d;++w)(w===d||u.charCodeAt(w)===47)&&(V.length===0?V+="..":V+="/..");return V.length>0?V+l.slice(g+D):(g+=D,l.charCodeAt(g)===47&&++g,l.slice(g))},_makeLong:function(u){return u},dirname:function(u){if(e(u),u.length===0)return".";for(var l=u.charCodeAt(0),c=l===47,d=-1,m=!0,g=u.length-1;g>=1;--g)if(l=u.charCodeAt(g),l===47){if(!m){d=g;break}}else m=!1;return d===-1?c?"/":".":c&&d===1?"//":u.slice(0,d)},basename:function(u,l){if(l!==void 0&&typeof l!="string")throw new TypeError('"ext" argument must be a string');e(u);var c=0,d=-1,m=!0,g;if(l!==void 0&&l.length>0&&l.length<=u.length){if(l.length===u.length&&l===u)return"";var E=l.length-1,b=-1;for(g=u.length-1;g>=0;--g){var M=u.charCodeAt(g);if(M===47){if(!m){c=g+1;break}}else b===-1&&(m=!1,b=g+1),E>=0&&(M===l.charCodeAt(E)?--E===-1&&(d=g):(E=-1,d=b))}return c===d?d=b:d===-1&&(d=u.length),u.slice(c,d)}else{for(g=u.length-1;g>=0;--g)if(u.charCodeAt(g)===47){if(!m){c=g+1;break}}else d===-1&&(m=!1,d=g+1);return d===-1?"":u.slice(c,d)}},extname:function(u){e(u);for(var l=-1,c=0,d=-1,m=!0,g=0,E=u.length-1;E>=0;--E){var b=u.charCodeAt(E);if(b===47){if(!m){c=E+1;break}continue}d===-1&&(m=!1,d=E+1),b===46?l===-1?l=E:g!==1&&(g=1):l!==-1&&(g=-1)}return l===-1||d===-1||g===0||g===1&&l===d-1&&l===c+1?"":u.slice(l,d)},format:function(u){if(u===null||typeof u!="object")throw new TypeError('Parameter "pathObject" must be an object, not '+typeof u);return n("/",u)},parse:function(u){e(u);var l={root:"",dir:"",base:"",ext:"",name:""};if(u.length===0)return l;var c=u.charCodeAt(0),d=c===47,m;d?(l.root="/",m=1):m=0;for(var g=-1,E=0,b=-1,M=!0,D=u.length-1,w=0;D>=m;--D){if(c=u.charCodeAt(D),c===47){if(!M){E=D+1;break}continue}b===-1&&(M=!1,b=D+1),c===46?g===-1?g=D:w!==1&&(w=1):g!==-1&&(w=-1)}return g===-1||b===-1||w===0||w===1&&g===b-1&&g===E+1?b!==-1&&(E===0&&d?l.base=l.name=u.slice(1,b):l.base=l.name=u.slice(E,b)):(E===0&&d?(l.name=u.slice(1,g),l.base=u.slice(1,b)):(l.name=u.slice(E,g),l.base=u.slice(E,b)),l.ext=u.slice(g,b)),E>0?l.dir=u.slice(0,E-1):d&&(l.dir="/"),l},sep:"/",delimiter:":",posix:null};return om=i,om}var jS=US();const Qs=uo(jS);class gs{constructor(e){var t,n;t=e.indexOf("://"),t>-1&&(e=new URL(e).pathname),n=this.parse(e),this.path=e,this.isDirectory(e)?this.directory=e:this.directory=n.dir+"/",this.filename=n.base,this.extension=n.ext.slice(1)}parse(e){return Qs.parse(e)}isAbsolute(e){return Qs.isAbsolute(e||this.path)}isDirectory(e){return e.charAt(e.length-1)==="/"}resolve(e){return Qs.resolve(this.directory,e)}relative(e){var t=e&&e.indexOf("://")>-1;return t?e:Qs.relative(this.directory,e)}splitPath(e){return this.splitPathRe.exec(e).slice(1)}toString(){return this.path}}class _i{constructor(e,t){var n=e.indexOf("://")>-1,i=e,o;if(this.Url=void 0,this.href=e,this.protocol="",this.origin="",this.hash="",this.hash="",this.search="",this.base=t,!n&&t!==!1&&typeof t!="string"&&window&&window.location&&(this.base=window.location.href),n||this.base)try{this.base?this.Url=new URL(e,this.base):this.Url=new URL(e),this.href=this.Url.href,this.protocol=this.Url.protocol,this.origin=this.Url.origin,this.hash=this.Url.hash,this.search=this.Url.search,i=this.Url.pathname+(this.Url.search?this.Url.search:"")}catch{this.Url=void 0,this.base&&(o=new gs(this.base),i=o.resolve(i))}this.Path=new gs(i),this.directory=this.Path.directory,this.filename=this.Path.filename,this.extension=this.Path.extension}path(){return this.Path}resolve(e){var t=e.indexOf("://")>-1,n;return t?e:(n=Qs.resolve(this.directory,e),this.origin+n)}relative(e){return Qs.relative(e,this.directory)}toString(){return this.href}}const Ma=1,si=3,qS=9;class Ut{constructor(e,t,n){var i;if(this.str="",this.base={},this.spinePos=0,this.range=!1,this.path={},this.start=null,this.end=null,!(this instanceof Ut))return new Ut(e,t,n);if(typeof t=="string"?this.base=this.parseComponent(t):typeof t=="object"&&t.steps&&(this.base=t),i=this.checkType(e),i==="string")return this.str=e,ar(this,this.parse(e));if(i==="range")return ar(this,this.fromRange(e,this.base,n));if(i==="node")return ar(this,this.fromNode(e,this.base,n));if(i==="EpubCFI"&&e.path)return e;if(e)throw new TypeError("not a valid argument for EpubCFI");return this}checkType(e){return this.isCfiString(e)?"string":e&&typeof e=="object"&&(i1(e)==="Range"||typeof e.startContainer<"u")?"range":e&&typeof e=="object"&&typeof e.nodeType<"u"?"node":e&&typeof e=="object"&&e instanceof Ut?"EpubCFI":!1}parse(e){var t={spinePos:-1,range:!1,base:{},path:{},start:null,end:null},n,i,o;return typeof e!="string"?{spinePos:-1}:(e.indexOf("epubcfi(")===0&&e[e.length-1]===")"&&(e=e.slice(8,e.length-1)),n=this.getChapterComponent(e),n?(t.base=this.parseComponent(n),i=this.getPathComponent(e),t.path=this.parseComponent(i),o=this.getRange(e),o&&(t.range=!0,t.start=this.parseComponent(o[0]),t.end=this.parseComponent(o[1])),t.spinePos=t.base.steps[1].index,t):{spinePos:-1})}parseComponent(e){var t={steps:[],terminal:{offset:null,assertion:null}},n=e.split(":"),i=n[0].split("/"),o;return n.length>1&&(o=n[1],t.terminal=this.parseTerminal(o)),i[0]===""&&i.shift(),t.steps=i.map((function(u){return this.parseStep(u)}).bind(this)),t}parseStep(e){var t,n,i,o,u;if(o=e.match(/\[(.*)\]/),o&&o[1]&&(u=o[1]),n=parseInt(e),!isNaN(n))return n%2===0?(t="element",i=n/2-1):(t="text",i=(n-1)/2),{type:t,index:i,id:u||null}}parseTerminal(e){var t,n,i=e.match(/\[(.*)\]/);return i&&i[1]?(t=parseInt(e.split("[")[0]),n=i[1]):t=parseInt(e),Dn(t)||(t=null),{offset:t,assertion:n}}getChapterComponent(e){var t=e.split("!");return t[0]}getPathComponent(e){var t=e.split("!");if(t[1])return t[1].split(",")[0]}getRange(e){var t=e.split(",");return t.length===3?[t[1],t[2]]:!1}getCharecterOffsetComponent(e){var t=e.split(":");return t[1]||""}joinSteps(e){return e?e.map(function(t){var n="";return t.type==="element"&&(n+=(t.index+1)*2),t.type==="text"&&(n+=1+2*t.index),t.id&&(n+="["+t.id+"]"),n}).join("/"):""}segmentString(e){var t="/";return t+=this.joinSteps(e.steps),e.terminal&&e.terminal.offset!=null&&(t+=":"+e.terminal.offset),e.terminal&&e.terminal.assertion!=null&&(t+="["+e.terminal.assertion+"]"),t}toString(){var e="epubcfi(";return e+=this.segmentString(this.base),e+="!",e+=this.segmentString(this.path),this.range&&this.start&&(e+=",",e+=this.segmentString(this.start)),this.range&&this.end&&(e+=",",e+=this.segmentString(this.end)),e+=")",e}compare(e,t){var n,i,o,u;if(typeof e=="string"&&(e=new Ut(e)),typeof t=="string"&&(t=new Ut(t)),e.spinePos>t.spinePos)return 1;if(e.spinePos<t.spinePos)return-1;e.range?(n=e.path.steps.concat(e.start.steps),o=e.start.terminal):(n=e.path.steps,o=e.path.terminal),t.range?(i=t.path.steps.concat(t.start.steps),u=t.start.terminal):(i=t.path.steps,u=t.path.terminal);for(var l=0;l<n.length;l++){if(!n[l])return-1;if(!i[l]||n[l].index>i[l].index)return 1;if(n[l].index<i[l].index)return-1}return n.length<i.length?-1:o.offset>u.offset?1:o.offset<u.offset?-1:0}step(e){var t=e.nodeType===si?"text":"element";return{id:e.id,tagName:e.tagName,type:t,index:this.position(e)}}filteredStep(e,t){var n=this.filter(e,t),i;if(n)return i=n.nodeType===si?"text":"element",{id:n.id,tagName:n.tagName,type:i,index:this.filteredPosition(n,t)}}pathTo(e,t,n){for(var i={steps:[],terminal:{offset:null,assertion:null}},o=e,u;o&&o.parentNode&&o.parentNode.nodeType!=qS;)n?u=this.filteredStep(o,n):u=this.step(o),u&&i.steps.unshift(u),o=o.parentNode;return t!=null&&t>=0&&(i.terminal.offset=t,i.steps[i.steps.length-1].type!="text"&&i.steps.push({type:"text",index:0})),i}equalStep(e,t){return!e||!t?!1:e.index===t.index&&e.id===t.id&&e.type===t.type}fromRange(e,t,n){var i={range:!1,base:{},path:{},start:null,end:null},o=e.startContainer,u=e.endContainer,l=e.startOffset,c=e.endOffset,d=!1;if(n&&(d=o.ownerDocument.querySelector("."+n)!=null),typeof t=="string"?(i.base=this.parseComponent(t),i.spinePos=i.base.steps[1].index):typeof t=="object"&&(i.base=t),e.collapsed)d&&(l=this.patchOffset(o,l,n)),i.path=this.pathTo(o,l,n);else{i.range=!0,d&&(l=this.patchOffset(o,l,n)),i.start=this.pathTo(o,l,n),d&&(c=this.patchOffset(u,c,n)),i.end=this.pathTo(u,c,n),i.path={steps:[],terminal:null};var m=i.start.steps.length,g;for(g=0;g<m&&this.equalStep(i.start.steps[g],i.end.steps[g]);g++)g===m-1?i.start.terminal===i.end.terminal&&(i.path.steps.push(i.start.steps[g]),i.range=!1):i.path.steps.push(i.start.steps[g]);i.start.steps=i.start.steps.slice(i.path.steps.length),i.end.steps=i.end.steps.slice(i.path.steps.length)}return i}fromNode(e,t,n){var i={range:!1,base:{},path:{},start:null,end:null};return typeof t=="string"?(i.base=this.parseComponent(t),i.spinePos=i.base.steps[1].index):typeof t=="object"&&(i.base=t),i.path=this.pathTo(e,null,n),i}filter(e,t){var n,i,o,u,l,c=!1;return e.nodeType===si?(c=!0,o=e.parentNode,n=e.parentNode.classList.contains(t)):(c=!1,n=e.classList.contains(t)),n&&c?(u=o.previousSibling,l=o.nextSibling,u&&u.nodeType===si?i=u:l&&l.nodeType===si&&(i=l),i||e):n&&!c?!1:e}patchOffset(e,t,n){if(e.nodeType!=si)throw new Error("Anchor must be a text node");var i=e,o=t;for(e.parentNode.classList.contains(n)&&(i=e.parentNode);i.previousSibling;){if(i.previousSibling.nodeType===Ma)if(i.previousSibling.classList.contains(n))o+=i.previousSibling.textContent.length;else break;else o+=i.previousSibling.textContent.length;i=i.previousSibling}return o}normalizedMap(e,t,n){var i={},o=-1,u,l=e.length,c,d;for(u=0;u<l;u++)c=e[u].nodeType,c===Ma&&e[u].classList.contains(n)&&(c=si),u>0&&c===si&&d===si?i[u]=o:t===c&&(o=o+1,i[u]=o),d=c;return i}position(e){var t,n;return e.nodeType===Ma?(t=e.parentNode.children,t||(t=Jm(e.parentNode)),n=Array.prototype.indexOf.call(t,e)):(t=this.textNodes(e.parentNode),n=t.indexOf(e)),n}filteredPosition(e,t){var n,i,o;return e.nodeType===Ma?(n=e.parentNode.children,o=this.normalizedMap(n,Ma,t)):(n=e.parentNode.childNodes,e.parentNode.classList.contains(t)&&(e=e.parentNode,n=e.parentNode.childNodes),o=this.normalizedMap(n,si,t)),i=Array.prototype.indexOf.call(n,e),o[i]}stepsToXpath(e){var t=[".","*"];return e.forEach(function(n){var i=n.index+1;n.id?t.push("*[position()="+i+" and @id='"+n.id+"']"):n.type==="text"?t.push("text()["+i+"]"):t.push("*["+i+"]")}),t.join("/")}stepsToQuerySelector(e){var t=["html"];return e.forEach(function(n){var i=n.index+1;n.id?t.push("#"+n.id):n.type==="text"||t.push("*:nth-child("+i+")")}),t.join(">")}textNodes(e,t){return Array.prototype.slice.call(e.childNodes).filter(function(n){return n.nodeType===si?!0:!!(t&&n.classList.contains(t))})}walkToNode(e,t,n){var i=t||document,o=i.documentElement,u,l,c=e.length,d;for(d=0;d<c&&(l=e[d],l.type==="element"?l.id?o=i.getElementById(l.id):(u=o.children||Jm(o),o=u[l.index]):l.type==="text"&&(o=this.textNodes(o,n)[l.index]),!!o);d++);return o}findNode(e,t,n){var i=t||document,o,u;return!n&&typeof i.evaluate<"u"?(u=this.stepsToXpath(e),o=i.evaluate(u,i,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue):n?o=this.walkToNode(e,i,n):o=this.walkToNode(e,i),o}fixMiss(e,t,n,i){var o=this.findNode(e.slice(0,-1),n,i),u=o.childNodes,l=this.normalizedMap(u,si,i),c,d,m=e[e.length-1].index;for(let g in l){if(!l.hasOwnProperty(g))return;if(l[g]===m)if(c=u[g],d=c.textContent.length,t>d)t=t-d;else{c.nodeType===Ma?o=c.childNodes[0]:o=c;break}}return{container:o,offset:t}}toRange(e,t){var n=e||document,i,o,u,l,c,d=this,m,g,E=t?n.querySelector("."+t)!=null:!1,b;if(typeof n.createRange<"u"?i=n.createRange():i=new a1,d.range?(o=d.start,m=d.path.steps.concat(o.steps),l=this.findNode(m,n,E?t:null),u=d.end,g=d.path.steps.concat(u.steps),c=this.findNode(g,n,E?t:null)):(o=d.path,m=d.path.steps,l=this.findNode(d.path.steps,n,E?t:null)),l)try{o.terminal.offset!=null?i.setStart(l,o.terminal.offset):i.setStart(l,0)}catch{b=this.fixMiss(m,o.terminal.offset,n,E?t:null),i.setStart(b.container,b.offset)}else return console.log("No startContainer found for",this.toString()),null;if(c)try{u.terminal.offset!=null?i.setEnd(c,u.terminal.offset):i.setEnd(c,0)}catch{b=this.fixMiss(g,d.end.terminal.offset,n,E?t:null),i.setEnd(b.container,b.offset)}return i}isCfiString(e){return typeof e=="string"&&e.indexOf("epubcfi(")===0&&e[e.length-1]===")"}generateChapterComponent(e,t,n){var i=parseInt(t),o=(e+1)*2,u="/"+o+"/";return u+=(i+1)*2,n&&(u+="["+n+"]"),u}collapse(e){this.range&&(this.range=!1,e?(this.path.steps=this.path.steps.concat(this.start.steps),this.path.terminal=this.start.terminal):(this.path.steps=this.path.steps.concat(this.end.steps),this.path.terminal=this.end.terminal))}}class wi{constructor(e){this.context=e||this,this.hooks=[]}register(){for(var e=0;e<arguments.length;++e)if(typeof arguments[e]=="function")this.hooks.push(arguments[e]);else for(var t=0;t<arguments[e].length;++t)this.hooks.push(arguments[e][t])}deregister(e){let t;for(let n=0;n<this.hooks.length;n++)if(t=this.hooks[n],t===e){this.hooks.splice(n,1);break}}trigger(){var e=arguments,t=this.context,n=[];return this.hooks.forEach(function(i){try{var o=i.apply(t,e)}catch(u){console.log(u)}o&&typeof o.then=="function"&&n.push(o)}),Promise.all(n)}list(){return this.hooks}clear(){return this.hooks=[]}}function u1(r,e){var t,n,i=e.url,o=i.indexOf("://")>-1;r&&(n=cn(r,"head"),t=cn(n,"base"),t||(t=r.createElement("base"),n.insertBefore(t,n.firstChild)),!o&&window&&window.location&&(i=window.location.origin+i),t.setAttribute("href",i))}function WS(r,e){var t,n,i=e.canonical;r&&(t=cn(r,"head"),n=cn(t,"link[rel='canonical']"),n?n.setAttribute("href",i):(n=r.createElement("link"),n.setAttribute("rel","canonical"),n.setAttribute("href",i),t.appendChild(n)))}function $S(r,e){var t,n,i=e.idref;r&&(t=cn(r,"head"),n=cn(t,"link[property='dc.identifier']"),n?n.setAttribute("content",i):(n=r.createElement("meta"),n.setAttribute("name","dc.identifier"),n.setAttribute("content",i),t.appendChild(n)))}function HS(r,e){var t=r.querySelectorAll("a[href]");if(t.length)for(var n=cn(r.ownerDocument,"base"),i=n?n.getAttribute("href"):void 0,o=(function(l){var c=l.getAttribute("href");if(c.indexOf("mailto:")!==0){var d=c.indexOf("://")>-1;if(d)l.setAttribute("target","_blank");else{var m;try{m=new _i(c,i)}catch{}l.onclick=function(){return m&&m.hash?e(m.Path.path+m.hash):e(m?m.Path.path:c),!1}}}}).bind(this),u=0;u<t.length;u++)o(t[u])}function lw(r,e,t){return e.forEach(function(n,i){n&&t[i]&&(n=n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),r=r.replace(new RegExp(n,"g"),t[i]))}),r}function Bl(r,e,t,n){var i=typeof window<"u"?window.URL:!1,o=i?"blob":"arraybuffer",u=new zt,l=new XMLHttpRequest,c=XMLHttpRequest.prototype,d;"overrideMimeType"in c||Object.defineProperty(c,"overrideMimeType",{value:function(){}}),t&&(l.withCredentials=!0),l.onreadystatechange=g,l.onerror=m,l.open("GET",r,!0);for(d in n)l.setRequestHeader(d,n[d]);e=="json"&&l.setRequestHeader("Accept","application/json"),e||(e=new gs(r).extension),e=="blob"&&(l.responseType=o),Ml(e)&&l.overrideMimeType("text/xml"),e=="binary"&&(l.responseType="arraybuffer"),l.send();function m(E){u.reject(E)}function g(){if(this.readyState===XMLHttpRequest.DONE){var E=!1;if((this.responseType===""||this.responseType==="document")&&(E=this.responseXML),this.status===200||this.status===0||E){var b;if(!this.response&&!E)return u.reject({status:this.status,message:"Empty Response",stack:new Error().stack}),u.promise;if(this.status===403)return u.reject({status:this.status,response:this.response,message:"Forbidden",stack:new Error().stack}),u.promise;E?b=this.responseXML:Ml(e)?b=zi(this.response,"text/xml"):e=="xhtml"?b=zi(this.response,"application/xhtml+xml"):e=="html"||e=="htm"?b=zi(this.response,"text/html"):e=="json"?b=JSON.parse(this.response):e=="blob"?i?b=this.response:b=new Blob([this.response]):b=this.response,u.resolve(b)}else u.reject({status:this.status,message:this.response,stack:new Error().stack})}}return u.promise}class GS{constructor(e,t){this.idref=e.idref,this.linear=e.linear==="yes",this.properties=e.properties,this.index=e.index,this.href=e.href,this.url=e.url,this.canonical=e.canonical,this.next=e.next,this.prev=e.prev,this.cfiBase=e.cfiBase,t?this.hooks=t:(this.hooks={},this.hooks.serialize=new wi(this),this.hooks.content=new wi(this)),this.document=void 0,this.contents=void 0,this.output=void 0}load(e){var t=e||this.request||Bl,n=new zt,i=n.promise;return this.contents?n.resolve(this.contents):t(this.url).then((function(o){return this.document=o,this.contents=o.documentElement,this.hooks.content.trigger(this.document,this)}).bind(this)).then((function(){n.resolve(this.contents)}).bind(this)).catch(function(o){n.reject(o)}),i}base(){return u1(this.document,this)}render(e){var t=new zt,n=t.promise;return this.output,this.load(e).then((function(i){var o=typeof navigator<"u"&&navigator.userAgent||"",u=o.indexOf("Trident")>=0,l;typeof XMLSerializer>"u"||u?l=YE.DOMParser:l=XMLSerializer;var c=new l;return this.output=c.serializeToString(i),this.output}).bind(this)).then((function(){return this.hooks.serialize.trigger(this.output,this)}).bind(this)).then((function(){t.resolve(this.output)}).bind(this)).catch(function(i){t.reject(i)}),n}find(e){var t=this,n=[],i=e.toLowerCase(),o=function(u){for(var l=u.textContent.toLowerCase(),c=t.document.createRange(),d,m,g=-1,E,b=150;m!=-1;)m=l.indexOf(i,g+1),m!=-1&&(c=t.document.createRange(),c.setStart(u,m),c.setEnd(u,m+i.length),d=t.cfiFromRange(c),u.textContent.length<b?E=u.textContent:(E=u.textContent.substring(m-b/2,m+b/2),E="..."+E+"..."),n.push({cfi:d,excerpt:E})),g=m};return nd(t.document,function(u){o(u)}),n}search(e,t=5){if(typeof document.createTreeWalker>"u")return this.find(e);let n=[];const i=150,o=this,u=e.toLowerCase(),l=function(g){const M=g.reduce((D,w)=>D+w.textContent,"").toLowerCase().indexOf(u);if(M!=-1){const w=M+u.length;let A=0,I=0;if(M<g[0].length){let V;for(;A<g.length-1&&(I+=g[A].length,!(w<=I));)A+=1;let q=g[0],P=g[A],U=o.document.createRange();U.setStart(q,M);let R=g.slice(0,A).reduce((C,N)=>C+N.textContent.length,0);U.setEnd(P,R>w?w:w-R),V=o.cfiFromRange(U);let S=g.slice(0,A+1).reduce((C,N)=>C+N.textContent,"");S.length>i&&(S=S.substring(M-i/2,M+i/2),S="..."+S+"..."),n.push({cfi:V,excerpt:S})}}},c=document.createTreeWalker(o.document,NodeFilter.SHOW_TEXT,null,!1);let d,m=[];for(;d=c.nextNode();)m.push(d),m.length==t&&(l(m.slice(0,t)),m=m.slice(1,t));return m.length>0&&l(m),n}reconcileLayoutSettings(e){var t={layout:e.layout,spread:e.spread,orientation:e.orientation};return this.properties.forEach(function(n){var i=n.replace("rendition:",""),o=i.indexOf("-"),u,l;o!=-1&&(u=i.slice(0,o),l=i.slice(o+1),t[u]=l)}),t}cfiFromRange(e){return new Ut(e,this.cfiBase).toString()}cfiFromElement(e){return new Ut(e,this.cfiBase).toString()}unload(){this.document=void 0,this.contents=void 0,this.output=void 0}destroy(){this.unload(),this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.idref=void 0,this.linear=void 0,this.properties=void 0,this.index=void 0,this.href=void 0,this.url=void 0,this.next=void 0,this.prev=void 0,this.cfiBase=void 0}}class KS{constructor(){this.spineItems=[],this.spineByHref={},this.spineById={},this.hooks={},this.hooks.serialize=new wi,this.hooks.content=new wi,this.hooks.content.register(u1),this.hooks.content.register(WS),this.hooks.content.register($S),this.epubcfi=new Ut,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}unpack(e,t,n){this.items=e.spine,this.manifest=e.manifest,this.spineNodeIndex=e.spineNodeIndex,this.baseUrl=e.baseUrl||e.basePath||"",this.length=this.items.length,this.items.forEach((i,o)=>{var u=this.manifest[i.idref],l;i.index=o,i.cfiBase=this.epubcfi.generateChapterComponent(this.spineNodeIndex,i.index,i.id),i.href&&(i.url=t(i.href,!0),i.canonical=n(i.href)),u&&(i.href=u.href,i.url=t(i.href,!0),i.canonical=n(i.href),u.properties.length&&i.properties.push.apply(i.properties,u.properties)),i.linear==="yes"?(i.prev=(function(){let c=i.index;for(;c>0;){let d=this.get(c-1);if(d&&d.linear)return d;c-=1}}).bind(this),i.next=(function(){let c=i.index;for(;c<this.spineItems.length-1;){let d=this.get(c+1);if(d&&d.linear)return d;c+=1}}).bind(this)):(i.prev=function(){},i.next=function(){}),l=new GS(i,this.hooks),this.append(l)}),this.loaded=!0}get(e){var t=0;if(typeof e>"u")for(;t<this.spineItems.length;){let n=this.spineItems[t];if(n&&n.linear)break;t+=1}else this.epubcfi.isCfiString(e)?t=new Ut(e).spinePos:typeof e=="number"||isNaN(e)===!1?t=e:typeof e=="string"&&e.indexOf("#")===0?t=this.spineById[e.substring(1)]:typeof e=="string"&&(e=e.split("#")[0],t=this.spineByHref[e]||this.spineByHref[encodeURI(e)]);return this.spineItems[t]||null}append(e){var t=this.spineItems.length;return e.index=t,this.spineItems.push(e),this.spineByHref[decodeURI(e.href)]=t,this.spineByHref[encodeURI(e.href)]=t,this.spineByHref[e.href]=t,this.spineById[e.idref]=t,t}prepend(e){return this.spineByHref[e.href]=0,this.spineById[e.idref]=0,this.spineItems.forEach(function(t,n){t.index=n}),0}remove(e){var t=this.spineItems.indexOf(e);if(t>-1)return delete this.spineByHref[e.href],delete this.spineById[e.idref],this.spineItems.splice(t,1)}each(){return this.spineItems.forEach.apply(this.spineItems,arguments)}first(){let e=0;do{let t=this.get(e);if(t&&t.linear)return t;e+=1}while(e<this.spineItems.length)}last(){let e=this.spineItems.length-1;do{let t=this.get(e);if(t&&t.linear)return t;e-=1}while(e>=0)}destroy(){this.each(e=>e.destroy()),this.spineItems=void 0,this.spineByHref=void 0,this.spineById=void 0,this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.epubcfi=void 0,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}}class Yg{constructor(e){this._q=[],this.context=e,this.tick=Gg,this.running=!1,this.paused=!1}enqueue(){var e,t,n,i=[].shift.call(arguments),o=arguments;if(!i)throw new Error("No Task Provided");return typeof i=="function"?(e=new zt,t=e.promise,n={task:i,args:o,deferred:e,promise:t}):n={promise:i},this._q.push(n),this.paused==!1&&!this.running&&this.run(),n.promise}dequeue(){var e,t,n;if(this._q.length&&!this.paused){if(e=this._q.shift(),t=e.task,t)return n=t.apply(this.context,e.args),n&&typeof n.then=="function"?n.then((function(){e.deferred.resolve.apply(this.context,arguments)}).bind(this),(function(){e.deferred.reject.apply(this.context,arguments)}).bind(this)):(e.deferred.resolve.apply(this.context,n),e.promise);if(e.promise)return e.promise}else return e=new zt,e.deferred.resolve(),e.promise}dump(){for(;this._q.length;)this.dequeue()}run(){return this.running||(this.running=!0,this.defered=new zt),this.tick.call(window,()=>{this._q.length?this.dequeue().then((function(){this.run()}).bind(this)):(this.defered.resolve(),this.running=void 0)}),this.paused==!0&&(this.paused=!1),this.defered.promise}flush(){if(this.running)return this.running;if(this._q.length)return this.running=this.dequeue().then((function(){return this.running=void 0,this.flush()}).bind(this)),this.running}clear(){this._q=[]}length(){return this._q.length}pause(){this.paused=!0}stop(){this._q=[],this.running=!1,this.paused=!0}}const Fd="0.3",Mh=["keydown","keyup","keypressed","mouseup","mousedown","mousemove","click","touchend","touchstart","touchmove"],Ye={BOOK:{OPEN_FAILED:"openFailed"},CONTENTS:{EXPAND:"expand",RESIZE:"resize",SELECTED:"selected",SELECTED_RANGE:"selectedRange",LINK_CLICKED:"linkClicked"},LOCATIONS:{CHANGED:"changed"},MANAGERS:{RESIZE:"resize",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",ADDED:"added",SCROLL:"scroll",SCROLLED:"scrolled",REMOVED:"removed"},VIEWS:{AXIS:"axis",WRITING_MODE:"writingMode",LOAD_ERROR:"loaderror",RENDERED:"rendered",RESIZED:"resized",DISPLAYED:"displayed",SHOWN:"shown",HIDDEN:"hidden",MARK_CLICKED:"markClicked"},RENDITION:{STARTED:"started",ATTACHED:"attached",DISPLAYED:"displayed",DISPLAY_ERROR:"displayerror",RENDERED:"rendered",REMOVED:"removed",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",LOCATION_CHANGED:"locationChanged",RELOCATED:"relocated",MARK_CLICKED:"markClicked",SELECTED:"selected",LAYOUT:"layout"},LAYOUT:{UPDATED:"updated"},ANNOTATION:{ATTACH:"attach",DETACH:"detach"}};class l1{constructor(e,t,n){this.spine=e,this.request=t,this.pause=n||100,this.q=new Yg(this),this.epubcfi=new Ut,this._locations=[],this._locationsWords=[],this.total=0,this.break=150,this._current=0,this._wordCounter=0,this.currentLocation="",this._currentCfi="",this.processingTimeout=void 0}generate(e){return e&&(this.break=e),this.q.pause(),this.spine.each((function(t){t.linear&&this.q.enqueue(this.process.bind(this),t)}).bind(this)),this.q.run().then((function(){return this.total=this._locations.length-1,this._currentCfi&&(this.currentLocation=this._currentCfi),this._locations}).bind(this))}createRange(){return{startContainer:void 0,startOffset:void 0,endContainer:void 0,endOffset:void 0}}process(e){return e.load(this.request).then((function(t){var n=new zt,i=this.parse(t,e.cfiBase);return this._locations=this._locations.concat(i),e.unload(),this.processingTimeout=setTimeout(()=>n.resolve(i),this.pause),n.promise}).bind(this))}parse(e,t,n){var i=[],o,u=e.ownerDocument,l=cn(u,"body"),c=0,d,m=n||this.break,g=function(E){var b=E.length,M,D=0;if(E.textContent.trim().length===0)return!1;for(c==0&&(o=this.createRange(),o.startContainer=E,o.startOffset=0),M=m-c,M>b&&(c+=b,D=b);D<b;)if(M=m-c,c===0&&(D+=1,o=this.createRange(),o.startContainer=E,o.startOffset=D),D+M>=b)c+=b-D,D=b;else{D+=M,o.endContainer=E,o.endOffset=D;let w=new Ut(o,t).toString();i.push(w),c=0}d=E};if(nd(l,g.bind(this)),o&&o.startContainer&&d){o.endContainer=d,o.endOffset=d.length;let E=new Ut(o,t).toString();i.push(E),c=0}return i}generateFromWords(e,t,n){var i=e?new Ut(e):void 0;return this.q.pause(),this._locationsWords=[],this._wordCounter=0,this.spine.each((function(o){o.linear&&(i?o.index>=i.spinePos&&this.q.enqueue(this.processWords.bind(this),o,t,i,n):this.q.enqueue(this.processWords.bind(this),o,t,i,n))}).bind(this)),this.q.run().then((function(){return this._currentCfi&&(this.currentLocation=this._currentCfi),this._locationsWords}).bind(this))}processWords(e,t,n,i){return i&&this._locationsWords.length>=i?Promise.resolve():e.load(this.request).then((function(o){var u=new zt,l=this.parseWords(o,e,t,n),c=i-this._locationsWords.length;return this._locationsWords=this._locationsWords.concat(l.length>=i?l.slice(0,c):l),e.unload(),this.processingTimeout=setTimeout(()=>u.resolve(l),this.pause),u.promise}).bind(this))}countWords(e){return e=e.replace(/(^\s*)|(\s*$)/gi,""),e=e.replace(/[ ]{2,}/gi," "),e=e.replace(/\n /,`
`),e.split(" ").length}parseWords(e,t,n,i){var o=t.cfiBase,u=[],l=e.ownerDocument,c=cn(l,"body"),d=n,m=i?i.spinePos!==t.index:!0,g;i&&t.index===i.spinePos&&(g=i.findNode(i.range?i.path.steps.concat(i.start.steps):i.path.steps,e.ownerDocument));var E=function(b){if(!m)if(b===g)m=!0;else return!1;if(b.textContent.length<10&&b.textContent.trim().length===0)return!1;var M=this.countWords(b.textContent),D,w=0;if(M===0)return!1;for(D=d-this._wordCounter,D>M&&(this._wordCounter+=M,w=M);w<M;)if(D=d-this._wordCounter,w+D>=M)this._wordCounter+=M-w,w=M;else{w+=D;let A=new Ut(b,o);u.push({cfi:A.toString(),wordCount:this._wordCounter}),this._wordCounter=0}};return nd(c,E.bind(this)),u}locationFromCfi(e){let t;return Ut.prototype.isCfiString(e)&&(e=new Ut(e)),this._locations.length===0?-1:(t=iu(e,this._locations,this.epubcfi.compare),t>this.total?this.total:t)}percentageFromCfi(e){if(this._locations.length===0)return null;var t=this.locationFromCfi(e);return this.percentageFromLocation(t)}percentageFromLocation(e){return!e||!this.total?0:e/this.total}cfiFromLocation(e){var t=-1;return typeof e!="number"&&(e=parseInt(e)),e>=0&&e<this._locations.length&&(t=this._locations[e]),t}cfiFromPercentage(e){let t;if(e>1&&console.warn("Normalize cfiFromPercentage value to between 0 - 1"),e>=1){let n=new Ut(this._locations[this.total]);return n.collapse(),n.toString()}return t=Math.ceil(this.total*e),this.cfiFromLocation(t)}load(e){return typeof e=="string"?this._locations=JSON.parse(e):this._locations=e,this.total=this._locations.length-1,this._locations}save(){return JSON.stringify(this._locations)}getCurrent(){return this._current}setCurrent(e){var t;if(typeof e=="string")this._currentCfi=e;else if(typeof e=="number")this._current=e;else return;this._locations.length!==0&&(typeof e=="string"?(t=this.locationFromCfi(e),this._current=t):t=e,this.emit(Ye.LOCATIONS.CHANGED,{percentage:this.percentageFromLocation(t)}))}get currentLocation(){return this._current}set currentLocation(e){this.setCurrent(e)}length(){return this._locations.length}destroy(){this.spine=void 0,this.request=void 0,this.pause=void 0,this.q.stop(),this.q=void 0,this.epubcfi=void 0,this._locations=void 0,this.total=void 0,this.break=void 0,this._current=void 0,this.currentLocation=void 0,this._currentCfi=void 0,clearTimeout(this.processingTimeout)}}Hi(l1.prototype);class QS{constructor(e){this.packagePath="",this.directory="",this.encoding="",e&&this.parse(e)}parse(e){var t;if(!e)throw new Error("Container File Not Found");if(t=cn(e,"rootfile"),!t)throw new Error("No RootFile Found");this.packagePath=t.getAttribute("full-path"),this.directory=Qs.dirname(this.packagePath),this.encoding=e.xmlEncoding}destroy(){this.packagePath=void 0,this.directory=void 0,this.encoding=void 0}}class cw{constructor(e){this.manifest={},this.navPath="",this.ncxPath="",this.coverPath="",this.spineNodeIndex=0,this.spine=[],this.metadata={},e&&this.parse(e)}parse(e){var t,n,i;if(!e)throw new Error("Package File Not Found");if(t=cn(e,"metadata"),!t)throw new Error("No Metadata Found");if(n=cn(e,"manifest"),!n)throw new Error("No Manifest Found");if(i=cn(e,"spine"),!i)throw new Error("No Spine Found");return this.manifest=this.parseManifest(n),this.navPath=this.findNavPath(n),this.ncxPath=this.findNcxPath(n,i),this.coverPath=this.findCoverPath(e),this.spineNodeIndex=t1(i),this.spine=this.parseSpine(i,this.manifest),this.uniqueIdentifier=this.findUniqueIdentifier(e),this.metadata=this.parseMetadata(t),this.metadata.direction=i.getAttribute("page-progression-direction"),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex}}parseMetadata(e){var t={};return t.title=this.getElementText(e,"title"),t.creator=this.getElementText(e,"creator"),t.description=this.getElementText(e,"description"),t.pubdate=this.getElementText(e,"date"),t.publisher=this.getElementText(e,"publisher"),t.identifier=this.getElementText(e,"identifier"),t.language=this.getElementText(e,"language"),t.rights=this.getElementText(e,"rights"),t.modified_date=this.getPropertyText(e,"dcterms:modified"),t.layout=this.getPropertyText(e,"rendition:layout"),t.orientation=this.getPropertyText(e,"rendition:orientation"),t.flow=this.getPropertyText(e,"rendition:flow"),t.viewport=this.getPropertyText(e,"rendition:viewport"),t.media_active_class=this.getPropertyText(e,"media:active-class"),t.spread=this.getPropertyText(e,"rendition:spread"),t}parseManifest(e){var t={},n=ms(e,"item"),i=Array.prototype.slice.call(n);return i.forEach(function(o){var u=o.getAttribute("id"),l=o.getAttribute("href")||"",c=o.getAttribute("media-type")||"",d=o.getAttribute("media-overlay")||"",m=o.getAttribute("properties")||"";t[u]={href:l,type:c,overlay:d,properties:m.length?m.split(" "):[]}}),t}parseSpine(e,t){var n=[],i=ms(e,"itemref"),o=Array.prototype.slice.call(i);return o.forEach(function(u,l){var c=u.getAttribute("idref"),d=u.getAttribute("properties")||"",m=d.length?d.split(" "):[],g={id:u.getAttribute("id"),idref:c,linear:u.getAttribute("linear")||"yes",properties:m,index:l};n.push(g)}),n}findUniqueIdentifier(e){var t=e.documentElement.getAttribute("unique-identifier");if(!t)return"";var n=e.getElementById(t);return n&&n.localName==="identifier"&&n.namespaceURI==="http://purl.org/dc/elements/1.1/"&&n.childNodes.length>0?n.childNodes[0].nodeValue.trim():""}findNavPath(e){var t=Ga(e,"item",{properties:"nav"});return t?t.getAttribute("href"):!1}findNcxPath(e,t){var n=Ga(e,"item",{"media-type":"application/x-dtbncx+xml"}),i;return n||(i=t.getAttribute("toc"),i&&(n=e.querySelector(`#${i}`))),n?n.getAttribute("href"):!1}findCoverPath(e){var t=cn(e,"package");t.getAttribute("version");var n=Ga(e,"item",{properties:"cover-image"});if(n)return n.getAttribute("href");var i=Ga(e,"meta",{name:"cover"});if(i){var o=i.getAttribute("content"),u=e.getElementById(o);return u?u.getAttribute("href"):""}else return!1}getElementText(e,t){var n=e.getElementsByTagNameNS("http://purl.org/dc/elements/1.1/",t),i;return!n||n.length===0?"":(i=n[0],i.childNodes.length?i.childNodes[0].nodeValue:"")}getPropertyText(e,t){var n=Ga(e,"meta",{property:t});return n&&n.childNodes.length?n.childNodes[0].nodeValue:""}load(e){this.metadata=e.metadata;let t=e.readingOrder||e.spine;return this.spine=t.map((n,i)=>(n.index=i,n.linear=n.linear||"yes",n)),e.resources.forEach((n,i)=>{this.manifest[i]=n,n.rel&&n.rel[0]==="cover"&&(this.coverPath=n.href)}),this.spineNodeIndex=0,this.toc=e.toc.map((n,i)=>(n.label=n.title,n)),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex,toc:this.toc}}destroy(){this.manifest=void 0,this.navPath=void 0,this.ncxPath=void 0,this.coverPath=void 0,this.spineNodeIndex=void 0,this.spine=void 0,this.metadata=void 0}}class am{constructor(e){this.toc=[],this.tocByHref={},this.tocById={},this.landmarks=[],this.landmarksByType={},this.length=0,e&&this.parse(e)}parse(e){let t=e.nodeType,n,i;t&&(n=cn(e,"html"),i=cn(e,"ncx")),t?n?(this.toc=this.parseNav(e),this.landmarks=this.parseLandmarks(e)):i&&(this.toc=this.parseNcx(e)):this.toc=this.load(e),this.length=0,this.unpack(this.toc)}unpack(e){for(var t,n=0;n<e.length;n++)t=e[n],t.href&&(this.tocByHref[t.href]=n),t.id&&(this.tocById[t.id]=n),this.length++,t.subitems.length&&this.unpack(t.subitems)}get(e){var t;return e?(e.indexOf("#")===0?t=this.tocById[e.substring(1)]:e in this.tocByHref&&(t=this.tocByHref[e]),this.getByIndex(e,t,this.toc)):this.toc}getByIndex(e,t,n){if(n.length===0)return;const i=n[t];if(i&&(e===i.id||e===i.href))return i;{let o;for(let u=0;u<n.length&&(o=this.getByIndex(e,t,n[u].subitems),!o);++u);return o}}landmark(e){var t;return e?(t=this.landmarksByType[e],this.landmarks[t]):this.landmarks}parseNav(e){var t=rd(e,"nav","toc"),n=[];if(!t)return n;let i=Ka(t,"ol",!0);return i&&(n=this.parseNavList(i)),n}parseNavList(e,t){const n=[];if(!e||!e.children)return n;for(let i=0;i<e.children.length;i++){const o=this.navItem(e.children[i],t);o&&n.push(o)}return n}navItem(e,t){let n=e.getAttribute("id")||void 0,i=Ka(e,"a",!0)||Ka(e,"span",!0);if(!i)return;let o=i.getAttribute("href")||"";n||(n=o);let u=i.textContent||"",l=[],c=Ka(e,"ol",!0);return c&&(l=this.parseNavList(c,n)),{id:n,href:o,label:u,subitems:l,parent:t}}parseLandmarks(e){var t=rd(e,"nav","landmarks"),n=t?ms(t,"li"):[],i=n.length,o,u=[],l;if(!n||i===0)return u;for(o=0;o<i;++o)l=this.landmarkItem(n[o]),l&&(u.push(l),this.landmarksByType[l.type]=o);return u}landmarkItem(e){let t=Ka(e,"a",!0);if(!t)return;let n=t.getAttributeNS("http://www.idpf.org/2007/ops","type")||void 0,i=t.getAttribute("href")||"",o=t.textContent||"";return{href:i,label:o,type:n}}parseNcx(e){var t=ms(e,"navPoint"),n=t.length,i,o={},u=[],l,c;if(!t||n===0)return u;for(i=0;i<n;++i)l=this.ncxItem(t[i]),o[l.id]=l,l.parent?(c=o[l.parent],c.subitems.push(l)):u.push(l);return u}ncxItem(e){var t=e.getAttribute("id")||!1,n=cn(e,"content"),i=n.getAttribute("src"),o=cn(e,"navLabel"),u=o.textContent?o.textContent:"",l=[],c=e.parentNode,d;return c&&(c.nodeName==="navPoint"||c.nodeName.split(":").slice(-1)[0]==="navPoint")&&(d=c.getAttribute("id")),{id:t,href:i,label:u,subitems:l,parent:d}}load(e){return e.map(t=>(t.label=t.title,t.subitems=t.children?this.load(t.children):[],t))}forEach(e){return this.toc.forEach(e)}}var hl={application:{ecmascript:["es","ecma"],javascript:"js",ogg:"ogx",pdf:"pdf",postscript:["ps","ai","eps","epsi","epsf","eps2","eps3"],"rdf+xml":"rdf",smil:["smi","smil"],"xhtml+xml":["xhtml","xht"],xml:["xml","xsl","xsd","opf","ncx"],zip:"zip","x-httpd-eruby":"rhtml","x-latex":"latex","x-maker":["frm","maker","frame","fm","fb","book","fbdoc"],"x-object":"o","x-shockwave-flash":["swf","swfl"],"x-silverlight":"scr","epub+zip":"epub","font-tdpfr":"pfr","inkml+xml":["ink","inkml"],json:"json","jsonml+json":"jsonml","mathml+xml":"mathml","metalink+xml":"metalink",mp4:"mp4s","omdoc+xml":"omdoc",oxps:"oxps","vnd.amazon.ebook":"azw",widget:"wgt","x-dtbook+xml":"dtb","x-dtbresource+xml":"res","x-font-bdf":"bdf","x-font-ghostscript":"gsf","x-font-linux-psf":"psf","x-font-otf":"otf","x-font-pcf":"pcf","x-font-snf":"snf","x-font-ttf":["ttf","ttc"],"x-font-type1":["pfa","pfb","pfm","afm"],"x-font-woff":"woff","x-mobipocket-ebook":["prc","mobi"],"x-mspublisher":"pub","x-nzb":"nzb","x-tgif":"obj","xaml+xml":"xaml","xml-dtd":"dtd","xproc+xml":"xpl","xslt+xml":"xslt","internet-property-stream":"acx","x-compress":"z","x-compressed":"tgz","x-gzip":"gz"},audio:{flac:"flac",midi:["mid","midi","kar","rmi"],mpeg:["mpga","mpega","mp2","mp3","m4a","mp2a","m2a","m3a"],mpegurl:"m3u",ogg:["oga","ogg","spx"],"x-aiff":["aif","aiff","aifc"],"x-ms-wma":"wma","x-wav":"wav",adpcm:"adp",mp4:"mp4a",webm:"weba","x-aac":"aac","x-caf":"caf","x-matroska":"mka","x-pn-realaudio-plugin":"rmp",xm:"xm",mid:["mid","rmi"]},image:{gif:"gif",ief:"ief",jpeg:["jpeg","jpg","jpe"],pcx:"pcx",png:"png","svg+xml":["svg","svgz"],tiff:["tiff","tif"],"x-icon":"ico",bmp:"bmp",webp:"webp","x-pict":["pic","pct"],"x-tga":"tga","cis-cod":"cod"},text:{"cache-manifest":["manifest","appcache"],css:"css",csv:"csv",html:["html","htm","shtml","stm"],mathml:"mml",plain:["txt","text","brf","conf","def","list","log","in","bas"],richtext:"rtx","tab-separated-values":"tsv","x-bibtex":"bib"},video:{mpeg:["mpeg","mpg","mpe","m1v","m2v","mp2","mpa","mpv2"],mp4:["mp4","mp4v","mpg4"],quicktime:["qt","mov"],ogg:"ogv","vnd.mpegurl":["mxu","m4u"],"x-flv":"flv","x-la-asf":["lsf","lsx"],"x-mng":"mng","x-ms-asf":["asf","asx","asr"],"x-ms-wm":"wm","x-ms-wmv":"wmv","x-ms-wmx":"wmx","x-ms-wvx":"wvx","x-msvideo":"avi","x-sgi-movie":"movie","x-matroska":["mpv","mkv","mk3d","mks"],"3gpp2":"3g2",h261:"h261",h263:"h263",h264:"h264",jpeg:"jpgv",jpm:["jpm","jpgm"],mj2:["mj2","mjp2"],"vnd.ms-playready.media.pyv":"pyv","vnd.uvvu.mp4":["uvu","uvvu"],"vnd.vivo":"viv",webm:"webm","x-f4v":"f4v","x-m4v":"m4v","x-ms-vob":"vob","x-smv":"smv"}},YS=(function(){var r,e,t,n,i={};for(r in hl)if(hl.hasOwnProperty(r)){for(e in hl[r])if(hl[r].hasOwnProperty(e))if(t=hl[r][e],typeof t=="string")i[t]=r+"/"+e;else for(n=0;n<t.length;n++)i[t[n]]=r+"/"+e}return i})(),XS="text/plain";function ZS(r){return r&&YS[r.split(".").pop().toLowerCase()]||XS}const eu={lookup:ZS};class JS{constructor(e,t){this.settings={replacements:t&&t.replacements||"base64",archive:t&&t.archive,resolver:t&&t.resolver,request:t&&t.request},this.process(e)}process(e){this.manifest=e,this.resources=Object.keys(e).map(function(t){return e[t]}),this.replacementUrls=[],this.html=[],this.assets=[],this.css=[],this.urls=[],this.cssUrls=[],this.split(),this.splitUrls()}split(){this.html=this.resources.filter(function(e){if(e.type==="application/xhtml+xml"||e.type==="text/html")return!0}),this.assets=this.resources.filter(function(e){if(e.type!=="application/xhtml+xml"&&e.type!=="text/html")return!0}),this.css=this.resources.filter(function(e){if(e.type==="text/css")return!0})}splitUrls(){this.urls=this.assets.map((function(e){return e.href}).bind(this)),this.cssUrls=this.css.map(function(e){return e.href})}createUrl(e){var t=new _i(e),n=eu.lookup(t.filename);return this.settings.archive?this.settings.archive.createUrl(e,{base64:this.settings.replacements==="base64"}):this.settings.replacements==="base64"?this.settings.request(e,"blob").then(i=>o1(i)).then(i=>Zm(i,n)):this.settings.request(e,"blob").then(i=>td(i,n))}replacements(){if(this.settings.replacements==="none")return new Promise((function(t){t(this.urls)}).bind(this));var e=this.urls.map(t=>{var n=this.settings.resolver(t);return this.createUrl(n).catch(i=>(console.error(i),null))});return Promise.all(e).then(t=>(this.replacementUrls=t.filter(n=>typeof n=="string"),t))}replaceCss(e,t){var n=[];return e=e||this.settings.archive,t=t||this.settings.resolver,this.cssUrls.forEach((function(i){var o=this.createCssFile(i,e,t).then((function(u){var l=this.urls.indexOf(i);l>-1&&(this.replacementUrls[l]=u)}).bind(this));n.push(o)}).bind(this)),Promise.all(n)}createCssFile(e){var t;if(Qs.isAbsolute(e))return new Promise(function(u){u()});var n=this.settings.resolver(e),i;this.settings.archive?i=this.settings.archive.getText(n):i=this.settings.request(n,"text");var o=this.urls.map(u=>{var l=this.settings.resolver(u),c=new gs(n).relative(l);return c});return i?i.then(u=>(u=lw(u,o,this.replacementUrls),this.settings.replacements==="base64"?t=Zm(u,"text/css"):t=td(u,"text/css"),t),u=>new Promise(function(l){l()})):new Promise(function(u){u()})}relativeTo(e,t){return t=t||this.settings.resolver,this.urls.map((function(n){var i=t(n),o=new gs(e).relative(i);return o}).bind(this))}get(e){var t=this.urls.indexOf(e);if(t!==-1)return this.replacementUrls.length?new Promise((function(n,i){n(this.replacementUrls[t])}).bind(this)):this.createUrl(e)}substitute(e,t){var n;return t?n=this.relativeTo(t):n=this.urls,lw(e,n,this.replacementUrls)}destroy(){this.settings=void 0,this.manifest=void 0,this.resources=void 0,this.replacementUrls=void 0,this.html=void 0,this.assets=void 0,this.css=void 0,this.urls=void 0,this.cssUrls=void 0}}class um{constructor(e){this.pages=[],this.locations=[],this.epubcfi=new Ut,this.firstPage=0,this.lastPage=0,this.totalPages=0,this.toc=void 0,this.ncx=void 0,e&&(this.pageList=this.parse(e)),this.pageList&&this.pageList.length&&this.process(this.pageList)}parse(e){var t=cn(e,"html"),n=cn(e,"ncx");if(t)return this.parseNav(e);if(n)return this.parseNcx(e)}parseNav(e){var t=rd(e,"nav","page-list"),n=t?ms(t,"li"):[],i=n.length,o,u=[],l;if(!n||i===0)return u;for(o=0;o<i;++o)l=this.item(n[o]),u.push(l);return u}parseNcx(e){var t=[],n=0,i,o,u,l=0;if(o=cn(e,"pageList"),!o||(u=ms(o,"pageTarget"),l=u.length,!u||u.length===0))return t;for(n=0;n<l;++n)i=this.ncxItem(u[n]),t.push(i);return t}ncxItem(e){var t=cn(e,"navLabel"),n=cn(t,"text"),i=n.textContent,o=cn(e,"content"),u=o.getAttribute("src"),l=parseInt(i,10);return{href:u,page:l}}item(e){var t=cn(e,"a"),n=t.getAttribute("href")||"",i=t.textContent||"",o=parseInt(i),u=n.indexOf("epubcfi"),l,c,d;return u!=-1?(l=n.split("#"),c=l[0],d=l.length>1?l[1]:!1,{cfi:d,href:n,packageUrl:c,page:o}):{href:n,page:o}}process(e){e.forEach(function(t){this.pages.push(t.page),t.cfi&&this.locations.push(t.cfi)},this),this.firstPage=parseInt(this.pages[0]),this.lastPage=parseInt(this.pages[this.pages.length-1]),this.totalPages=this.lastPage-this.firstPage}pageFromCfi(e){var t=-1;if(this.locations.length===0)return-1;var n=Zh(e,this.locations,this.epubcfi.compare);return n!=-1?t=this.pages[n]:(n=iu(e,this.locations,this.epubcfi.compare),t=n-1>=0?this.pages[n-1]:this.pages[0],t!==void 0||(t=-1)),t}cfiFromPage(e){var t=-1;typeof e!="number"&&(e=parseInt(e));var n=this.pages.indexOf(e);return n!=-1&&(t=this.locations[n]),t}pageFromPercentage(e){var t=Math.round(this.totalPages*e);return t}percentageFromPage(e){var t=(e-this.firstPage)/this.totalPages;return Math.round(t*1e3)/1e3}percentageFromCfi(e){var t=this.pageFromCfi(e),n=this.percentageFromPage(t);return n}destroy(){this.pages=void 0,this.locations=void 0,this.epubcfi=void 0,this.pageList=void 0,this.toc=void 0,this.ncx=void 0}}class c1{constructor(e){this.settings=e,this.name=e.layout||"reflowable",this._spread=e.spread!=="none",this._minSpreadWidth=e.minSpreadWidth||800,this._evenSpreads=e.evenSpreads||!1,e.flow==="scrolled"||e.flow==="scrolled-continuous"||e.flow==="scrolled-doc"?this._flow="scrolled":this._flow="paginated",this.width=0,this.height=0,this.spreadWidth=0,this.delta=0,this.columnWidth=0,this.gap=0,this.divisor=1,this.props={name:this.name,spread:this._spread,flow:this._flow,width:0,height:0,spreadWidth:0,delta:0,columnWidth:0,gap:0,divisor:1}}flow(e){return typeof e<"u"&&(e==="scrolled"||e==="scrolled-continuous"||e==="scrolled-doc"?this._flow="scrolled":this._flow="paginated",this.update({flow:this._flow})),this._flow}spread(e,t){return e&&(this._spread=e!=="none",this.update({spread:this._spread})),t>=0&&(this._minSpreadWidth=t),this._spread}calculate(e,t,n){var i=1,o=n||0,u=e,l=t,c=Math.floor(u/12),d,m,g,E;this._spread&&u>=this._minSpreadWidth?i=2:i=1,this.name==="reflowable"&&this._flow==="paginated"&&!(n>=0)&&(o=c%2===0?c:c-1),this.name==="pre-paginated"&&(o=0),i>1?(d=u/i-o,g=d+o):(d=u,g=u),this.name==="pre-paginated"&&i>1&&(u=d),m=d*i+o,E=u,this.width=u,this.height=l,this.spreadWidth=m,this.pageWidth=g,this.delta=E,this.columnWidth=d,this.gap=o,this.divisor=i,this.update({width:u,height:l,spreadWidth:m,pageWidth:g,delta:E,columnWidth:d,gap:o,divisor:i})}format(e,t,n){var i;return this.name==="pre-paginated"?i=e.fit(this.columnWidth,this.height,t):this._flow==="paginated"?i=e.columns(this.width,this.height,this.columnWidth,this.gap,this.settings.direction):n&&n==="horizontal"?i=e.size(null,this.height):i=e.size(this.width,null),i}count(e,t){let n,i;return this.name==="pre-paginated"?(n=1,i=1):this._flow==="paginated"?(t=t||this.delta,n=Math.ceil(e/t),i=n*this.divisor):(t=t||this.height,n=Math.ceil(e/t),i=n),{spreads:n,pages:i}}update(e){if(Object.keys(e).forEach(t=>{this.props[t]===e[t]&&delete e[t]}),Object.keys(e).length>0){let t=ar(this.props,e);this.emit(Ye.LAYOUT.UPDATED,t,e)}}}Hi(c1.prototype);class eI{constructor(e){this.rendition=e,this._themes={default:{rules:{},url:"",serialized:""}},this._overrides={},this._current="default",this._injected=[],this.rendition.hooks.content.register(this.inject.bind(this)),this.rendition.hooks.content.register(this.overrides.bind(this))}register(){if(arguments.length!==0){if(arguments.length===1&&typeof arguments[0]=="object")return this.registerThemes(arguments[0]);if(arguments.length===1&&typeof arguments[0]=="string")return this.default(arguments[0]);if(arguments.length===2&&typeof arguments[1]=="string")return this.registerUrl(arguments[0],arguments[1]);if(arguments.length===2&&typeof arguments[1]=="object")return this.registerRules(arguments[0],arguments[1])}}default(e){if(e){if(typeof e=="string")return this.registerUrl("default",e);if(typeof e=="object")return this.registerRules("default",e)}}registerThemes(e){for(var t in e)e.hasOwnProperty(t)&&(typeof e[t]=="string"?this.registerUrl(t,e[t]):this.registerRules(t,e[t]))}registerCss(e,t){this._themes[e]={serialized:t},(this._injected[e]||e=="default")&&this.update(e)}registerUrl(e,t){var n=new _i(t);this._themes[e]={url:n.toString()},(this._injected[e]||e=="default")&&this.update(e)}registerRules(e,t){this._themes[e]={rules:t},(this._injected[e]||e=="default")&&this.update(e)}select(e){var t=this._current,n;this._current=e,this.update(e),n=this.rendition.getContents(),n.forEach(i=>{i.removeClass(t),i.addClass(e)})}update(e){var t=this.rendition.getContents();t.forEach(n=>{this.add(e,n)})}inject(e){var t=[],n=this._themes,i;for(var o in n)n.hasOwnProperty(o)&&(o===this._current||o==="default")&&(i=n[o],(i.rules&&Object.keys(i.rules).length>0||i.url&&t.indexOf(i.url)===-1)&&this.add(o,e),this._injected.push(o));this._current!="default"&&e.addClass(this._current)}add(e,t){var n=this._themes[e];!n||!t||(n.url?t.addStylesheet(n.url):n.serialized?(t.addStylesheetCss(n.serialized,e),n.injected=!0):n.rules&&(t.addStylesheetRules(n.rules,e),n.injected=!0))}override(e,t,n){var i=this.rendition.getContents();this._overrides[e]={value:t,priority:n===!0},i.forEach(o=>{o.css(e,this._overrides[e].value,this._overrides[e].priority)})}removeOverride(e){var t=this.rendition.getContents();delete this._overrides[e],t.forEach(n=>{n.css(e)})}overrides(e){var t=this._overrides;for(var n in t)t.hasOwnProperty(n)&&e.css(n,t[n].value,t[n].priority)}fontSize(e){this.override("font-size",e)}font(e){this.override("font-family",e,!0)}destroy(){this.rendition=void 0,this._themes=void 0,this._overrides=void 0,this._current=void 0,this._injected=void 0}}class id{constructor(e,t,n,i=!1){this.layout=e,this.horizontal=n==="horizontal",this.direction=t||"ltr",this._dev=i}section(e){var t=this.findRanges(e),n=this.rangeListToCfiList(e.section.cfiBase,t);return n}page(e,t,n,i){var o=e&&e.document?e.document.body:!1,u;if(o){if(u=this.rangePairToCfiPair(t,{start:this.findStart(o,n,i),end:this.findEnd(o,n,i)}),this._dev===!0){let l=e.document,c=new Ut(u.start).toRange(l),d=new Ut(u.end).toRange(l),m=l.defaultView.getSelection(),g=l.createRange();m.removeAllRanges(),g.setStart(c.startContainer,c.startOffset),g.setEnd(d.endContainer,d.endOffset),m.addRange(g)}return u}}walk(e,t){if(!(e&&e.nodeType===Node.TEXT_NODE)){var n={acceptNode:function(c){return c.data.trim().length>0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}},i=n.acceptNode;i.acceptNode=n.acceptNode;for(var o=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,i,!1),u,l;(u=o.nextNode())&&(l=t(u),!l););return l}}findRanges(e){for(var t=[],n=e.contents.scrollWidth(),i=Math.ceil(n/this.layout.spreadWidth),o=i*this.layout.divisor,u=this.layout.columnWidth,l=this.layout.gap,c,d,m=0;m<o.pages;m++)c=(u+l)*m,d=u*(m+1)+l*m,t.push({start:this.findStart(e.document.body,c,d),end:this.findEnd(e.document.body,c,d)});return t}findStart(e,t,n){for(var i=[e],o,u,l=e;i.length;)if(o=i.shift(),u=this.walk(o,c=>{var d,m,g,E,b;if(b=Xm(c),this.horizontal&&this.direction==="ltr"){if(d=this.horizontal?b.left:b.top,m=this.horizontal?b.right:b.bottom,d>=t&&d<=n)return c;if(m>t)return c;l=c,i.push(c)}else if(this.horizontal&&this.direction==="rtl"){if(d=b.left,m=b.right,m<=n&&m>=t)return c;if(d<n)return c;l=c,i.push(c)}else{if(g=b.top,E=b.bottom,g>=t&&g<=n)return c;if(E>t)return c;l=c,i.push(c)}}),u)return this.findTextStartRange(u,t,n);return this.findTextStartRange(l,t,n)}findEnd(e,t,n){for(var i=[e],o,u=e,l;i.length;)if(o=i.shift(),l=this.walk(o,c=>{var d,m,g,E,b;if(b=Xm(c),this.horizontal&&this.direction==="ltr"){if(d=Math.round(b.left),m=Math.round(b.right),d>n&&u)return u;if(m>n)return c;u=c,i.push(c)}else if(this.horizontal&&this.direction==="rtl"){if(d=Math.round(this.horizontal?b.left:b.top),m=Math.round(this.horizontal?b.right:b.bottom),m<t&&u)return u;if(d<t)return c;u=c,i.push(c)}else{if(g=Math.round(b.top),E=Math.round(b.bottom),g>n&&u)return u;if(E>n)return c;u=c,i.push(c)}}),l)return this.findTextEndRange(l,t,n);return this.findTextEndRange(u,t,n)}findTextStartRange(e,t,n){for(var i=this.splitTextNodeIntoRanges(e),o,u,l,c,d,m=0;m<i.length;m++)if(o=i[m],u=o.getBoundingClientRect(),this.horizontal&&this.direction==="ltr"){if(l=u.left,l>=t)return o}else if(this.horizontal&&this.direction==="rtl"){if(d=u.right,d<=n)return o}else if(c=u.top,c>=t)return o;return i[0]}findTextEndRange(e,t,n){for(var i=this.splitTextNodeIntoRanges(e),o,u,l,c,d,m,g,E=0;E<i.length;E++){if(u=i[E],l=u.getBoundingClientRect(),this.horizontal&&this.direction==="ltr"){if(c=l.left,d=l.right,c>n&&o)return o;if(d>n)return u}else if(this.horizontal&&this.direction==="rtl"){if(c=l.left,d=l.right,d<t&&o)return o;if(c<t)return u}else{if(m=l.top,g=l.bottom,m>n&&o)return o;if(g>n)return u}o=u}return i[i.length-1]}splitTextNodeIntoRanges(e,t){var n=[],i=e.textContent||"",o=i.trim(),u,l=e.ownerDocument,c=t||" ",d=o.indexOf(c);if(d===-1||e.nodeType!=Node.TEXT_NODE)return u=l.createRange(),u.selectNodeContents(e),[u];for(u=l.createRange(),u.setStart(e,0),u.setEnd(e,d),n.push(u),u=!1;d!=-1;)d=o.indexOf(c,d+1),d>0&&(u&&(u.setEnd(e,d),n.push(u)),u=l.createRange(),u.setStart(e,d+1));return u&&(u.setEnd(e,o.length),n.push(u)),n}rangePairToCfiPair(e,t){var n=t.start,i=t.end;n.collapse(!0),i.collapse(!1);let o=new Ut(n,e).toString(),u=new Ut(i,e).toString();return{start:o,end:u}}rangeListToCfiList(e,t){for(var n=[],i,o=0;o<t.length;o++)i=this.rangePairToCfiPair(e,t[o]),n.push(i);return n}axis(e){return e&&(this.horizontal=e==="horizontal"),this.horizontal}}const h1=typeof navigator<"u",tI=h1&&/Chrome/.test(navigator.userAgent),hw=h1&&!tI&&/AppleWebKit/.test(navigator.userAgent),nI=1;class Xg{constructor(e,t,n,i){this.epubcfi=new Ut,this.document=e,this.documentElement=this.document.documentElement,this.content=t||this.document.body,this.window=this.document.defaultView,this._size={width:0,height:0},this.sectionIndex=i||0,this.cfiBase=n||"",this.epubReadingSystem("epub.js",Fd),this.called=0,this.active=!0,this.listeners()}static get listenedEvents(){return Mh}width(e){var t=this.content;return e&&Dn(e)&&(e=e+"px"),e&&(t.style.width=e),parseInt(this.window.getComputedStyle(t).width)}height(e){var t=this.content;return e&&Dn(e)&&(e=e+"px"),e&&(t.style.height=e),parseInt(this.window.getComputedStyle(t).height)}contentWidth(e){var t=this.content||this.document.body;return e&&Dn(e)&&(e=e+"px"),e&&(t.style.width=e),parseInt(this.window.getComputedStyle(t).width)}contentHeight(e){var t=this.content||this.document.body;return e&&Dn(e)&&(e=e+"px"),e&&(t.style.height=e),parseInt(this.window.getComputedStyle(t).height)}textWidth(){let e,t,n=this.document.createRange(),i=this.content||this.document.body,o=Jh(i);return n.selectNodeContents(i),e=n.getBoundingClientRect(),t=e.width,o&&o.width&&(t+=o.width),Math.round(t)}textHeight(){let e,t,n=this.document.createRange(),i=this.content||this.document.body;return n.selectNodeContents(i),e=n.getBoundingClientRect(),t=e.bottom,Math.round(t)}scrollWidth(){var e=this.documentElement.scrollWidth;return e}scrollHeight(){var e=this.documentElement.scrollHeight;return e}overflow(e){return e&&(this.documentElement.style.overflow=e),this.window.getComputedStyle(this.documentElement).overflow}overflowX(e){return e&&(this.documentElement.style.overflowX=e),this.window.getComputedStyle(this.documentElement).overflowX}overflowY(e){return e&&(this.documentElement.style.overflowY=e),this.window.getComputedStyle(this.documentElement).overflowY}css(e,t,n){var i=this.content||this.document.body;return t?i.style.setProperty(e,t,n?"important":""):i.style.removeProperty(e),this.window.getComputedStyle(i)[e]}viewport(e){var t=this.document.querySelector("meta[name='viewport']"),n={width:void 0,height:void 0,scale:void 0,minimum:void 0,maximum:void 0,scalable:void 0},i=[],o={};if(t&&t.hasAttribute("content")){let u=t.getAttribute("content"),l=u.match(/width\s*=\s*([^,]*)/),c=u.match(/height\s*=\s*([^,]*)/),d=u.match(/initial-scale\s*=\s*([^,]*)/),m=u.match(/minimum-scale\s*=\s*([^,]*)/),g=u.match(/maximum-scale\s*=\s*([^,]*)/),E=u.match(/user-scalable\s*=\s*([^,]*)/);l&&l.length&&typeof l[1]<"u"&&(n.width=l[1]),c&&c.length&&typeof c[1]<"u"&&(n.height=c[1]),d&&d.length&&typeof d[1]<"u"&&(n.scale=d[1]),m&&m.length&&typeof m[1]<"u"&&(n.minimum=m[1]),g&&g.length&&typeof g[1]<"u"&&(n.maximum=g[1]),E&&E.length&&typeof E[1]<"u"&&(n.scalable=E[1])}return o=e1(e||{},n),e&&(o.width&&i.push("width="+o.width),o.height&&i.push("height="+o.height),o.scale&&i.push("initial-scale="+o.scale),o.scalable==="no"?(i.push("minimum-scale="+o.scale),i.push("maximum-scale="+o.scale),i.push("user-scalable="+o.scalable)):(o.scalable&&i.push("user-scalable="+o.scalable),o.minimum&&i.push("minimum-scale="+o.minimum),o.maximum&&i.push("minimum-scale="+o.maximum)),t||(t=this.document.createElement("meta"),t.setAttribute("name","viewport"),this.document.querySelector("head").appendChild(t)),t.setAttribute("content",i.join(", ")),this.window.scrollTo(0,0)),o}expand(){this.emit(Ye.CONTENTS.EXPAND)}listeners(){this.imageLoadListeners(),this.mediaQueryListeners(),this.addEventListeners(),this.addSelectionListeners(),typeof ResizeObserver>"u"?(this.resizeListeners(),this.visibilityListeners()):this.resizeObservers(),this.linksHandler()}removeListeners(){this.removeEventListeners(),this.removeSelectionListeners(),this.observer&&this.observer.disconnect(),clearTimeout(this.expanding)}resizeCheck(){let e=this.textWidth(),t=this.textHeight();(e!=this._size.width||t!=this._size.height)&&(this._size={width:e,height:t},this.onResize&&this.onResize(this._size),this.emit(Ye.CONTENTS.RESIZE,this._size))}resizeListeners(){clearTimeout(this.expanding),requestAnimationFrame(this.resizeCheck.bind(this)),this.expanding=setTimeout(this.resizeListeners.bind(this),350)}visibilityListeners(){document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&this.active===!1?(this.active=!0,this.resizeListeners()):(this.active=!1,clearTimeout(this.expanding))})}transitionListeners(){let e=this.content;e.style.transitionProperty="font, font-size, font-size-adjust, font-stretch, font-variation-settings, font-weight, width, height",e.style.transitionDuration="0.001ms",e.style.transitionTimingFunction="linear",e.style.transitionDelay="0",this._resizeCheck=this.resizeCheck.bind(this),this.document.addEventListener("transitionend",this._resizeCheck)}mediaQueryListeners(){for(var e=this.document.styleSheets,t=(function(l){l.matches&&!this._expanding&&setTimeout(this.expand.bind(this),1)}).bind(this),n=0;n<e.length;n+=1){var i;try{i=e[n].cssRules}catch{return}if(!i)return;for(var o=0;o<i.length;o+=1)if(i[o].media){var u=this.window.matchMedia(i[o].media.mediaText);u.addListener(t)}}}resizeObservers(){this.observer=new ResizeObserver(e=>{requestAnimationFrame(this.resizeCheck.bind(this))}),this.observer.observe(this.document.documentElement)}mutationObservers(){this.observer=new MutationObserver(t=>{this.resizeCheck()});let e={attributes:!0,childList:!0,characterData:!0,subtree:!0};this.observer.observe(this.document,e)}imageLoadListeners(){for(var e=this.document.querySelectorAll("img"),t,n=0;n<e.length;n++)t=e[n],typeof t.naturalWidth<"u"&&t.naturalWidth===0&&(t.onload=this.expand.bind(this))}fontLoadListeners(){!this.document||!this.document.fonts||this.document.fonts.ready.then((function(){this.resizeCheck()}).bind(this))}root(){return this.document?this.document.documentElement:null}locationOf(e,t){var n,i={left:0,top:0};if(!this.document)return i;if(this.epubcfi.isCfiString(e)){let o=new Ut(e).toRange(this.document,t);if(o){try{if(!o.endContainer||o.startContainer==o.endContainer&&o.startOffset==o.endOffset){let u=o.startContainer.textContent.indexOf(" ",o.startOffset);u==-1&&(u=o.startContainer.textContent.length),o.setEnd(o.startContainer,u)}}catch(u){console.error("setting end offset to start container length failed",u)}if(o.startContainer.nodeType===Node.ELEMENT_NODE)n=o.startContainer.getBoundingClientRect(),i.left=n.left,i.top=n.top;else if(hw){let u=o.startContainer,l=new Range;try{u.nodeType===nI?n=u.getBoundingClientRect():o.startOffset+2<u.length?(l.setStart(u,o.startOffset),l.setEnd(u,o.startOffset+2),n=l.getBoundingClientRect()):o.startOffset-2>0?(l.setStart(u,o.startOffset-2),l.setEnd(u,o.startOffset),n=l.getBoundingClientRect()):n=u.parentNode.getBoundingClientRect()}catch(c){console.error(c,c.stack)}}else n=o.getBoundingClientRect()}}else if(typeof e=="string"&&e.indexOf("#")>-1){let o=e.substring(e.indexOf("#")+1),u=this.document.getElementById(o);if(u)if(hw){let l=new Range;l.selectNode(u),n=l.getBoundingClientRect()}else n=u.getBoundingClientRect()}return n&&(i.left=n.left,i.top=n.top),i}addStylesheet(e){return new Promise((function(t,n){var i,o=!1;if(!this.document){t(!1);return}if(i=this.document.querySelector("link[href='"+e+"']"),i){t(!0);return}i=this.document.createElement("link"),i.type="text/css",i.rel="stylesheet",i.href=e,i.onload=i.onreadystatechange=function(){!o&&(!this.readyState||this.readyState=="complete")&&(o=!0,setTimeout(()=>{t(!0)},1))},this.document.head.appendChild(i)}).bind(this))}_getStylesheetNode(e){var t;return e="epubjs-inserted-css-"+(e||""),this.document?(t=this.document.getElementById(e),t||(t=this.document.createElement("style"),t.id=e,this.document.head.appendChild(t)),t):!1}addStylesheetCss(e,t){if(!this.document||!e)return!1;var n;return n=this._getStylesheetNode(t),n.innerHTML=e,!0}addStylesheetRules(e,t){var n;if(!(!this.document||!e||e.length===0))if(n=this._getStylesheetNode(t).sheet,Object.prototype.toString.call(e)==="[object Array]")for(var i=0,o=e.length;i<o;i++){var u=1,l=e[i],c=e[i][0],d="";Object.prototype.toString.call(l[1][0])==="[object Array]"&&(l=l[1],u=0);for(var m=l.length;u<m;u++){var g=l[u];d+=g[0]+":"+g[1]+(g[2]?" !important":"")+`;
`}n.insertRule(c+"{"+d+"}",n.cssRules.length)}else Object.keys(e).forEach(b=>{const M=e[b];if(Array.isArray(M))M.forEach(D=>{const A=Object.keys(D).map(I=>`${I}:${D[I]}`).join(";");n.insertRule(`${b}{${A}}`,n.cssRules.length)});else{const w=Object.keys(M).map(A=>`${A}:${M[A]}`).join(";");n.insertRule(`${b}{${w}}`,n.cssRules.length)}})}addScript(e){return new Promise((function(t,n){var i,o=!1;if(!this.document){t(!1);return}i=this.document.createElement("script"),i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){!o&&(!this.readyState||this.readyState=="complete")&&(o=!0,setTimeout(function(){t(!0)},1))},this.document.head.appendChild(i)}).bind(this))}addClass(e){var t;this.document&&(t=this.content||this.document.body,t&&t.classList.add(e))}removeClass(e){var t;this.document&&(t=this.content||this.document.body,t&&t.classList.remove(e))}addEventListeners(){this.document&&(this._triggerEvent=this.triggerEvent.bind(this),Mh.forEach(function(e){this.document.addEventListener(e,this._triggerEvent,{passive:!0})},this))}removeEventListeners(){this.document&&(Mh.forEach(function(e){this.document.removeEventListener(e,this._triggerEvent,{passive:!0})},this),this._triggerEvent=void 0)}triggerEvent(e){this.emit(e.type,e)}addSelectionListeners(){this.document&&(this._onSelectionChange=this.onSelectionChange.bind(this),this.document.addEventListener("selectionchange",this._onSelectionChange,{passive:!0}))}removeSelectionListeners(){this.document&&(this.document.removeEventListener("selectionchange",this._onSelectionChange,{passive:!0}),this._onSelectionChange=void 0)}onSelectionChange(e){this.selectionEndTimeout&&clearTimeout(this.selectionEndTimeout),this.selectionEndTimeout=setTimeout((function(){var t=this.window.getSelection();this.triggerSelectedEvent(t)}).bind(this),250)}triggerSelectedEvent(e){var t,n;e&&e.rangeCount>0&&(t=e.getRangeAt(0),t.collapsed||(n=new Ut(t,this.cfiBase).toString(),this.emit(Ye.CONTENTS.SELECTED,n),this.emit(Ye.CONTENTS.SELECTED_RANGE,t)))}range(e,t){var n=new Ut(e);return n.toRange(this.document,t)}cfiFromRange(e,t){return new Ut(e,this.cfiBase,t).toString()}cfiFromNode(e,t){return new Ut(e,this.cfiBase,t).toString()}map(e){var t=new id(e);return t.section()}size(e,t){var n={scale:1,scalable:"no"};this.layoutStyle("scrolling"),e>=0&&(this.width(e),n.width=e,this.css("padding","0 "+e/12+"px")),t>=0&&(this.height(t),n.height=t),this.css("margin","0"),this.css("box-sizing","border-box"),this.viewport(n)}columns(e,t,n,i,o){let u=Ha("column-axis"),l=Ha("column-gap"),c=Ha("column-width"),d=Ha("column-fill"),g=this.writingMode().indexOf("vertical")===0?"vertical":"horizontal";this.layoutStyle("paginated"),o==="rtl"&&g==="horizontal"&&this.direction(o),this.width(e),this.height(t),this.viewport({width:e,height:t,scale:1,scalable:"no"}),this.css("overflow-y","hidden"),this.css("margin","0",!0),g==="vertical"?(this.css("padding-top",i/2+"px",!0),this.css("padding-bottom",i/2+"px",!0),this.css("padding-left","20px"),this.css("padding-right","20px"),this.css(u,"vertical")):(this.css("padding-top","20px"),this.css("padding-bottom","20px"),this.css("padding-left",i/2+"px",!0),this.css("padding-right",i/2+"px",!0),this.css(u,"horizontal")),this.css("box-sizing","border-box"),this.css("max-width","inherit"),this.css(d,"auto"),this.css(l,i+"px"),this.css(c,n+"px"),this.css("-webkit-line-box-contain","block glyphs replaced")}scaler(e,t,n){var i="scale("+e+")",o="";this.css("transform-origin","top left"),(t>=0||n>=0)&&(o=" translate("+(t||0)+"px, "+(n||0)+"px )"),this.css("transform",i+o)}fit(e,t,n){var i=this.viewport(),o=parseInt(i.width),u=parseInt(i.height),l=e/o,c=t/u,d=l<c?l:c;if(this.layoutStyle("paginated"),this.width(o),this.height(u),this.overflow("hidden"),this.scaler(d,0,0),this.css("background-size",o*d+"px "+u*d+"px"),this.css("background-color","transparent"),n&&n.properties.includes("page-spread-left")){var m=e-o*d;this.css("margin-left",m+"px")}}direction(e){this.documentElement&&(this.documentElement.style.direction=e)}mapPage(e,t,n,i,o){var u=new id(t,o);return u.page(this,e,n,i)}linksHandler(){HS(this.content,e=>{this.emit(Ye.CONTENTS.LINK_CLICKED,e)})}writingMode(e){let t=Ha("writing-mode");return e&&this.documentElement&&(this.documentElement.style[t]=e),this.window.getComputedStyle(this.documentElement)[t]||""}layoutStyle(e){return e&&(this._layoutStyle=e,navigator.epubReadingSystem.layoutStyle=this._layoutStyle),this._layoutStyle||"paginated"}epubReadingSystem(e,t){return navigator.epubReadingSystem={name:e,version:t,layoutStyle:this.layoutStyle(),hasFeature:function(n){switch(n){case"dom-manipulation":return!0;case"layout-changes":return!0;case"touch-events":return!0;case"mouse-events":return!0;case"keyboard-events":return!0;case"spine-scripting":return!1;default:return!1}}},navigator.epubReadingSystem}destroy(){this.removeListeners()}}Hi(Xg.prototype);class rI{constructor(e){this.rendition=e,this.highlights=[],this.underlines=[],this.marks=[],this._annotations={},this._annotationsBySectionIndex={},this.rendition.hooks.render.register(this.inject.bind(this)),this.rendition.hooks.unloaded.register(this.clear.bind(this))}add(e,t,n,i,o,u){let l=encodeURI(t+e),d=new Ut(t).spinePos,m=new d1({type:e,cfiRange:t,data:n,sectionIndex:d,cb:i,className:o,styles:u});return this._annotations[l]=m,d in this._annotationsBySectionIndex?this._annotationsBySectionIndex[d].push(l):this._annotationsBySectionIndex[d]=[l],this.rendition.views().forEach(E=>{m.sectionIndex===E.index&&m.attach(E)}),m}remove(e,t){let n=encodeURI(e+t);if(n in this._annotations){let i=this._annotations[n];if(t&&i.type!==t)return;this.rendition.views().forEach(u=>{this._removeFromAnnotationBySectionIndex(i.sectionIndex,n),i.sectionIndex===u.index&&i.detach(u)}),delete this._annotations[n]}}_removeFromAnnotationBySectionIndex(e,t){this._annotationsBySectionIndex[e]=this._annotationsAt(e).filter(n=>n!==t)}_annotationsAt(e){return this._annotationsBySectionIndex[e]}highlight(e,t,n,i,o){return this.add("highlight",e,t,n,i,o)}underline(e,t,n,i,o){return this.add("underline",e,t,n,i,o)}mark(e,t,n){return this.add("mark",e,t,n)}each(){return this._annotations.forEach.apply(this._annotations,arguments)}inject(e){let t=e.index;t in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[t].forEach(i=>{this._annotations[i].attach(e)})}clear(e){let t=e.index;t in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[t].forEach(i=>{this._annotations[i].detach(e)})}show(){}hide(){}}class d1{constructor({type:e,cfiRange:t,data:n,sectionIndex:i,cb:o,className:u,styles:l}){this.type=e,this.cfiRange=t,this.data=n,this.sectionIndex=i,this.mark=void 0,this.cb=o,this.className=u,this.styles=l}update(e){this.data=e}attach(e){let{cfiRange:t,data:n,type:i,mark:o,cb:u,className:l,styles:c}=this,d;return i==="highlight"?d=e.highlight(t,n,u,l,c):i==="underline"?d=e.underline(t,n,u,l,c):i==="mark"&&(d=e.mark(t,n,u)),this.mark=d,this.emit(Ye.ANNOTATION.ATTACH,d),d}detach(e){let{cfiRange:t,type:n}=this,i;return e&&(n==="highlight"?i=e.unhighlight(t):n==="underline"?i=e.ununderline(t):n==="mark"&&(i=e.unmark(t))),this.mark=void 0,this.emit(Ye.ANNOTATION.DETACH,i),i}text(){}}Hi(d1.prototype);var vi={},dl={},dw;function iI(){if(dw)return dl;dw=1,Object.defineProperty(dl,"__esModule",{value:!0}),dl.createElement=r;function r(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}return dl.default={createElement:r},dl}var Ba={},fw;function sI(){if(fw)return Ba;fw=1,Object.defineProperty(Ba,"__esModule",{value:!0}),Ba.proxyMouse=r,Ba.clone=e,Ba.default={proxyMouse:r};function r(n,i){function o(d){for(var m=i.length-1;m>=0;m--){var g=i[m],E=d.clientX,b=d.clientY;if(d.touches&&d.touches.length&&(E=d.touches[0].clientX,b=d.touches[0].clientY),!!t(g,n,E,b)){g.dispatchEvent(e(d));break}}}if(n.nodeName==="iframe"||n.nodeName==="IFRAME")try{this.target=n.contentDocument}catch{this.target=n}else this.target=n;for(var u=["mouseup","mousedown","click","touchstart"],l=0;l<u.length;l++){var c=u[l];this.target.addEventListener(c,function(d){return o(d)},!1)}}function e(n){var i=Object.assign({},n,{bubbles:!1});try{return new MouseEvent(n.type,i)}catch{var o=document.createEvent("MouseEvents");return o.initMouseEvent(n.type,!1,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget),o}}function t(n,i,o,u){var l=i.getBoundingClientRect();function c(b,M,D){var w=b.top-l.top,A=b.left-l.left,I=w+b.height,V=A+b.width;return w<=D&&A<=M&&I>D&&V>M}var d=n.getBoundingClientRect();if(!c(d,o,u))return!1;for(var m=n.getClientRects(),g=0,E=m.length;g<E;g++)if(c(m[g],o,u))return!0;return!1}return Ba}var pw;function oI(){if(pw)return vi;pw=1,Object.defineProperty(vi,"__esModule",{value:!0}),vi.Underline=vi.Highlight=vi.Mark=vi.Pane=void 0;var r=function D(w,A,I){w===null&&(w=Function.prototype);var V=Object.getOwnPropertyDescriptor(w,A);if(V===void 0){var q=Object.getPrototypeOf(w);return q===null?void 0:D(q,A,I)}else{if("value"in V)return V.value;var P=V.get;return P===void 0?void 0:P.call(I)}},e=(function(){function D(w,A){for(var I=0;I<A.length;I++){var V=A[I];V.enumerable=V.enumerable||!1,V.configurable=!0,"value"in V&&(V.writable=!0),Object.defineProperty(w,V.key,V)}}return function(w,A,I){return A&&D(w.prototype,A),I&&D(w,I),w}})(),t=iI(),n=u(t),i=sI(),o=u(i);function u(D){return D&&D.__esModule?D:{default:D}}function l(D,w){if(!D)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w&&(typeof w=="object"||typeof w=="function")?w:D}function c(D,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof w);D.prototype=Object.create(w&&w.prototype,{constructor:{value:D,enumerable:!1,writable:!0,configurable:!0}}),w&&(Object.setPrototypeOf?Object.setPrototypeOf(D,w):D.__proto__=w)}function d(D,w){if(!(D instanceof w))throw new TypeError("Cannot call a class as a function")}vi.Pane=(function(){function D(w){var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document.body;d(this,D),this.target=w,this.element=n.default.createElement("svg"),this.marks=[],this.element.style.position="absolute",this.element.setAttribute("pointer-events","none"),o.default.proxyMouse(this.target,this.marks),this.container=A,this.container.appendChild(this.element),this.render()}return e(D,[{key:"addMark",value:function(A){var I=n.default.createElement("g");return this.element.appendChild(I),A.bind(I,this.container),this.marks.push(A),A.render(),A}},{key:"removeMark",value:function(A){var I=this.marks.indexOf(A);if(I!==-1){var V=A.unbind();this.element.removeChild(V),this.marks.splice(I,1)}}},{key:"render",value:function(){b(this.element,E(this.target,this.container));var A=!0,I=!1,V=void 0;try{for(var q=this.marks[Symbol.iterator](),P;!(A=(P=q.next()).done);A=!0){var U=P.value;U.render()}}catch(R){I=!0,V=R}finally{try{!A&&q.return&&q.return()}finally{if(I)throw V}}}}]),D})();var m=vi.Mark=(function(){function D(){d(this,D),this.element=null}return e(D,[{key:"bind",value:function(A,I){this.element=A,this.container=I}},{key:"unbind",value:function(){var A=this.element;return this.element=null,A}},{key:"render",value:function(){}},{key:"dispatchEvent",value:function(A){this.element&&this.element.dispatchEvent(A)}},{key:"getBoundingClientRect",value:function(){return this.element.getBoundingClientRect()}},{key:"getClientRects",value:function(){for(var A=[],I=this.element.firstChild;I;)A.push(I.getBoundingClientRect()),I=I.nextSibling;return A}},{key:"filteredRanges",value:function(){var A=Array.from(this.range.getClientRects());return A.filter(function(I){for(var V=0;V<A.length;V++){if(A[V]===I)return!0;var q=M(A[V],I);if(q)return!1}return!0})}}]),D})(),g=vi.Highlight=(function(D){c(w,D);function w(A,I,V,q){d(this,w);var P=l(this,(w.__proto__||Object.getPrototypeOf(w)).call(this));return P.range=A,P.className=I,P.data=V||{},P.attributes=q||{},P}return e(w,[{key:"bind",value:function(I,V){r(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"bind",this).call(this,I,V);for(var q in this.data)this.data.hasOwnProperty(q)&&(this.element.dataset[q]=this.data[q]);for(var q in this.attributes)this.attributes.hasOwnProperty(q)&&this.element.setAttribute(q,this.attributes[q]);this.className&&this.element.classList.add(this.className)}},{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var I=this.element.ownerDocument.createDocumentFragment(),V=this.filteredRanges(),q=this.element.getBoundingClientRect(),P=this.container.getBoundingClientRect(),U=0,R=V.length;U<R;U++){var S=V[U],C=n.default.createElement("rect");C.setAttribute("x",S.left-q.left+P.left),C.setAttribute("y",S.top-q.top+P.top),C.setAttribute("height",S.height),C.setAttribute("width",S.width),I.appendChild(C)}this.element.appendChild(I)}}]),w})(m);vi.Underline=(function(D){c(w,D);function w(A,I,V,q){return d(this,w),l(this,(w.__proto__||Object.getPrototypeOf(w)).call(this,A,I,V,q))}return e(w,[{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var I=this.element.ownerDocument.createDocumentFragment(),V=this.filteredRanges(),q=this.element.getBoundingClientRect(),P=this.container.getBoundingClientRect(),U=0,R=V.length;U<R;U++){var S=V[U],C=n.default.createElement("rect");C.setAttribute("x",S.left-q.left+P.left),C.setAttribute("y",S.top-q.top+P.top),C.setAttribute("height",S.height),C.setAttribute("width",S.width),C.setAttribute("fill","none");var N=n.default.createElement("line");N.setAttribute("x1",S.left-q.left+P.left),N.setAttribute("x2",S.left-q.left+P.left+S.width),N.setAttribute("y1",S.top-q.top+P.top+S.height-1),N.setAttribute("y2",S.top-q.top+P.top+S.height-1),N.setAttribute("stroke-width",1),N.setAttribute("stroke","black"),N.setAttribute("stroke-linecap","square"),I.appendChild(C),I.appendChild(N)}this.element.appendChild(I)}}]),w})(g);function E(D,w){var A=w.getBoundingClientRect(),I=D.getBoundingClientRect();return{top:I.top-A.top,left:I.left-A.left,height:D.scrollHeight,width:D.scrollWidth}}function b(D,w){D.style.setProperty("top",w.top+"px","important"),D.style.setProperty("left",w.left+"px","important"),D.style.setProperty("height",w.height+"px","important"),D.style.setProperty("width",w.width+"px","important")}function M(D,w){return w.right<=D.right&&w.left>=D.left&&w.top>=D.top&&w.bottom<=D.bottom}return vi}var Ah=oI();class f1{constructor(e,t){this.settings=ar({ignoreClass:"",axis:void 0,direction:void 0,width:0,height:0,layout:void 0,globalLayoutProperties:{},method:void 0,forceRight:!1,allowScriptedContent:!1,allowPopups:!1},t||{}),this.id="epubjs-view-"+Vd(),this.section=e,this.index=e.index,this.element=this.container(this.settings.axis),this.added=!1,this.displayed=!1,this.rendered=!1,this.fixedWidth=0,this.fixedHeight=0,this.epubcfi=new Ut,this.layout=this.settings.layout,this.pane=void 0,this.highlights={},this.underlines={},this.marks={}}container(e){var t=document.createElement("div");return t.classList.add("epub-view"),t.style.height="0px",t.style.width="0px",t.style.overflow="hidden",t.style.position="relative",t.style.display="block",e&&e=="horizontal"?t.style.flex="none":t.style.flex="initial",t}create(){return this.iframe?this.iframe:(this.element||(this.element=this.createContainer()),this.iframe=document.createElement("iframe"),this.iframe.id=this.id,this.iframe.scrolling="no",this.iframe.style.overflow="hidden",this.iframe.seamless="seamless",this.iframe.style.border="none",this.iframe.sandbox="allow-same-origin",this.settings.allowScriptedContent&&(this.iframe.sandbox+=" allow-scripts"),this.settings.allowPopups&&(this.iframe.sandbox+=" allow-popups"),this.iframe.setAttribute("enable-annotation","true"),this.resizing=!0,this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this.element.setAttribute("ref",this.index),this.added=!0,this.elementBounds=Fh(this.element),"srcdoc"in this.iframe?this.supportsSrcdoc=!0:this.supportsSrcdoc=!1,this.settings.method||(this.settings.method=this.supportsSrcdoc?"srcdoc":"write"),this.iframe)}render(e,t){return this.create(),this.size(),this.sectionRender||(this.sectionRender=this.section.render(e)),this.sectionRender.then((function(n){return this.load(n)}).bind(this)).then((function(){let n=this.contents.writingMode(),i;return this.settings.flow==="scrolled"?i=n.indexOf("vertical")===0?"horizontal":"vertical":i=n.indexOf("vertical")===0?"vertical":"horizontal",n.indexOf("vertical")===0&&this.settings.flow==="paginated"&&(this.layout.delta=this.layout.height),this.setAxis(i),this.emit(Ye.VIEWS.AXIS,i),this.setWritingMode(n),this.emit(Ye.VIEWS.WRITING_MODE,n),this.layout.format(this.contents,this.section,this.axis),this.addListeners(),new Promise((o,u)=>{this.expand(),this.settings.forceRight&&(this.element.style.marginLeft=this.width()+"px"),o()})}).bind(this),(function(n){return this.emit(Ye.VIEWS.LOAD_ERROR,n),new Promise((i,o)=>{o(n)})}).bind(this)).then((function(){this.emit(Ye.VIEWS.RENDERED,this.section)}).bind(this))}reset(){this.iframe&&(this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this._textWidth=void 0,this._contentWidth=void 0,this._textHeight=void 0,this._contentHeight=void 0),this._needsReframe=!0}size(e,t){var n=e||this.settings.width,i=t||this.settings.height;this.layout.name==="pre-paginated"?this.lock("both",n,i):this.settings.axis==="horizontal"?this.lock("height",n,i):this.lock("width",n,i),this.settings.width=n,this.settings.height=i}lock(e,t,n){var i=Jh(this.element),o;this.iframe?o=Jh(this.iframe):o={width:0,height:0},e=="width"&&Dn(t)&&(this.lockedWidth=t-i.width-o.width),e=="height"&&Dn(n)&&(this.lockedHeight=n-i.height-o.height),e==="both"&&Dn(t)&&Dn(n)&&(this.lockedWidth=t-i.width-o.width,this.lockedHeight=n-i.height-o.height),this.displayed&&this.iframe&&this.expand()}expand(e){var t=this.lockedWidth,n=this.lockedHeight,i;!this.iframe||this._expanding||(this._expanding=!0,this.layout.name==="pre-paginated"?(t=this.layout.columnWidth,n=this.layout.height):this.settings.axis==="horizontal"?(t=this.contents.textWidth(),t%this.layout.pageWidth>0&&(t=Math.ceil(t/this.layout.pageWidth)*this.layout.pageWidth),this.settings.forceEvenPages&&(i=t/this.layout.pageWidth,this.layout.divisor>1&&this.layout.name==="reflowable"&&i%2>0&&(t+=this.layout.pageWidth))):this.settings.axis==="vertical"&&(n=this.contents.textHeight(),this.settings.flow==="paginated"&&n%this.layout.height>0&&(n=Math.ceil(n/this.layout.height)*this.layout.height)),(this._needsReframe||t!=this._width||n!=this._height)&&this.reframe(t,n),this._expanding=!1)}reframe(e,t){var n;Dn(e)&&(this.element.style.width=e+"px",this.iframe.style.width=e+"px",this._width=e),Dn(t)&&(this.element.style.height=t+"px",this.iframe.style.height=t+"px",this._height=t);let i=this.prevBounds?e-this.prevBounds.width:e,o=this.prevBounds?t-this.prevBounds.height:t;n={width:e,height:t,widthDelta:i,heightDelta:o},this.pane&&this.pane.render(),requestAnimationFrame(()=>{let u;for(let l in this.marks)this.marks.hasOwnProperty(l)&&(u=this.marks[l],this.placeMark(u.element,u.range))}),this.onResize(this,n),this.emit(Ye.VIEWS.RESIZED,n),this.prevBounds=n,this.elementBounds=Fh(this.element)}load(e){var t=new zt,n=t.promise;if(!this.iframe)return t.reject(new Error("No Iframe Available")),n;if(this.iframe.onload=(function(o){this.onLoad(o,t)}).bind(this),this.settings.method==="blobUrl")this.blobUrl=td(e,"application/xhtml+xml"),this.iframe.src=this.blobUrl,this.element.appendChild(this.iframe);else if(this.settings.method==="srcdoc")this.iframe.srcdoc=e,this.element.appendChild(this.iframe);else{if(this.element.appendChild(this.iframe),this.document=this.iframe.contentDocument,!this.document)return t.reject(new Error("No Document Available")),n;if(this.iframe.contentDocument.open(),window.MSApp&&MSApp.execUnsafeLocalFunction){var i=this;MSApp.execUnsafeLocalFunction(function(){i.iframe.contentDocument.write(e)})}else this.iframe.contentDocument.write(e);this.iframe.contentDocument.close()}return n}onLoad(e,t){this.window=this.iframe.contentWindow,this.document=this.iframe.contentDocument,this.contents=new Xg(this.document,this.document.body,this.section.cfiBase,this.section.index),this.rendering=!1;var n=this.document.querySelector("link[rel='canonical']");n?n.setAttribute("href",this.section.canonical):(n=this.document.createElement("link"),n.setAttribute("rel","canonical"),n.setAttribute("href",this.section.canonical),this.document.querySelector("head").appendChild(n)),this.contents.on(Ye.CONTENTS.EXPAND,()=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents))}),this.contents.on(Ye.CONTENTS.RESIZE,i=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents))}),t.resolve(this.contents)}setLayout(e){this.layout=e,this.contents&&(this.layout.format(this.contents),this.expand())}setAxis(e){this.settings.axis=e,e=="horizontal"?this.element.style.flex="none":this.element.style.flex="initial",this.size()}setWritingMode(e){this.writingMode=e}addListeners(){}removeListeners(e){}display(e){var t=new zt;return this.displayed?t.resolve(this):this.render(e).then((function(){this.emit(Ye.VIEWS.DISPLAYED,this),this.onDisplayed(this),this.displayed=!0,t.resolve(this)}).bind(this),function(n){t.reject(n,this)}),t.promise}show(){this.element.style.visibility="visible",this.iframe&&(this.iframe.style.visibility="visible",this.iframe.style.transform="translateZ(0)",this.iframe.offsetWidth,this.iframe.style.transform=null),this.emit(Ye.VIEWS.SHOWN,this)}hide(){this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.stopExpanding=!0,this.emit(Ye.VIEWS.HIDDEN,this)}offset(){return{top:this.element.offsetTop,left:this.element.offsetLeft}}width(){return this._width}height(){return this._height}position(){return this.element.getBoundingClientRect()}locationOf(e){this.iframe.getBoundingClientRect();var t=this.contents.locationOf(e,this.settings.ignoreClass);return{left:t.left,top:t.top}}onDisplayed(e){}onResize(e,t){}bounds(e){return(e||!this.elementBounds)&&(this.elementBounds=Fh(this.element)),this.elementBounds}highlight(e,t={},n,i="epubjs-hl",o={}){if(!this.contents)return;const u=Object.assign({fill:"yellow","fill-opacity":"0.3","mix-blend-mode":"multiply"},o);let l=this.contents.range(e),c=()=>{this.emit(Ye.VIEWS.MARK_CLICKED,e,t)};t.epubcfi=e,this.pane||(this.pane=new Ah.Pane(this.iframe,this.element));let d=new Ah.Highlight(l,i,t,u),m=this.pane.addMark(d);return this.highlights[e]={mark:m,element:m.element,listeners:[c,n]},m.element.setAttribute("ref",i),m.element.addEventListener("click",c),m.element.addEventListener("touchstart",c),n&&(m.element.addEventListener("click",n),m.element.addEventListener("touchstart",n)),m}underline(e,t={},n,i="epubjs-ul",o={}){if(!this.contents)return;const u=Object.assign({stroke:"black","stroke-opacity":"0.3","mix-blend-mode":"multiply"},o);let l=this.contents.range(e),c=()=>{this.emit(Ye.VIEWS.MARK_CLICKED,e,t)};t.epubcfi=e,this.pane||(this.pane=new Ah.Pane(this.iframe,this.element));let d=new Ah.Underline(l,i,t,u),m=this.pane.addMark(d);return this.underlines[e]={mark:m,element:m.element,listeners:[c,n]},m.element.setAttribute("ref",i),m.element.addEventListener("click",c),m.element.addEventListener("touchstart",c),n&&(m.element.addEventListener("click",n),m.element.addEventListener("touchstart",n)),m}mark(e,t={},n){if(!this.contents)return;if(e in this.marks)return this.marks[e];let i=this.contents.range(e);if(!i)return;let o=i.commonAncestorContainer,u=o.nodeType===1?o:o.parentNode,l=d=>{this.emit(Ye.VIEWS.MARK_CLICKED,e,t)};i.collapsed&&o.nodeType===1?(i=new Range,i.selectNodeContents(o)):i.collapsed&&(i=new Range,i.selectNodeContents(u));let c=this.document.createElement("a");return c.setAttribute("ref","epubjs-mk"),c.style.position="absolute",c.dataset.epubcfi=e,t&&Object.keys(t).forEach(d=>{c.dataset[d]=t[d]}),n&&(c.addEventListener("click",n),c.addEventListener("touchstart",n)),c.addEventListener("click",l),c.addEventListener("touchstart",l),this.placeMark(c,i),this.element.appendChild(c),this.marks[e]={element:c,range:i,listeners:[l,n]},u}placeMark(e,t){let n,i,o;if(this.layout.name==="pre-paginated"||this.settings.axis!=="horizontal"){let l=t.getBoundingClientRect();n=l.top,i=l.right}else{let l=t.getClientRects(),c;for(var u=0;u!=l.length;u++)c=l[u],(!o||c.left<o)&&(o=c.left,i=Math.ceil(o/this.layout.props.pageWidth)*this.layout.props.pageWidth-this.layout.gap/2,n=c.top)}e.style.top=`${n}px`,e.style.left=`${i}px`}unhighlight(e){let t;e in this.highlights&&(t=this.highlights[e],this.pane.removeMark(t.mark),t.listeners.forEach(n=>{n&&(t.element.removeEventListener("click",n),t.element.removeEventListener("touchstart",n))}),delete this.highlights[e])}ununderline(e){let t;e in this.underlines&&(t=this.underlines[e],this.pane.removeMark(t.mark),t.listeners.forEach(n=>{n&&(t.element.removeEventListener("click",n),t.element.removeEventListener("touchstart",n))}),delete this.underlines[e])}unmark(e){let t;e in this.marks&&(t=this.marks[e],this.element.removeChild(t.element),t.listeners.forEach(n=>{n&&(t.element.removeEventListener("click",n),t.element.removeEventListener("touchstart",n))}),delete this.marks[e])}destroy(){for(let e in this.highlights)this.unhighlight(e);for(let e in this.underlines)this.ununderline(e);for(let e in this.marks)this.unmark(e);this.blobUrl&&r1(this.blobUrl),this.displayed&&(this.displayed=!1,this.removeListeners(),this.contents.destroy(),this.stopExpanding=!0,this.element.removeChild(this.iframe),this.pane&&(this.pane.element.remove(),this.pane=void 0),this.iframe=void 0,this.contents=void 0,this._textWidth=null,this._textHeight=null,this._width=null,this._height=null)}}Hi(f1.prototype);function aI(){var r="reverse",e=uI();return document.body.appendChild(e),e.scrollLeft>0?r="default":typeof Element<"u"&&Element.prototype.scrollIntoView?(e.children[0].children[1].scrollIntoView(),e.scrollLeft<0&&(r="negative")):(e.scrollLeft=1,e.scrollLeft===0&&(r="negative")),document.body.removeChild(e),r}function uI(){var r=document.createElement("div");r.dir="rtl",r.style.position="fixed",r.style.width="1px",r.style.height="1px",r.style.top="0px",r.style.left="0px",r.style.overflow="hidden";var e=document.createElement("div");e.style.width="2px";var t=document.createElement("span");t.style.width="1px",t.style.display="inline-block";var n=document.createElement("span");return n.style.width="1px",n.style.display="inline-block",e.appendChild(t),e.appendChild(n),r.appendChild(e),r}var lm,mw;function Zg(){if(mw)return lm;mw=1;function r(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}return lm=r,lm}var cm,gw;function lI(){if(gw)return cm;gw=1;var r=typeof ai=="object"&&ai&&ai.Object===Object&&ai;return cm=r,cm}var hm,vw;function p1(){if(vw)return hm;vw=1;var r=lI(),e=typeof self=="object"&&self&&self.Object===Object&&self,t=r||e||Function("return this")();return hm=t,hm}var dm,yw;function cI(){if(yw)return dm;yw=1;var r=p1(),e=function(){return r.Date.now()};return dm=e,dm}var fm,_w;function hI(){if(_w)return fm;_w=1;var r=/\s/;function e(t){for(var n=t.length;n--&&r.test(t.charAt(n)););return n}return fm=e,fm}var pm,ww;function dI(){if(ww)return pm;ww=1;var r=hI(),e=/^\s+/;function t(n){return n&&n.slice(0,r(n)+1).replace(e,"")}return pm=t,pm}var mm,Ew;function m1(){if(Ew)return mm;Ew=1;var r=p1(),e=r.Symbol;return mm=e,mm}var gm,bw;function fI(){if(bw)return gm;bw=1;var r=m1(),e=Object.prototype,t=e.hasOwnProperty,n=e.toString,i=r?r.toStringTag:void 0;function o(u){var l=t.call(u,i),c=u[i];try{u[i]=void 0;var d=!0}catch{}var m=n.call(u);return d&&(l?u[i]=c:delete u[i]),m}return gm=o,gm}var vm,xw;function pI(){if(xw)return vm;xw=1;var r=Object.prototype,e=r.toString;function t(n){return e.call(n)}return vm=t,vm}var ym,Tw;function mI(){if(Tw)return ym;Tw=1;var r=m1(),e=fI(),t=pI(),n="[object Null]",i="[object Undefined]",o=r?r.toStringTag:void 0;function u(l){return l==null?l===void 0?i:n:o&&o in Object(l)?e(l):t(l)}return ym=u,ym}var _m,Aw;function gI(){if(Aw)return _m;Aw=1;function r(e){return e!=null&&typeof e=="object"}return _m=r,_m}var wm,Sw;function vI(){if(Sw)return wm;Sw=1;var r=mI(),e=gI(),t="[object Symbol]";function n(i){return typeof i=="symbol"||e(i)&&r(i)==t}return wm=n,wm}var Em,Iw;function yI(){if(Iw)return Em;Iw=1;var r=dI(),e=Zg(),t=vI(),n=NaN,i=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,u=/^0o[0-7]+$/i,l=parseInt;function c(d){if(typeof d=="number")return d;if(t(d))return n;if(e(d)){var m=typeof d.valueOf=="function"?d.valueOf():d;d=e(m)?m+"":m}if(typeof d!="string")return d===0?d:+d;d=r(d);var g=o.test(d);return g||u.test(d)?l(d.slice(2),g?2:8):i.test(d)?n:+d}return Em=c,Em}var bm,Cw;function g1(){if(Cw)return bm;Cw=1;var r=Zg(),e=cI(),t=yI(),n="Expected a function",i=Math.max,o=Math.min;function u(l,c,d){var m,g,E,b,M,D,w=0,A=!1,I=!1,V=!0;if(typeof l!="function")throw new TypeError(n);c=t(c)||0,r(d)&&(A=!!d.leading,I="maxWait"in d,E=I?i(t(d.maxWait)||0,c):E,V="trailing"in d?!!d.trailing:V);function q(L){var he=m,_e=g;return m=g=void 0,w=L,b=l.apply(_e,he),b}function P(L){return w=L,M=setTimeout(S,c),A?q(L):b}function U(L){var he=L-D,_e=L-w,De=c-he;return I?o(De,E-_e):De}function R(L){var he=L-D,_e=L-w;return D===void 0||he>=c||he<0||I&&_e>=E}function S(){var L=e();if(R(L))return C(L);M=setTimeout(S,U(L))}function C(L){return M=void 0,V&&m?q(L):(m=g=void 0,b)}function N(){M!==void 0&&clearTimeout(M),w=0,m=D=g=M=void 0}function z(){return M===void 0?b:C(e())}function j(){var L=e(),he=R(L);if(m=arguments,g=this,D=L,he){if(M===void 0)return P(D);if(I)return clearTimeout(M),M=setTimeout(S,c),q(D)}return M===void 0&&(M=setTimeout(S,c)),b}return j.cancel=N,j.flush=z,j}return bm=u,bm}var xm,Dw;function _I(){if(Dw)return xm;Dw=1;var r=g1(),e=Zg(),t="Expected a function";function n(i,o,u){var l=!0,c=!0;if(typeof i!="function")throw new TypeError(t);return e(u)&&(l="leading"in u?!!u.leading:l,c="trailing"in u?!!u.trailing:c),r(i,o,{leading:l,maxWait:o,trailing:c})}return xm=n,xm}var wI=_I();const EI=uo(wI);class bI{constructor(e){this.settings=e||{},this.id="epubjs-container-"+Vd(),this.container=this.create(this.settings),this.settings.hidden&&(this.wrapper=this.wrap(this.container))}create(e){let t=e.height,n=e.width,i=e.overflow||!1,o=e.axis||"vertical",u=e.direction;ar(this.settings,e),e.height&&Dn(e.height)&&(t=e.height+"px"),e.width&&Dn(e.width)&&(n=e.width+"px");let l=document.createElement("div");return l.id=this.id,l.classList.add("epub-container"),l.style.wordSpacing="0",l.style.lineHeight="0",l.style.verticalAlign="top",l.style.position="relative",o==="horizontal"&&(l.style.display="flex",l.style.flexDirection="row",l.style.flexWrap="nowrap"),n&&(l.style.width=n),t&&(l.style.height=t),i&&(i==="scroll"&&o==="vertical"?(l.style["overflow-y"]=i,l.style["overflow-x"]="hidden"):i==="scroll"&&o==="horizontal"?(l.style["overflow-y"]="hidden",l.style["overflow-x"]=i):l.style.overflow=i),u&&(l.dir=u,l.style.direction=u),u&&this.settings.fullsize&&(document.body.style.direction=u),l}wrap(e){var t=document.createElement("div");return t.style.visibility="hidden",t.style.overflow="hidden",t.style.width="0",t.style.height="0",t.appendChild(e),t}getElement(e){var t;if(ZE(e)?t=e:typeof e=="string"&&(t=document.getElementById(e)),!t)throw new Error("Not an Element");return t}attachTo(e){var t=this.getElement(e),n;if(t)return this.settings.hidden?n=this.wrapper:n=this.container,t.appendChild(n),this.element=t,t}getContainer(){return this.container}onResize(e){(!Dn(this.settings.width)||!Dn(this.settings.height))&&(this.resizeFunc=EI(e,50),window.addEventListener("resize",this.resizeFunc,!1))}onOrientationChange(e){this.orientationChangeFunc=e,window.addEventListener("orientationchange",this.orientationChangeFunc,!1)}size(e,t){var n;let i=e||this.settings.width,o=t||this.settings.height;e===null?(n=this.element.getBoundingClientRect(),n.width&&(e=Math.floor(n.width),this.container.style.width=e+"px")):Dn(e)?this.container.style.width=e+"px":this.container.style.width=e,t===null?(n=n||this.element.getBoundingClientRect(),n.height&&(t=n.height,this.container.style.height=t+"px")):Dn(t)?this.container.style.height=t+"px":this.container.style.height=t,Dn(e)||(e=this.container.clientWidth),Dn(t)||(t=this.container.clientHeight),this.containerStyles=window.getComputedStyle(this.container),this.containerPadding={left:parseFloat(this.containerStyles["padding-left"])||0,right:parseFloat(this.containerStyles["padding-right"])||0,top:parseFloat(this.containerStyles["padding-top"])||0,bottom:parseFloat(this.containerStyles["padding-bottom"])||0};let u=ed(),l=window.getComputedStyle(document.body),c={left:parseFloat(l["padding-left"])||0,right:parseFloat(l["padding-right"])||0,top:parseFloat(l["padding-top"])||0,bottom:parseFloat(l["padding-bottom"])||0};return i||(e=u.width-c.left-c.right),(this.settings.fullsize&&!o||!o)&&(t=u.height-c.top-c.bottom),{width:e-this.containerPadding.left-this.containerPadding.right,height:t-this.containerPadding.top-this.containerPadding.bottom}}bounds(){let e;return this.container.style.overflow!=="visible"&&(e=this.container&&this.container.getBoundingClientRect()),!e||!e.width||!e.height?ed():e}getSheet(){var e=document.createElement("style");return e.appendChild(document.createTextNode("")),document.head.appendChild(e),e.sheet}addStyleRules(e,t){var n="#"+this.id+" ",i="";this.sheet||(this.sheet=this.getSheet()),t.forEach(function(o){for(var u in o)o.hasOwnProperty(u)&&(i+=u+":"+o[u]+";")}),this.sheet.insertRule(n+e+" {"+i+"}",0)}axis(e){e==="horizontal"?(this.container.style.display="flex",this.container.style.flexDirection="row",this.container.style.flexWrap="nowrap"):this.container.style.display="block",this.settings.axis=e}direction(e){this.container&&(this.container.dir=e,this.container.style.direction=e),this.settings.fullsize&&(document.body.style.direction=e),this.settings.dir=e}overflow(e){this.container&&(e==="scroll"&&this.settings.axis==="vertical"?(this.container.style["overflow-y"]=e,this.container.style["overflow-x"]="hidden"):e==="scroll"&&this.settings.axis==="horizontal"?(this.container.style["overflow-y"]="hidden",this.container.style["overflow-x"]=e):this.container.style.overflow=e),this.settings.overflow=e}destroy(){this.element&&(this.settings.hidden?this.wrapper:this.container,this.element.contains(this.container)&&this.element.removeChild(this.container),window.removeEventListener("resize",this.resizeFunc),window.removeEventListener("orientationChange",this.orientationChangeFunc))}}class xI{constructor(e){this.container=e,this._views=[],this.length=0,this.hidden=!1}all(){return this._views}first(){return this._views[0]}last(){return this._views[this._views.length-1]}indexOf(e){return this._views.indexOf(e)}slice(){return this._views.slice.apply(this._views,arguments)}get(e){return this._views[e]}append(e){return this._views.push(e),this.container&&this.container.appendChild(e.element),this.length++,e}prepend(e){return this._views.unshift(e),this.container&&this.container.insertBefore(e.element,this.container.firstChild),this.length++,e}insert(e,t){return this._views.splice(t,0,e),this.container&&(t<this.container.children.length?this.container.insertBefore(e.element,this.container.children[t]):this.container.appendChild(e.element)),this.length++,e}remove(e){var t=this._views.indexOf(e);t>-1&&this._views.splice(t,1),this.destroy(e),this.length--}destroy(e){e.displayed&&e.destroy(),this.container&&this.container.removeChild(e.element),e=null}forEach(){return this._views.forEach.apply(this._views,arguments)}clear(){var e,t=this.length;if(this.length){for(var n=0;n<t;n++)e=this._views[n],this.destroy(e);this._views=[],this.length=0}}find(e){for(var t,n=this.length,i=0;i<n;i++)if(t=this._views[i],t.displayed&&t.section.index==e.index)return t}displayed(){for(var e=[],t,n=this.length,i=0;i<n;i++)t=this._views[i],t.displayed&&e.push(t);return e}show(){for(var e,t=this.length,n=0;n<t;n++)e=this._views[n],e.displayed&&e.show();this.hidden=!1}hide(){for(var e,t=this.length,n=0;n<t;n++)e=this._views[n],e.displayed&&e.hide();this.hidden=!0}}class sd{constructor(e){this.name="default",this.optsSettings=e.settings,this.View=e.view,this.request=e.request,this.renditionQueue=e.queue,this.q=new Yg(this),this.settings=ar(this.settings||{},{infinite:!0,hidden:!1,width:void 0,height:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",ignoreClass:"",fullsize:void 0,allowScriptedContent:!1,allowPopups:!1}),ar(this.settings,e.settings||{}),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,method:this.settings.method,width:0,height:0,forceEvenPages:!0,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.rendered=!1}render(e,t){let n=e.tagName;typeof this.settings.fullsize>"u"&&n&&(n.toLowerCase()=="body"||n.toLowerCase()=="html")&&(this.settings.fullsize=!0),this.settings.fullsize&&(this.settings.overflow="visible",this.overflow=this.settings.overflow),this.settings.size=t,this.settings.rtlScrollType=aI(),this.stage=new bI({width:t.width,height:t.height,overflow:this.overflow,hidden:this.settings.hidden,axis:this.settings.axis,fullsize:this.settings.fullsize,direction:this.settings.direction}),this.stage.attachTo(e),this.container=this.stage.getContainer(),this.views=new xI(this.container),this._bounds=this.bounds(),this._stageSize=this.stage.size(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.stage.onResize(this.onResized.bind(this)),this.stage.onOrientationChange(this.onOrientationChange.bind(this)),this.addEventListeners(),this.layout&&this.updateLayout(),this.rendered=!0}addEventListeners(){var e;window.addEventListener("unload",(function(t){this.destroy()}).bind(this)),this.settings.fullsize?e=window:e=this.container,this._onScroll=this.onScroll.bind(this),e.addEventListener("scroll",this._onScroll)}removeEventListeners(){var e;this.settings.fullsize?e=window:e=this.container,e.removeEventListener("scroll",this._onScroll),this._onScroll=void 0}destroy(){clearTimeout(this.orientationTimeout),clearTimeout(this.resizeTimeout),clearTimeout(this.afterScrolled),this.clear(),this.removeEventListeners(),this.stage.destroy(),this.rendered=!1}onOrientationChange(e){let{orientation:t}=window;this.optsSettings.resizeOnOrientationChange&&this.resize(),clearTimeout(this.orientationTimeout),this.orientationTimeout=setTimeout((function(){this.orientationTimeout=void 0,this.optsSettings.resizeOnOrientationChange&&this.resize(),this.emit(Ye.MANAGERS.ORIENTATION_CHANGE,t)}).bind(this),500)}onResized(e){this.resize()}resize(e,t,n){let i=this.stage.size(e,t);if(this.winBounds=ed(),this.orientationTimeout&&this.winBounds.width===this.winBounds.height){this._stageSize=void 0;return}this._stageSize&&this._stageSize.width===i.width&&this._stageSize.height===i.height||(this._stageSize=i,this._bounds=this.bounds(),this.clear(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.updateLayout(),this.emit(Ye.MANAGERS.RESIZED,{width:this._stageSize.width,height:this._stageSize.height},n))}createView(e,t){return new this.View(e,ar(this.viewSettings,{forceRight:t}))}handleNextPrePaginated(e,t,n){let i;if(this.layout.name==="pre-paginated"&&this.layout.divisor>1){if(e||t.index===0)return;if(i=t.next(),i&&!i.properties.includes("page-spread-left"))return n.call(this,i)}}display(e,t){var n=new zt,i=n.promise;(t===e.href||Dn(t))&&(t=void 0);var o=this.views.find(e);if(o&&e&&this.layout.name!=="pre-paginated"){let l=o.offset();if(this.settings.direction==="ltr")this.scrollTo(l.left,l.top,!0);else{let c=o.width();this.scrollTo(l.left+c,l.top,!0)}if(t){let c=o.locationOf(t),d=o.width();this.moveTo(c,d)}return n.resolve(),i}this.clear();let u=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&e.properties.includes("page-spread-right")&&(u=!0),this.add(e,u).then((function(l){if(t){let c=l.locationOf(t),d=l.width();this.moveTo(c,d)}}).bind(this),l=>{n.reject(l)}).then((function(){return this.handleNextPrePaginated(u,e,this.add)}).bind(this)).then((function(){this.views.show(),n.resolve()}).bind(this)),i}afterDisplayed(e){this.emit(Ye.MANAGERS.ADDED,e)}afterResized(e){this.emit(Ye.MANAGERS.RESIZE,e.section)}moveTo(e,t){var n=0,i=0;this.isPaginated?(n=Math.floor(e.left/this.layout.delta)*this.layout.delta,n+this.layout.delta>this.container.scrollWidth&&(n=this.container.scrollWidth-this.layout.delta),i=Math.floor(e.top/this.layout.delta)*this.layout.delta,i+this.layout.delta>this.container.scrollHeight&&(i=this.container.scrollHeight-this.layout.delta)):i=e.top,this.settings.direction==="rtl"&&(n=n+this.layout.delta,n=n-t),this.scrollTo(n,i,!0)}add(e,t){var n=this.createView(e,t);return this.views.append(n),n.onDisplayed=this.afterDisplayed.bind(this),n.onResize=this.afterResized.bind(this),n.on(Ye.VIEWS.AXIS,i=>{this.updateAxis(i)}),n.on(Ye.VIEWS.WRITING_MODE,i=>{this.updateWritingMode(i)}),n.display(this.request)}append(e,t){var n=this.createView(e,t);return this.views.append(n),n.onDisplayed=this.afterDisplayed.bind(this),n.onResize=this.afterResized.bind(this),n.on(Ye.VIEWS.AXIS,i=>{this.updateAxis(i)}),n.on(Ye.VIEWS.WRITING_MODE,i=>{this.updateWritingMode(i)}),n.display(this.request)}prepend(e,t){var n=this.createView(e,t);return n.on(Ye.VIEWS.RESIZED,i=>{this.counter(i)}),this.views.prepend(n),n.onDisplayed=this.afterDisplayed.bind(this),n.onResize=this.afterResized.bind(this),n.on(Ye.VIEWS.AXIS,i=>{this.updateAxis(i)}),n.on(Ye.VIEWS.WRITING_MODE,i=>{this.updateWritingMode(i)}),n.display(this.request)}counter(e){this.settings.axis==="vertical"?this.scrollBy(0,e.heightDelta,!0):this.scrollBy(e.widthDelta,0,!0)}next(){var e,t;let n=this.settings.direction;if(this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"&&(!n||n==="ltr")?(this.scrollLeft=this.container.scrollLeft,t=this.container.scrollLeft+this.container.offsetWidth+this.layout.delta,t<=this.container.scrollWidth?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next()):this.isPaginated&&this.settings.axis==="horizontal"&&n==="rtl"?(this.scrollLeft=this.container.scrollLeft,this.settings.rtlScrollType==="default"?(t=this.container.scrollLeft,t>0?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next()):(t=this.container.scrollLeft+this.layout.delta*-1,t>this.container.scrollWidth*-1?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next())):this.isPaginated&&this.settings.axis==="vertical"?(this.scrollTop=this.container.scrollTop,this.container.scrollTop+this.container.offsetHeight<this.container.scrollHeight?this.scrollBy(0,this.layout.height,!0):e=this.views.last().section.next()):e=this.views.last().section.next(),e)){this.clear(),this.updateLayout();let i=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&e.properties.includes("page-spread-right")&&(i=!0),this.append(e,i).then((function(){return this.handleNextPrePaginated(i,e,this.append)}).bind(this),o=>o).then((function(){!this.isPaginated&&this.settings.axis==="horizontal"&&this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"&&this.scrollTo(this.container.scrollWidth,0,!0),this.views.show()}).bind(this))}}prev(){var e,t;let n=this.settings.direction;if(this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"&&(!n||n==="ltr")?(this.scrollLeft=this.container.scrollLeft,t=this.container.scrollLeft,t>0?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev()):this.isPaginated&&this.settings.axis==="horizontal"&&n==="rtl"?(this.scrollLeft=this.container.scrollLeft,this.settings.rtlScrollType==="default"?(t=this.container.scrollLeft+this.container.offsetWidth,t<this.container.scrollWidth?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev()):(t=this.container.scrollLeft,t<0?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev())):this.isPaginated&&this.settings.axis==="vertical"?(this.scrollTop=this.container.scrollTop,this.container.scrollTop>0?this.scrollBy(0,-this.layout.height,!0):e=this.views.first().section.prev()):e=this.views.first().section.prev(),e)){this.clear(),this.updateLayout();let i=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&typeof e.prev()!="object"&&(i=!0),this.prepend(e,i).then((function(){var o;if(this.layout.name==="pre-paginated"&&this.layout.divisor>1&&(o=e.prev(),o))return this.prepend(o)}).bind(this),o=>o).then((function(){this.isPaginated&&this.settings.axis==="horizontal"&&(this.settings.direction==="rtl"?this.settings.rtlScrollType==="default"?this.scrollTo(0,0,!0):this.scrollTo(this.container.scrollWidth*-1+this.layout.delta,0,!0):this.scrollTo(this.container.scrollWidth-this.layout.delta,0,!0)),this.views.show()}).bind(this))}}current(){var e=this.visible();return e.length?e[e.length-1]:null}clear(){this.views&&(this.views.hide(),this.scrollTo(0,0,!0),this.views.clear())}currentLocation(){return this.updateLayout(),this.isPaginated&&this.settings.axis==="horizontal"?this.location=this.paginatedLocation():this.location=this.scrolledLocation(),this.location}scrolledLocation(){let e=this.visible(),t=this.container.getBoundingClientRect(),n=t.height<window.innerHeight?t.height:window.innerHeight,i=t.width<window.innerWidth?t.width:window.innerWidth,o=this.settings.axis==="vertical";this.settings.direction;let u=0,l=0;return this.settings.fullsize&&(u=o?window.scrollY:window.scrollX),e.map(d=>{let{index:m,href:g}=d.section,E=d.position(),b=d.width(),M=d.height(),D,w,A,I;o?(D=u+t.top-E.top+l,w=D+n-l,I=this.layout.count(M,n).pages,A=n):(D=u+t.left-E.left+l,w=D+i-l,I=this.layout.count(b,i).pages,A=i);let V=Math.ceil(D/A),q=[],P=Math.ceil(w/A);if(this.settings.direction==="rtl"&&!o){let S=V;V=I-P,P=I-S}q=[];for(var U=V;U<=P;U++){let S=U+1;q.push(S)}let R=this.mapping.page(d.contents,d.section.cfiBase,D,w);return{index:m,href:g,pages:q,totalPages:I,mapping:R}})}paginatedLocation(){let e=this.visible(),t=this.container.getBoundingClientRect(),n=0,i=0;return this.settings.fullsize&&(n=window.scrollX),e.map(u=>{let{index:l,href:c}=u.section,d,m=u.position(),g=u.width(),E,b,M;this.settings.direction==="rtl"?(d=t.right-n,M=Math.min(Math.abs(d-m.left),this.layout.width)-i,b=m.width-(m.right-d)-i,E=b-M):(d=t.left+n,M=Math.min(m.right-d,this.layout.width)-i,E=d-m.left+i,b=E+M),i+=M;let D=this.mapping.page(u.contents,u.section.cfiBase,E,b),w=this.layout.count(g).pages,A=Math.floor(E/this.layout.pageWidth),I=[],V=Math.floor(b/this.layout.pageWidth);if(A<0&&(A=0,V=V+1),this.settings.direction==="rtl"){let P=A;A=w-V,V=w-P}for(var q=A+1;q<=V;q++){let P=q;I.push(P)}return{index:l,href:c,pages:I,totalPages:w,mapping:D}})}isVisible(e,t,n,i){var o=e.position(),u=i||this.bounds();return this.settings.axis==="horizontal"&&o.right>u.left-t&&o.left<u.right+n?!0:this.settings.axis==="vertical"&&o.bottom>u.top-t&&o.top<u.bottom+n}visible(){for(var e=this.bounds(),t=this.views.displayed(),n=t.length,i=[],o,u,l=0;l<n;l++)u=t[l],o=this.isVisible(u,0,0,e),o===!0&&i.push(u);return i}scrollBy(e,t,n){let i=this.settings.direction==="rtl"?-1:1;n&&(this.ignore=!0),this.settings.fullsize?window.scrollBy(e*i,t*i):(e&&(this.container.scrollLeft+=e*i),t&&(this.container.scrollTop+=t)),this.scrolled=!0}scrollTo(e,t,n){n&&(this.ignore=!0),this.settings.fullsize?window.scrollTo(e,t):(this.container.scrollLeft=e,this.container.scrollTop=t),this.scrolled=!0}onScroll(){let e,t;this.settings.fullsize?(e=window.scrollY,t=window.scrollX):(e=this.container.scrollTop,t=this.container.scrollLeft),this.scrollTop=e,this.scrollLeft=t,this.ignore?this.ignore=!1:(this.emit(Ye.MANAGERS.SCROLL,{top:e,left:t}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout((function(){this.emit(Ye.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}).bind(this),20))}bounds(){var e;return e=this.stage.bounds(),e}applyLayout(e){this.layout=e,this.updateLayout(),this.views&&this.views.length>0&&this.layout.name==="pre-paginated"&&this.display(this.views.first().section)}updateLayout(){this.stage&&(this._stageSize=this.stage.size(),this.isPaginated?(this.layout.calculate(this._stageSize.width,this._stageSize.height,this.settings.gap),this.settings.offset=this.layout.delta/this.layout.divisor):this.layout.calculate(this._stageSize.width,this._stageSize.height),this.viewSettings.width=this.layout.width,this.viewSettings.height=this.layout.height,this.setLayout(this.layout))}setLayout(e){this.viewSettings.layout=e,this.mapping=new id(e.props,this.settings.direction,this.settings.axis),this.views&&this.views.forEach(function(t){t&&t.setLayout(e)})}updateWritingMode(e){this.writingMode=e}updateAxis(e,t){!t&&e===this.settings.axis||(this.settings.axis=e,this.stage&&this.stage.axis(e),this.viewSettings.axis=e,this.mapping&&(this.mapping=new id(this.layout.props,this.settings.direction,this.settings.axis)),this.layout&&(e==="vertical"?this.layout.spread("none"):this.layout.spread(this.layout.settings.spread)))}updateFlow(e,t="auto"){let n=e==="paginated"||e==="auto";this.isPaginated=n,e==="scrolled-doc"||e==="scrolled-continuous"||e==="scrolled"?this.updateAxis("vertical"):this.updateAxis("horizontal"),this.viewSettings.flow=e,this.settings.overflow?this.overflow=this.settings.overflow:this.overflow=n?"hidden":t,this.stage&&this.stage.overflow(this.overflow),this.updateLayout()}getContents(){var e=[];return this.views&&this.views.forEach(function(t){const n=t&&t.contents;n&&e.push(n)}),e}direction(e="ltr"){this.settings.direction=e,this.stage&&this.stage.direction(e),this.viewSettings.direction=e,this.updateLayout()}isRendered(){return this.rendered}}Hi(sd.prototype);const TI={easeInCubic:function(r){return Math.pow(r,3)}};class tg{constructor(e,t){this.settings=ar({duration:80,minVelocity:.2,minDistance:10,easing:TI.easeInCubic},t||{}),this.supportsTouch=this.supportsTouch(),this.supportsTouch&&this.setup(e)}setup(e){this.manager=e,this.layout=this.manager.layout,this.fullsize=this.manager.settings.fullsize,this.fullsize?(this.element=this.manager.stage.element,this.scroller=window,this.disableScroll()):(this.element=this.manager.stage.container,this.scroller=this.element,this.element.style.WebkitOverflowScrolling="touch"),this.manager.settings.offset=this.layout.width,this.manager.settings.afterScrolledTimeout=this.settings.duration*2,this.isVertical=this.manager.settings.axis==="vertical",!(!this.manager.isPaginated||this.isVertical)&&(this.touchCanceler=!1,this.resizeCanceler=!1,this.snapping=!1,this.scrollLeft,this.scrollTop,this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0,this.addListeners())}supportsTouch(){return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)}disableScroll(){this.element.style.overflow="hidden"}enableScroll(){this.element.style.overflow=""}addListeners(){this._onResize=this.onResize.bind(this),window.addEventListener("resize",this._onResize),this._onScroll=this.onScroll.bind(this),this.scroller.addEventListener("scroll",this._onScroll),this._onTouchStart=this.onTouchStart.bind(this),this.scroller.addEventListener("touchstart",this._onTouchStart,{passive:!0}),this.on("touchstart",this._onTouchStart),this._onTouchMove=this.onTouchMove.bind(this),this.scroller.addEventListener("touchmove",this._onTouchMove,{passive:!0}),this.on("touchmove",this._onTouchMove),this._onTouchEnd=this.onTouchEnd.bind(this),this.scroller.addEventListener("touchend",this._onTouchEnd,{passive:!0}),this.on("touchend",this._onTouchEnd),this._afterDisplayed=this.afterDisplayed.bind(this),this.manager.on(Ye.MANAGERS.ADDED,this._afterDisplayed)}removeListeners(){window.removeEventListener("resize",this._onResize),this._onResize=void 0,this.scroller.removeEventListener("scroll",this._onScroll),this._onScroll=void 0,this.scroller.removeEventListener("touchstart",this._onTouchStart,{passive:!0}),this.off("touchstart",this._onTouchStart),this._onTouchStart=void 0,this.scroller.removeEventListener("touchmove",this._onTouchMove,{passive:!0}),this.off("touchmove",this._onTouchMove),this._onTouchMove=void 0,this.scroller.removeEventListener("touchend",this._onTouchEnd,{passive:!0}),this.off("touchend",this._onTouchEnd),this._onTouchEnd=void 0,this.manager.off(Ye.MANAGERS.ADDED,this._afterDisplayed),this._afterDisplayed=void 0}afterDisplayed(e){let t=e.contents;["touchstart","touchmove","touchend"].forEach(n=>{t.on(n,i=>this.triggerViewEvent(i,t))})}triggerViewEvent(e,t){this.emit(e.type,e,t)}onScroll(e){this.scrollLeft=this.fullsize?window.scrollX:this.scroller.scrollLeft,this.scrollTop=this.fullsize?window.scrollY:this.scroller.scrollTop}onResize(e){this.resizeCanceler=!0}onTouchStart(e){let{screenX:t,screenY:n}=e.touches[0];this.fullsize&&this.enableScroll(),this.touchCanceler=!0,this.startTouchX||(this.startTouchX=t,this.startTouchY=n,this.startTime=this.now()),this.endTouchX=t,this.endTouchY=n,this.endTime=this.now()}onTouchMove(e){let{screenX:t,screenY:n}=e.touches[0],i=Math.abs(n-this.endTouchY);this.touchCanceler=!0,!this.fullsize&&i<10&&(this.element.scrollLeft-=t-this.endTouchX),this.endTouchX=t,this.endTouchY=n,this.endTime=this.now()}onTouchEnd(e){this.fullsize&&this.disableScroll(),this.touchCanceler=!1;let t=this.wasSwiped();t!==0?this.snap(t):this.snap(),this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0}wasSwiped(){let e=this.layout.pageWidth*this.layout.divisor,t=this.endTouchX-this.startTouchX,n=Math.abs(t),i=this.endTime-this.startTime,o=t/i,u=this.settings.minVelocity;if(n<=this.settings.minDistance||n>=e)return 0;if(o>u)return-1;if(o<-u)return 1}needsSnap(){let e=this.scrollLeft,t=this.layout.pageWidth*this.layout.divisor;return e%t!==0}snap(e=0){let t=this.scrollLeft,n=this.layout.pageWidth*this.layout.divisor,i=Math.round(t/n)*n;return e&&(i+=e*n),this.smoothScrollTo(i)}smoothScrollTo(e){const t=new zt,n=this.scrollLeft,i=this.now(),o=this.settings.duration,u=this.settings.easing;this.snapping=!0;function l(){const c=this.now(),d=Math.min(1,(c-i)/o);if(u(d),this.touchCanceler||this.resizeCanceler){this.resizeCanceler=!1,this.snapping=!1,t.resolve();return}d<1?(window.requestAnimationFrame(l.bind(this)),this.scrollTo(n+(e-n)*d,0)):(this.scrollTo(e,0),this.snapping=!1,t.resolve())}return l.call(this),t.promise}scrollTo(e=0,t=0){this.fullsize?window.scroll(e,t):(this.scroller.scrollLeft=e,this.scroller.scrollTop=t)}now(){return"now"in window.performance?performance.now():new Date().getTime()}destroy(){this.scroller&&(this.fullsize&&this.enableScroll(),this.removeListeners(),this.scroller=void 0)}}Hi(tg.prototype);var AI=g1();const SI=uo(AI);class II extends sd{constructor(e){super(e),this.name="continuous",this.settings=ar(this.settings||{},{infinite:!0,overflow:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",offset:500,offsetDelta:250,width:void 0,height:void 0,snap:!1,afterScrolledTimeout:10,allowScriptedContent:!1,allowPopups:!1}),ar(this.settings,e.settings||{}),e.settings.gap!="undefined"&&e.settings.gap===0&&(this.settings.gap=e.settings.gap),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,width:0,height:0,forceEvenPages:!1,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.scrollTop=0,this.scrollLeft=0}display(e,t){return sd.prototype.display.call(this,e,t).then((function(){return this.fill()}).bind(this))}fill(e){var t=e||new zt;return this.q.enqueue(()=>this.check()).then(n=>{n?this.fill(t):t.resolve()}),t.promise}moveTo(e){var t=0,n=0;this.isPaginated?(t=Math.floor(e.left/this.layout.delta)*this.layout.delta,t+this.settings.offsetDelta):(n=e.top,e.top+this.settings.offsetDelta),(t>0||n>0)&&this.scrollBy(t,n,!0)}afterResized(e){this.emit(Ye.MANAGERS.RESIZE,e.section)}removeShownListeners(e){e.onDisplayed=function(){}}add(e){var t=this.createView(e);return this.views.append(t),t.on(Ye.VIEWS.RESIZED,n=>{t.expanded=!0}),t.on(Ye.VIEWS.AXIS,n=>{this.updateAxis(n)}),t.on(Ye.VIEWS.WRITING_MODE,n=>{this.updateWritingMode(n)}),t.onDisplayed=this.afterDisplayed.bind(this),t.onResize=this.afterResized.bind(this),t.display(this.request)}append(e){var t=this.createView(e);return t.on(Ye.VIEWS.RESIZED,n=>{t.expanded=!0}),t.on(Ye.VIEWS.AXIS,n=>{this.updateAxis(n)}),t.on(Ye.VIEWS.WRITING_MODE,n=>{this.updateWritingMode(n)}),this.views.append(t),t.onDisplayed=this.afterDisplayed.bind(this),t}prepend(e){var t=this.createView(e);return t.on(Ye.VIEWS.RESIZED,n=>{this.counter(n),t.expanded=!0}),t.on(Ye.VIEWS.AXIS,n=>{this.updateAxis(n)}),t.on(Ye.VIEWS.WRITING_MODE,n=>{this.updateWritingMode(n)}),this.views.prepend(t),t.onDisplayed=this.afterDisplayed.bind(this),t}counter(e){this.settings.axis==="vertical"?this.scrollBy(0,e.heightDelta,!0):this.scrollBy(e.widthDelta,0,!0)}update(e){for(var t=this.bounds(),n=this.views.all(),i=n.length,o=typeof e<"u"?e:this.settings.offset||0,u,l,c=new zt,d=[],m=0;m<i;m++)if(l=n[m],u=this.isVisible(l,o,o,t),u===!0)if(l.displayed)l.show();else{let g=l.display(this.request).then(function(E){E.show()},E=>{l.hide()});d.push(g)}else this.q.enqueue(l.destroy.bind(l)),clearTimeout(this.trimTimeout),this.trimTimeout=setTimeout((function(){this.q.enqueue(this.trim.bind(this))}).bind(this),250);return d.length?Promise.all(d).catch(g=>{c.reject(g)}):(c.resolve(),c.promise)}check(e,t){var n=new zt,i=[],o=this.settings.axis==="horizontal",u=this.settings.offset||0;e&&o&&(u=e),t&&!o&&(u=t);var l=this._bounds;let c=o?this.scrollLeft:this.scrollTop,d=o?Math.floor(l.width):l.height,m=o?this.container.scrollWidth:this.container.scrollHeight,g=this.writingMode&&this.writingMode.indexOf("vertical")===0?"vertical":"horizontal",E=this.settings.rtlScrollType,b=this.settings.direction==="rtl";this.settings.fullsize?(o&&b&&E==="negative"||!o&&b&&E==="default")&&(c=c*-1):(b&&E==="default"&&g==="horizontal"&&(c=m-d-c),b&&E==="negative"&&g==="horizontal"&&(c=c*-1));let M=()=>{let V=this.views.first(),q=V&&V.section.prev();q&&i.push(this.prepend(q))},D=()=>{let V=this.views.last(),q=V&&V.section.next();q&&i.push(this.append(q))},w=c+d+u,A=c-u;w>=m&&D(),A<0&&M();let I=i.map(V=>V.display(this.request));return i.length?Promise.all(I).then(()=>this.check()).then(()=>this.update(u),V=>V):(this.q.enqueue((function(){this.update()}).bind(this)),n.resolve(!1),n.promise)}trim(){for(var e=new zt,t=this.views.displayed(),n=t[0],i=t[t.length-1],o=this.views.indexOf(n),u=this.views.indexOf(i),l=this.views.slice(0,o),c=this.views.slice(u+1),d=0;d<l.length-1;d++)this.erase(l[d],l);for(var m=1;m<c.length;m++)this.erase(c[m]);return e.resolve(),e.promise}erase(e,t){var n,i;this.settings.fullsize?(n=window.scrollY,i=window.scrollX):(n=this.container.scrollTop,i=this.container.scrollLeft);var o=e.bounds();this.views.remove(e),t&&(this.settings.axis==="vertical"?this.scrollTo(0,n-o.height,!0):this.settings.direction==="rtl"?this.settings.fullsize?this.scrollTo(i+Math.floor(o.width),0,!0):this.scrollTo(i,0,!0):this.scrollTo(i-Math.floor(o.width),0,!0))}addEventListeners(e){window.addEventListener("unload",(function(t){this.ignore=!0,this.destroy()}).bind(this)),this.addScrollListeners(),this.isPaginated&&this.settings.snap&&(this.snapper=new tg(this,this.settings.snap&&typeof this.settings.snap=="object"&&this.settings.snap))}addScrollListeners(){var e;this.tick=Gg;let t=this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"?-1:1;this.scrollDeltaVert=0,this.scrollDeltaHorz=0,this.settings.fullsize?(e=window,this.scrollTop=window.scrollY*t,this.scrollLeft=window.scrollX*t):(e=this.container,this.scrollTop=this.container.scrollTop,this.scrollLeft=this.container.scrollLeft),this._onScroll=this.onScroll.bind(this),e.addEventListener("scroll",this._onScroll),this._scrolled=SI(this.scrolled.bind(this),30),this.didScroll=!1}removeEventListeners(){var e;this.settings.fullsize?e=window:e=this.container,e.removeEventListener("scroll",this._onScroll),this._onScroll=void 0}onScroll(){let e,t,n=this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"?-1:1;this.settings.fullsize?(e=window.scrollY*n,t=window.scrollX*n):(e=this.container.scrollTop,t=this.container.scrollLeft),this.scrollTop=e,this.scrollLeft=t,this.ignore?this.ignore=!1:this._scrolled(),this.scrollDeltaVert+=Math.abs(e-this.prevScrollTop),this.scrollDeltaHorz+=Math.abs(t-this.prevScrollLeft),this.prevScrollTop=e,this.prevScrollLeft=t,clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout((function(){this.scrollDeltaVert=0,this.scrollDeltaHorz=0}).bind(this),150),clearTimeout(this.afterScrolled),this.didScroll=!1}scrolled(){this.q.enqueue((function(){return this.check()}).bind(this)),this.emit(Ye.MANAGERS.SCROLL,{top:this.scrollTop,left:this.scrollLeft}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout((function(){this.snapper&&this.snapper.supportsTouch&&this.snapper.needsSnap()||this.emit(Ye.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}).bind(this),this.settings.afterScrolledTimeout)}next(){let e=this.layout.props.name==="pre-paginated"&&this.layout.props.spread?this.layout.props.delta*2:this.layout.props.delta;this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"?this.scrollBy(e,0,!0):this.scrollBy(0,this.layout.height,!0),this.q.enqueue((function(){return this.check()}).bind(this)))}prev(){let e=this.layout.props.name==="pre-paginated"&&this.layout.props.spread?this.layout.props.delta*2:this.layout.props.delta;this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"?this.scrollBy(-e,0,!0):this.scrollBy(0,-this.layout.height,!0),this.q.enqueue((function(){return this.check()}).bind(this)))}updateFlow(e){this.rendered&&this.snapper&&(this.snapper.destroy(),this.snapper=void 0),super.updateFlow(e,"scroll"),this.rendered&&this.isPaginated&&this.settings.snap&&(this.snapper=new tg(this,this.settings.snap&&typeof this.settings.snap=="object"&&this.settings.snap))}destroy(){super.destroy(),this.snapper&&this.snapper.destroy()}}class Jg{constructor(e,t){this.settings=ar(this.settings||{},{width:null,height:null,ignoreClass:"",manager:"default",view:"iframe",flow:null,layout:null,spread:null,minSpreadWidth:800,stylesheet:null,resizeOnOrientationChange:!0,script:null,snap:!1,defaultDirection:"ltr",allowScriptedContent:!1,allowPopups:!1}),ar(this.settings,t),typeof this.settings.manager=="object"&&(this.manager=this.settings.manager),this.book=e,this.hooks={},this.hooks.display=new wi(this),this.hooks.serialize=new wi(this),this.hooks.content=new wi(this),this.hooks.unloaded=new wi(this),this.hooks.layout=new wi(this),this.hooks.render=new wi(this),this.hooks.show=new wi(this),this.hooks.content.register(this.handleLinks.bind(this)),this.hooks.content.register(this.passEvents.bind(this)),this.hooks.content.register(this.adjustImages.bind(this)),this.book.spine.hooks.content.register(this.injectIdentifier.bind(this)),this.settings.stylesheet&&this.book.spine.hooks.content.register(this.injectStylesheet.bind(this)),this.settings.script&&this.book.spine.hooks.content.register(this.injectScript.bind(this)),this.themes=new eI(this),this.annotations=new rI(this),this.epubcfi=new Ut,this.q=new Yg(this),this.location=void 0,this.q.enqueue(this.book.opened),this.starting=new zt,this.started=this.starting.promise,this.q.enqueue(this.start)}setManager(e){this.manager=e}requireManager(e){var t;return typeof e=="string"&&e==="default"?t=sd:typeof e=="string"&&e==="continuous"?t=II:t=e,t}requireView(e){var t;return typeof e=="string"&&e==="iframe"?t=f1:t=e,t}start(){switch(!this.settings.layout&&(this.book.package.metadata.layout==="pre-paginated"||this.book.displayOptions.fixedLayout==="true")&&(this.settings.layout="pre-paginated"),this.book.package.metadata.spread){case"none":this.settings.spread="none";break;case"both":this.settings.spread=!0;break}this.manager||(this.ViewManager=this.requireManager(this.settings.manager),this.View=this.requireView(this.settings.view),this.manager=new this.ViewManager({view:this.View,queue:this.q,request:this.book.load.bind(this.book),settings:this.settings})),this.direction(this.book.package.metadata.direction||this.settings.defaultDirection),this.settings.globalLayoutProperties=this.determineLayoutProperties(this.book.package.metadata),this.flow(this.settings.globalLayoutProperties.flow),this.layout(this.settings.globalLayoutProperties),this.manager.on(Ye.MANAGERS.ADDED,this.afterDisplayed.bind(this)),this.manager.on(Ye.MANAGERS.REMOVED,this.afterRemoved.bind(this)),this.manager.on(Ye.MANAGERS.RESIZED,this.onResized.bind(this)),this.manager.on(Ye.MANAGERS.ORIENTATION_CHANGE,this.onOrientationChange.bind(this)),this.manager.on(Ye.MANAGERS.SCROLLED,this.reportLocation.bind(this)),this.emit(Ye.RENDITION.STARTED),this.starting.resolve()}attachTo(e){return this.q.enqueue((function(){this.manager.render(e,{width:this.settings.width,height:this.settings.height}),this.emit(Ye.RENDITION.ATTACHED)}).bind(this))}display(e){return this.displaying&&this.displaying.resolve(),this.q.enqueue(this._display,e)}_display(e){if(this.book){this.epubcfi.isCfiString(e);var t=new zt,n=t.promise,i;return this.displaying=t,this.book.locations.length()&&JE(e)&&(e=this.book.locations.cfiFromPercentage(parseFloat(e))),i=this.book.spine.get(e),i?(this.manager.display(i,e).then(()=>{t.resolve(i),this.displaying=void 0,this.emit(Ye.RENDITION.DISPLAYED,i),this.reportLocation()},o=>{this.emit(Ye.RENDITION.DISPLAY_ERROR,o)}),n):(t.reject(new Error("No Section Found")),n)}}afterDisplayed(e){e.on(Ye.VIEWS.MARK_CLICKED,(t,n)=>this.triggerMarkEvent(t,n,e.contents)),this.hooks.render.trigger(e,this).then(()=>{e.contents?this.hooks.content.trigger(e.contents,this).then(()=>{this.emit(Ye.RENDITION.RENDERED,e.section,e)}):this.emit(Ye.RENDITION.RENDERED,e.section,e)})}afterRemoved(e){this.hooks.unloaded.trigger(e,this).then(()=>{this.emit(Ye.RENDITION.REMOVED,e.section,e)})}onResized(e,t){this.emit(Ye.RENDITION.RESIZED,{width:e.width,height:e.height},t),this.location&&this.location.start&&this.display(t||this.location.start.cfi)}onOrientationChange(e){this.emit(Ye.RENDITION.ORIENTATION_CHANGE,e)}moveTo(e){this.manager.moveTo(e)}resize(e,t,n){e&&(this.settings.width=e),t&&(this.settings.height=t),this.manager.resize(e,t,n)}clear(){this.manager.clear()}next(){return this.q.enqueue(this.manager.next.bind(this.manager)).then(this.reportLocation.bind(this))}prev(){return this.q.enqueue(this.manager.prev.bind(this.manager)).then(this.reportLocation.bind(this))}determineLayoutProperties(e){var t,n=this.settings.layout||e.layout||"reflowable",i=this.settings.spread||e.spread||"auto",o=this.settings.orientation||e.orientation||"auto",u=this.settings.flow||e.flow||"auto",l=e.viewport||"",c=this.settings.minSpreadWidth||e.minSpreadWidth||800,d=this.settings.direction||e.direction||"ltr";return(this.settings.width===0||this.settings.width>0)&&(this.settings.height===0||this.settings.height>0),t={layout:n,spread:i,orientation:o,flow:u,viewport:l,minSpreadWidth:c,direction:d},t}flow(e){var t=e;(e==="scrolled"||e==="scrolled-doc"||e==="scrolled-continuous")&&(t="scrolled"),(e==="auto"||e==="paginated")&&(t="paginated"),this.settings.flow=e,this._layout&&this._layout.flow(t),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this.manager&&this.manager.updateFlow(t),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}layout(e){return e&&(this._layout=new c1(e),this._layout.spread(e.spread,this.settings.minSpreadWidth),this._layout.on(Ye.LAYOUT.UPDATED,(t,n)=>{this.emit(Ye.RENDITION.LAYOUT,t,n)})),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this._layout}spread(e,t){this.settings.spread=e,t&&(this.settings.minSpreadWidth=t),this._layout&&this._layout.spread(e,t),this.manager&&this.manager.isRendered()&&this.manager.updateLayout()}direction(e){this.settings.direction=e||"ltr",this.manager&&this.manager.direction(this.settings.direction),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}reportLocation(){return this.q.enqueue((function(){requestAnimationFrame((function(){var n=this.manager.currentLocation();if(n&&n.then&&typeof n.then=="function")n.then((function(i){let o=this.located(i);!o||!o.start||!o.end||(this.location=o,this.emit(Ye.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(Ye.RENDITION.RELOCATED,this.location))}).bind(this));else if(n){let i=this.located(n);if(!i||!i.start||!i.end)return;this.location=i,this.emit(Ye.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(Ye.RENDITION.RELOCATED,this.location)}}).bind(this))}).bind(this))}currentLocation(){var e=this.manager.currentLocation();if(e&&e.then&&typeof e.then=="function")e.then((function(t){return this.located(t)}).bind(this));else if(e)return this.located(e)}located(e){if(!e.length)return{};let t=e[0],n=e[e.length-1],i={start:{index:t.index,href:t.href,cfi:t.mapping.start,displayed:{page:t.pages[0]||1,total:t.totalPages}},end:{index:n.index,href:n.href,cfi:n.mapping.end,displayed:{page:n.pages[n.pages.length-1]||1,total:n.totalPages}}},o=this.book.locations.locationFromCfi(t.mapping.start),u=this.book.locations.locationFromCfi(n.mapping.end);o!=null&&(i.start.location=o,i.start.percentage=this.book.locations.percentageFromLocation(o)),u!=null&&(i.end.location=u,i.end.percentage=this.book.locations.percentageFromLocation(u));let l=this.book.pageList.pageFromCfi(t.mapping.start),c=this.book.pageList.pageFromCfi(n.mapping.end);return l!=-1&&(i.start.page=l),c!=-1&&(i.end.page=c),n.index===this.book.spine.last().index&&i.end.displayed.page>=i.end.displayed.total&&(i.atEnd=!0),t.index===this.book.spine.first().index&&i.start.displayed.page===1&&(i.atStart=!0),i}destroy(){this.manager&&this.manager.destroy(),this.book=void 0}passEvents(e){Mh.forEach(t=>{e.on(t,n=>this.triggerViewEvent(n,e))}),e.on(Ye.CONTENTS.SELECTED,t=>this.triggerSelectedEvent(t,e))}triggerViewEvent(e,t){this.emit(e.type,e,t)}triggerSelectedEvent(e,t){this.emit(Ye.RENDITION.SELECTED,e,t)}triggerMarkEvent(e,t,n){this.emit(Ye.RENDITION.MARK_CLICKED,e,t,n)}getRange(e,t){var n=new Ut(e),i=this.manager.visible().filter(function(o){if(n.spinePos===o.index)return!0});if(i.length)return i[0].contents.range(n,t)}adjustImages(e){if(this._layout.name==="pre-paginated")return new Promise(function(o){o()});let t=e.window.getComputedStyle(e.content,null),n=(e.content.offsetHeight-(parseFloat(t.paddingTop)+parseFloat(t.paddingBottom)))*.95,i=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight);return e.addStylesheetRules({img:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-i+"px":"100%")+"!important","max-height":n+"px!important","object-fit":"contain","page-break-inside":"avoid","break-inside":"avoid","box-sizing":"border-box"},svg:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-i+"px":"100%")+"!important","max-height":n+"px!important","page-break-inside":"avoid","break-inside":"avoid"}}),new Promise(function(o,u){setTimeout(function(){o()},1)})}getContents(){return this.manager?this.manager.getContents():[]}views(){return(this.manager?this.manager.views:void 0)||[]}handleLinks(e){e&&e.on(Ye.CONTENTS.LINK_CLICKED,t=>{let n=this.book.path.relative(t);this.display(n)})}injectStylesheet(e,t){let n=e.createElement("link");n.setAttribute("type","text/css"),n.setAttribute("rel","stylesheet"),n.setAttribute("href",this.settings.stylesheet),e.getElementsByTagName("head")[0].appendChild(n)}injectScript(e,t){let n=e.createElement("script");n.setAttribute("type","text/javascript"),n.setAttribute("src",this.settings.script),n.textContent=" ",e.getElementsByTagName("head")[0].appendChild(n)}injectIdentifier(e,t){let n=this.book.packaging.metadata.identifier,i=e.createElement("meta");i.setAttribute("name","dc.relation.ispartof"),n&&i.setAttribute("content",n),e.getElementsByTagName("head")[0].appendChild(i)}}Hi(Jg.prototype);function Ys(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Tm={exports:{}};var Rw;function CI(){return Rw||(Rw=1,(function(r,e){(function(t){r.exports=t()})(function(){return(function t(n,i,o){function u(d,m){if(!i[d]){if(!n[d]){var g=typeof Ys=="function"&&Ys;if(!m&&g)return g(d,!0);if(l)return l(d,!0);var E=new Error("Cannot find module '"+d+"'");throw E.code="MODULE_NOT_FOUND",E}var b=i[d]={exports:{}};n[d][0].call(b.exports,function(M){var D=n[d][1][M];return u(D||M)},b,b.exports,t,n,i,o)}return i[d].exports}for(var l=typeof Ys=="function"&&Ys,c=0;c<o.length;c++)u(o[c]);return u})({1:[function(t,n,i){var o=t("./utils"),u=t("./support"),l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(c){for(var d=[],m,g,E,b,M,D,w,A=0,I=c.length,V=I,q=o.getTypeOf(c)!=="string";A<c.length;)V=I-A,q?(m=c[A++],g=A<I?c[A++]:0,E=A<I?c[A++]:0):(m=c.charCodeAt(A++),g=A<I?c.charCodeAt(A++):0,E=A<I?c.charCodeAt(A++):0),b=m>>2,M=(m&3)<<4|g>>4,D=V>1?(g&15)<<2|E>>6:64,w=V>2?E&63:64,d.push(l.charAt(b)+l.charAt(M)+l.charAt(D)+l.charAt(w));return d.join("")},i.decode=function(c){var d,m,g,E,b,M,D,w=0,A=0,I="data:";if(c.substr(0,I.length)===I)throw new Error("Invalid base64 input, it looks like a data url.");c=c.replace(/[^A-Za-z0-9+/=]/g,"");var V=c.length*3/4;if(c.charAt(c.length-1)===l.charAt(64)&&V--,c.charAt(c.length-2)===l.charAt(64)&&V--,V%1!==0)throw new Error("Invalid base64 input, bad content length.");var q;for(u.uint8array?q=new Uint8Array(V|0):q=new Array(V|0);w<c.length;)E=l.indexOf(c.charAt(w++)),b=l.indexOf(c.charAt(w++)),M=l.indexOf(c.charAt(w++)),D=l.indexOf(c.charAt(w++)),d=E<<2|b>>4,m=(b&15)<<4|M>>2,g=(M&3)<<6|D,q[A++]=d,M!==64&&(q[A++]=m),D!==64&&(q[A++]=g);return q}},{"./support":30,"./utils":32}],2:[function(t,n,i){var o=t("./external"),u=t("./stream/DataWorker"),l=t("./stream/Crc32Probe"),c=t("./stream/DataLengthProbe");function d(m,g,E,b,M){this.compressedSize=m,this.uncompressedSize=g,this.crc32=E,this.compression=b,this.compressedContent=M}d.prototype={getContentWorker:function(){var m=new u(o.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new c("data_length")),g=this;return m.on("end",function(){if(this.streamInfo.data_length!==g.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),m},getCompressedWorker:function(){return new u(o.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},d.createWorkerFrom=function(m,g,E){return m.pipe(new l).pipe(new c("uncompressedSize")).pipe(g.compressWorker(E)).pipe(new c("compressedSize")).withStreamInfo("compression",g)},n.exports=d},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,n,i){var o=t("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new o("STORE compression")},uncompressWorker:function(){return new o("STORE decompression")}},i.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,n,i){var o=t("./utils");function u(){for(var m,g=[],E=0;E<256;E++){m=E;for(var b=0;b<8;b++)m=m&1?3988292384^m>>>1:m>>>1;g[E]=m}return g}var l=u();function c(m,g,E,b){var M=l,D=b+E;m=m^-1;for(var w=b;w<D;w++)m=m>>>8^M[(m^g[w])&255];return m^-1}function d(m,g,E,b){var M=l,D=b+E;m=m^-1;for(var w=b;w<D;w++)m=m>>>8^M[(m^g.charCodeAt(w))&255];return m^-1}n.exports=function(g,E){if(typeof g>"u"||!g.length)return 0;var b=o.getTypeOf(g)!=="string";return b?c(E|0,g,g.length,0):d(E|0,g,g.length,0)}},{"./utils":32}],5:[function(t,n,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(t,n,i){var o=null;typeof Promise<"u"?o=Promise:o=t("lie"),n.exports={Promise:o}},{lie:37}],7:[function(t,n,i){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",u=t("pako"),l=t("./utils"),c=t("./stream/GenericWorker"),d=o?"uint8array":"array";i.magic="\b\0";function m(g,E){c.call(this,"FlateWorker/"+g),this._pako=null,this._pakoAction=g,this._pakoOptions=E,this.meta={}}l.inherits(m,c),m.prototype.processChunk=function(g){this.meta=g.meta,this._pako===null&&this._createPako(),this._pako.push(l.transformTo(d,g.data),!1)},m.prototype.flush=function(){c.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},m.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this._pako=null},m.prototype._createPako=function(){this._pako=new u[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var g=this;this._pako.onData=function(E){g.push({data:E,meta:g.meta})}},i.compressWorker=function(g){return new m("Deflate",g)},i.uncompressWorker=function(){return new m("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,n,i){var o=t("../utils"),u=t("../stream/GenericWorker"),l=t("../utf8"),c=t("../crc32"),d=t("../signature"),m=function(A,I){var V="",q;for(q=0;q<I;q++)V+=String.fromCharCode(A&255),A=A>>>8;return V},g=function(A,I){var V=A;return A||(V=I?16893:33204),(V&65535)<<16},E=function(A){return(A||0)&63},b=function(A,I,V,q,P,U){var R=A.file,S=A.compression,C=U!==l.utf8encode,N=o.transformTo("string",U(R.name)),z=o.transformTo("string",l.utf8encode(R.name)),j=R.comment,L=o.transformTo("string",U(j)),he=o.transformTo("string",l.utf8encode(j)),_e=z.length!==R.name.length,De=he.length!==j.length,de,J,ce="",xe="",Q="",se=R.dir,Ce=R.date,Ie={crc32:0,compressedSize:0,uncompressedSize:0};(!I||V)&&(Ie.crc32=A.crc32,Ie.compressedSize=A.compressedSize,Ie.uncompressedSize=A.uncompressedSize);var He=0;I&&(He|=8),!C&&(_e||De)&&(He|=2048);var Ke=0,et=0;se&&(Ke|=16),P==="UNIX"?(et=798,Ke|=g(R.unixPermissions,se)):(et=20,Ke|=E(R.dosPermissions)),de=Ce.getUTCHours(),de=de<<6,de=de|Ce.getUTCMinutes(),de=de<<5,de=de|Ce.getUTCSeconds()/2,J=Ce.getUTCFullYear()-1980,J=J<<4,J=J|Ce.getUTCMonth()+1,J=J<<5,J=J|Ce.getUTCDate(),_e&&(xe=m(1,1)+m(c(N),4)+z,ce+="up"+m(xe.length,2)+xe),De&&(Q=m(1,1)+m(c(L),4)+he,ce+="uc"+m(Q.length,2)+Q);var Fe="";Fe+=`
\0`,Fe+=m(He,2),Fe+=S.magic,Fe+=m(de,2),Fe+=m(J,2),Fe+=m(Ie.crc32,4),Fe+=m(Ie.compressedSize,4),Fe+=m(Ie.uncompressedSize,4),Fe+=m(N.length,2),Fe+=m(ce.length,2);var Je=d.LOCAL_FILE_HEADER+Fe+N+ce,Xe=d.CENTRAL_FILE_HEADER+m(et,2)+Fe+m(L.length,2)+"\0\0\0\0"+m(Ke,4)+m(q,4)+N+ce+L;return{fileRecord:Je,dirRecord:Xe}},M=function(A,I,V,q,P){var U="",R=o.transformTo("string",P(q));return U=d.CENTRAL_DIRECTORY_END+"\0\0\0\0"+m(A,2)+m(A,2)+m(I,4)+m(V,4)+m(R.length,2)+R,U},D=function(A){var I="";return I=d.DATA_DESCRIPTOR+m(A.crc32,4)+m(A.compressedSize,4)+m(A.uncompressedSize,4),I};function w(A,I,V,q){u.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=I,this.zipPlatform=V,this.encodeFileName=q,this.streamFiles=A,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(w,u),w.prototype.push=function(A){var I=A.meta.percent||0,V=this.entriesCount,q=this._sources.length;this.accumulate?this.contentBuffer.push(A):(this.bytesWritten+=A.data.length,u.prototype.push.call(this,{data:A.data,meta:{currentFile:this.currentFile,percent:V?(I+100*(V-q-1))/V:100}}))},w.prototype.openedSource=function(A){this.currentSourceOffset=this.bytesWritten,this.currentFile=A.file.name;var I=this.streamFiles&&!A.file.dir;if(I){var V=b(A,I,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:V.fileRecord,meta:{percent:0}})}else this.accumulate=!0},w.prototype.closedSource=function(A){this.accumulate=!1;var I=this.streamFiles&&!A.file.dir,V=b(A,I,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(V.dirRecord),I)this.push({data:D(A),meta:{percent:100}});else for(this.push({data:V.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},w.prototype.flush=function(){for(var A=this.bytesWritten,I=0;I<this.dirRecords.length;I++)this.push({data:this.dirRecords[I],meta:{percent:100}});var V=this.bytesWritten-A,q=M(this.dirRecords.length,V,A,this.zipComment,this.encodeFileName);this.push({data:q,meta:{percent:100}})},w.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},w.prototype.registerPrevious=function(A){this._sources.push(A);var I=this;return A.on("data",function(V){I.processChunk(V)}),A.on("end",function(){I.closedSource(I.previous.streamInfo),I._sources.length?I.prepareNextSource():I.end()}),A.on("error",function(V){I.error(V)}),this},w.prototype.resume=function(){if(!u.prototype.resume.call(this))return!1;if(!this.previous&&this._sources.length)return this.prepareNextSource(),!0;if(!this.previous&&!this._sources.length&&!this.generatedError)return this.end(),!0},w.prototype.error=function(A){var I=this._sources;if(!u.prototype.error.call(this,A))return!1;for(var V=0;V<I.length;V++)try{I[V].error(A)}catch{}return!0},w.prototype.lock=function(){u.prototype.lock.call(this);for(var A=this._sources,I=0;I<A.length;I++)A[I].lock()},n.exports=w},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,n,i){var o=t("../compressions"),u=t("./ZipFileWorker"),l=function(c,d){var m=c||d,g=o[m];if(!g)throw new Error(m+" is not a valid compression method !");return g};i.generateWorker=function(c,d,m){var g=new u(d.streamFiles,m,d.platform,d.encodeFileName),E=0;try{c.forEach(function(b,M){E++;var D=l(M.options.compression,d.compression),w=M.options.compressionOptions||d.compressionOptions||{},A=M.dir,I=M.date;M._compressWorker(D,w).withStreamInfo("file",{name:b,dir:A,date:I,comment:M.comment||"",unixPermissions:M.unixPermissions,dosPermissions:M.dosPermissions}).pipe(g)}),g.entriesCount=E}catch(b){g.error(b)}return g}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,n,i){function o(){if(!(this instanceof o))return new o;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var u=new o;for(var l in this)typeof this[l]!="function"&&(u[l]=this[l]);return u}}o.prototype=t("./object"),o.prototype.loadAsync=t("./load"),o.support=t("./support"),o.defaults=t("./defaults"),o.version="3.10.1",o.loadAsync=function(u,l){return new o().loadAsync(u,l)},o.external=t("./external"),n.exports=o},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,n,i){var o=t("./utils"),u=t("./external"),l=t("./utf8"),c=t("./zipEntries"),d=t("./stream/Crc32Probe"),m=t("./nodejsUtils");function g(E){return new u.Promise(function(b,M){var D=E.decompressed.getContentWorker().pipe(new d);D.on("error",function(w){M(w)}).on("end",function(){D.streamInfo.crc32!==E.decompressed.crc32?M(new Error("Corrupted zip : CRC32 mismatch")):b()}).resume()})}n.exports=function(E,b){var M=this;return b=o.extend(b||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:l.utf8decode}),m.isNode&&m.isStream(E)?u.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):o.prepareContent("the loaded zip file",E,!0,b.optimizedBinaryString,b.base64).then(function(D){var w=new c(b);return w.load(D),w}).then(function(w){var A=[u.Promise.resolve(w)],I=w.files;if(b.checkCRC32)for(var V=0;V<I.length;V++)A.push(g(I[V]));return u.Promise.all(A)}).then(function(w){for(var A=w.shift(),I=A.files,V=0;V<I.length;V++){var q=I[V],P=q.fileNameStr,U=o.resolve(q.fileNameStr);M.file(U,q.decompressed,{binary:!0,optimizedBinaryString:!0,date:q.date,dir:q.dir,comment:q.fileCommentStr.length?q.fileCommentStr:null,unixPermissions:q.unixPermissions,dosPermissions:q.dosPermissions,createFolders:b.createFolders}),q.dir||(M.file(U).unsafeOriginalName=P)}return A.zipComment.length&&(M.comment=A.zipComment),M})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,n,i){var o=t("../utils"),u=t("../stream/GenericWorker");function l(c,d){u.call(this,"Nodejs stream input adapter for "+c),this._upstreamEnded=!1,this._bindStream(d)}o.inherits(l,u),l.prototype._bindStream=function(c){var d=this;this._stream=c,c.pause(),c.on("data",function(m){d.push({data:m,meta:{percent:0}})}).on("error",function(m){d.isPaused?this.generatedError=m:d.error(m)}).on("end",function(){d.isPaused?d._upstreamEnded=!0:d.end()})},l.prototype.pause=function(){return u.prototype.pause.call(this)?(this._stream.pause(),!0):!1},l.prototype.resume=function(){return u.prototype.resume.call(this)?(this._upstreamEnded?this.end():this._stream.resume(),!0):!1},n.exports=l},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,n,i){var o=t("readable-stream").Readable,u=t("../utils");u.inherits(l,o);function l(c,d,m){o.call(this,d),this._helper=c;var g=this;c.on("data",function(E,b){g.push(E)||g._helper.pause(),m&&m(b)}).on("error",function(E){g.emit("error",E)}).on("end",function(){g.push(null)})}l.prototype._read=function(){this._helper.resume()},n.exports=l},{"../utils":32,"readable-stream":16}],14:[function(t,n,i){n.exports={isNode:typeof Buffer<"u",newBufferFrom:function(o,u){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(o,u);if(typeof o=="number")throw new Error('The "data" argument must not be a number');return new Buffer(o,u)},allocBuffer:function(o){if(Buffer.alloc)return Buffer.alloc(o);var u=new Buffer(o);return u.fill(0),u},isBuffer:function(o){return Buffer.isBuffer(o)},isStream:function(o){return o&&typeof o.on=="function"&&typeof o.pause=="function"&&typeof o.resume=="function"}}},{}],15:[function(t,n,i){var o=t("./utf8"),u=t("./utils"),l=t("./stream/GenericWorker"),c=t("./stream/StreamHelper"),d=t("./defaults"),m=t("./compressedObject"),g=t("./zipObject"),E=t("./generate"),b=t("./nodejsUtils"),M=t("./nodejs/NodejsStreamInputAdapter"),D=function(P,U,R){var S=u.getTypeOf(U),C,N=u.extend(R||{},d);N.date=N.date||new Date,N.compression!==null&&(N.compression=N.compression.toUpperCase()),typeof N.unixPermissions=="string"&&(N.unixPermissions=parseInt(N.unixPermissions,8)),N.unixPermissions&&N.unixPermissions&16384&&(N.dir=!0),N.dosPermissions&&N.dosPermissions&16&&(N.dir=!0),N.dir&&(P=A(P)),N.createFolders&&(C=w(P))&&I.call(this,C,!0);var z=S==="string"&&N.binary===!1&&N.base64===!1;(!R||typeof R.binary>"u")&&(N.binary=!z);var j=U instanceof m&&U.uncompressedSize===0;(j||N.dir||!U||U.length===0)&&(N.base64=!1,N.binary=!0,U="",N.compression="STORE",S="string");var L=null;U instanceof m||U instanceof l?L=U:b.isNode&&b.isStream(U)?L=new M(P,U):L=u.prepareContent(P,U,N.binary,N.optimizedBinaryString,N.base64);var he=new g(P,L,N);this.files[P]=he},w=function(P){P.slice(-1)==="/"&&(P=P.substring(0,P.length-1));var U=P.lastIndexOf("/");return U>0?P.substring(0,U):""},A=function(P){return P.slice(-1)!=="/"&&(P+="/"),P},I=function(P,U){return U=typeof U<"u"?U:d.createFolders,P=A(P),this.files[P]||D.call(this,P,null,{dir:!0,createFolders:U}),this.files[P]};function V(P){return Object.prototype.toString.call(P)==="[object RegExp]"}var q={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(P){var U,R,S;for(U in this.files)S=this.files[U],R=U.slice(this.root.length,U.length),R&&U.slice(0,this.root.length)===this.root&&P(R,S)},filter:function(P){var U=[];return this.forEach(function(R,S){P(R,S)&&U.push(S)}),U},file:function(P,U,R){if(arguments.length===1)if(V(P)){var S=P;return this.filter(function(N,z){return!z.dir&&S.test(N)})}else{var C=this.files[this.root+P];return C&&!C.dir?C:null}else P=this.root+P,D.call(this,P,U,R);return this},folder:function(P){if(!P)return this;if(V(P))return this.filter(function(C,N){return N.dir&&P.test(C)});var U=this.root+P,R=I.call(this,U),S=this.clone();return S.root=R.name,S},remove:function(P){P=this.root+P;var U=this.files[P];if(U||(P.slice(-1)!=="/"&&(P+="/"),U=this.files[P]),U&&!U.dir)delete this.files[P];else for(var R=this.filter(function(C,N){return N.name.slice(0,P.length)===P}),S=0;S<R.length;S++)delete this.files[R[S].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(P){var U,R={};try{if(R=u.extend(P||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:o.utf8encode}),R.type=R.type.toLowerCase(),R.compression=R.compression.toUpperCase(),R.type==="binarystring"&&(R.type="string"),!R.type)throw new Error("No output type specified.");u.checkSupport(R.type),(R.platform==="darwin"||R.platform==="freebsd"||R.platform==="linux"||R.platform==="sunos")&&(R.platform="UNIX"),R.platform==="win32"&&(R.platform="DOS");var S=R.comment||this.comment||"";U=E.generateWorker(this,R,S)}catch(C){U=new l("error"),U.error(C)}return new c(U,R.type||"string",R.mimeType)},generateAsync:function(P,U){return this.generateInternalStream(P).accumulate(U)},generateNodeStream:function(P,U){return P=P||{},P.type||(P.type="nodebuffer"),this.generateInternalStream(P).toNodejsStream(U)}};n.exports=q},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,n,i){n.exports=t("stream")},{stream:void 0}],17:[function(t,n,i){var o=t("./DataReader"),u=t("../utils");function l(c){o.call(this,c);for(var d=0;d<this.data.length;d++)c[d]=c[d]&255}u.inherits(l,o),l.prototype.byteAt=function(c){return this.data[this.zero+c]},l.prototype.lastIndexOfSignature=function(c){for(var d=c.charCodeAt(0),m=c.charCodeAt(1),g=c.charCodeAt(2),E=c.charCodeAt(3),b=this.length-4;b>=0;--b)if(this.data[b]===d&&this.data[b+1]===m&&this.data[b+2]===g&&this.data[b+3]===E)return b-this.zero;return-1},l.prototype.readAndCheckSignature=function(c){var d=c.charCodeAt(0),m=c.charCodeAt(1),g=c.charCodeAt(2),E=c.charCodeAt(3),b=this.readData(4);return d===b[0]&&m===b[1]&&g===b[2]&&E===b[3]},l.prototype.readData=function(c){if(this.checkOffset(c),c===0)return[];var d=this.data.slice(this.zero+this.index,this.zero+this.index+c);return this.index+=c,d},n.exports=l},{"../utils":32,"./DataReader":18}],18:[function(t,n,i){var o=t("../utils");function u(l){this.data=l,this.length=l.length,this.index=0,this.zero=0}u.prototype={checkOffset:function(l){this.checkIndex(this.index+l)},checkIndex:function(l){if(this.length<this.zero+l||l<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+l+"). Corrupted zip ?")},setIndex:function(l){this.checkIndex(l),this.index=l},skip:function(l){this.setIndex(this.index+l)},byteAt:function(){},readInt:function(l){var c=0,d;for(this.checkOffset(l),d=this.index+l-1;d>=this.index;d--)c=(c<<8)+this.byteAt(d);return this.index+=l,c},readString:function(l){return o.transformTo("string",this.readData(l))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var l=this.readInt(4);return new Date(Date.UTC((l>>25&127)+1980,(l>>21&15)-1,l>>16&31,l>>11&31,l>>5&63,(l&31)<<1))}},n.exports=u},{"../utils":32}],19:[function(t,n,i){var o=t("./Uint8ArrayReader"),u=t("../utils");function l(c){o.call(this,c)}u.inherits(l,o),l.prototype.readData=function(c){this.checkOffset(c);var d=this.data.slice(this.zero+this.index,this.zero+this.index+c);return this.index+=c,d},n.exports=l},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,n,i){var o=t("./DataReader"),u=t("../utils");function l(c){o.call(this,c)}u.inherits(l,o),l.prototype.byteAt=function(c){return this.data.charCodeAt(this.zero+c)},l.prototype.lastIndexOfSignature=function(c){return this.data.lastIndexOf(c)-this.zero},l.prototype.readAndCheckSignature=function(c){var d=this.readData(4);return c===d},l.prototype.readData=function(c){this.checkOffset(c);var d=this.data.slice(this.zero+this.index,this.zero+this.index+c);return this.index+=c,d},n.exports=l},{"../utils":32,"./DataReader":18}],21:[function(t,n,i){var o=t("./ArrayReader"),u=t("../utils");function l(c){o.call(this,c)}u.inherits(l,o),l.prototype.readData=function(c){if(this.checkOffset(c),c===0)return new Uint8Array(0);var d=this.data.subarray(this.zero+this.index,this.zero+this.index+c);return this.index+=c,d},n.exports=l},{"../utils":32,"./ArrayReader":17}],22:[function(t,n,i){var o=t("../utils"),u=t("../support"),l=t("./ArrayReader"),c=t("./StringReader"),d=t("./NodeBufferReader"),m=t("./Uint8ArrayReader");n.exports=function(g){var E=o.getTypeOf(g);return o.checkSupport(E),E==="string"&&!u.uint8array?new c(g):E==="nodebuffer"?new d(g):u.uint8array?new m(o.transformTo("uint8array",g)):new l(o.transformTo("array",g))}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,n,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,n,i){var o=t("./GenericWorker"),u=t("../utils");function l(c){o.call(this,"ConvertWorker to "+c),this.destType=c}u.inherits(l,o),l.prototype.processChunk=function(c){this.push({data:u.transformTo(this.destType,c.data),meta:c.meta})},n.exports=l},{"../utils":32,"./GenericWorker":28}],25:[function(t,n,i){var o=t("./GenericWorker"),u=t("../crc32"),l=t("../utils");function c(){o.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}l.inherits(c,o),c.prototype.processChunk=function(d){this.streamInfo.crc32=u(d.data,this.streamInfo.crc32||0),this.push(d)},n.exports=c},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,n,i){var o=t("../utils"),u=t("./GenericWorker");function l(c){u.call(this,"DataLengthProbe for "+c),this.propName=c,this.withStreamInfo(c,0)}o.inherits(l,u),l.prototype.processChunk=function(c){if(c){var d=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=d+c.data.length}u.prototype.processChunk.call(this,c)},n.exports=l},{"../utils":32,"./GenericWorker":28}],27:[function(t,n,i){var o=t("../utils"),u=t("./GenericWorker"),l=16*1024;function c(d){u.call(this,"DataWorker");var m=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,d.then(function(g){m.dataIsReady=!0,m.data=g,m.max=g&&g.length||0,m.type=o.getTypeOf(g),m.isPaused||m._tickAndRepeat()},function(g){m.error(g)})}o.inherits(c,u),c.prototype.cleanUp=function(){u.prototype.cleanUp.call(this),this.data=null},c.prototype.resume=function(){return u.prototype.resume.call(this)?(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,o.delay(this._tickAndRepeat,[],this)),!0):!1},c.prototype._tickAndRepeat=function(){this._tickScheduled=!1,!(this.isPaused||this.isFinished)&&(this._tick(),this.isFinished||(o.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},c.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var d=l,m=null,g=Math.min(this.max,this.index+d);if(this.index>=this.max)return this.end();switch(this.type){case"string":m=this.data.substring(this.index,g);break;case"uint8array":m=this.data.subarray(this.index,g);break;case"array":case"nodebuffer":m=this.data.slice(this.index,g);break}return this.index=g,this.push({data:m,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=c},{"../utils":32,"./GenericWorker":28}],28:[function(t,n,i){function o(u){this.name=u||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}o.prototype={push:function(u){this.emit("data",u)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(u){this.emit("error",u)}return!0},error:function(u){return this.isFinished?!1:(this.isPaused?this.generatedError=u:(this.isFinished=!0,this.emit("error",u),this.previous&&this.previous.error(u),this.cleanUp()),!0)},on:function(u,l){return this._listeners[u].push(l),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(u,l){if(this._listeners[u])for(var c=0;c<this._listeners[u].length;c++)this._listeners[u][c].call(this,l)},pipe:function(u){return u.registerPrevious(this)},registerPrevious:function(u){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=u.streamInfo,this.mergeStreamInfo(),this.previous=u;var l=this;return u.on("data",function(c){l.processChunk(c)}),u.on("end",function(){l.end()}),u.on("error",function(c){l.error(c)}),this},pause:function(){return this.isPaused||this.isFinished?!1:(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var u=!1;return this.generatedError&&(this.error(this.generatedError),u=!0),this.previous&&this.previous.resume(),!u},flush:function(){},processChunk:function(u){this.push(u)},withStreamInfo:function(u,l){return this.extraStreamInfo[u]=l,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var u in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,u)&&(this.streamInfo[u]=this.extraStreamInfo[u])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var u="Worker "+this.name;return this.previous?this.previous+" -> "+u:u}},n.exports=o},{}],29:[function(t,n,i){var o=t("../utils"),u=t("./ConvertWorker"),l=t("./GenericWorker"),c=t("../base64"),d=t("../support"),m=t("../external"),g=null;if(d.nodestream)try{g=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function E(w,A,I){switch(w){case"blob":return o.newBlob(o.transformTo("arraybuffer",A),I);case"base64":return c.encode(A);default:return o.transformTo(w,A)}}function b(w,A){var I,V=0,q=null,P=0;for(I=0;I<A.length;I++)P+=A[I].length;switch(w){case"string":return A.join("");case"array":return Array.prototype.concat.apply([],A);case"uint8array":for(q=new Uint8Array(P),I=0;I<A.length;I++)q.set(A[I],V),V+=A[I].length;return q;case"nodebuffer":return Buffer.concat(A);default:throw new Error("concat : unsupported type '"+w+"'")}}function M(w,A){return new m.Promise(function(I,V){var q=[],P=w._internalType,U=w._outputType,R=w._mimeType;w.on("data",function(S,C){q.push(S),A&&A(C)}).on("error",function(S){q=[],V(S)}).on("end",function(){try{var S=E(U,b(P,q),R);I(S)}catch(C){V(C)}q=[]}).resume()})}function D(w,A,I){var V=A;switch(A){case"blob":case"arraybuffer":V="uint8array";break;case"base64":V="string";break}try{this._internalType=V,this._outputType=A,this._mimeType=I,o.checkSupport(V),this._worker=w.pipe(new u(V)),w.lock()}catch(q){this._worker=new l("error"),this._worker.error(q)}}D.prototype={accumulate:function(w){return M(this,w)},on:function(w,A){var I=this;return w==="data"?this._worker.on(w,function(V){A.call(I,V.data,V.meta)}):this._worker.on(w,function(){o.delay(A,arguments,I)}),this},resume:function(){return o.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(w){if(o.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new g(this,{objectMode:this._outputType!=="nodebuffer"},w)}},n.exports=D},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,n,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var o=new ArrayBuffer(0);try{i.blob=new Blob([o],{type:"application/zip"}).size===0}catch{try{var u=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,l=new u;l.append(o),i.blob=l.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!t("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(t,n,i){for(var o=t("./utils"),u=t("./support"),l=t("./nodejsUtils"),c=t("./stream/GenericWorker"),d=new Array(256),m=0;m<256;m++)d[m]=m>=252?6:m>=248?5:m>=240?4:m>=224?3:m>=192?2:1;d[254]=d[254]=1;var g=function(w){var A,I,V,q,P,U=w.length,R=0;for(q=0;q<U;q++)I=w.charCodeAt(q),(I&64512)===55296&&q+1<U&&(V=w.charCodeAt(q+1),(V&64512)===56320&&(I=65536+(I-55296<<10)+(V-56320),q++)),R+=I<128?1:I<2048?2:I<65536?3:4;for(u.uint8array?A=new Uint8Array(R):A=new Array(R),P=0,q=0;P<R;q++)I=w.charCodeAt(q),(I&64512)===55296&&q+1<U&&(V=w.charCodeAt(q+1),(V&64512)===56320&&(I=65536+(I-55296<<10)+(V-56320),q++)),I<128?A[P++]=I:I<2048?(A[P++]=192|I>>>6,A[P++]=128|I&63):I<65536?(A[P++]=224|I>>>12,A[P++]=128|I>>>6&63,A[P++]=128|I&63):(A[P++]=240|I>>>18,A[P++]=128|I>>>12&63,A[P++]=128|I>>>6&63,A[P++]=128|I&63);return A},E=function(w,A){var I;for(A=A||w.length,A>w.length&&(A=w.length),I=A-1;I>=0&&(w[I]&192)===128;)I--;return I<0||I===0?A:I+d[w[I]]>A?I:A},b=function(w){var A,I,V,q,P=w.length,U=new Array(P*2);for(I=0,A=0;A<P;){if(V=w[A++],V<128){U[I++]=V;continue}if(q=d[V],q>4){U[I++]=65533,A+=q-1;continue}for(V&=q===2?31:q===3?15:7;q>1&&A<P;)V=V<<6|w[A++]&63,q--;if(q>1){U[I++]=65533;continue}V<65536?U[I++]=V:(V-=65536,U[I++]=55296|V>>10&1023,U[I++]=56320|V&1023)}return U.length!==I&&(U.subarray?U=U.subarray(0,I):U.length=I),o.applyFromCharCode(U)};i.utf8encode=function(A){return u.nodebuffer?l.newBufferFrom(A,"utf-8"):g(A)},i.utf8decode=function(A){return u.nodebuffer?o.transformTo("nodebuffer",A).toString("utf-8"):(A=o.transformTo(u.uint8array?"uint8array":"array",A),b(A))};function M(){c.call(this,"utf-8 decode"),this.leftOver=null}o.inherits(M,c),M.prototype.processChunk=function(w){var A=o.transformTo(u.uint8array?"uint8array":"array",w.data);if(this.leftOver&&this.leftOver.length){if(u.uint8array){var I=A;A=new Uint8Array(I.length+this.leftOver.length),A.set(this.leftOver,0),A.set(I,this.leftOver.length)}else A=this.leftOver.concat(A);this.leftOver=null}var V=E(A),q=A;V!==A.length&&(u.uint8array?(q=A.subarray(0,V),this.leftOver=A.subarray(V,A.length)):(q=A.slice(0,V),this.leftOver=A.slice(V,A.length))),this.push({data:i.utf8decode(q),meta:w.meta})},M.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=M;function D(){c.call(this,"utf-8 encode")}o.inherits(D,c),D.prototype.processChunk=function(w){this.push({data:i.utf8encode(w.data),meta:w.meta})},i.Utf8EncodeWorker=D},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,n,i){var o=t("./support"),u=t("./base64"),l=t("./nodejsUtils"),c=t("./external");t("setimmediate");function d(w){var A=null;return o.uint8array?A=new Uint8Array(w.length):A=new Array(w.length),g(w,A)}i.newBlob=function(w,A){i.checkSupport("blob");try{return new Blob([w],{type:A})}catch{try{var I=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,V=new I;return V.append(w),V.getBlob(A)}catch{throw new Error("Bug : can't construct the Blob.")}}};function m(w){return w}function g(w,A){for(var I=0;I<w.length;++I)A[I]=w.charCodeAt(I)&255;return A}var E={stringifyByChunk:function(w,A,I){var V=[],q=0,P=w.length;if(P<=I)return String.fromCharCode.apply(null,w);for(;q<P;)A==="array"||A==="nodebuffer"?V.push(String.fromCharCode.apply(null,w.slice(q,Math.min(q+I,P)))):V.push(String.fromCharCode.apply(null,w.subarray(q,Math.min(q+I,P)))),q+=I;return V.join("")},stringifyByChar:function(w){for(var A="",I=0;I<w.length;I++)A+=String.fromCharCode(w[I]);return A},applyCanBeUsed:{uint8array:(function(){try{return o.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return o.nodebuffer&&String.fromCharCode.apply(null,l.allocBuffer(1)).length===1}catch{return!1}})()}};function b(w){var A=65536,I=i.getTypeOf(w),V=!0;if(I==="uint8array"?V=E.applyCanBeUsed.uint8array:I==="nodebuffer"&&(V=E.applyCanBeUsed.nodebuffer),V)for(;A>1;)try{return E.stringifyByChunk(w,I,A)}catch{A=Math.floor(A/2)}return E.stringifyByChar(w)}i.applyFromCharCode=b;function M(w,A){for(var I=0;I<w.length;I++)A[I]=w[I];return A}var D={};D.string={string:m,array:function(w){return g(w,new Array(w.length))},arraybuffer:function(w){return D.string.uint8array(w).buffer},uint8array:function(w){return g(w,new Uint8Array(w.length))},nodebuffer:function(w){return g(w,l.allocBuffer(w.length))}},D.array={string:b,array:m,arraybuffer:function(w){return new Uint8Array(w).buffer},uint8array:function(w){return new Uint8Array(w)},nodebuffer:function(w){return l.newBufferFrom(w)}},D.arraybuffer={string:function(w){return b(new Uint8Array(w))},array:function(w){return M(new Uint8Array(w),new Array(w.byteLength))},arraybuffer:m,uint8array:function(w){return new Uint8Array(w)},nodebuffer:function(w){return l.newBufferFrom(new Uint8Array(w))}},D.uint8array={string:b,array:function(w){return M(w,new Array(w.length))},arraybuffer:function(w){return w.buffer},uint8array:m,nodebuffer:function(w){return l.newBufferFrom(w)}},D.nodebuffer={string:b,array:function(w){return M(w,new Array(w.length))},arraybuffer:function(w){return D.nodebuffer.uint8array(w).buffer},uint8array:function(w){return M(w,new Uint8Array(w.length))},nodebuffer:m},i.transformTo=function(w,A){if(A||(A=""),!w)return A;i.checkSupport(w);var I=i.getTypeOf(A),V=D[I][w](A);return V},i.resolve=function(w){for(var A=w.split("/"),I=[],V=0;V<A.length;V++){var q=A[V];q==="."||q===""&&V!==0&&V!==A.length-1||(q===".."?I.pop():I.push(q))}return I.join("/")},i.getTypeOf=function(w){if(typeof w=="string")return"string";if(Object.prototype.toString.call(w)==="[object Array]")return"array";if(o.nodebuffer&&l.isBuffer(w))return"nodebuffer";if(o.uint8array&&w instanceof Uint8Array)return"uint8array";if(o.arraybuffer&&w instanceof ArrayBuffer)return"arraybuffer"},i.checkSupport=function(w){var A=o[w.toLowerCase()];if(!A)throw new Error(w+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(w){var A="",I,V;for(V=0;V<(w||"").length;V++)I=w.charCodeAt(V),A+="\\x"+(I<16?"0":"")+I.toString(16).toUpperCase();return A},i.delay=function(w,A,I){setImmediate(function(){w.apply(I||null,A||[])})},i.inherits=function(w,A){var I=function(){};I.prototype=A.prototype,w.prototype=new I},i.extend=function(){var w={},A,I;for(A=0;A<arguments.length;A++)for(I in arguments[A])Object.prototype.hasOwnProperty.call(arguments[A],I)&&typeof w[I]>"u"&&(w[I]=arguments[A][I]);return w},i.prepareContent=function(w,A,I,V,q){var P=c.Promise.resolve(A).then(function(U){var R=o.blob&&(U instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(U))!==-1);return R&&typeof FileReader<"u"?new c.Promise(function(S,C){var N=new FileReader;N.onload=function(z){S(z.target.result)},N.onerror=function(z){C(z.target.error)},N.readAsArrayBuffer(U)}):U});return P.then(function(U){var R=i.getTypeOf(U);return R?(R==="arraybuffer"?U=i.transformTo("uint8array",U):R==="string"&&(q?U=u.decode(U):I&&V!==!0&&(U=d(U))),U):c.Promise.reject(new Error("Can't read the data of '"+w+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,n,i){var o=t("./reader/readerFor"),u=t("./utils"),l=t("./signature"),c=t("./zipEntry"),d=t("./support");function m(g){this.files=[],this.loadOptions=g}m.prototype={checkSignature:function(g){if(!this.reader.readAndCheckSignature(g)){this.reader.index-=4;var E=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+u.pretty(E)+", expected "+u.pretty(g)+")")}},isSignature:function(g,E){var b=this.reader.index;this.reader.setIndex(g);var M=this.reader.readString(4),D=M===E;return this.reader.setIndex(b),D},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var g=this.reader.readData(this.zipCommentLength),E=d.uint8array?"uint8array":"array",b=u.transformTo(E,g);this.zipComment=this.loadOptions.decodeFileName(b)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var g=this.zip64EndOfCentralSize-44,E=0,b,M,D;E<g;)b=this.reader.readInt(2),M=this.reader.readInt(4),D=this.reader.readData(M),this.zip64ExtensibleData[b]={id:b,length:M,value:D}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var g,E;for(g=0;g<this.files.length;g++)E=this.files[g],this.reader.setIndex(E.localHeaderOffset),this.checkSignature(l.LOCAL_FILE_HEADER),E.readLocalPart(this.reader),E.handleUTF8(),E.processAttributes()},readCentralDir:function(){var g;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(l.CENTRAL_FILE_HEADER);)g=new c({zip64:this.zip64},this.loadOptions),g.readCentralPart(this.reader),this.files.push(g);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var g=this.reader.lastIndexOfSignature(l.CENTRAL_DIRECTORY_END);if(g<0){var E=!this.isSignature(0,l.LOCAL_FILE_HEADER);throw E?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory")}this.reader.setIndex(g);var b=g;if(this.checkSignature(l.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===u.MAX_VALUE_16BITS||this.diskWithCentralDirStart===u.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===u.MAX_VALUE_16BITS||this.centralDirRecords===u.MAX_VALUE_16BITS||this.centralDirSize===u.MAX_VALUE_32BITS||this.centralDirOffset===u.MAX_VALUE_32BITS){if(this.zip64=!0,g=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR),g<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(g),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,l.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var M=this.centralDirOffset+this.centralDirSize;this.zip64&&(M+=20,M+=12+this.zip64EndOfCentralSize);var D=b-M;if(D>0)this.isSignature(b,l.CENTRAL_FILE_HEADER)||(this.reader.zero=D);else if(D<0)throw new Error("Corrupted zip: missing "+Math.abs(D)+" bytes.")},prepareReader:function(g){this.reader=o(g)},load:function(g){this.prepareReader(g),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=m},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,n,i){var o=t("./reader/readerFor"),u=t("./utils"),l=t("./compressedObject"),c=t("./crc32"),d=t("./utf8"),m=t("./compressions"),g=t("./support"),E=0,b=3,M=function(w){for(var A in m)if(Object.prototype.hasOwnProperty.call(m,A)&&m[A].magic===w)return m[A];return null};function D(w,A){this.options=w,this.loadOptions=A}D.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},readLocalPart:function(w){var A,I;if(w.skip(22),this.fileNameLength=w.readInt(2),I=w.readInt(2),this.fileName=w.readData(this.fileNameLength),w.skip(I),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(A=M(this.compressionMethod),A===null)throw new Error("Corrupted zip : compression "+u.pretty(this.compressionMethod)+" unknown (inner file : "+u.transformTo("string",this.fileName)+")");this.decompressed=new l(this.compressedSize,this.uncompressedSize,this.crc32,A,w.readData(this.compressedSize))},readCentralPart:function(w){this.versionMadeBy=w.readInt(2),w.skip(2),this.bitFlag=w.readInt(2),this.compressionMethod=w.readString(2),this.date=w.readDate(),this.crc32=w.readInt(4),this.compressedSize=w.readInt(4),this.uncompressedSize=w.readInt(4);var A=w.readInt(2);if(this.extraFieldsLength=w.readInt(2),this.fileCommentLength=w.readInt(2),this.diskNumberStart=w.readInt(2),this.internalFileAttributes=w.readInt(2),this.externalFileAttributes=w.readInt(4),this.localHeaderOffset=w.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");w.skip(A),this.readExtraFields(w),this.parseZIP64ExtraField(w),this.fileComment=w.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var w=this.versionMadeBy>>8;this.dir=!!(this.externalFileAttributes&16),w===E&&(this.dosPermissions=this.externalFileAttributes&63),w===b&&(this.unixPermissions=this.externalFileAttributes>>16&65535),!this.dir&&this.fileNameStr.slice(-1)==="/"&&(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var w=o(this.extraFields[1].value);this.uncompressedSize===u.MAX_VALUE_32BITS&&(this.uncompressedSize=w.readInt(8)),this.compressedSize===u.MAX_VALUE_32BITS&&(this.compressedSize=w.readInt(8)),this.localHeaderOffset===u.MAX_VALUE_32BITS&&(this.localHeaderOffset=w.readInt(8)),this.diskNumberStart===u.MAX_VALUE_32BITS&&(this.diskNumberStart=w.readInt(4))}},readExtraFields:function(w){var A=w.index+this.extraFieldsLength,I,V,q;for(this.extraFields||(this.extraFields={});w.index+4<A;)I=w.readInt(2),V=w.readInt(2),q=w.readData(V),this.extraFields[I]={id:I,length:V,value:q};w.setIndex(A)},handleUTF8:function(){var w=g.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=d.utf8decode(this.fileName),this.fileCommentStr=d.utf8decode(this.fileComment);else{var A=this.findExtraFieldUnicodePath();if(A!==null)this.fileNameStr=A;else{var I=u.transformTo(w,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(I)}var V=this.findExtraFieldUnicodeComment();if(V!==null)this.fileCommentStr=V;else{var q=u.transformTo(w,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(q)}}},findExtraFieldUnicodePath:function(){var w=this.extraFields[28789];if(w){var A=o(w.value);return A.readInt(1)!==1||c(this.fileName)!==A.readInt(4)?null:d.utf8decode(A.readData(w.length-5))}return null},findExtraFieldUnicodeComment:function(){var w=this.extraFields[25461];if(w){var A=o(w.value);return A.readInt(1)!==1||c(this.fileComment)!==A.readInt(4)?null:d.utf8decode(A.readData(w.length-5))}return null}},n.exports=D},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,n,i){var o=t("./stream/StreamHelper"),u=t("./stream/DataWorker"),l=t("./utf8"),c=t("./compressedObject"),d=t("./stream/GenericWorker"),m=function(M,D,w){this.name=M,this.dir=w.dir,this.date=w.date,this.comment=w.comment,this.unixPermissions=w.unixPermissions,this.dosPermissions=w.dosPermissions,this._data=D,this._dataBinary=w.binary,this.options={compression:w.compression,compressionOptions:w.compressionOptions}};m.prototype={internalStream:function(M){var D=null,w="string";try{if(!M)throw new Error("No output type specified.");w=M.toLowerCase();var A=w==="string"||w==="text";(w==="binarystring"||w==="text")&&(w="string"),D=this._decompressWorker();var I=!this._dataBinary;I&&!A&&(D=D.pipe(new l.Utf8EncodeWorker)),!I&&A&&(D=D.pipe(new l.Utf8DecodeWorker))}catch(V){D=new d("error"),D.error(V)}return new o(D,w,"")},async:function(M,D){return this.internalStream(M).accumulate(D)},nodeStream:function(M,D){return this.internalStream(M||"nodebuffer").toNodejsStream(D)},_compressWorker:function(M,D){if(this._data instanceof c&&this._data.compression.magic===M.magic)return this._data.getCompressedWorker();var w=this._decompressWorker();return this._dataBinary||(w=w.pipe(new l.Utf8EncodeWorker)),c.createWorkerFrom(w,M,D)},_decompressWorker:function(){return this._data instanceof c?this._data.getContentWorker():this._data instanceof d?this._data:new u(this._data)}};for(var g=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],E=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},b=0;b<g.length;b++)m.prototype[g[b]]=E;n.exports=m},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,n,i){(function(o){var u=o.MutationObserver||o.WebKitMutationObserver,l;if(u){var c=0,d=new u(M),m=o.document.createTextNode("");d.observe(m,{characterData:!0}),l=function(){m.data=c=++c%2}}else if(!o.setImmediate&&typeof o.MessageChannel<"u"){var g=new o.MessageChannel;g.port1.onmessage=M,l=function(){g.port2.postMessage(0)}}else"document"in o&&"onreadystatechange"in o.document.createElement("script")?l=function(){var w=o.document.createElement("script");w.onreadystatechange=function(){M(),w.onreadystatechange=null,w.parentNode.removeChild(w),w=null},o.document.documentElement.appendChild(w)}:l=function(){setTimeout(M,0)};var E,b=[];function M(){E=!0;for(var w,A,I=b.length;I;){for(A=b,b=[],w=-1;++w<I;)A[w]();I=b.length}E=!1}n.exports=D;function D(w){b.push(w)===1&&!E&&l()}}).call(this,typeof ai<"u"?ai:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,n,i){var o=t("immediate");function u(){}var l={},c=["REJECTED"],d=["FULFILLED"],m=["PENDING"];n.exports=g;function g(P){if(typeof P!="function")throw new TypeError("resolver must be a function");this.state=m,this.queue=[],this.outcome=void 0,P!==u&&D(this,P)}g.prototype.finally=function(P){if(typeof P!="function")return this;var U=this.constructor;return this.then(R,S);function R(C){function N(){return C}return U.resolve(P()).then(N)}function S(C){function N(){throw C}return U.resolve(P()).then(N)}},g.prototype.catch=function(P){return this.then(null,P)},g.prototype.then=function(P,U){if(typeof P!="function"&&this.state===d||typeof U!="function"&&this.state===c)return this;var R=new this.constructor(u);if(this.state!==m){var S=this.state===d?P:U;b(R,S,this.outcome)}else this.queue.push(new E(R,P,U));return R};function E(P,U,R){this.promise=P,typeof U=="function"&&(this.onFulfilled=U,this.callFulfilled=this.otherCallFulfilled),typeof R=="function"&&(this.onRejected=R,this.callRejected=this.otherCallRejected)}E.prototype.callFulfilled=function(P){l.resolve(this.promise,P)},E.prototype.otherCallFulfilled=function(P){b(this.promise,this.onFulfilled,P)},E.prototype.callRejected=function(P){l.reject(this.promise,P)},E.prototype.otherCallRejected=function(P){b(this.promise,this.onRejected,P)};function b(P,U,R){o(function(){var S;try{S=U(R)}catch(C){return l.reject(P,C)}S===P?l.reject(P,new TypeError("Cannot resolve promise with itself")):l.resolve(P,S)})}l.resolve=function(P,U){var R=w(M,U);if(R.status==="error")return l.reject(P,R.value);var S=R.value;if(S)D(P,S);else{P.state=d,P.outcome=U;for(var C=-1,N=P.queue.length;++C<N;)P.queue[C].callFulfilled(U)}return P},l.reject=function(P,U){P.state=c,P.outcome=U;for(var R=-1,S=P.queue.length;++R<S;)P.queue[R].callRejected(U);return P};function M(P){var U=P&&P.then;if(P&&(typeof P=="object"||typeof P=="function")&&typeof U=="function")return function(){U.apply(P,arguments)}}function D(P,U){var R=!1;function S(j){R||(R=!0,l.reject(P,j))}function C(j){R||(R=!0,l.resolve(P,j))}function N(){U(C,S)}var z=w(N);z.status==="error"&&S(z.value)}function w(P,U){var R={};try{R.value=P(U),R.status="success"}catch(S){R.status="error",R.value=S}return R}g.resolve=A;function A(P){return P instanceof this?P:l.resolve(new this(u),P)}g.reject=I;function I(P){var U=new this(u);return l.reject(U,P)}g.all=V;function V(P){var U=this;if(Object.prototype.toString.call(P)!=="[object Array]")return this.reject(new TypeError("must be an array"));var R=P.length,S=!1;if(!R)return this.resolve([]);for(var C=new Array(R),N=0,z=-1,j=new this(u);++z<R;)L(P[z],z);return j;function L(he,_e){U.resolve(he).then(De,function(de){S||(S=!0,l.reject(j,de))});function De(de){C[_e]=de,++N===R&&!S&&(S=!0,l.resolve(j,C))}}}g.race=q;function q(P){var U=this;if(Object.prototype.toString.call(P)!=="[object Array]")return this.reject(new TypeError("must be an array"));var R=P.length,S=!1;if(!R)return this.resolve([]);for(var C=-1,N=new this(u);++C<R;)z(P[C]);return N;function z(j){U.resolve(j).then(function(L){S||(S=!0,l.resolve(N,L))},function(L){S||(S=!0,l.reject(N,L))})}}},{immediate:36}],38:[function(t,n,i){var o=t("./lib/utils/common").assign,u=t("./lib/deflate"),l=t("./lib/inflate"),c=t("./lib/zlib/constants"),d={};o(d,u,l,c),n.exports=d},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,n,i){var o=t("./zlib/deflate"),u=t("./utils/common"),l=t("./utils/strings"),c=t("./zlib/messages"),d=t("./zlib/zstream"),m=Object.prototype.toString,g=0,E=4,b=0,M=1,D=2,w=-1,A=0,I=8;function V(R){if(!(this instanceof V))return new V(R);this.options=u.assign({level:w,method:I,chunkSize:16384,windowBits:15,memLevel:8,strategy:A,to:""},R||{});var S=this.options;S.raw&&S.windowBits>0?S.windowBits=-S.windowBits:S.gzip&&S.windowBits>0&&S.windowBits<16&&(S.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var C=o.deflateInit2(this.strm,S.level,S.method,S.windowBits,S.memLevel,S.strategy);if(C!==b)throw new Error(c[C]);if(S.header&&o.deflateSetHeader(this.strm,S.header),S.dictionary){var N;if(typeof S.dictionary=="string"?N=l.string2buf(S.dictionary):m.call(S.dictionary)==="[object ArrayBuffer]"?N=new Uint8Array(S.dictionary):N=S.dictionary,C=o.deflateSetDictionary(this.strm,N),C!==b)throw new Error(c[C]);this._dict_set=!0}}V.prototype.push=function(R,S){var C=this.strm,N=this.options.chunkSize,z,j;if(this.ended)return!1;j=S===~~S?S:S===!0?E:g,typeof R=="string"?C.input=l.string2buf(R):m.call(R)==="[object ArrayBuffer]"?C.input=new Uint8Array(R):C.input=R,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new u.Buf8(N),C.next_out=0,C.avail_out=N),z=o.deflate(C,j),z!==M&&z!==b)return this.onEnd(z),this.ended=!0,!1;(C.avail_out===0||C.avail_in===0&&(j===E||j===D))&&(this.options.to==="string"?this.onData(l.buf2binstring(u.shrinkBuf(C.output,C.next_out))):this.onData(u.shrinkBuf(C.output,C.next_out)))}while((C.avail_in>0||C.avail_out===0)&&z!==M);return j===E?(z=o.deflateEnd(this.strm),this.onEnd(z),this.ended=!0,z===b):(j===D&&(this.onEnd(b),C.avail_out=0),!0)},V.prototype.onData=function(R){this.chunks.push(R)},V.prototype.onEnd=function(R){R===b&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=u.flattenChunks(this.chunks)),this.chunks=[],this.err=R,this.msg=this.strm.msg};function q(R,S){var C=new V(S);if(C.push(R,!0),C.err)throw C.msg||c[C.err];return C.result}function P(R,S){return S=S||{},S.raw=!0,q(R,S)}function U(R,S){return S=S||{},S.gzip=!0,q(R,S)}i.Deflate=V,i.deflate=q,i.deflateRaw=P,i.gzip=U},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,n,i){var o=t("./zlib/inflate"),u=t("./utils/common"),l=t("./utils/strings"),c=t("./zlib/constants"),d=t("./zlib/messages"),m=t("./zlib/zstream"),g=t("./zlib/gzheader"),E=Object.prototype.toString;function b(w){if(!(this instanceof b))return new b(w);this.options=u.assign({chunkSize:16384,windowBits:0,to:""},w||{});var A=this.options;A.raw&&A.windowBits>=0&&A.windowBits<16&&(A.windowBits=-A.windowBits,A.windowBits===0&&(A.windowBits=-15)),A.windowBits>=0&&A.windowBits<16&&!(w&&w.windowBits)&&(A.windowBits+=32),A.windowBits>15&&A.windowBits<48&&(A.windowBits&15)===0&&(A.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new m,this.strm.avail_out=0;var I=o.inflateInit2(this.strm,A.windowBits);if(I!==c.Z_OK)throw new Error(d[I]);this.header=new g,o.inflateGetHeader(this.strm,this.header)}b.prototype.push=function(w,A){var I=this.strm,V=this.options.chunkSize,q=this.options.dictionary,P,U,R,S,C,N,z=!1;if(this.ended)return!1;U=A===~~A?A:A===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof w=="string"?I.input=l.binstring2buf(w):E.call(w)==="[object ArrayBuffer]"?I.input=new Uint8Array(w):I.input=w,I.next_in=0,I.avail_in=I.input.length;do{if(I.avail_out===0&&(I.output=new u.Buf8(V),I.next_out=0,I.avail_out=V),P=o.inflate(I,c.Z_NO_FLUSH),P===c.Z_NEED_DICT&&q&&(typeof q=="string"?N=l.string2buf(q):E.call(q)==="[object ArrayBuffer]"?N=new Uint8Array(q):N=q,P=o.inflateSetDictionary(this.strm,N)),P===c.Z_BUF_ERROR&&z===!0&&(P=c.Z_OK,z=!1),P!==c.Z_STREAM_END&&P!==c.Z_OK)return this.onEnd(P),this.ended=!0,!1;I.next_out&&(I.avail_out===0||P===c.Z_STREAM_END||I.avail_in===0&&(U===c.Z_FINISH||U===c.Z_SYNC_FLUSH))&&(this.options.to==="string"?(R=l.utf8border(I.output,I.next_out),S=I.next_out-R,C=l.buf2string(I.output,R),I.next_out=S,I.avail_out=V-S,S&&u.arraySet(I.output,I.output,R,S,0),this.onData(C)):this.onData(u.shrinkBuf(I.output,I.next_out))),I.avail_in===0&&I.avail_out===0&&(z=!0)}while((I.avail_in>0||I.avail_out===0)&&P!==c.Z_STREAM_END);return P===c.Z_STREAM_END&&(U=c.Z_FINISH),U===c.Z_FINISH?(P=o.inflateEnd(this.strm),this.onEnd(P),this.ended=!0,P===c.Z_OK):(U===c.Z_SYNC_FLUSH&&(this.onEnd(c.Z_OK),I.avail_out=0),!0)},b.prototype.onData=function(w){this.chunks.push(w)},b.prototype.onEnd=function(w){w===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=u.flattenChunks(this.chunks)),this.chunks=[],this.err=w,this.msg=this.strm.msg};function M(w,A){var I=new b(A);if(I.push(w,!0),I.err)throw I.msg||d[I.err];return I.result}function D(w,A){return A=A||{},A.raw=!0,M(w,A)}i.Inflate=b,i.inflate=M,i.inflateRaw=D,i.ungzip=M},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,n,i){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(c){for(var d=Array.prototype.slice.call(arguments,1);d.length;){var m=d.shift();if(m){if(typeof m!="object")throw new TypeError(m+"must be non-object");for(var g in m)m.hasOwnProperty(g)&&(c[g]=m[g])}}return c},i.shrinkBuf=function(c,d){return c.length===d?c:c.subarray?c.subarray(0,d):(c.length=d,c)};var u={arraySet:function(c,d,m,g,E){if(d.subarray&&c.subarray){c.set(d.subarray(m,m+g),E);return}for(var b=0;b<g;b++)c[E+b]=d[m+b]},flattenChunks:function(c){var d,m,g,E,b,M;for(g=0,d=0,m=c.length;d<m;d++)g+=c[d].length;for(M=new Uint8Array(g),E=0,d=0,m=c.length;d<m;d++)b=c[d],M.set(b,E),E+=b.length;return M}},l={arraySet:function(c,d,m,g,E){for(var b=0;b<g;b++)c[E+b]=d[m+b]},flattenChunks:function(c){return[].concat.apply([],c)}};i.setTyped=function(c){c?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,u)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,l))},i.setTyped(o)},{}],42:[function(t,n,i){var o=t("./common"),u=!0,l=!0;try{String.fromCharCode.apply(null,[0])}catch{u=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{l=!1}for(var c=new o.Buf8(256),d=0;d<256;d++)c[d]=d>=252?6:d>=248?5:d>=240?4:d>=224?3:d>=192?2:1;c[254]=c[254]=1,i.string2buf=function(g){var E,b,M,D,w,A=g.length,I=0;for(D=0;D<A;D++)b=g.charCodeAt(D),(b&64512)===55296&&D+1<A&&(M=g.charCodeAt(D+1),(M&64512)===56320&&(b=65536+(b-55296<<10)+(M-56320),D++)),I+=b<128?1:b<2048?2:b<65536?3:4;for(E=new o.Buf8(I),w=0,D=0;w<I;D++)b=g.charCodeAt(D),(b&64512)===55296&&D+1<A&&(M=g.charCodeAt(D+1),(M&64512)===56320&&(b=65536+(b-55296<<10)+(M-56320),D++)),b<128?E[w++]=b:b<2048?(E[w++]=192|b>>>6,E[w++]=128|b&63):b<65536?(E[w++]=224|b>>>12,E[w++]=128|b>>>6&63,E[w++]=128|b&63):(E[w++]=240|b>>>18,E[w++]=128|b>>>12&63,E[w++]=128|b>>>6&63,E[w++]=128|b&63);return E};function m(g,E){if(E<65537&&(g.subarray&&l||!g.subarray&&u))return String.fromCharCode.apply(null,o.shrinkBuf(g,E));for(var b="",M=0;M<E;M++)b+=String.fromCharCode(g[M]);return b}i.buf2binstring=function(g){return m(g,g.length)},i.binstring2buf=function(g){for(var E=new o.Buf8(g.length),b=0,M=E.length;b<M;b++)E[b]=g.charCodeAt(b);return E},i.buf2string=function(g,E){var b,M,D,w,A=E||g.length,I=new Array(A*2);for(M=0,b=0;b<A;){if(D=g[b++],D<128){I[M++]=D;continue}if(w=c[D],w>4){I[M++]=65533,b+=w-1;continue}for(D&=w===2?31:w===3?15:7;w>1&&b<A;)D=D<<6|g[b++]&63,w--;if(w>1){I[M++]=65533;continue}D<65536?I[M++]=D:(D-=65536,I[M++]=55296|D>>10&1023,I[M++]=56320|D&1023)}return m(I,M)},i.utf8border=function(g,E){var b;for(E=E||g.length,E>g.length&&(E=g.length),b=E-1;b>=0&&(g[b]&192)===128;)b--;return b<0||b===0?E:b+c[g[b]]>E?b:E}},{"./common":41}],43:[function(t,n,i){function o(u,l,c,d){for(var m=u&65535|0,g=u>>>16&65535|0,E=0;c!==0;){E=c>2e3?2e3:c,c-=E;do m=m+l[d++]|0,g=g+m|0;while(--E);m%=65521,g%=65521}return m|g<<16|0}n.exports=o},{}],44:[function(t,n,i){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,n,i){function o(){for(var c,d=[],m=0;m<256;m++){c=m;for(var g=0;g<8;g++)c=c&1?3988292384^c>>>1:c>>>1;d[m]=c}return d}var u=o();function l(c,d,m,g){var E=u,b=g+m;c^=-1;for(var M=g;M<b;M++)c=c>>>8^E[(c^d[M])&255];return c^-1}n.exports=l},{}],46:[function(t,n,i){var o=t("../utils/common"),u=t("./trees"),l=t("./adler32"),c=t("./crc32"),d=t("./messages"),m=0,g=1,E=3,b=4,M=5,D=0,w=1,A=-2,I=-3,V=-5,q=-1,P=1,U=2,R=3,S=4,C=0,N=2,z=8,j=9,L=15,he=8,_e=29,De=256,de=De+1+_e,J=30,ce=19,xe=2*de+1,Q=15,se=3,Ce=258,Ie=Ce+se+1,He=32,Ke=42,et=69,Fe=73,Je=91,Xe=103,ft=113,yt=666,mt=1,_t=2,kt=3,St=4,Tt=3;function Ht(y,X){return y.msg=d[X],X}function Dt(y){return(y<<1)-(y>4?9:0)}function wt(y){for(var X=y.length;--X>=0;)y[X]=0}function it(y){var X=y.state,ie=X.pending;ie>y.avail_out&&(ie=y.avail_out),ie!==0&&(o.arraySet(y.output,X.pending_buf,X.pending_out,ie,y.next_out),y.next_out+=ie,X.pending_out+=ie,y.total_out+=ie,y.avail_out-=ie,X.pending-=ie,X.pending===0&&(X.pending_out=0))}function gt(y,X){u._tr_flush_block(y,y.block_start>=0?y.block_start:-1,y.strstart-y.block_start,X),y.block_start=y.strstart,it(y.strm)}function dt(y,X){y.pending_buf[y.pending++]=X}function an(y,X){y.pending_buf[y.pending++]=X>>>8&255,y.pending_buf[y.pending++]=X&255}function _n(y,X,ie,F){var Z=y.avail_in;return Z>F&&(Z=F),Z===0?0:(y.avail_in-=Z,o.arraySet(X,y.input,y.next_in,Z,ie),y.state.wrap===1?y.adler=l(y.adler,X,Z,ie):y.state.wrap===2&&(y.adler=c(y.adler,X,Z,ie)),y.next_in+=Z,y.total_in+=Z,Z)}function xn(y,X){var ie=y.max_chain_length,F=y.strstart,Z,ue,Ue=y.prev_length,Ne=y.nice_match,ze=y.strstart>y.w_size-Ie?y.strstart-(y.w_size-Ie):0,lt=y.window,Lt=y.w_mask,xt=y.prev,at=y.strstart+Ce,Vt=lt[F+Ue-1],Nt=lt[F+Ue];y.prev_length>=y.good_match&&(ie>>=2),Ne>y.lookahead&&(Ne=y.lookahead);do if(Z=X,!(lt[Z+Ue]!==Nt||lt[Z+Ue-1]!==Vt||lt[Z]!==lt[F]||lt[++Z]!==lt[F+1])){F+=2,Z++;do;while(lt[++F]===lt[++Z]&&lt[++F]===lt[++Z]&&lt[++F]===lt[++Z]&&lt[++F]===lt[++Z]&&lt[++F]===lt[++Z]&&lt[++F]===lt[++Z]&&lt[++F]===lt[++Z]&&lt[++F]===lt[++Z]&&F<at);if(ue=Ce-(at-F),F=at-Ce,ue>Ue){if(y.match_start=X,Ue=ue,ue>=Ne)break;Vt=lt[F+Ue-1],Nt=lt[F+Ue]}}while((X=xt[X&Lt])>ze&&--ie!==0);return Ue<=y.lookahead?Ue:y.lookahead}function jt(y){var X=y.w_size,ie,F,Z,ue,Ue;do{if(ue=y.window_size-y.lookahead-y.strstart,y.strstart>=X+(X-Ie)){o.arraySet(y.window,y.window,X,X,0),y.match_start-=X,y.strstart-=X,y.block_start-=X,F=y.hash_size,ie=F;do Z=y.head[--ie],y.head[ie]=Z>=X?Z-X:0;while(--F);F=X,ie=F;do Z=y.prev[--ie],y.prev[ie]=Z>=X?Z-X:0;while(--F);ue+=X}if(y.strm.avail_in===0)break;if(F=_n(y.strm,y.window,y.strstart+y.lookahead,ue),y.lookahead+=F,y.lookahead+y.insert>=se)for(Ue=y.strstart-y.insert,y.ins_h=y.window[Ue],y.ins_h=(y.ins_h<<y.hash_shift^y.window[Ue+1])&y.hash_mask;y.insert&&(y.ins_h=(y.ins_h<<y.hash_shift^y.window[Ue+se-1])&y.hash_mask,y.prev[Ue&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=Ue,Ue++,y.insert--,!(y.lookahead+y.insert<se)););}while(y.lookahead<Ie&&y.strm.avail_in!==0)}function on(y,X){var ie=65535;for(ie>y.pending_buf_size-5&&(ie=y.pending_buf_size-5);;){if(y.lookahead<=1){if(jt(y),y.lookahead===0&&X===m)return mt;if(y.lookahead===0)break}y.strstart+=y.lookahead,y.lookahead=0;var F=y.block_start+ie;if((y.strstart===0||y.strstart>=F)&&(y.lookahead=y.strstart-F,y.strstart=F,gt(y,!1),y.strm.avail_out===0)||y.strstart-y.block_start>=y.w_size-Ie&&(gt(y,!1),y.strm.avail_out===0))return mt}return y.insert=0,X===b?(gt(y,!0),y.strm.avail_out===0?kt:St):(y.strstart>y.block_start&&(gt(y,!1),y.strm.avail_out===0),mt)}function pn(y,X){for(var ie,F;;){if(y.lookahead<Ie){if(jt(y),y.lookahead<Ie&&X===m)return mt;if(y.lookahead===0)break}if(ie=0,y.lookahead>=se&&(y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+se-1])&y.hash_mask,ie=y.prev[y.strstart&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=y.strstart),ie!==0&&y.strstart-ie<=y.w_size-Ie&&(y.match_length=xn(y,ie)),y.match_length>=se)if(F=u._tr_tally(y,y.strstart-y.match_start,y.match_length-se),y.lookahead-=y.match_length,y.match_length<=y.max_lazy_match&&y.lookahead>=se){y.match_length--;do y.strstart++,y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+se-1])&y.hash_mask,ie=y.prev[y.strstart&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=y.strstart;while(--y.match_length!==0);y.strstart++}else y.strstart+=y.match_length,y.match_length=0,y.ins_h=y.window[y.strstart],y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+1])&y.hash_mask;else F=u._tr_tally(y,0,y.window[y.strstart]),y.lookahead--,y.strstart++;if(F&&(gt(y,!1),y.strm.avail_out===0))return mt}return y.insert=y.strstart<se-1?y.strstart:se-1,X===b?(gt(y,!0),y.strm.avail_out===0?kt:St):y.last_lit&&(gt(y,!1),y.strm.avail_out===0)?mt:_t}function en(y,X){for(var ie,F,Z;;){if(y.lookahead<Ie){if(jt(y),y.lookahead<Ie&&X===m)return mt;if(y.lookahead===0)break}if(ie=0,y.lookahead>=se&&(y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+se-1])&y.hash_mask,ie=y.prev[y.strstart&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=y.strstart),y.prev_length=y.match_length,y.prev_match=y.match_start,y.match_length=se-1,ie!==0&&y.prev_length<y.max_lazy_match&&y.strstart-ie<=y.w_size-Ie&&(y.match_length=xn(y,ie),y.match_length<=5&&(y.strategy===P||y.match_length===se&&y.strstart-y.match_start>4096)&&(y.match_length=se-1)),y.prev_length>=se&&y.match_length<=y.prev_length){Z=y.strstart+y.lookahead-se,F=u._tr_tally(y,y.strstart-1-y.prev_match,y.prev_length-se),y.lookahead-=y.prev_length-1,y.prev_length-=2;do++y.strstart<=Z&&(y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+se-1])&y.hash_mask,ie=y.prev[y.strstart&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=y.strstart);while(--y.prev_length!==0);if(y.match_available=0,y.match_length=se-1,y.strstart++,F&&(gt(y,!1),y.strm.avail_out===0))return mt}else if(y.match_available){if(F=u._tr_tally(y,0,y.window[y.strstart-1]),F&&gt(y,!1),y.strstart++,y.lookahead--,y.strm.avail_out===0)return mt}else y.match_available=1,y.strstart++,y.lookahead--}return y.match_available&&(F=u._tr_tally(y,0,y.window[y.strstart-1]),y.match_available=0),y.insert=y.strstart<se-1?y.strstart:se-1,X===b?(gt(y,!0),y.strm.avail_out===0?kt:St):y.last_lit&&(gt(y,!1),y.strm.avail_out===0)?mt:_t}function Qt(y,X){for(var ie,F,Z,ue,Ue=y.window;;){if(y.lookahead<=Ce){if(jt(y),y.lookahead<=Ce&&X===m)return mt;if(y.lookahead===0)break}if(y.match_length=0,y.lookahead>=se&&y.strstart>0&&(Z=y.strstart-1,F=Ue[Z],F===Ue[++Z]&&F===Ue[++Z]&&F===Ue[++Z])){ue=y.strstart+Ce;do;while(F===Ue[++Z]&&F===Ue[++Z]&&F===Ue[++Z]&&F===Ue[++Z]&&F===Ue[++Z]&&F===Ue[++Z]&&F===Ue[++Z]&&F===Ue[++Z]&&Z<ue);y.match_length=Ce-(ue-Z),y.match_length>y.lookahead&&(y.match_length=y.lookahead)}if(y.match_length>=se?(ie=u._tr_tally(y,1,y.match_length-se),y.lookahead-=y.match_length,y.strstart+=y.match_length,y.match_length=0):(ie=u._tr_tally(y,0,y.window[y.strstart]),y.lookahead--,y.strstart++),ie&&(gt(y,!1),y.strm.avail_out===0))return mt}return y.insert=0,X===b?(gt(y,!0),y.strm.avail_out===0?kt:St):y.last_lit&&(gt(y,!1),y.strm.avail_out===0)?mt:_t}function Tn(y,X){for(var ie;;){if(y.lookahead===0&&(jt(y),y.lookahead===0)){if(X===m)return mt;break}if(y.match_length=0,ie=u._tr_tally(y,0,y.window[y.strstart]),y.lookahead--,y.strstart++,ie&&(gt(y,!1),y.strm.avail_out===0))return mt}return y.insert=0,X===b?(gt(y,!0),y.strm.avail_out===0?kt:St):y.last_lit&&(gt(y,!1),y.strm.avail_out===0)?mt:_t}function Gt(y,X,ie,F,Z){this.good_length=y,this.max_lazy=X,this.nice_length=ie,this.max_chain=F,this.func=Z}var hn;hn=[new Gt(0,0,0,0,on),new Gt(4,4,8,4,pn),new Gt(4,5,16,8,pn),new Gt(4,6,32,32,pn),new Gt(4,4,16,16,en),new Gt(8,16,32,32,en),new Gt(8,16,128,128,en),new Gt(8,32,128,256,en),new Gt(32,128,258,1024,en),new Gt(32,258,258,4096,en)];function Pn(y){y.window_size=2*y.w_size,wt(y.head),y.max_lazy_match=hn[y.level].max_lazy,y.good_match=hn[y.level].good_length,y.nice_match=hn[y.level].nice_length,y.max_chain_length=hn[y.level].max_chain,y.strstart=0,y.block_start=0,y.lookahead=0,y.insert=0,y.match_length=y.prev_length=se-1,y.match_available=0,y.ins_h=0}function $(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=z,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new o.Buf16(xe*2),this.dyn_dtree=new o.Buf16((2*J+1)*2),this.bl_tree=new o.Buf16((2*ce+1)*2),wt(this.dyn_ltree),wt(this.dyn_dtree),wt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new o.Buf16(Q+1),this.heap=new o.Buf16(2*de+1),wt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new o.Buf16(2*de+1),wt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Se(y){var X;return!y||!y.state?Ht(y,A):(y.total_in=y.total_out=0,y.data_type=N,X=y.state,X.pending=0,X.pending_out=0,X.wrap<0&&(X.wrap=-X.wrap),X.status=X.wrap?Ke:ft,y.adler=X.wrap===2?0:1,X.last_flush=m,u._tr_init(X),D)}function Re(y){var X=Se(y);return X===D&&Pn(y.state),X}function Ge(y,X){return!y||!y.state||y.state.wrap!==2?A:(y.state.gzhead=X,D)}function ne(y,X,ie,F,Z,ue){if(!y)return A;var Ue=1;if(X===q&&(X=6),F<0?(Ue=0,F=-F):F>15&&(Ue=2,F-=16),Z<1||Z>j||ie!==z||F<8||F>15||X<0||X>9||ue<0||ue>S)return Ht(y,A);F===8&&(F=9);var Ne=new $;return y.state=Ne,Ne.strm=y,Ne.wrap=Ue,Ne.gzhead=null,Ne.w_bits=F,Ne.w_size=1<<Ne.w_bits,Ne.w_mask=Ne.w_size-1,Ne.hash_bits=Z+7,Ne.hash_size=1<<Ne.hash_bits,Ne.hash_mask=Ne.hash_size-1,Ne.hash_shift=~~((Ne.hash_bits+se-1)/se),Ne.window=new o.Buf8(Ne.w_size*2),Ne.head=new o.Buf16(Ne.hash_size),Ne.prev=new o.Buf16(Ne.w_size),Ne.lit_bufsize=1<<Z+6,Ne.pending_buf_size=Ne.lit_bufsize*4,Ne.pending_buf=new o.Buf8(Ne.pending_buf_size),Ne.d_buf=1*Ne.lit_bufsize,Ne.l_buf=3*Ne.lit_bufsize,Ne.level=X,Ne.strategy=ue,Ne.method=ie,Re(y)}function be(y,X){return ne(y,X,z,L,he,C)}function v(y,X){var ie,F,Z,ue;if(!y||!y.state||X>M||X<0)return y?Ht(y,A):A;if(F=y.state,!y.output||!y.input&&y.avail_in!==0||F.status===yt&&X!==b)return Ht(y,y.avail_out===0?V:A);if(F.strm=y,ie=F.last_flush,F.last_flush=X,F.status===Ke)if(F.wrap===2)y.adler=0,dt(F,31),dt(F,139),dt(F,8),F.gzhead?(dt(F,(F.gzhead.text?1:0)+(F.gzhead.hcrc?2:0)+(F.gzhead.extra?4:0)+(F.gzhead.name?8:0)+(F.gzhead.comment?16:0)),dt(F,F.gzhead.time&255),dt(F,F.gzhead.time>>8&255),dt(F,F.gzhead.time>>16&255),dt(F,F.gzhead.time>>24&255),dt(F,F.level===9?2:F.strategy>=U||F.level<2?4:0),dt(F,F.gzhead.os&255),F.gzhead.extra&&F.gzhead.extra.length&&(dt(F,F.gzhead.extra.length&255),dt(F,F.gzhead.extra.length>>8&255)),F.gzhead.hcrc&&(y.adler=c(y.adler,F.pending_buf,F.pending,0)),F.gzindex=0,F.status=et):(dt(F,0),dt(F,0),dt(F,0),dt(F,0),dt(F,0),dt(F,F.level===9?2:F.strategy>=U||F.level<2?4:0),dt(F,Tt),F.status=ft);else{var Ue=z+(F.w_bits-8<<4)<<8,Ne=-1;F.strategy>=U||F.level<2?Ne=0:F.level<6?Ne=1:F.level===6?Ne=2:Ne=3,Ue|=Ne<<6,F.strstart!==0&&(Ue|=He),Ue+=31-Ue%31,F.status=ft,an(F,Ue),F.strstart!==0&&(an(F,y.adler>>>16),an(F,y.adler&65535)),y.adler=1}if(F.status===et)if(F.gzhead.extra){for(Z=F.pending;F.gzindex<(F.gzhead.extra.length&65535)&&!(F.pending===F.pending_buf_size&&(F.gzhead.hcrc&&F.pending>Z&&(y.adler=c(y.adler,F.pending_buf,F.pending-Z,Z)),it(y),Z=F.pending,F.pending===F.pending_buf_size));)dt(F,F.gzhead.extra[F.gzindex]&255),F.gzindex++;F.gzhead.hcrc&&F.pending>Z&&(y.adler=c(y.adler,F.pending_buf,F.pending-Z,Z)),F.gzindex===F.gzhead.extra.length&&(F.gzindex=0,F.status=Fe)}else F.status=Fe;if(F.status===Fe)if(F.gzhead.name){Z=F.pending;do{if(F.pending===F.pending_buf_size&&(F.gzhead.hcrc&&F.pending>Z&&(y.adler=c(y.adler,F.pending_buf,F.pending-Z,Z)),it(y),Z=F.pending,F.pending===F.pending_buf_size)){ue=1;break}F.gzindex<F.gzhead.name.length?ue=F.gzhead.name.charCodeAt(F.gzindex++)&255:ue=0,dt(F,ue)}while(ue!==0);F.gzhead.hcrc&&F.pending>Z&&(y.adler=c(y.adler,F.pending_buf,F.pending-Z,Z)),ue===0&&(F.gzindex=0,F.status=Je)}else F.status=Je;if(F.status===Je)if(F.gzhead.comment){Z=F.pending;do{if(F.pending===F.pending_buf_size&&(F.gzhead.hcrc&&F.pending>Z&&(y.adler=c(y.adler,F.pending_buf,F.pending-Z,Z)),it(y),Z=F.pending,F.pending===F.pending_buf_size)){ue=1;break}F.gzindex<F.gzhead.comment.length?ue=F.gzhead.comment.charCodeAt(F.gzindex++)&255:ue=0,dt(F,ue)}while(ue!==0);F.gzhead.hcrc&&F.pending>Z&&(y.adler=c(y.adler,F.pending_buf,F.pending-Z,Z)),ue===0&&(F.status=Xe)}else F.status=Xe;if(F.status===Xe&&(F.gzhead.hcrc?(F.pending+2>F.pending_buf_size&&it(y),F.pending+2<=F.pending_buf_size&&(dt(F,y.adler&255),dt(F,y.adler>>8&255),y.adler=0,F.status=ft)):F.status=ft),F.pending!==0){if(it(y),y.avail_out===0)return F.last_flush=-1,D}else if(y.avail_in===0&&Dt(X)<=Dt(ie)&&X!==b)return Ht(y,V);if(F.status===yt&&y.avail_in!==0)return Ht(y,V);if(y.avail_in!==0||F.lookahead!==0||X!==m&&F.status!==yt){var ze=F.strategy===U?Tn(F,X):F.strategy===R?Qt(F,X):hn[F.level].func(F,X);if((ze===kt||ze===St)&&(F.status=yt),ze===mt||ze===kt)return y.avail_out===0&&(F.last_flush=-1),D;if(ze===_t&&(X===g?u._tr_align(F):X!==M&&(u._tr_stored_block(F,0,0,!1),X===E&&(wt(F.head),F.lookahead===0&&(F.strstart=0,F.block_start=0,F.insert=0))),it(y),y.avail_out===0))return F.last_flush=-1,D}return X!==b?D:F.wrap<=0?w:(F.wrap===2?(dt(F,y.adler&255),dt(F,y.adler>>8&255),dt(F,y.adler>>16&255),dt(F,y.adler>>24&255),dt(F,y.total_in&255),dt(F,y.total_in>>8&255),dt(F,y.total_in>>16&255),dt(F,y.total_in>>24&255)):(an(F,y.adler>>>16),an(F,y.adler&65535)),it(y),F.wrap>0&&(F.wrap=-F.wrap),F.pending!==0?D:w)}function O(y){var X;return!y||!y.state?A:(X=y.state.status,X!==Ke&&X!==et&&X!==Fe&&X!==Je&&X!==Xe&&X!==ft&&X!==yt?Ht(y,A):(y.state=null,X===ft?Ht(y,I):D))}function G(y,X){var ie=X.length,F,Z,ue,Ue,Ne,ze,lt,Lt;if(!y||!y.state||(F=y.state,Ue=F.wrap,Ue===2||Ue===1&&F.status!==Ke||F.lookahead))return A;for(Ue===1&&(y.adler=l(y.adler,X,ie,0)),F.wrap=0,ie>=F.w_size&&(Ue===0&&(wt(F.head),F.strstart=0,F.block_start=0,F.insert=0),Lt=new o.Buf8(F.w_size),o.arraySet(Lt,X,ie-F.w_size,F.w_size,0),X=Lt,ie=F.w_size),Ne=y.avail_in,ze=y.next_in,lt=y.input,y.avail_in=ie,y.next_in=0,y.input=X,jt(F);F.lookahead>=se;){Z=F.strstart,ue=F.lookahead-(se-1);do F.ins_h=(F.ins_h<<F.hash_shift^F.window[Z+se-1])&F.hash_mask,F.prev[Z&F.w_mask]=F.head[F.ins_h],F.head[F.ins_h]=Z,Z++;while(--ue);F.strstart=Z,F.lookahead=se-1,jt(F)}return F.strstart+=F.lookahead,F.block_start=F.strstart,F.insert=F.lookahead,F.lookahead=0,F.match_length=F.prev_length=se-1,F.match_available=0,y.next_in=ze,y.input=lt,y.avail_in=Ne,F.wrap=Ue,D}i.deflateInit=be,i.deflateInit2=ne,i.deflateReset=Re,i.deflateResetKeep=Se,i.deflateSetHeader=Ge,i.deflate=v,i.deflateEnd=O,i.deflateSetDictionary=G,i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,n,i){function o(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}n.exports=o},{}],48:[function(t,n,i){var o=30,u=12;n.exports=function(c,d){var m,g,E,b,M,D,w,A,I,V,q,P,U,R,S,C,N,z,j,L,he,_e,De,de,J;m=c.state,g=c.next_in,de=c.input,E=g+(c.avail_in-5),b=c.next_out,J=c.output,M=b-(d-c.avail_out),D=b+(c.avail_out-257),w=m.dmax,A=m.wsize,I=m.whave,V=m.wnext,q=m.window,P=m.hold,U=m.bits,R=m.lencode,S=m.distcode,C=(1<<m.lenbits)-1,N=(1<<m.distbits)-1;e:do{U<15&&(P+=de[g++]<<U,U+=8,P+=de[g++]<<U,U+=8),z=R[P&C];t:for(;;){if(j=z>>>24,P>>>=j,U-=j,j=z>>>16&255,j===0)J[b++]=z&65535;else if(j&16){L=z&65535,j&=15,j&&(U<j&&(P+=de[g++]<<U,U+=8),L+=P&(1<<j)-1,P>>>=j,U-=j),U<15&&(P+=de[g++]<<U,U+=8,P+=de[g++]<<U,U+=8),z=S[P&N];n:for(;;){if(j=z>>>24,P>>>=j,U-=j,j=z>>>16&255,j&16){if(he=z&65535,j&=15,U<j&&(P+=de[g++]<<U,U+=8,U<j&&(P+=de[g++]<<U,U+=8)),he+=P&(1<<j)-1,he>w){c.msg="invalid distance too far back",m.mode=o;break e}if(P>>>=j,U-=j,j=b-M,he>j){if(j=he-j,j>I&&m.sane){c.msg="invalid distance too far back",m.mode=o;break e}if(_e=0,De=q,V===0){if(_e+=A-j,j<L){L-=j;do J[b++]=q[_e++];while(--j);_e=b-he,De=J}}else if(V<j){if(_e+=A+V-j,j-=V,j<L){L-=j;do J[b++]=q[_e++];while(--j);if(_e=0,V<L){j=V,L-=j;do J[b++]=q[_e++];while(--j);_e=b-he,De=J}}}else if(_e+=V-j,j<L){L-=j;do J[b++]=q[_e++];while(--j);_e=b-he,De=J}for(;L>2;)J[b++]=De[_e++],J[b++]=De[_e++],J[b++]=De[_e++],L-=3;L&&(J[b++]=De[_e++],L>1&&(J[b++]=De[_e++]))}else{_e=b-he;do J[b++]=J[_e++],J[b++]=J[_e++],J[b++]=J[_e++],L-=3;while(L>2);L&&(J[b++]=J[_e++],L>1&&(J[b++]=J[_e++]))}}else if((j&64)===0){z=S[(z&65535)+(P&(1<<j)-1)];continue n}else{c.msg="invalid distance code",m.mode=o;break e}break}}else if((j&64)===0){z=R[(z&65535)+(P&(1<<j)-1)];continue t}else if(j&32){m.mode=u;break e}else{c.msg="invalid literal/length code",m.mode=o;break e}break}}while(g<E&&b<D);L=U>>3,g-=L,U-=L<<3,P&=(1<<U)-1,c.next_in=g,c.next_out=b,c.avail_in=g<E?5+(E-g):5-(g-E),c.avail_out=b<D?257+(D-b):257-(b-D),m.hold=P,m.bits=U}},{}],49:[function(t,n,i){var o=t("../utils/common"),u=t("./adler32"),l=t("./crc32"),c=t("./inffast"),d=t("./inftrees"),m=0,g=1,E=2,b=4,M=5,D=6,w=0,A=1,I=2,V=-2,q=-3,P=-4,U=-5,R=8,S=1,C=2,N=3,z=4,j=5,L=6,he=7,_e=8,De=9,de=10,J=11,ce=12,xe=13,Q=14,se=15,Ce=16,Ie=17,He=18,Ke=19,et=20,Fe=21,Je=22,Xe=23,ft=24,yt=25,mt=26,_t=27,kt=28,St=29,Tt=30,Ht=31,Dt=32,wt=852,it=592,gt=15,dt=gt;function an(ne){return(ne>>>24&255)+(ne>>>8&65280)+((ne&65280)<<8)+((ne&255)<<24)}function _n(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new o.Buf16(320),this.work=new o.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function xn(ne){var be;return!ne||!ne.state?V:(be=ne.state,ne.total_in=ne.total_out=be.total=0,ne.msg="",be.wrap&&(ne.adler=be.wrap&1),be.mode=S,be.last=0,be.havedict=0,be.dmax=32768,be.head=null,be.hold=0,be.bits=0,be.lencode=be.lendyn=new o.Buf32(wt),be.distcode=be.distdyn=new o.Buf32(it),be.sane=1,be.back=-1,w)}function jt(ne){var be;return!ne||!ne.state?V:(be=ne.state,be.wsize=0,be.whave=0,be.wnext=0,xn(ne))}function on(ne,be){var v,O;return!ne||!ne.state||(O=ne.state,be<0?(v=0,be=-be):(v=(be>>4)+1,be<48&&(be&=15)),be&&(be<8||be>15))?V:(O.window!==null&&O.wbits!==be&&(O.window=null),O.wrap=v,O.wbits=be,jt(ne))}function pn(ne,be){var v,O;return ne?(O=new _n,ne.state=O,O.window=null,v=on(ne,be),v!==w&&(ne.state=null),v):V}function en(ne){return pn(ne,dt)}var Qt=!0,Tn,Gt;function hn(ne){if(Qt){var be;for(Tn=new o.Buf32(512),Gt=new o.Buf32(32),be=0;be<144;)ne.lens[be++]=8;for(;be<256;)ne.lens[be++]=9;for(;be<280;)ne.lens[be++]=7;for(;be<288;)ne.lens[be++]=8;for(d(g,ne.lens,0,288,Tn,0,ne.work,{bits:9}),be=0;be<32;)ne.lens[be++]=5;d(E,ne.lens,0,32,Gt,0,ne.work,{bits:5}),Qt=!1}ne.lencode=Tn,ne.lenbits=9,ne.distcode=Gt,ne.distbits=5}function Pn(ne,be,v,O){var G,y=ne.state;return y.window===null&&(y.wsize=1<<y.wbits,y.wnext=0,y.whave=0,y.window=new o.Buf8(y.wsize)),O>=y.wsize?(o.arraySet(y.window,be,v-y.wsize,y.wsize,0),y.wnext=0,y.whave=y.wsize):(G=y.wsize-y.wnext,G>O&&(G=O),o.arraySet(y.window,be,v-O,G,y.wnext),O-=G,O?(o.arraySet(y.window,be,v-O,O,0),y.wnext=O,y.whave=y.wsize):(y.wnext+=G,y.wnext===y.wsize&&(y.wnext=0),y.whave<y.wsize&&(y.whave+=G))),0}function $(ne,be){var v,O,G,y,X,ie,F,Z,ue,Ue,Ne,ze,lt,Lt,xt=0,at,Vt,Nt,mn,gn,yr,un,jn,wn=new o.Buf8(4),qn,Kn,ui=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!ne||!ne.state||!ne.output||!ne.input&&ne.avail_in!==0)return V;v=ne.state,v.mode===ce&&(v.mode=xe),X=ne.next_out,G=ne.output,F=ne.avail_out,y=ne.next_in,O=ne.input,ie=ne.avail_in,Z=v.hold,ue=v.bits,Ue=ie,Ne=F,jn=w;e:for(;;)switch(v.mode){case S:if(v.wrap===0){v.mode=xe;break}for(;ue<16;){if(ie===0)break e;ie--,Z+=O[y++]<<ue,ue+=8}if(v.wrap&2&&Z===35615){v.check=0,wn[0]=Z&255,wn[1]=Z>>>8&255,v.check=l(v.check,wn,2,0),Z=0,ue=0,v.mode=C;break}if(v.flags=0,v.head&&(v.head.done=!1),!(v.wrap&1)||(((Z&255)<<8)+(Z>>8))%31){ne.msg="incorrect header check",v.mode=Tt;break}if((Z&15)!==R){ne.msg="unknown compression method",v.mode=Tt;break}if(Z>>>=4,ue-=4,un=(Z&15)+8,v.wbits===0)v.wbits=un;else if(un>v.wbits){ne.msg="invalid window size",v.mode=Tt;break}v.dmax=1<<un,ne.adler=v.check=1,v.mode=Z&512?de:ce,Z=0,ue=0;break;case C:for(;ue<16;){if(ie===0)break e;ie--,Z+=O[y++]<<ue,ue+=8}if(v.flags=Z,(v.flags&255)!==R){ne.msg="unknown compression method",v.mode=Tt;break}if(v.flags&57344){ne.msg="unknown header flags set",v.mode=Tt;break}v.head&&(v.head.text=Z>>8&1),v.flags&512&&(wn[0]=Z&255,wn[1]=Z>>>8&255,v.check=l(v.check,wn,2,0)),Z=0,ue=0,v.mode=N;case N:for(;ue<32;){if(ie===0)break e;ie--,Z+=O[y++]<<ue,ue+=8}v.head&&(v.head.time=Z),v.flags&512&&(wn[0]=Z&255,wn[1]=Z>>>8&255,wn[2]=Z>>>16&255,wn[3]=Z>>>24&255,v.check=l(v.check,wn,4,0)),Z=0,ue=0,v.mode=z;case z:for(;ue<16;){if(ie===0)break e;ie--,Z+=O[y++]<<ue,ue+=8}v.head&&(v.head.xflags=Z&255,v.head.os=Z>>8),v.flags&512&&(wn[0]=Z&255,wn[1]=Z>>>8&255,v.check=l(v.check,wn,2,0)),Z=0,ue=0,v.mode=j;case j:if(v.flags&1024){for(;ue<16;){if(ie===0)break e;ie--,Z+=O[y++]<<ue,ue+=8}v.length=Z,v.head&&(v.head.extra_len=Z),v.flags&512&&(wn[0]=Z&255,wn[1]=Z>>>8&255,v.check=l(v.check,wn,2,0)),Z=0,ue=0}else v.head&&(v.head.extra=null);v.mode=L;case L:if(v.flags&1024&&(ze=v.length,ze>ie&&(ze=ie),ze&&(v.head&&(un=v.head.extra_len-v.length,v.head.extra||(v.head.extra=new Array(v.head.extra_len)),o.arraySet(v.head.extra,O,y,ze,un)),v.flags&512&&(v.check=l(v.check,O,ze,y)),ie-=ze,y+=ze,v.length-=ze),v.length))break e;v.length=0,v.mode=he;case he:if(v.flags&2048){if(ie===0)break e;ze=0;do un=O[y+ze++],v.head&&un&&v.length<65536&&(v.head.name+=String.fromCharCode(un));while(un&&ze<ie);if(v.flags&512&&(v.check=l(v.check,O,ze,y)),ie-=ze,y+=ze,un)break e}else v.head&&(v.head.name=null);v.length=0,v.mode=_e;case _e:if(v.flags&4096){if(ie===0)break e;ze=0;do un=O[y+ze++],v.head&&un&&v.length<65536&&(v.head.comment+=String.fromCharCode(un));while(un&&ze<ie);if(v.flags&512&&(v.check=l(v.check,O,ze,y)),ie-=ze,y+=ze,un)break e}else v.head&&(v.head.comment=null);v.mode=De;case De:if(v.flags&512){for(;ue<16;){if(ie===0)break e;ie--,Z+=O[y++]<<ue,ue+=8}if(Z!==(v.check&65535)){ne.msg="header crc mismatch",v.mode=Tt;break}Z=0,ue=0}v.head&&(v.head.hcrc=v.flags>>9&1,v.head.done=!0),ne.adler=v.check=0,v.mode=ce;break;case de:for(;ue<32;){if(ie===0)break e;ie--,Z+=O[y++]<<ue,ue+=8}ne.adler=v.check=an(Z),Z=0,ue=0,v.mode=J;case J:if(v.havedict===0)return ne.next_out=X,ne.avail_out=F,ne.next_in=y,ne.avail_in=ie,v.hold=Z,v.bits=ue,I;ne.adler=v.check=1,v.mode=ce;case ce:if(be===M||be===D)break e;case xe:if(v.last){Z>>>=ue&7,ue-=ue&7,v.mode=_t;break}for(;ue<3;){if(ie===0)break e;ie--,Z+=O[y++]<<ue,ue+=8}switch(v.last=Z&1,Z>>>=1,ue-=1,Z&3){case 0:v.mode=Q;break;case 1:if(hn(v),v.mode=et,be===D){Z>>>=2,ue-=2;break e}break;case 2:v.mode=Ie;break;case 3:ne.msg="invalid block type",v.mode=Tt}Z>>>=2,ue-=2;break;case Q:for(Z>>>=ue&7,ue-=ue&7;ue<32;){if(ie===0)break e;ie--,Z+=O[y++]<<ue,ue+=8}if((Z&65535)!==(Z>>>16^65535)){ne.msg="invalid stored block lengths",v.mode=Tt;break}if(v.length=Z&65535,Z=0,ue=0,v.mode=se,be===D)break e;case se:v.mode=Ce;case Ce:if(ze=v.length,ze){if(ze>ie&&(ze=ie),ze>F&&(ze=F),ze===0)break e;o.arraySet(G,O,y,ze,X),ie-=ze,y+=ze,F-=ze,X+=ze,v.length-=ze;break}v.mode=ce;break;case Ie:for(;ue<14;){if(ie===0)break e;ie--,Z+=O[y++]<<ue,ue+=8}if(v.nlen=(Z&31)+257,Z>>>=5,ue-=5,v.ndist=(Z&31)+1,Z>>>=5,ue-=5,v.ncode=(Z&15)+4,Z>>>=4,ue-=4,v.nlen>286||v.ndist>30){ne.msg="too many length or distance symbols",v.mode=Tt;break}v.have=0,v.mode=He;case He:for(;v.have<v.ncode;){for(;ue<3;){if(ie===0)break e;ie--,Z+=O[y++]<<ue,ue+=8}v.lens[ui[v.have++]]=Z&7,Z>>>=3,ue-=3}for(;v.have<19;)v.lens[ui[v.have++]]=0;if(v.lencode=v.lendyn,v.lenbits=7,qn={bits:v.lenbits},jn=d(m,v.lens,0,19,v.lencode,0,v.work,qn),v.lenbits=qn.bits,jn){ne.msg="invalid code lengths set",v.mode=Tt;break}v.have=0,v.mode=Ke;case Ke:for(;v.have<v.nlen+v.ndist;){for(;xt=v.lencode[Z&(1<<v.lenbits)-1],at=xt>>>24,Vt=xt>>>16&255,Nt=xt&65535,!(at<=ue);){if(ie===0)break e;ie--,Z+=O[y++]<<ue,ue+=8}if(Nt<16)Z>>>=at,ue-=at,v.lens[v.have++]=Nt;else{if(Nt===16){for(Kn=at+2;ue<Kn;){if(ie===0)break e;ie--,Z+=O[y++]<<ue,ue+=8}if(Z>>>=at,ue-=at,v.have===0){ne.msg="invalid bit length repeat",v.mode=Tt;break}un=v.lens[v.have-1],ze=3+(Z&3),Z>>>=2,ue-=2}else if(Nt===17){for(Kn=at+3;ue<Kn;){if(ie===0)break e;ie--,Z+=O[y++]<<ue,ue+=8}Z>>>=at,ue-=at,un=0,ze=3+(Z&7),Z>>>=3,ue-=3}else{for(Kn=at+7;ue<Kn;){if(ie===0)break e;ie--,Z+=O[y++]<<ue,ue+=8}Z>>>=at,ue-=at,un=0,ze=11+(Z&127),Z>>>=7,ue-=7}if(v.have+ze>v.nlen+v.ndist){ne.msg="invalid bit length repeat",v.mode=Tt;break}for(;ze--;)v.lens[v.have++]=un}}if(v.mode===Tt)break;if(v.lens[256]===0){ne.msg="invalid code -- missing end-of-block",v.mode=Tt;break}if(v.lenbits=9,qn={bits:v.lenbits},jn=d(g,v.lens,0,v.nlen,v.lencode,0,v.work,qn),v.lenbits=qn.bits,jn){ne.msg="invalid literal/lengths set",v.mode=Tt;break}if(v.distbits=6,v.distcode=v.distdyn,qn={bits:v.distbits},jn=d(E,v.lens,v.nlen,v.ndist,v.distcode,0,v.work,qn),v.distbits=qn.bits,jn){ne.msg="invalid distances set",v.mode=Tt;break}if(v.mode=et,be===D)break e;case et:v.mode=Fe;case Fe:if(ie>=6&&F>=258){ne.next_out=X,ne.avail_out=F,ne.next_in=y,ne.avail_in=ie,v.hold=Z,v.bits=ue,c(ne,Ne),X=ne.next_out,G=ne.output,F=ne.avail_out,y=ne.next_in,O=ne.input,ie=ne.avail_in,Z=v.hold,ue=v.bits,v.mode===ce&&(v.back=-1);break}for(v.back=0;xt=v.lencode[Z&(1<<v.lenbits)-1],at=xt>>>24,Vt=xt>>>16&255,Nt=xt&65535,!(at<=ue);){if(ie===0)break e;ie--,Z+=O[y++]<<ue,ue+=8}if(Vt&&(Vt&240)===0){for(mn=at,gn=Vt,yr=Nt;xt=v.lencode[yr+((Z&(1<<mn+gn)-1)>>mn)],at=xt>>>24,Vt=xt>>>16&255,Nt=xt&65535,!(mn+at<=ue);){if(ie===0)break e;ie--,Z+=O[y++]<<ue,ue+=8}Z>>>=mn,ue-=mn,v.back+=mn}if(Z>>>=at,ue-=at,v.back+=at,v.length=Nt,Vt===0){v.mode=mt;break}if(Vt&32){v.back=-1,v.mode=ce;break}if(Vt&64){ne.msg="invalid literal/length code",v.mode=Tt;break}v.extra=Vt&15,v.mode=Je;case Je:if(v.extra){for(Kn=v.extra;ue<Kn;){if(ie===0)break e;ie--,Z+=O[y++]<<ue,ue+=8}v.length+=Z&(1<<v.extra)-1,Z>>>=v.extra,ue-=v.extra,v.back+=v.extra}v.was=v.length,v.mode=Xe;case Xe:for(;xt=v.distcode[Z&(1<<v.distbits)-1],at=xt>>>24,Vt=xt>>>16&255,Nt=xt&65535,!(at<=ue);){if(ie===0)break e;ie--,Z+=O[y++]<<ue,ue+=8}if((Vt&240)===0){for(mn=at,gn=Vt,yr=Nt;xt=v.distcode[yr+((Z&(1<<mn+gn)-1)>>mn)],at=xt>>>24,Vt=xt>>>16&255,Nt=xt&65535,!(mn+at<=ue);){if(ie===0)break e;ie--,Z+=O[y++]<<ue,ue+=8}Z>>>=mn,ue-=mn,v.back+=mn}if(Z>>>=at,ue-=at,v.back+=at,Vt&64){ne.msg="invalid distance code",v.mode=Tt;break}v.offset=Nt,v.extra=Vt&15,v.mode=ft;case ft:if(v.extra){for(Kn=v.extra;ue<Kn;){if(ie===0)break e;ie--,Z+=O[y++]<<ue,ue+=8}v.offset+=Z&(1<<v.extra)-1,Z>>>=v.extra,ue-=v.extra,v.back+=v.extra}if(v.offset>v.dmax){ne.msg="invalid distance too far back",v.mode=Tt;break}v.mode=yt;case yt:if(F===0)break e;if(ze=Ne-F,v.offset>ze){if(ze=v.offset-ze,ze>v.whave&&v.sane){ne.msg="invalid distance too far back",v.mode=Tt;break}ze>v.wnext?(ze-=v.wnext,lt=v.wsize-ze):lt=v.wnext-ze,ze>v.length&&(ze=v.length),Lt=v.window}else Lt=G,lt=X-v.offset,ze=v.length;ze>F&&(ze=F),F-=ze,v.length-=ze;do G[X++]=Lt[lt++];while(--ze);v.length===0&&(v.mode=Fe);break;case mt:if(F===0)break e;G[X++]=v.length,F--,v.mode=Fe;break;case _t:if(v.wrap){for(;ue<32;){if(ie===0)break e;ie--,Z|=O[y++]<<ue,ue+=8}if(Ne-=F,ne.total_out+=Ne,v.total+=Ne,Ne&&(ne.adler=v.check=v.flags?l(v.check,G,Ne,X-Ne):u(v.check,G,Ne,X-Ne)),Ne=F,(v.flags?Z:an(Z))!==v.check){ne.msg="incorrect data check",v.mode=Tt;break}Z=0,ue=0}v.mode=kt;case kt:if(v.wrap&&v.flags){for(;ue<32;){if(ie===0)break e;ie--,Z+=O[y++]<<ue,ue+=8}if(Z!==(v.total&4294967295)){ne.msg="incorrect length check",v.mode=Tt;break}Z=0,ue=0}v.mode=St;case St:jn=A;break e;case Tt:jn=q;break e;case Ht:return P;case Dt:default:return V}return ne.next_out=X,ne.avail_out=F,ne.next_in=y,ne.avail_in=ie,v.hold=Z,v.bits=ue,(v.wsize||Ne!==ne.avail_out&&v.mode<Tt&&(v.mode<_t||be!==b))&&Pn(ne,ne.output,ne.next_out,Ne-ne.avail_out),Ue-=ne.avail_in,Ne-=ne.avail_out,ne.total_in+=Ue,ne.total_out+=Ne,v.total+=Ne,v.wrap&&Ne&&(ne.adler=v.check=v.flags?l(v.check,G,Ne,ne.next_out-Ne):u(v.check,G,Ne,ne.next_out-Ne)),ne.data_type=v.bits+(v.last?64:0)+(v.mode===ce?128:0)+(v.mode===et||v.mode===se?256:0),(Ue===0&&Ne===0||be===b)&&jn===w&&(jn=U),jn}function Se(ne){if(!ne||!ne.state)return V;var be=ne.state;return be.window&&(be.window=null),ne.state=null,w}function Re(ne,be){var v;return!ne||!ne.state||(v=ne.state,(v.wrap&2)===0)?V:(v.head=be,be.done=!1,w)}function Ge(ne,be){var v=be.length,O,G,y;return!ne||!ne.state||(O=ne.state,O.wrap!==0&&O.mode!==J)?V:O.mode===J&&(G=1,G=u(G,be,v,0),G!==O.check)?q:(y=Pn(ne,be,v,v),y?(O.mode=Ht,P):(O.havedict=1,w))}i.inflateReset=jt,i.inflateReset2=on,i.inflateResetKeep=xn,i.inflateInit=en,i.inflateInit2=pn,i.inflate=$,i.inflateEnd=Se,i.inflateGetHeader=Re,i.inflateSetDictionary=Ge,i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,n,i){var o=t("../utils/common"),u=15,l=852,c=592,d=0,m=1,g=2,E=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],b=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],M=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],D=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(A,I,V,q,P,U,R,S){var C=S.bits,N=0,z=0,j=0,L=0,he=0,_e=0,De=0,de=0,J=0,ce=0,xe,Q,se,Ce,Ie,He=null,Ke=0,et,Fe=new o.Buf16(u+1),Je=new o.Buf16(u+1),Xe=null,ft=0,yt,mt,_t;for(N=0;N<=u;N++)Fe[N]=0;for(z=0;z<q;z++)Fe[I[V+z]]++;for(he=C,L=u;L>=1&&Fe[L]===0;L--);if(he>L&&(he=L),L===0)return P[U++]=1<<24|64<<16|0,P[U++]=1<<24|64<<16|0,S.bits=1,0;for(j=1;j<L&&Fe[j]===0;j++);for(he<j&&(he=j),de=1,N=1;N<=u;N++)if(de<<=1,de-=Fe[N],de<0)return-1;if(de>0&&(A===d||L!==1))return-1;for(Je[1]=0,N=1;N<u;N++)Je[N+1]=Je[N]+Fe[N];for(z=0;z<q;z++)I[V+z]!==0&&(R[Je[I[V+z]]++]=z);if(A===d?(He=Xe=R,et=19):A===m?(He=E,Ke-=257,Xe=b,ft-=257,et=256):(He=M,Xe=D,et=-1),ce=0,z=0,N=j,Ie=U,_e=he,De=0,se=-1,J=1<<he,Ce=J-1,A===m&&J>l||A===g&&J>c)return 1;for(;;){yt=N-De,R[z]<et?(mt=0,_t=R[z]):R[z]>et?(mt=Xe[ft+R[z]],_t=He[Ke+R[z]]):(mt=96,_t=0),xe=1<<N-De,Q=1<<_e,j=Q;do Q-=xe,P[Ie+(ce>>De)+Q]=yt<<24|mt<<16|_t|0;while(Q!==0);for(xe=1<<N-1;ce&xe;)xe>>=1;if(xe!==0?(ce&=xe-1,ce+=xe):ce=0,z++,--Fe[N]===0){if(N===L)break;N=I[V+R[z]]}if(N>he&&(ce&Ce)!==se){for(De===0&&(De=he),Ie+=j,_e=N-De,de=1<<_e;_e+De<L&&(de-=Fe[_e+De],!(de<=0));)_e++,de<<=1;if(J+=1<<_e,A===m&&J>l||A===g&&J>c)return 1;se=ce&Ce,P[se]=he<<24|_e<<16|Ie-U|0}}return ce!==0&&(P[Ie+ce]=N-De<<24|64<<16|0),S.bits=he,0}},{"../utils/common":41}],51:[function(t,n,i){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,n,i){var o=t("../utils/common"),u=4,l=0,c=1,d=2;function m($){for(var Se=$.length;--Se>=0;)$[Se]=0}var g=0,E=1,b=2,M=3,D=258,w=29,A=256,I=A+1+w,V=30,q=19,P=2*I+1,U=15,R=16,S=7,C=256,N=16,z=17,j=18,L=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],he=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],_e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],De=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],de=512,J=new Array((I+2)*2);m(J);var ce=new Array(V*2);m(ce);var xe=new Array(de);m(xe);var Q=new Array(D-M+1);m(Q);var se=new Array(w);m(se);var Ce=new Array(V);m(Ce);function Ie($,Se,Re,Ge,ne){this.static_tree=$,this.extra_bits=Se,this.extra_base=Re,this.elems=Ge,this.max_length=ne,this.has_stree=$&&$.length}var He,Ke,et;function Fe($,Se){this.dyn_tree=$,this.max_code=0,this.stat_desc=Se}function Je($){return $<256?xe[$]:xe[256+($>>>7)]}function Xe($,Se){$.pending_buf[$.pending++]=Se&255,$.pending_buf[$.pending++]=Se>>>8&255}function ft($,Se,Re){$.bi_valid>R-Re?($.bi_buf|=Se<<$.bi_valid&65535,Xe($,$.bi_buf),$.bi_buf=Se>>R-$.bi_valid,$.bi_valid+=Re-R):($.bi_buf|=Se<<$.bi_valid&65535,$.bi_valid+=Re)}function yt($,Se,Re){ft($,Re[Se*2],Re[Se*2+1])}function mt($,Se){var Re=0;do Re|=$&1,$>>>=1,Re<<=1;while(--Se>0);return Re>>>1}function _t($){$.bi_valid===16?(Xe($,$.bi_buf),$.bi_buf=0,$.bi_valid=0):$.bi_valid>=8&&($.pending_buf[$.pending++]=$.bi_buf&255,$.bi_buf>>=8,$.bi_valid-=8)}function kt($,Se){var Re=Se.dyn_tree,Ge=Se.max_code,ne=Se.stat_desc.static_tree,be=Se.stat_desc.has_stree,v=Se.stat_desc.extra_bits,O=Se.stat_desc.extra_base,G=Se.stat_desc.max_length,y,X,ie,F,Z,ue,Ue=0;for(F=0;F<=U;F++)$.bl_count[F]=0;for(Re[$.heap[$.heap_max]*2+1]=0,y=$.heap_max+1;y<P;y++)X=$.heap[y],F=Re[Re[X*2+1]*2+1]+1,F>G&&(F=G,Ue++),Re[X*2+1]=F,!(X>Ge)&&($.bl_count[F]++,Z=0,X>=O&&(Z=v[X-O]),ue=Re[X*2],$.opt_len+=ue*(F+Z),be&&($.static_len+=ue*(ne[X*2+1]+Z)));if(Ue!==0){do{for(F=G-1;$.bl_count[F]===0;)F--;$.bl_count[F]--,$.bl_count[F+1]+=2,$.bl_count[G]--,Ue-=2}while(Ue>0);for(F=G;F!==0;F--)for(X=$.bl_count[F];X!==0;)ie=$.heap[--y],!(ie>Ge)&&(Re[ie*2+1]!==F&&($.opt_len+=(F-Re[ie*2+1])*Re[ie*2],Re[ie*2+1]=F),X--)}}function St($,Se,Re){var Ge=new Array(U+1),ne=0,be,v;for(be=1;be<=U;be++)Ge[be]=ne=ne+Re[be-1]<<1;for(v=0;v<=Se;v++){var O=$[v*2+1];O!==0&&($[v*2]=mt(Ge[O]++,O))}}function Tt(){var $,Se,Re,Ge,ne,be=new Array(U+1);for(Re=0,Ge=0;Ge<w-1;Ge++)for(se[Ge]=Re,$=0;$<1<<L[Ge];$++)Q[Re++]=Ge;for(Q[Re-1]=Ge,ne=0,Ge=0;Ge<16;Ge++)for(Ce[Ge]=ne,$=0;$<1<<he[Ge];$++)xe[ne++]=Ge;for(ne>>=7;Ge<V;Ge++)for(Ce[Ge]=ne<<7,$=0;$<1<<he[Ge]-7;$++)xe[256+ne++]=Ge;for(Se=0;Se<=U;Se++)be[Se]=0;for($=0;$<=143;)J[$*2+1]=8,$++,be[8]++;for(;$<=255;)J[$*2+1]=9,$++,be[9]++;for(;$<=279;)J[$*2+1]=7,$++,be[7]++;for(;$<=287;)J[$*2+1]=8,$++,be[8]++;for(St(J,I+1,be),$=0;$<V;$++)ce[$*2+1]=5,ce[$*2]=mt($,5);He=new Ie(J,L,A+1,I,U),Ke=new Ie(ce,he,0,V,U),et=new Ie(new Array(0),_e,0,q,S)}function Ht($){var Se;for(Se=0;Se<I;Se++)$.dyn_ltree[Se*2]=0;for(Se=0;Se<V;Se++)$.dyn_dtree[Se*2]=0;for(Se=0;Se<q;Se++)$.bl_tree[Se*2]=0;$.dyn_ltree[C*2]=1,$.opt_len=$.static_len=0,$.last_lit=$.matches=0}function Dt($){$.bi_valid>8?Xe($,$.bi_buf):$.bi_valid>0&&($.pending_buf[$.pending++]=$.bi_buf),$.bi_buf=0,$.bi_valid=0}function wt($,Se,Re,Ge){Dt($),Xe($,Re),Xe($,~Re),o.arraySet($.pending_buf,$.window,Se,Re,$.pending),$.pending+=Re}function it($,Se,Re,Ge){var ne=Se*2,be=Re*2;return $[ne]<$[be]||$[ne]===$[be]&&Ge[Se]<=Ge[Re]}function gt($,Se,Re){for(var Ge=$.heap[Re],ne=Re<<1;ne<=$.heap_len&&(ne<$.heap_len&&it(Se,$.heap[ne+1],$.heap[ne],$.depth)&&ne++,!it(Se,Ge,$.heap[ne],$.depth));)$.heap[Re]=$.heap[ne],Re=ne,ne<<=1;$.heap[Re]=Ge}function dt($,Se,Re){var Ge,ne,be=0,v,O;if($.last_lit!==0)do Ge=$.pending_buf[$.d_buf+be*2]<<8|$.pending_buf[$.d_buf+be*2+1],ne=$.pending_buf[$.l_buf+be],be++,Ge===0?yt($,ne,Se):(v=Q[ne],yt($,v+A+1,Se),O=L[v],O!==0&&(ne-=se[v],ft($,ne,O)),Ge--,v=Je(Ge),yt($,v,Re),O=he[v],O!==0&&(Ge-=Ce[v],ft($,Ge,O)));while(be<$.last_lit);yt($,C,Se)}function an($,Se){var Re=Se.dyn_tree,Ge=Se.stat_desc.static_tree,ne=Se.stat_desc.has_stree,be=Se.stat_desc.elems,v,O,G=-1,y;for($.heap_len=0,$.heap_max=P,v=0;v<be;v++)Re[v*2]!==0?($.heap[++$.heap_len]=G=v,$.depth[v]=0):Re[v*2+1]=0;for(;$.heap_len<2;)y=$.heap[++$.heap_len]=G<2?++G:0,Re[y*2]=1,$.depth[y]=0,$.opt_len--,ne&&($.static_len-=Ge[y*2+1]);for(Se.max_code=G,v=$.heap_len>>1;v>=1;v--)gt($,Re,v);y=be;do v=$.heap[1],$.heap[1]=$.heap[$.heap_len--],gt($,Re,1),O=$.heap[1],$.heap[--$.heap_max]=v,$.heap[--$.heap_max]=O,Re[y*2]=Re[v*2]+Re[O*2],$.depth[y]=($.depth[v]>=$.depth[O]?$.depth[v]:$.depth[O])+1,Re[v*2+1]=Re[O*2+1]=y,$.heap[1]=y++,gt($,Re,1);while($.heap_len>=2);$.heap[--$.heap_max]=$.heap[1],kt($,Se),St(Re,G,$.bl_count)}function _n($,Se,Re){var Ge,ne=-1,be,v=Se[1],O=0,G=7,y=4;for(v===0&&(G=138,y=3),Se[(Re+1)*2+1]=65535,Ge=0;Ge<=Re;Ge++)be=v,v=Se[(Ge+1)*2+1],!(++O<G&&be===v)&&(O<y?$.bl_tree[be*2]+=O:be!==0?(be!==ne&&$.bl_tree[be*2]++,$.bl_tree[N*2]++):O<=10?$.bl_tree[z*2]++:$.bl_tree[j*2]++,O=0,ne=be,v===0?(G=138,y=3):be===v?(G=6,y=3):(G=7,y=4))}function xn($,Se,Re){var Ge,ne=-1,be,v=Se[1],O=0,G=7,y=4;for(v===0&&(G=138,y=3),Ge=0;Ge<=Re;Ge++)if(be=v,v=Se[(Ge+1)*2+1],!(++O<G&&be===v)){if(O<y)do yt($,be,$.bl_tree);while(--O!==0);else be!==0?(be!==ne&&(yt($,be,$.bl_tree),O--),yt($,N,$.bl_tree),ft($,O-3,2)):O<=10?(yt($,z,$.bl_tree),ft($,O-3,3)):(yt($,j,$.bl_tree),ft($,O-11,7));O=0,ne=be,v===0?(G=138,y=3):be===v?(G=6,y=3):(G=7,y=4)}}function jt($){var Se;for(_n($,$.dyn_ltree,$.l_desc.max_code),_n($,$.dyn_dtree,$.d_desc.max_code),an($,$.bl_desc),Se=q-1;Se>=3&&$.bl_tree[De[Se]*2+1]===0;Se--);return $.opt_len+=3*(Se+1)+5+5+4,Se}function on($,Se,Re,Ge){var ne;for(ft($,Se-257,5),ft($,Re-1,5),ft($,Ge-4,4),ne=0;ne<Ge;ne++)ft($,$.bl_tree[De[ne]*2+1],3);xn($,$.dyn_ltree,Se-1),xn($,$.dyn_dtree,Re-1)}function pn($){var Se=4093624447,Re;for(Re=0;Re<=31;Re++,Se>>>=1)if(Se&1&&$.dyn_ltree[Re*2]!==0)return l;if($.dyn_ltree[18]!==0||$.dyn_ltree[20]!==0||$.dyn_ltree[26]!==0)return c;for(Re=32;Re<A;Re++)if($.dyn_ltree[Re*2]!==0)return c;return l}var en=!1;function Qt($){en||(Tt(),en=!0),$.l_desc=new Fe($.dyn_ltree,He),$.d_desc=new Fe($.dyn_dtree,Ke),$.bl_desc=new Fe($.bl_tree,et),$.bi_buf=0,$.bi_valid=0,Ht($)}function Tn($,Se,Re,Ge){ft($,(g<<1)+(Ge?1:0),3),wt($,Se,Re)}function Gt($){ft($,E<<1,3),yt($,C,J),_t($)}function hn($,Se,Re,Ge){var ne,be,v=0;$.level>0?($.strm.data_type===d&&($.strm.data_type=pn($)),an($,$.l_desc),an($,$.d_desc),v=jt($),ne=$.opt_len+3+7>>>3,be=$.static_len+3+7>>>3,be<=ne&&(ne=be)):ne=be=Re+5,Re+4<=ne&&Se!==-1?Tn($,Se,Re,Ge):$.strategy===u||be===ne?(ft($,(E<<1)+(Ge?1:0),3),dt($,J,ce)):(ft($,(b<<1)+(Ge?1:0),3),on($,$.l_desc.max_code+1,$.d_desc.max_code+1,v+1),dt($,$.dyn_ltree,$.dyn_dtree)),Ht($),Ge&&Dt($)}function Pn($,Se,Re){return $.pending_buf[$.d_buf+$.last_lit*2]=Se>>>8&255,$.pending_buf[$.d_buf+$.last_lit*2+1]=Se&255,$.pending_buf[$.l_buf+$.last_lit]=Re&255,$.last_lit++,Se===0?$.dyn_ltree[Re*2]++:($.matches++,Se--,$.dyn_ltree[(Q[Re]+A+1)*2]++,$.dyn_dtree[Je(Se)*2]++),$.last_lit===$.lit_bufsize-1}i._tr_init=Qt,i._tr_stored_block=Tn,i._tr_flush_block=hn,i._tr_tally=Pn,i._tr_align=Gt},{"../utils/common":41}],53:[function(t,n,i){function o(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}n.exports=o},{}],54:[function(t,n,i){(function(o){(function(u,l){if(u.setImmediate)return;var c=1,d={},m=!1,g=u.document,E;function b(S){typeof S!="function"&&(S=new Function(""+S));for(var C=new Array(arguments.length-1),N=0;N<C.length;N++)C[N]=arguments[N+1];var z={callback:S,args:C};return d[c]=z,E(c),c++}function M(S){delete d[S]}function D(S){var C=S.callback,N=S.args;switch(N.length){case 0:C();break;case 1:C(N[0]);break;case 2:C(N[0],N[1]);break;case 3:C(N[0],N[1],N[2]);break;default:C.apply(l,N);break}}function w(S){if(m)setTimeout(w,0,S);else{var C=d[S];if(C){m=!0;try{D(C)}finally{M(S),m=!1}}}}function A(){E=function(S){process.nextTick(function(){w(S)})}}function I(){if(u.postMessage&&!u.importScripts){var S=!0,C=u.onmessage;return u.onmessage=function(){S=!1},u.postMessage("","*"),u.onmessage=C,S}}function V(){var S="setImmediate$"+Math.random()+"$",C=function(N){N.source===u&&typeof N.data=="string"&&N.data.indexOf(S)===0&&w(+N.data.slice(S.length))};u.addEventListener?u.addEventListener("message",C,!1):u.attachEvent("onmessage",C),E=function(N){u.postMessage(S+N,"*")}}function q(){var S=new MessageChannel;S.port1.onmessage=function(C){var N=C.data;w(N)},E=function(C){S.port2.postMessage(C)}}function P(){var S=g.documentElement;E=function(C){var N=g.createElement("script");N.onreadystatechange=function(){w(C),N.onreadystatechange=null,S.removeChild(N),N=null},S.appendChild(N)}}function U(){E=function(S){setTimeout(w,0,S)}}var R=Object.getPrototypeOf&&Object.getPrototypeOf(u);R=R&&R.setTimeout?R:u,{}.toString.call(u.process)==="[object process]"?A():I()?V():u.MessageChannel?q():g&&"onreadystatechange"in g.createElement("script")?P():U(),R.setImmediate=b,R.clearImmediate=M})(typeof self>"u"?typeof o>"u"?this:o:self)}).call(this,typeof ai<"u"?ai:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(Tm)),Tm.exports}var DI=CI();const RI=uo(DI);class kI{constructor(){this.zip=void 0,this.urlCache={},this.checkRequirements()}checkRequirements(){try{this.zip=new RI}catch{throw new Error("JSZip lib not loaded")}}open(e,t){return this.zip.loadAsync(e,{base64:t})}openUrl(e,t){return Bl(e,"binary").then((function(n){return this.zip.loadAsync(n,{base64:t})}).bind(this))}request(e,t){var n=new zt,i,o=new gs(e);return t||(t=o.extension),t=="blob"?i=this.getBlob(e):i=this.getText(e),i?i.then((function(u){let l=this.handleResponse(u,t);n.resolve(l)}).bind(this)):n.reject({message:"File not found in the epub: "+e,stack:new Error().stack}),n.promise}handleResponse(e,t){var n;return t=="json"?n=JSON.parse(e):Ml(t)?n=zi(e,"text/xml"):t=="xhtml"?n=zi(e,"application/xhtml+xml"):t=="html"||t=="htm"?n=zi(e,"text/html"):n=e,n}getBlob(e,t){var n=window.decodeURIComponent(e.substr(1)),i=this.zip.file(n);if(i)return t=t||eu.lookup(i.name),i.async("uint8array").then(function(o){return new Blob([o],{type:t})})}getText(e,t){var n=window.decodeURIComponent(e.substr(1)),i=this.zip.file(n);if(i)return i.async("string").then(function(o){return o})}getBase64(e,t){var n=window.decodeURIComponent(e.substr(1)),i=this.zip.file(n);if(i)return t=t||eu.lookup(i.name),i.async("base64").then(function(o){return"data:"+t+";base64,"+o})}createUrl(e,t){var n=new zt,i=window.URL||window.webkitURL||window.mozURL,o,u,l=t&&t.base64;return e in this.urlCache?(n.resolve(this.urlCache[e]),n.promise):(l?(u=this.getBase64(e),u&&u.then((function(c){this.urlCache[e]=c,n.resolve(c)}).bind(this))):(u=this.getBlob(e),u&&u.then((function(c){o=i.createObjectURL(c),this.urlCache[e]=o,n.resolve(o)}).bind(this))),u||n.reject({message:"File not found in the epub: "+e,stack:new Error().stack}),n.promise)}revokeUrl(e){var t=window.URL||window.webkitURL||window.mozURL,n=this.urlCache[e];n&&t.revokeObjectURL(n)}destroy(){var e=window.URL||window.webkitURL||window.mozURL;for(let t in this.urlCache)e.revokeObjectURL(t);this.zip=void 0,this.urlCache={}}}var Am={exports:{}};var kw;function NI(){return kw||(kw=1,(function(r,e){(function(t){r.exports=t()})(function(){return(function t(n,i,o){function u(d,m){if(!i[d]){if(!n[d]){var g=typeof Ys=="function"&&Ys;if(!m&&g)return g(d,!0);if(l)return l(d,!0);var E=new Error("Cannot find module '"+d+"'");throw E.code="MODULE_NOT_FOUND",E}var b=i[d]={exports:{}};n[d][0].call(b.exports,function(M){var D=n[d][1][M];return u(D||M)},b,b.exports,t,n,i,o)}return i[d].exports}for(var l=typeof Ys=="function"&&Ys,c=0;c<o.length;c++)u(o[c]);return u})({1:[function(t,n,i){(function(o){var u=o.MutationObserver||o.WebKitMutationObserver,l;if(u){var c=0,d=new u(M),m=o.document.createTextNode("");d.observe(m,{characterData:!0}),l=function(){m.data=c=++c%2}}else if(!o.setImmediate&&typeof o.MessageChannel<"u"){var g=new o.MessageChannel;g.port1.onmessage=M,l=function(){g.port2.postMessage(0)}}else"document"in o&&"onreadystatechange"in o.document.createElement("script")?l=function(){var w=o.document.createElement("script");w.onreadystatechange=function(){M(),w.onreadystatechange=null,w.parentNode.removeChild(w),w=null},o.document.documentElement.appendChild(w)}:l=function(){setTimeout(M,0)};var E,b=[];function M(){E=!0;for(var w,A,I=b.length;I;){for(A=b,b=[],w=-1;++w<I;)A[w]();I=b.length}E=!1}n.exports=D;function D(w){b.push(w)===1&&!E&&l()}}).call(this,typeof ai<"u"?ai:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(t,n,i){var o=t(1);function u(){}var l={},c=["REJECTED"],d=["FULFILLED"],m=["PENDING"];n.exports=g;function g(P){if(typeof P!="function")throw new TypeError("resolver must be a function");this.state=m,this.queue=[],this.outcome=void 0,P!==u&&D(this,P)}g.prototype.catch=function(P){return this.then(null,P)},g.prototype.then=function(P,U){if(typeof P!="function"&&this.state===d||typeof U!="function"&&this.state===c)return this;var R=new this.constructor(u);if(this.state!==m){var S=this.state===d?P:U;b(R,S,this.outcome)}else this.queue.push(new E(R,P,U));return R};function E(P,U,R){this.promise=P,typeof U=="function"&&(this.onFulfilled=U,this.callFulfilled=this.otherCallFulfilled),typeof R=="function"&&(this.onRejected=R,this.callRejected=this.otherCallRejected)}E.prototype.callFulfilled=function(P){l.resolve(this.promise,P)},E.prototype.otherCallFulfilled=function(P){b(this.promise,this.onFulfilled,P)},E.prototype.callRejected=function(P){l.reject(this.promise,P)},E.prototype.otherCallRejected=function(P){b(this.promise,this.onRejected,P)};function b(P,U,R){o(function(){var S;try{S=U(R)}catch(C){return l.reject(P,C)}S===P?l.reject(P,new TypeError("Cannot resolve promise with itself")):l.resolve(P,S)})}l.resolve=function(P,U){var R=w(M,U);if(R.status==="error")return l.reject(P,R.value);var S=R.value;if(S)D(P,S);else{P.state=d,P.outcome=U;for(var C=-1,N=P.queue.length;++C<N;)P.queue[C].callFulfilled(U)}return P},l.reject=function(P,U){P.state=c,P.outcome=U;for(var R=-1,S=P.queue.length;++R<S;)P.queue[R].callRejected(U);return P};function M(P){var U=P&&P.then;if(P&&(typeof P=="object"||typeof P=="function")&&typeof U=="function")return function(){U.apply(P,arguments)}}function D(P,U){var R=!1;function S(j){R||(R=!0,l.reject(P,j))}function C(j){R||(R=!0,l.resolve(P,j))}function N(){U(C,S)}var z=w(N);z.status==="error"&&S(z.value)}function w(P,U){var R={};try{R.value=P(U),R.status="success"}catch(S){R.status="error",R.value=S}return R}g.resolve=A;function A(P){return P instanceof this?P:l.resolve(new this(u),P)}g.reject=I;function I(P){var U=new this(u);return l.reject(U,P)}g.all=V;function V(P){var U=this;if(Object.prototype.toString.call(P)!=="[object Array]")return this.reject(new TypeError("must be an array"));var R=P.length,S=!1;if(!R)return this.resolve([]);for(var C=new Array(R),N=0,z=-1,j=new this(u);++z<R;)L(P[z],z);return j;function L(he,_e){U.resolve(he).then(De,function(de){S||(S=!0,l.reject(j,de))});function De(de){C[_e]=de,++N===R&&!S&&(S=!0,l.resolve(j,C))}}}g.race=q;function q(P){var U=this;if(Object.prototype.toString.call(P)!=="[object Array]")return this.reject(new TypeError("must be an array"));var R=P.length,S=!1;if(!R)return this.resolve([]);for(var C=-1,N=new this(u);++C<R;)z(P[C]);return N;function z(j){U.resolve(j).then(function(L){S||(S=!0,l.resolve(N,L))},function(L){S||(S=!0,l.reject(N,L))})}}},{1:1}],3:[function(t,n,i){(function(o){typeof o.Promise!="function"&&(o.Promise=t(2))}).call(this,typeof ai<"u"?ai:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(t,n,i){var o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(W){return typeof W}:function(W){return W&&typeof Symbol=="function"&&W.constructor===Symbol&&W!==Symbol.prototype?"symbol":typeof W};function u(W,ee){if(!(W instanceof ee))throw new TypeError("Cannot call a class as a function")}function l(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var c=l();function d(){try{if(!c||!c.open)return!1;var W=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),ee=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!W||ee)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function m(W,ee){W=W||[],ee=ee||{};try{return new Blob(W,ee)}catch(te){if(te.name!=="TypeError")throw te;for(var K=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,oe=new K,le=0;le<W.length;le+=1)oe.append(W[le]);return oe.getBlob(ee.type)}}typeof Promise>"u"&&t(3);var g=Promise;function E(W,ee){ee&&W.then(function(K){ee(null,K)},function(K){ee(K)})}function b(W,ee,K){typeof ee=="function"&&W.then(ee),typeof K=="function"&&W.catch(K)}function M(W){return typeof W!="string"&&(console.warn(W+" used as a key, but it is not a string."),W=String(W)),W}function D(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var w="local-forage-detect-blob-support",A=void 0,I={},V=Object.prototype.toString,q="readonly",P="readwrite";function U(W){for(var ee=W.length,K=new ArrayBuffer(ee),oe=new Uint8Array(K),le=0;le<ee;le++)oe[le]=W.charCodeAt(le);return K}function R(W){return new g(function(ee){var K=W.transaction(w,P),oe=m([""]);K.objectStore(w).put(oe,"key"),K.onabort=function(le){le.preventDefault(),le.stopPropagation(),ee(!1)},K.oncomplete=function(){var le=navigator.userAgent.match(/Chrome\/(\d+)/),te=navigator.userAgent.match(/Edge\//);ee(te||!le||parseInt(le[1],10)>=43)}}).catch(function(){return!1})}function S(W){return typeof A=="boolean"?g.resolve(A):R(W).then(function(ee){return A=ee,A})}function C(W){var ee=I[W.name],K={};K.promise=new g(function(oe,le){K.resolve=oe,K.reject=le}),ee.deferredOperations.push(K),ee.dbReady?ee.dbReady=ee.dbReady.then(function(){return K.promise}):ee.dbReady=K.promise}function N(W){var ee=I[W.name],K=ee.deferredOperations.pop();if(K)return K.resolve(),K.promise}function z(W,ee){var K=I[W.name],oe=K.deferredOperations.pop();if(oe)return oe.reject(ee),oe.promise}function j(W,ee){return new g(function(K,oe){if(I[W.name]=I[W.name]||se(),W.db)if(ee)C(W),W.db.close();else return K(W.db);var le=[W.name];ee&&le.push(W.version);var te=c.open.apply(c,le);ee&&(te.onupgradeneeded=function(Ae){var ke=te.result;try{ke.createObjectStore(W.storeName),Ae.oldVersion<=1&&ke.createObjectStore(w)}catch(Ve){if(Ve.name==="ConstraintError")console.warn('The database "'+W.name+'" has been upgraded from version '+Ae.oldVersion+" to version "+Ae.newVersion+', but the storage "'+W.storeName+'" already exists.');else throw Ve}}),te.onerror=function(Ae){Ae.preventDefault(),oe(te.error)},te.onsuccess=function(){var Ae=te.result;Ae.onversionchange=function(ke){ke.target.close()},K(Ae),N(W)}})}function L(W){return j(W,!1)}function he(W){return j(W,!0)}function _e(W,ee){if(!W.db)return!0;var K=!W.db.objectStoreNames.contains(W.storeName),oe=W.version<W.db.version,le=W.version>W.db.version;if(oe&&(W.version!==ee&&console.warn('The database "'+W.name+`" can't be downgraded from version `+W.db.version+" to version "+W.version+"."),W.version=W.db.version),le||K){if(K){var te=W.db.version+1;te>W.version&&(W.version=te)}return!0}return!1}function De(W){return new g(function(ee,K){var oe=new FileReader;oe.onerror=K,oe.onloadend=function(le){var te=btoa(le.target.result||"");ee({__local_forage_encoded_blob:!0,data:te,type:W.type})},oe.readAsBinaryString(W)})}function de(W){var ee=U(atob(W.data));return m([ee],{type:W.type})}function J(W){return W&&W.__local_forage_encoded_blob}function ce(W){var ee=this,K=ee._initReady().then(function(){var oe=I[ee._dbInfo.name];if(oe&&oe.dbReady)return oe.dbReady});return b(K,W,W),K}function xe(W){C(W);for(var ee=I[W.name],K=ee.forages,oe=0;oe<K.length;oe++){var le=K[oe];le._dbInfo.db&&(le._dbInfo.db.close(),le._dbInfo.db=null)}return W.db=null,L(W).then(function(te){return W.db=te,_e(W)?he(W):te}).then(function(te){W.db=ee.db=te;for(var Ae=0;Ae<K.length;Ae++)K[Ae]._dbInfo.db=te}).catch(function(te){throw z(W,te),te})}function Q(W,ee,K,oe){oe===void 0&&(oe=1);try{var le=W.db.transaction(W.storeName,ee);K(null,le)}catch(te){if(oe>0&&(!W.db||te.name==="InvalidStateError"||te.name==="NotFoundError"))return g.resolve().then(function(){if(!W.db||te.name==="NotFoundError"&&!W.db.objectStoreNames.contains(W.storeName)&&W.version<=W.db.version)return W.db&&(W.version=W.db.version+1),he(W)}).then(function(){return xe(W).then(function(){Q(W,ee,K,oe-1)})}).catch(K);K(te)}}function se(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function Ce(W){var ee=this,K={db:null};if(W)for(var oe in W)K[oe]=W[oe];var le=I[K.name];le||(le=se(),I[K.name]=le),le.forages.push(ee),ee._initReady||(ee._initReady=ee.ready,ee.ready=ce);var te=[];function Ae(){return g.resolve()}for(var ke=0;ke<le.forages.length;ke++){var Ve=le.forages[ke];Ve!==ee&&te.push(Ve._initReady().catch(Ae))}var Be=le.forages.slice(0);return g.all(te).then(function(){return K.db=le.db,L(K)}).then(function(je){return K.db=je,_e(K,ee._defaultConfig.version)?he(K):je}).then(function(je){K.db=le.db=je,ee._dbInfo=K;for(var tt=0;tt<Be.length;tt++){var It=Be[tt];It!==ee&&(It._dbInfo.db=K.db,It._dbInfo.version=K.version)}})}function Ie(W,ee){var K=this;W=M(W);var oe=new g(function(le,te){K.ready().then(function(){Q(K._dbInfo,q,function(Ae,ke){if(Ae)return te(Ae);try{var Ve=ke.objectStore(K._dbInfo.storeName),Be=Ve.get(W);Be.onsuccess=function(){var je=Be.result;je===void 0&&(je=null),J(je)&&(je=de(je)),le(je)},Be.onerror=function(){te(Be.error)}}catch(je){te(je)}})}).catch(te)});return E(oe,ee),oe}function He(W,ee){var K=this,oe=new g(function(le,te){K.ready().then(function(){Q(K._dbInfo,q,function(Ae,ke){if(Ae)return te(Ae);try{var Ve=ke.objectStore(K._dbInfo.storeName),Be=Ve.openCursor(),je=1;Be.onsuccess=function(){var tt=Be.result;if(tt){var It=tt.value;J(It)&&(It=de(It));var qt=W(It,tt.key,je++);qt!==void 0?le(qt):tt.continue()}else le()},Be.onerror=function(){te(Be.error)}}catch(tt){te(tt)}})}).catch(te)});return E(oe,ee),oe}function Ke(W,ee,K){var oe=this;W=M(W);var le=new g(function(te,Ae){var ke;oe.ready().then(function(){return ke=oe._dbInfo,V.call(ee)==="[object Blob]"?S(ke.db).then(function(Ve){return Ve?ee:De(ee)}):ee}).then(function(Ve){Q(oe._dbInfo,P,function(Be,je){if(Be)return Ae(Be);try{var tt=je.objectStore(oe._dbInfo.storeName);Ve===null&&(Ve=void 0);var It=tt.put(Ve,W);je.oncomplete=function(){Ve===void 0&&(Ve=null),te(Ve)},je.onabort=je.onerror=function(){var qt=It.error?It.error:It.transaction.error;Ae(qt)}}catch(qt){Ae(qt)}})}).catch(Ae)});return E(le,K),le}function et(W,ee){var K=this;W=M(W);var oe=new g(function(le,te){K.ready().then(function(){Q(K._dbInfo,P,function(Ae,ke){if(Ae)return te(Ae);try{var Ve=ke.objectStore(K._dbInfo.storeName),Be=Ve.delete(W);ke.oncomplete=function(){le()},ke.onerror=function(){te(Be.error)},ke.onabort=function(){var je=Be.error?Be.error:Be.transaction.error;te(je)}}catch(je){te(je)}})}).catch(te)});return E(oe,ee),oe}function Fe(W){var ee=this,K=new g(function(oe,le){ee.ready().then(function(){Q(ee._dbInfo,P,function(te,Ae){if(te)return le(te);try{var ke=Ae.objectStore(ee._dbInfo.storeName),Ve=ke.clear();Ae.oncomplete=function(){oe()},Ae.onabort=Ae.onerror=function(){var Be=Ve.error?Ve.error:Ve.transaction.error;le(Be)}}catch(Be){le(Be)}})}).catch(le)});return E(K,W),K}function Je(W){var ee=this,K=new g(function(oe,le){ee.ready().then(function(){Q(ee._dbInfo,q,function(te,Ae){if(te)return le(te);try{var ke=Ae.objectStore(ee._dbInfo.storeName),Ve=ke.count();Ve.onsuccess=function(){oe(Ve.result)},Ve.onerror=function(){le(Ve.error)}}catch(Be){le(Be)}})}).catch(le)});return E(K,W),K}function Xe(W,ee){var K=this,oe=new g(function(le,te){if(W<0){le(null);return}K.ready().then(function(){Q(K._dbInfo,q,function(Ae,ke){if(Ae)return te(Ae);try{var Ve=ke.objectStore(K._dbInfo.storeName),Be=!1,je=Ve.openKeyCursor();je.onsuccess=function(){var tt=je.result;if(!tt){le(null);return}W===0||Be?le(tt.key):(Be=!0,tt.advance(W))},je.onerror=function(){te(je.error)}}catch(tt){te(tt)}})}).catch(te)});return E(oe,ee),oe}function ft(W){var ee=this,K=new g(function(oe,le){ee.ready().then(function(){Q(ee._dbInfo,q,function(te,Ae){if(te)return le(te);try{var ke=Ae.objectStore(ee._dbInfo.storeName),Ve=ke.openKeyCursor(),Be=[];Ve.onsuccess=function(){var je=Ve.result;if(!je){oe(Be);return}Be.push(je.key),je.continue()},Ve.onerror=function(){le(Ve.error)}}catch(je){le(je)}})}).catch(le)});return E(K,W),K}function yt(W,ee){ee=D.apply(this,arguments);var K=this.config();W=typeof W!="function"&&W||{},W.name||(W.name=W.name||K.name,W.storeName=W.storeName||K.storeName);var oe=this,le;if(!W.name)le=g.reject("Invalid arguments");else{var te=W.name===K.name&&oe._dbInfo.db,Ae=te?g.resolve(oe._dbInfo.db):L(W).then(function(ke){var Ve=I[W.name],Be=Ve.forages;Ve.db=ke;for(var je=0;je<Be.length;je++)Be[je]._dbInfo.db=ke;return ke});W.storeName?le=Ae.then(function(ke){if(ke.objectStoreNames.contains(W.storeName)){var Ve=ke.version+1;C(W);var Be=I[W.name],je=Be.forages;ke.close();for(var tt=0;tt<je.length;tt++){var It=je[tt];It._dbInfo.db=null,It._dbInfo.version=Ve}var qt=new g(function(Mt,pt){var Yt=c.open(W.name,Ve);Yt.onerror=function(Qn){var Xr=Yt.result;Xr.close(),pt(Qn)},Yt.onupgradeneeded=function(){var Qn=Yt.result;Qn.deleteObjectStore(W.storeName)},Yt.onsuccess=function(){var Qn=Yt.result;Qn.close(),Mt(Qn)}});return qt.then(function(Mt){Be.db=Mt;for(var pt=0;pt<je.length;pt++){var Yt=je[pt];Yt._dbInfo.db=Mt,N(Yt._dbInfo)}}).catch(function(Mt){throw(z(W,Mt)||g.resolve()).catch(function(){}),Mt})}}):le=Ae.then(function(ke){C(W);var Ve=I[W.name],Be=Ve.forages;ke.close();for(var je=0;je<Be.length;je++){var tt=Be[je];tt._dbInfo.db=null}var It=new g(function(qt,Mt){var pt=c.deleteDatabase(W.name);pt.onerror=function(){var Yt=pt.result;Yt&&Yt.close(),Mt(pt.error)},pt.onblocked=function(){console.warn('dropInstance blocked for database "'+W.name+'" until all open connections are closed')},pt.onsuccess=function(){var Yt=pt.result;Yt&&Yt.close(),qt(Yt)}});return It.then(function(qt){Ve.db=qt;for(var Mt=0;Mt<Be.length;Mt++){var pt=Be[Mt];N(pt._dbInfo)}}).catch(function(qt){throw(z(W,qt)||g.resolve()).catch(function(){}),qt})})}return E(le,ee),le}var mt={_driver:"asyncStorage",_initStorage:Ce,_support:d(),iterate:He,getItem:Ie,setItem:Ke,removeItem:et,clear:Fe,length:Je,key:Xe,keys:ft,dropInstance:yt};function _t(){return typeof openDatabase=="function"}var kt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",St="~~local_forage_type~",Tt=/^~~local_forage_type~([^~]+)~/,Ht="__lfsc__:",Dt=Ht.length,wt="arbf",it="blob",gt="si08",dt="ui08",an="uic8",_n="si16",xn="si32",jt="ur16",on="ui32",pn="fl32",en="fl64",Qt=Dt+wt.length,Tn=Object.prototype.toString;function Gt(W){var ee=W.length*.75,K=W.length,oe,le=0,te,Ae,ke,Ve;W[W.length-1]==="="&&(ee--,W[W.length-2]==="="&&ee--);var Be=new ArrayBuffer(ee),je=new Uint8Array(Be);for(oe=0;oe<K;oe+=4)te=kt.indexOf(W[oe]),Ae=kt.indexOf(W[oe+1]),ke=kt.indexOf(W[oe+2]),Ve=kt.indexOf(W[oe+3]),je[le++]=te<<2|Ae>>4,je[le++]=(Ae&15)<<4|ke>>2,je[le++]=(ke&3)<<6|Ve&63;return Be}function hn(W){var ee=new Uint8Array(W),K="",oe;for(oe=0;oe<ee.length;oe+=3)K+=kt[ee[oe]>>2],K+=kt[(ee[oe]&3)<<4|ee[oe+1]>>4],K+=kt[(ee[oe+1]&15)<<2|ee[oe+2]>>6],K+=kt[ee[oe+2]&63];return ee.length%3===2?K=K.substring(0,K.length-1)+"=":ee.length%3===1&&(K=K.substring(0,K.length-2)+"=="),K}function Pn(W,ee){var K="";if(W&&(K=Tn.call(W)),W&&(K==="[object ArrayBuffer]"||W.buffer&&Tn.call(W.buffer)==="[object ArrayBuffer]")){var oe,le=Ht;W instanceof ArrayBuffer?(oe=W,le+=wt):(oe=W.buffer,K==="[object Int8Array]"?le+=gt:K==="[object Uint8Array]"?le+=dt:K==="[object Uint8ClampedArray]"?le+=an:K==="[object Int16Array]"?le+=_n:K==="[object Uint16Array]"?le+=jt:K==="[object Int32Array]"?le+=xn:K==="[object Uint32Array]"?le+=on:K==="[object Float32Array]"?le+=pn:K==="[object Float64Array]"?le+=en:ee(new Error("Failed to get type for BinaryArray"))),ee(le+hn(oe))}else if(K==="[object Blob]"){var te=new FileReader;te.onload=function(){var Ae=St+W.type+"~"+hn(this.result);ee(Ht+it+Ae)},te.readAsArrayBuffer(W)}else try{ee(JSON.stringify(W))}catch(Ae){console.error("Couldn't convert value into a JSON string: ",W),ee(null,Ae)}}function $(W){if(W.substring(0,Dt)!==Ht)return JSON.parse(W);var ee=W.substring(Qt),K=W.substring(Dt,Qt),oe;if(K===it&&Tt.test(ee)){var le=ee.match(Tt);oe=le[1],ee=ee.substring(le[0].length)}var te=Gt(ee);switch(K){case wt:return te;case it:return m([te],{type:oe});case gt:return new Int8Array(te);case dt:return new Uint8Array(te);case an:return new Uint8ClampedArray(te);case _n:return new Int16Array(te);case jt:return new Uint16Array(te);case xn:return new Int32Array(te);case on:return new Uint32Array(te);case pn:return new Float32Array(te);case en:return new Float64Array(te);default:throw new Error("Unkown type: "+K)}}var Se={serialize:Pn,deserialize:$,stringToBuffer:Gt,bufferToString:hn};function Re(W,ee,K,oe){W.executeSql("CREATE TABLE IF NOT EXISTS "+ee.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],K,oe)}function Ge(W){var ee=this,K={db:null};if(W)for(var oe in W)K[oe]=typeof W[oe]!="string"?W[oe].toString():W[oe];var le=new g(function(te,Ae){try{K.db=openDatabase(K.name,String(K.version),K.description,K.size)}catch(ke){return Ae(ke)}K.db.transaction(function(ke){Re(ke,K,function(){ee._dbInfo=K,te()},function(Ve,Be){Ae(Be)})},Ae)});return K.serializer=Se,le}function ne(W,ee,K,oe,le,te){W.executeSql(K,oe,le,function(Ae,ke){ke.code===ke.SYNTAX_ERR?Ae.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[ee.storeName],function(Ve,Be){Be.rows.length?te(Ve,ke):Re(Ve,ee,function(){Ve.executeSql(K,oe,le,te)},te)},te):te(Ae,ke)},te)}function be(W,ee){var K=this;W=M(W);var oe=new g(function(le,te){K.ready().then(function(){var Ae=K._dbInfo;Ae.db.transaction(function(ke){ne(ke,Ae,"SELECT * FROM "+Ae.storeName+" WHERE key = ? LIMIT 1",[W],function(Ve,Be){var je=Be.rows.length?Be.rows.item(0).value:null;je&&(je=Ae.serializer.deserialize(je)),le(je)},function(Ve,Be){te(Be)})})}).catch(te)});return E(oe,ee),oe}function v(W,ee){var K=this,oe=new g(function(le,te){K.ready().then(function(){var Ae=K._dbInfo;Ae.db.transaction(function(ke){ne(ke,Ae,"SELECT * FROM "+Ae.storeName,[],function(Ve,Be){for(var je=Be.rows,tt=je.length,It=0;It<tt;It++){var qt=je.item(It),Mt=qt.value;if(Mt&&(Mt=Ae.serializer.deserialize(Mt)),Mt=W(Mt,qt.key,It+1),Mt!==void 0){le(Mt);return}}le()},function(Ve,Be){te(Be)})})}).catch(te)});return E(oe,ee),oe}function O(W,ee,K,oe){var le=this;W=M(W);var te=new g(function(Ae,ke){le.ready().then(function(){ee===void 0&&(ee=null);var Ve=ee,Be=le._dbInfo;Be.serializer.serialize(ee,function(je,tt){tt?ke(tt):Be.db.transaction(function(It){ne(It,Be,"INSERT OR REPLACE INTO "+Be.storeName+" (key, value) VALUES (?, ?)",[W,je],function(){Ae(Ve)},function(qt,Mt){ke(Mt)})},function(It){if(It.code===It.QUOTA_ERR){if(oe>0){Ae(O.apply(le,[W,Ve,K,oe-1]));return}ke(It)}})})}).catch(ke)});return E(te,K),te}function G(W,ee,K){return O.apply(this,[W,ee,K,1])}function y(W,ee){var K=this;W=M(W);var oe=new g(function(le,te){K.ready().then(function(){var Ae=K._dbInfo;Ae.db.transaction(function(ke){ne(ke,Ae,"DELETE FROM "+Ae.storeName+" WHERE key = ?",[W],function(){le()},function(Ve,Be){te(Be)})})}).catch(te)});return E(oe,ee),oe}function X(W){var ee=this,K=new g(function(oe,le){ee.ready().then(function(){var te=ee._dbInfo;te.db.transaction(function(Ae){ne(Ae,te,"DELETE FROM "+te.storeName,[],function(){oe()},function(ke,Ve){le(Ve)})})}).catch(le)});return E(K,W),K}function ie(W){var ee=this,K=new g(function(oe,le){ee.ready().then(function(){var te=ee._dbInfo;te.db.transaction(function(Ae){ne(Ae,te,"SELECT COUNT(key) as c FROM "+te.storeName,[],function(ke,Ve){var Be=Ve.rows.item(0).c;oe(Be)},function(ke,Ve){le(Ve)})})}).catch(le)});return E(K,W),K}function F(W,ee){var K=this,oe=new g(function(le,te){K.ready().then(function(){var Ae=K._dbInfo;Ae.db.transaction(function(ke){ne(ke,Ae,"SELECT key FROM "+Ae.storeName+" WHERE id = ? LIMIT 1",[W+1],function(Ve,Be){var je=Be.rows.length?Be.rows.item(0).key:null;le(je)},function(Ve,Be){te(Be)})})}).catch(te)});return E(oe,ee),oe}function Z(W){var ee=this,K=new g(function(oe,le){ee.ready().then(function(){var te=ee._dbInfo;te.db.transaction(function(Ae){ne(Ae,te,"SELECT key FROM "+te.storeName,[],function(ke,Ve){for(var Be=[],je=0;je<Ve.rows.length;je++)Be.push(Ve.rows.item(je).key);oe(Be)},function(ke,Ve){le(Ve)})})}).catch(le)});return E(K,W),K}function ue(W){return new g(function(ee,K){W.transaction(function(oe){oe.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(le,te){for(var Ae=[],ke=0;ke<te.rows.length;ke++)Ae.push(te.rows.item(ke).name);ee({db:W,storeNames:Ae})},function(le,te){K(te)})},function(oe){K(oe)})})}function Ue(W,ee){ee=D.apply(this,arguments);var K=this.config();W=typeof W!="function"&&W||{},W.name||(W.name=W.name||K.name,W.storeName=W.storeName||K.storeName);var oe=this,le;return W.name?le=new g(function(te){var Ae;W.name===K.name?Ae=oe._dbInfo.db:Ae=openDatabase(W.name,"","",0),W.storeName?te({db:Ae,storeNames:[W.storeName]}):te(ue(Ae))}).then(function(te){return new g(function(Ae,ke){te.db.transaction(function(Ve){function Be(qt){return new g(function(Mt,pt){Ve.executeSql("DROP TABLE IF EXISTS "+qt,[],function(){Mt()},function(Yt,Qn){pt(Qn)})})}for(var je=[],tt=0,It=te.storeNames.length;tt<It;tt++)je.push(Be(te.storeNames[tt]));g.all(je).then(function(){Ae()}).catch(function(qt){ke(qt)})},function(Ve){ke(Ve)})})}):le=g.reject("Invalid arguments"),E(le,ee),le}var Ne={_driver:"webSQLStorage",_initStorage:Ge,_support:_t(),iterate:v,getItem:be,setItem:G,removeItem:y,clear:X,length:ie,key:F,keys:Z,dropInstance:Ue};function ze(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function lt(W,ee){var K=W.name+"/";return W.storeName!==ee.storeName&&(K+=W.storeName+"/"),K}function Lt(){var W="_localforage_support_test";try{return localStorage.setItem(W,!0),localStorage.removeItem(W),!1}catch{return!0}}function xt(){return!Lt()||localStorage.length>0}function at(W){var ee=this,K={};if(W)for(var oe in W)K[oe]=W[oe];return K.keyPrefix=lt(W,ee._defaultConfig),xt()?(ee._dbInfo=K,K.serializer=Se,g.resolve()):g.reject()}function Vt(W){var ee=this,K=ee.ready().then(function(){for(var oe=ee._dbInfo.keyPrefix,le=localStorage.length-1;le>=0;le--){var te=localStorage.key(le);te.indexOf(oe)===0&&localStorage.removeItem(te)}});return E(K,W),K}function Nt(W,ee){var K=this;W=M(W);var oe=K.ready().then(function(){var le=K._dbInfo,te=localStorage.getItem(le.keyPrefix+W);return te&&(te=le.serializer.deserialize(te)),te});return E(oe,ee),oe}function mn(W,ee){var K=this,oe=K.ready().then(function(){for(var le=K._dbInfo,te=le.keyPrefix,Ae=te.length,ke=localStorage.length,Ve=1,Be=0;Be<ke;Be++){var je=localStorage.key(Be);if(je.indexOf(te)===0){var tt=localStorage.getItem(je);if(tt&&(tt=le.serializer.deserialize(tt)),tt=W(tt,je.substring(Ae),Ve++),tt!==void 0)return tt}}});return E(oe,ee),oe}function gn(W,ee){var K=this,oe=K.ready().then(function(){var le=K._dbInfo,te;try{te=localStorage.key(W)}catch{te=null}return te&&(te=te.substring(le.keyPrefix.length)),te});return E(oe,ee),oe}function yr(W){var ee=this,K=ee.ready().then(function(){for(var oe=ee._dbInfo,le=localStorage.length,te=[],Ae=0;Ae<le;Ae++){var ke=localStorage.key(Ae);ke.indexOf(oe.keyPrefix)===0&&te.push(ke.substring(oe.keyPrefix.length))}return te});return E(K,W),K}function un(W){var ee=this,K=ee.keys().then(function(oe){return oe.length});return E(K,W),K}function jn(W,ee){var K=this;W=M(W);var oe=K.ready().then(function(){var le=K._dbInfo;localStorage.removeItem(le.keyPrefix+W)});return E(oe,ee),oe}function wn(W,ee,K){var oe=this;W=M(W);var le=oe.ready().then(function(){ee===void 0&&(ee=null);var te=ee;return new g(function(Ae,ke){var Ve=oe._dbInfo;Ve.serializer.serialize(ee,function(Be,je){if(je)ke(je);else try{localStorage.setItem(Ve.keyPrefix+W,Be),Ae(te)}catch(tt){(tt.name==="QuotaExceededError"||tt.name==="NS_ERROR_DOM_QUOTA_REACHED")&&ke(tt),ke(tt)}})})});return E(le,K),le}function qn(W,ee){if(ee=D.apply(this,arguments),W=typeof W!="function"&&W||{},!W.name){var K=this.config();W.name=W.name||K.name,W.storeName=W.storeName||K.storeName}var oe=this,le;return W.name?le=new g(function(te){W.storeName?te(lt(W,oe._defaultConfig)):te(W.name+"/")}).then(function(te){for(var Ae=localStorage.length-1;Ae>=0;Ae--){var ke=localStorage.key(Ae);ke.indexOf(te)===0&&localStorage.removeItem(ke)}}):le=g.reject("Invalid arguments"),E(le,ee),le}var Kn={_driver:"localStorageWrapper",_initStorage:at,_support:ze(),iterate:mn,getItem:Nt,setItem:wn,removeItem:jn,clear:Vt,length:un,key:gn,keys:yr,dropInstance:qn},ui=function(ee,K){return ee===K||typeof ee=="number"&&typeof K=="number"&&isNaN(ee)&&isNaN(K)},Ki=function(ee,K){for(var oe=ee.length,le=0;le<oe;){if(ui(ee[le],K))return!0;le++}return!1},Qr=Array.isArray||function(W){return Object.prototype.toString.call(W)==="[object Array]"},Zt={},sa={},Or={INDEXEDDB:mt,WEBSQL:Ne,LOCALSTORAGE:Kn},go=[Or.INDEXEDDB._driver,Or.WEBSQL._driver,Or.LOCALSTORAGE._driver],Yr=["dropInstance"],Qi=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Yr),xs={description:"",driver:go.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function Yi(W,ee){W[ee]=function(){var K=arguments;return W.ready().then(function(){return W[ee].apply(W,K)})}}function tr(){for(var W=1;W<arguments.length;W++){var ee=arguments[W];if(ee)for(var K in ee)ee.hasOwnProperty(K)&&(Qr(ee[K])?arguments[0][K]=ee[K].slice():arguments[0][K]=ee[K])}return arguments[0]}var oa=(function(){function W(ee){u(this,W);for(var K in Or)if(Or.hasOwnProperty(K)){var oe=Or[K],le=oe._driver;this[K]=le,Zt[le]||this.defineDriver(oe)}this._defaultConfig=tr({},xs),this._config=tr({},this._defaultConfig,ee),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return W.prototype.config=function(K){if((typeof K>"u"?"undefined":o(K))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var oe in K){if(oe==="storeName"&&(K[oe]=K[oe].replace(/\W/g,"_")),oe==="version"&&typeof K[oe]!="number")return new Error("Database version must be a number.");this._config[oe]=K[oe]}return"driver"in K&&K.driver?this.setDriver(this._config.driver):!0}else return typeof K=="string"?this._config[K]:this._config},W.prototype.defineDriver=function(K,oe,le){var te=new g(function(Ae,ke){try{var Ve=K._driver,Be=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!K._driver){ke(Be);return}for(var je=Qi.concat("_initStorage"),tt=0,It=je.length;tt<It;tt++){var qt=je[tt],Mt=!Ki(Yr,qt);if((Mt||K[qt])&&typeof K[qt]!="function"){ke(Be);return}}var pt=function(){for(var Xr=function(Ts){return function(){var Zr=new Error("Method "+Ts+" is not implemented by the current driver"),Lr=g.reject(Zr);return E(Lr,arguments[arguments.length-1]),Lr}},Xi=0,vo=Yr.length;Xi<vo;Xi++){var Zi=Yr[Xi];K[Zi]||(K[Zi]=Xr(Zi))}};pt();var Yt=function(Xr){Zt[Ve]&&console.info("Redefining LocalForage driver: "+Ve),Zt[Ve]=K,sa[Ve]=Xr,Ae()};"_support"in K?K._support&&typeof K._support=="function"?K._support().then(Yt,ke):Yt(!!K._support):Yt(!0)}catch(Qn){ke(Qn)}});return b(te,oe,le),te},W.prototype.driver=function(){return this._driver||null},W.prototype.getDriver=function(K,oe,le){var te=Zt[K]?g.resolve(Zt[K]):g.reject(new Error("Driver not found."));return b(te,oe,le),te},W.prototype.getSerializer=function(K){var oe=g.resolve(Se);return b(oe,K),oe},W.prototype.ready=function(K){var oe=this,le=oe._driverSet.then(function(){return oe._ready===null&&(oe._ready=oe._initDriver()),oe._ready});return b(le,K,K),le},W.prototype.setDriver=function(K,oe,le){var te=this;Qr(K)||(K=[K]);var Ae=this._getSupportedDrivers(K);function ke(){te._config.driver=te.driver()}function Ve(tt){return te._extend(tt),ke(),te._ready=te._initStorage(te._config),te._ready}function Be(tt){return function(){var It=0;function qt(){for(;It<tt.length;){var Mt=tt[It];return It++,te._dbInfo=null,te._ready=null,te.getDriver(Mt).then(Ve).catch(qt)}ke();var pt=new Error("No available storage method found.");return te._driverSet=g.reject(pt),te._driverSet}return qt()}}var je=this._driverSet!==null?this._driverSet.catch(function(){return g.resolve()}):g.resolve();return this._driverSet=je.then(function(){var tt=Ae[0];return te._dbInfo=null,te._ready=null,te.getDriver(tt).then(function(It){te._driver=It._driver,ke(),te._wrapLibraryMethodsWithReady(),te._initDriver=Be(Ae)})}).catch(function(){ke();var tt=new Error("No available storage method found.");return te._driverSet=g.reject(tt),te._driverSet}),b(this._driverSet,oe,le),this._driverSet},W.prototype.supports=function(K){return!!sa[K]},W.prototype._extend=function(K){tr(this,K)},W.prototype._getSupportedDrivers=function(K){for(var oe=[],le=0,te=K.length;le<te;le++){var Ae=K[le];this.supports(Ae)&&oe.push(Ae)}return oe},W.prototype._wrapLibraryMethodsWithReady=function(){for(var K=0,oe=Qi.length;K<oe;K++)Yi(this,Qi[K])},W.prototype.createInstance=function(K){return new W(K)},W})(),_r=new oa;n.exports=_r},{3:3}]},{},[4])(4)})})(Am)),Am.exports}var PI=NI();const Nw=uo(PI);class v1{constructor(e,t,n){this.urlCache={},this.storage=void 0,this.name=e,this.requester=t||Bl,this.resolver=n,this.online=!0,this.checkRequirements(),this.addListeners()}checkRequirements(){try{let e;typeof Nw>"u"&&(e=Nw),this.storage=e.createInstance({name:this.name})}catch{throw new Error("localForage lib not loaded")}}addListeners(){this._status=this.status.bind(this),window.addEventListener("online",this._status),window.addEventListener("offline",this._status)}removeListeners(){window.removeEventListener("online",this._status),window.removeEventListener("offline",this._status),this._status=void 0}status(e){let t=navigator.onLine;this.online=t,t?this.emit("online",this):this.emit("offline",this)}add(e,t){let n=e.resources.map(i=>{let{href:o}=i,u=this.resolver(o),l=window.encodeURIComponent(u);return this.storage.getItem(l).then(c=>!c||t?this.requester(u,"binary").then(d=>this.storage.setItem(l,d)):c)});return Promise.all(n)}put(e,t,n){let i=window.encodeURIComponent(e);return this.storage.getItem(i).then(o=>o||this.requester(e,"binary",t,n).then(u=>this.storage.setItem(i,u)))}request(e,t,n,i){return this.online?this.requester(e,t,n,i).then(o=>(this.put(e),o)):this.retrieve(e,t)}retrieve(e,t){new zt;var n,i=new gs(e);return t||(t=i.extension),t=="blob"?n=this.getBlob(e):n=this.getText(e),n.then(o=>{var u=new zt,l;return o?(l=this.handleResponse(o,t),u.resolve(l)):u.reject({message:"File not found in storage: "+e,stack:new Error().stack}),u.promise})}handleResponse(e,t){var n;return t=="json"?n=JSON.parse(e):Ml(t)?n=zi(e,"text/xml"):t=="xhtml"?n=zi(e,"application/xhtml+xml"):t=="html"||t=="htm"?n=zi(e,"text/html"):n=e,n}getBlob(e,t){let n=window.encodeURIComponent(e);return this.storage.getItem(n).then(function(i){if(i)return t=t||eu.lookup(e),new Blob([i],{type:t})})}getText(e,t){let n=window.encodeURIComponent(e);return t=t||eu.lookup(e),this.storage.getItem(n).then(function(i){var o=new zt,u=new FileReader,l;if(i)return l=new Blob([i],{type:t}),u.addEventListener("loadend",()=>{o.resolve(u.result)}),u.readAsText(l,t),o.promise})}getBase64(e,t){let n=window.encodeURIComponent(e);return t=t||eu.lookup(e),this.storage.getItem(n).then(i=>{var o=new zt,u=new FileReader,l;if(i)return l=new Blob([i],{type:t}),u.addEventListener("loadend",()=>{o.resolve(u.result)}),u.readAsDataURL(l,t),o.promise})}createUrl(e,t){var n=new zt,i=window.URL||window.webkitURL||window.mozURL,o,u,l=t&&t.base64;return e in this.urlCache?(n.resolve(this.urlCache[e]),n.promise):(l?(u=this.getBase64(e),u&&u.then((function(c){this.urlCache[e]=c,n.resolve(c)}).bind(this))):(u=this.getBlob(e),u&&u.then((function(c){o=i.createObjectURL(c),this.urlCache[e]=o,n.resolve(o)}).bind(this))),u||n.reject({message:"File not found in storage: "+e,stack:new Error().stack}),n.promise)}revokeUrl(e){var t=window.URL||window.webkitURL||window.mozURL,n=this.urlCache[e];n&&t.revokeObjectURL(n)}destroy(){var e=window.URL||window.webkitURL||window.mozURL;for(let t in this.urlCache)e.revokeObjectURL(t);this.urlCache={},this.removeListeners()}}Hi(v1.prototype);class Sm{constructor(e){this.interactive="",this.fixedLayout="",this.openToSpread="",this.orientationLock="",e&&this.parse(e)}parse(e){if(!e)return this;const t=cn(e,"display_options");return t?(ms(t,"option").forEach(i=>{let o="";switch(i.childNodes.length&&(o=i.childNodes[0].nodeValue),i.attributes.name.value){case"interactive":this.interactive=o;break;case"fixed-layout":this.fixedLayout=o;break;case"open-to-spread":this.openToSpread=o;break;case"orientation-lock":this.orientationLock=o;break}}),this):this}destroy(){this.interactive=void 0,this.fixedLayout=void 0,this.openToSpread=void 0,this.orientationLock=void 0}}const Pw="META-INF/container.xml",OI="META-INF/com.apple.ibooks.display-options.xml",yi={BINARY:"binary",BASE64:"base64",EPUB:"epub",OPF:"opf",MANIFEST:"json",DIRECTORY:"directory"};class ev{constructor(e,t){typeof t>"u"&&typeof e!="string"&&!(e instanceof Blob)&&!(e instanceof ArrayBuffer)&&(t=e,e=void 0),this.settings=ar(this.settings||{},{requestMethod:void 0,requestCredentials:void 0,requestHeaders:void 0,encoding:void 0,replacements:void 0,canonical:void 0,openAs:void 0,store:void 0}),ar(this.settings,t),this.opening=new zt,this.opened=this.opening.promise,this.isOpen=!1,this.loading={manifest:new zt,spine:new zt,metadata:new zt,cover:new zt,navigation:new zt,pageList:new zt,resources:new zt,displayOptions:new zt},this.loaded={manifest:this.loading.manifest.promise,spine:this.loading.spine.promise,metadata:this.loading.metadata.promise,cover:this.loading.cover.promise,navigation:this.loading.navigation.promise,pageList:this.loading.pageList.promise,resources:this.loading.resources.promise,displayOptions:this.loading.displayOptions.promise},this.ready=Promise.all([this.loaded.manifest,this.loaded.spine,this.loaded.metadata,this.loaded.cover,this.loaded.navigation,this.loaded.resources,this.loaded.displayOptions]),this.isRendered=!1,this.request=this.settings.requestMethod||Bl,this.spine=new KS,this.locations=new l1(this.spine,this.load.bind(this)),this.navigation=void 0,this.pageList=void 0,this.url=void 0,this.path=void 0,this.archived=!1,this.archive=void 0,this.storage=void 0,this.resources=void 0,this.rendition=void 0,this.container=void 0,this.packaging=void 0,this.displayOptions=void 0,this.settings.store&&this.store(this.settings.store),e&&this.open(e,this.settings.openAs).catch(n=>{var i=new Error("Cannot load book at "+e);this.emit(Ye.BOOK.OPEN_FAILED,i)})}open(e,t){var n,i=t||this.determineType(e);return i===yi.BINARY?(this.archived=!0,this.url=new _i("/",""),n=this.openEpub(e)):i===yi.BASE64?(this.archived=!0,this.url=new _i("/",""),n=this.openEpub(e,i)):i===yi.EPUB?(this.archived=!0,this.url=new _i("/",""),n=this.request(e,"binary",this.settings.requestCredentials,this.settings.requestHeaders).then(this.openEpub.bind(this))):i==yi.OPF?(this.url=new _i(e),n=this.openPackaging(this.url.Path.toString())):i==yi.MANIFEST?(this.url=new _i(e),n=this.openManifest(this.url.Path.toString())):(this.url=new _i(e),n=this.openContainer(Pw).then(this.openPackaging.bind(this))),n}openEpub(e,t){return this.unarchive(e,t||this.settings.encoding).then(()=>this.openContainer(Pw)).then(n=>this.openPackaging(n))}openContainer(e){return this.load(e).then(t=>(this.container=new QS(t),this.resolve(this.container.packagePath)))}openPackaging(e){return this.path=new gs(e),this.load(e).then(t=>(this.packaging=new cw(t),this.unpack(this.packaging)))}openManifest(e){return this.path=new gs(e),this.load(e).then(t=>(this.packaging=new cw,this.packaging.load(t),this.unpack(this.packaging)))}load(e){var t=this.resolve(e);return this.archived?this.archive.request(t):this.request(t,null,this.settings.requestCredentials,this.settings.requestHeaders)}resolve(e,t){if(e){var n=e,i=e.indexOf("://")>-1;return i?e:(this.path&&(n=this.path.resolve(e)),t!=!1&&this.url&&(n=this.url.resolve(n)),n)}}canonical(e){var t=e;return e?(this.settings.canonical?t=this.settings.canonical(e):t=this.resolve(e,!0),t):""}determineType(e){var t,n,i;if(this.settings.encoding==="base64")return yi.BASE64;if(typeof e!="string")return yi.BINARY;if(t=new _i(e),n=t.path(),i=n.extension,i&&(i=i.replace(/\?.*$/,"")),!i)return yi.DIRECTORY;if(i==="epub")return yi.EPUB;if(i==="opf")return yi.OPF;if(i==="json")return yi.MANIFEST}unpack(e){this.package=e,this.packaging.metadata.layout===""?this.load(this.url.resolve(OI)).then(t=>{this.displayOptions=new Sm(t),this.loading.displayOptions.resolve(this.displayOptions)}).catch(t=>{this.displayOptions=new Sm,this.loading.displayOptions.resolve(this.displayOptions)}):(this.displayOptions=new Sm,this.loading.displayOptions.resolve(this.displayOptions)),this.spine.unpack(this.packaging,this.resolve.bind(this),this.canonical.bind(this)),this.resources=new JS(this.packaging.manifest,{archive:this.archive,resolver:this.resolve.bind(this),request:this.request.bind(this),replacements:this.settings.replacements||(this.archived?"blobUrl":"base64")}),this.loadNavigation(this.packaging).then(()=>{this.loading.navigation.resolve(this.navigation)}),this.packaging.coverPath&&(this.cover=this.resolve(this.packaging.coverPath)),this.loading.manifest.resolve(this.packaging.manifest),this.loading.metadata.resolve(this.packaging.metadata),this.loading.spine.resolve(this.spine),this.loading.cover.resolve(this.cover),this.loading.resources.resolve(this.resources),this.loading.pageList.resolve(this.pageList),this.isOpen=!0,this.archived||this.settings.replacements&&this.settings.replacements!="none"?this.replacements().then(()=>{this.loaded.displayOptions.then(()=>{this.opening.resolve(this)})}).catch(t=>{console.error(t)}):this.loaded.displayOptions.then(()=>{this.opening.resolve(this)})}loadNavigation(e){let t=e.navPath||e.ncxPath,n=e.toc;return n?new Promise((i,o)=>{this.navigation=new am(n),e.pageList&&(this.pageList=new um(e.pageList)),i(this.navigation)}):t?this.load(t,"xml").then(i=>(this.navigation=new am(i),this.pageList=new um(i),this.navigation)):new Promise((i,o)=>{this.navigation=new am,this.pageList=new um,i(this.navigation)})}section(e){return this.spine.get(e)}renderTo(e,t){return this.rendition=new Jg(this,t),this.rendition.attachTo(e),this.rendition}setRequestCredentials(e){this.settings.requestCredentials=e}setRequestHeaders(e){this.settings.requestHeaders=e}unarchive(e,t){return this.archive=new kI,this.archive.open(e,t)}store(e){let t=this.settings.replacements&&this.settings.replacements!=="none",n=this.url,i=this.settings.requestMethod||Bl.bind(this);return this.storage=new v1(e,i,this.resolve.bind(this)),this.request=this.storage.request.bind(this.storage),this.opened.then(()=>{this.archived&&(this.storage.requester=this.archive.request.bind(this.archive));let o=(u,l)=>{l.output=this.resources.substitute(u,l.url)};this.resources.settings.replacements=t||"blobUrl",this.resources.replacements().then(()=>this.resources.replaceCss()),this.storage.on("offline",()=>{this.url=new _i("/",""),this.spine.hooks.serialize.register(o)}),this.storage.on("online",()=>{this.url=n,this.spine.hooks.serialize.deregister(o)})}),this.storage}coverUrl(){return this.loaded.cover.then(()=>this.cover?this.archived?this.archive.createUrl(this.cover):this.cover:null)}replacements(){return this.spine.hooks.serialize.register((e,t)=>{t.output=this.resources.substitute(e,t.url)}),this.resources.replacements().then(()=>this.resources.replaceCss())}getRange(e){var t=new Ut(e),n=this.spine.get(t.spinePos),i=this.load.bind(this);return n?n.load(i).then(function(o){var u=t.toRange(n.document);return u}):new Promise((o,u)=>{u("CFI could not be found")})}key(e){var t=e||this.packaging.metadata.identifier||this.url.filename;return`epubjs:${Fd}:${t}`}destroy(){this.opened=void 0,this.loading=void 0,this.loaded=void 0,this.ready=void 0,this.isOpen=!1,this.isRendered=!1,this.spine&&this.spine.destroy(),this.locations&&this.locations.destroy(),this.pageList&&this.pageList.destroy(),this.archive&&this.archive.destroy(),this.resources&&this.resources.destroy(),this.container&&this.container.destroy(),this.packaging&&this.packaging.destroy(),this.rendition&&this.rendition.destroy(),this.displayOptions&&this.displayOptions.destroy(),this.spine=void 0,this.locations=void 0,this.pageList=void 0,this.archive=void 0,this.resources=void 0,this.container=void 0,this.packaging=void 0,this.rendition=void 0,this.navigation=void 0,this.url=void 0,this.path=void 0,this.archived=!1}}Hi(ev.prototype);function lo(r,e){return new ev(r,e)}lo.VERSION=Fd;typeof global<"u"&&(global.EPUBJS_VERSION=Fd);lo.Book=ev;lo.Rendition=Jg;lo.Contents=Xg;lo.CFI=Ut;lo.utils=zS;const LI=({data:r,location:e,onLocationChange:t,onTocLoaded:n,onProgress:i,settings:o})=>{const u=ge.useRef(null),[l,c]=ge.useState(null);return ge.useEffect(()=>{if(console.log("Reader: Initializing with data:",r?.byteLength,"bytes"),!u.current||!r)return;u.current.innerHTML="";const d=new Blob([r],{type:"application/epub+zip"}),m=lo(d),g=m.renderTo(u.current,{width:"100%",height:"100%",flow:"paginated",manager:"default",allowScriptedContent:!0});(async()=>{console.log("Reader: Book rendered. Waiting for ready..."),await m.ready,console.log("Reader: Book ready. Displaying location:",e);try{e?await g.display(e):await g.display(),c(g),window.epubRendition=g;let M=0,D=0;g.on("touchstart",w=>{M=w.changedTouches[0].screenX}),g.on("touchend",w=>{D=w.changedTouches[0].screenX;const A=D-M,I=50;A>I?g.prev():A<-I&&g.next()})}catch(M){console.error("Reader: Initial display failed:",M),await g.display(),c(g),window.epubRendition=g}})(),m.loaded.navigation.then(M=>{n(M.toc)}),g.on("relocated",M=>{const D=M.start.cfi;if((l||window.epubRendition)&&t(D),m.locations&&m.locations.length()>0){const w=m.locations.percentageFromCfi(D);i&&i(w)}}),m.ready.then(()=>m.locations.generate(600)).then(()=>{const M=g.location?.start?.cfi;M&&i&&i(m.locations.percentageFromCfi(M))});const b=M=>{M.key==="ArrowLeft"&&g.prev(),M.key==="ArrowRight"&&g.next()};return window.addEventListener("keydown",b),()=>{m.destroy(),window.removeEventListener("keydown",b)}},[r]),ge.useEffect(()=>{if(!l)return;const d=()=>{requestAnimationFrame(()=>{if(u.current){const{width:m,height:g}=u.current.getBoundingClientRect();l.resize(m,g)}})};return window.addEventListener("resize",d),window.addEventListener("orientationchange",d),()=>{window.removeEventListener("resize",d),window.removeEventListener("orientationchange",d)}},[l]),ge.useEffect(()=>{l&&e&&l.location?.start?.cfi!==e&&(console.log("Reader: Syncing to external location:",e),l.display(e))},[e,l]),ge.useEffect(()=>{if(!l)return;const d={body:{"background-color":`${o.theme==="white"?"#ffffff":o.theme==="sepia"?"#fbf0d9":"#1a1a1a"} !important`,color:`${o.theme==="dark"?"#d1d1d1":"#333333"} !important`},"p, div, span, li":{"font-family":`${o.fontFamily==="sans"?"Inter, sans-serif":o.fontFamily==="serif"?"Georgia, serif":"monospace"} !important`,"font-size":`${o.fontSize}px !important`,"line-height":`${o.lineHeight} !important`}};l.getContents().forEach(g=>{g.addStylesheetRules(d)}),l.themes.register("custom",d),l.themes.select("custom")},[l,o]),ye.jsx("div",{className:"w-full h-full overflow-hidden",children:ye.jsx("div",{ref:u,className:"w-full h-full block",id:"epub-viewer"})})},VI=({isOpen:r,onClose:e,toc:t,onSelectChapter:n,theme:i})=>{const o={white:"bg-white text-gray-900 border-gray-100",sepia:"bg-[#fbf0d9] text-[#5b4636] border-[#e8dcc4]",dark:"bg-[#1a1a1a] text-gray-300 border-gray-800"},u={white:"hover:bg-blue-50 hover:text-blue-600 hover:border-blue-100",sepia:"hover:bg-[#f7e7c3] hover:text-[#5b4636] hover:border-[#e1cd9f]",dark:"hover:bg-white/5 hover:text-white hover:border-white/10"};return ye.jsxs(ye.Fragment,{children:[r&&ye.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm z-40 transition-opacity",onClick:e}),ye.jsx("div",{className:`fixed top-0 left-0 w-80 h-full shadow-2xl z-50 transform transition-transform duration-300 ease-in-out border-r ${o[i]} ${r?"translate-x-0":"-translate-x-full"}`,children:ye.jsxs("div",{className:"p-6 h-full flex flex-col",children:[ye.jsxs("div",{className:"flex justify-between items-center mb-8",children:[ye.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2",children:[ye.jsx(nS,{className:"w-5 h-5"}),"Contenido"]}),ye.jsx("button",{onClick:e,className:"p-2 hover:bg-black/5 rounded-full transition-colors",children:ye.jsx(GE,{className:"w-6 h-6"})})]}),ye.jsx("div",{className:"flex-1 overflow-y-auto pr-2 custom-scrollbar",children:t.length===0?ye.jsx("p",{className:"opacity-50 italic",children:"No se encontr tabla de contenidos."}):ye.jsx("ul",{className:"space-y-1",children:t.map((l,c)=>ye.jsxs("li",{children:[ye.jsx("button",{onClick:()=>{n(l.href),e()},className:`w-full text-left p-3 rounded-xl transition-all text-sm font-medium border border-transparent ${u[i]}`,children:l.label}),l.subitems&&l.subitems.length>0&&ye.jsx("ul",{className:"ml-4 mt-1 border-l-2 border-current/10 pl-2",children:l.subitems.map((d,m)=>ye.jsx("li",{children:ye.jsx("button",{onClick:()=>{n(d.href),e()},className:`w-full text-left p-2 rounded transition-colors text-xs opacity-70 ${u[i]}`,children:d.label})},m))})]},c))})})]})})]})},FI=({isOpen:r,onClose:e,settings:t,onUpdateSettings:n})=>{const i={white:"bg-white text-gray-900 border-gray-100",sepia:"bg-[#fbf0d9] text-[#5b4636] border-[#e8dcc4]",dark:"bg-[#1a1a1a] text-gray-300 border-gray-800"},o={white:"bg-gray-50 border-gray-100 text-gray-400",sepia:"bg-[#f7e7c3]/50 border-[#e1cd9f]/30 text-[#5b4636]/60",dark:"bg-white/5 border-white/5 text-gray-500"},u=[{id:"white",name:"Original",icon:ye.jsx(HE,{className:"w-4 h-4"}),bg:"bg-white",text:"text-gray-900",border:"border-gray-200"},{id:"sepia",name:"Sepia",icon:ye.jsx(jE,{className:"w-4 h-4"}),bg:"bg-[#fbf0d9]",text:"text-[#5b4636]",border:"border-[#e8dcc4]"},{id:"dark",name:"Noche",icon:ye.jsx(qE,{className:"w-4 h-4"}),bg:"bg-[#1a1a1a]",text:"text-gray-300",border:"border-gray-800"}],l=[{id:"sans",name:"Sans Serif",class:"font-sans"},{id:"serif",name:"Serif",class:"font-serif"},{id:"mono",name:"Monospace",class:"font-mono"}];return ye.jsxs(ye.Fragment,{children:[r&&ye.jsx("div",{className:"fixed inset-0 bg-black/10 z-40",onClick:e}),ye.jsx("div",{className:`fixed bottom-0 right-0 w-full sm:w-96 sm:m-4 sm:rounded-3xl shadow-2xl z-50 transform transition-all duration-500 ease-in-out border ${i[t.theme]} ${r?"translate-y-0 sm:translate-y-0":"translate-y-full sm:translate-y-[120%]"}`,children:ye.jsxs("div",{className:"p-8",children:[ye.jsxs("div",{className:"flex justify-between items-center mb-8",children:[ye.jsxs("h2",{className:"text-xl font-bold flex items-center gap-3",children:[ye.jsx(lS,{className:"w-6 h-6 text-blue-500"}),"Ajustes de Lectura"]}),ye.jsx("button",{onClick:e,className:"p-2 hover:bg-black/5 rounded-full transition-colors",children:ye.jsx(GE,{className:"w-6 h-6 opacity-50"})})]}),ye.jsxs("div",{className:"mb-10",children:[ye.jsx("p",{className:"text-[10px] font-bold opacity-40 uppercase tracking-widest mb-4",children:"Color de fondo"}),ye.jsx("div",{className:"flex gap-4",children:u.map(c=>ye.jsxs("button",{onClick:()=>n({...t,theme:c.id}),className:`flex-1 flex flex-col items-center gap-2 p-4 rounded-2xl border-2 transition-all duration-300 ${t.theme===c.id?"border-blue-500 ring-4 ring-blue-500/10 scale-105 shadow-lg":`border-transparent ${c.bg} hover:border-blue-200`}`,children:[ye.jsx("div",{className:`${c.text}`,children:c.icon}),ye.jsx("span",{className:`text-[10px] font-bold ${c.text}`,children:c.name})]},c.id))})]}),ye.jsxs("div",{className:"mb-10",children:[ye.jsx("p",{className:"text-[10px] font-bold opacity-40 uppercase tracking-widest mb-4",children:"Tipografa"}),ye.jsx("div",{className:`grid grid-cols-3 gap-2 p-1 rounded-2xl ${o[t.theme]}`,children:l.map(c=>ye.jsx("button",{onClick:()=>n({...t,fontFamily:c.id}),className:`p-3 rounded-xl text-sm transition-all duration-300 ${t.fontFamily===c.id?"bg-blue-500 text-white shadow-lg font-bold":"hover:bg-black/5 opacity-70 hover:opacity-100"} ${c.class}`,children:c.name},c.id))})]}),ye.jsxs("div",{className:"mb-10",children:[ye.jsxs("div",{className:"flex justify-between items-center mb-4",children:[ye.jsx("p",{className:"text-[10px] font-bold opacity-40 uppercase tracking-widest",children:"Tamao del texto"}),ye.jsxs("span",{className:"text-xs font-bold text-blue-500",children:[t.fontSize,"px"]})]}),ye.jsxs("div",{className:`flex items-center gap-4 p-2 rounded-2xl border border-transparent ${o[t.theme]}`,children:[ye.jsx("button",{onClick:()=>n({...t,fontSize:Math.max(12,t.fontSize-1)}),className:"p-3 bg-white/10 hover:bg-white/20 rounded-xl transition-all shadow-sm",children:ye.jsx(sS,{className:"w-5 h-5"})}),ye.jsx("input",{type:"range",min:"12",max:"48",value:t.fontSize,onChange:c=>n({...t,fontSize:parseInt(c.target.value)}),className:"flex-1 accent-blue-500 h-1.5 bg-black/10 rounded-lg appearance-none cursor-pointer"}),ye.jsx("button",{onClick:()=>n({...t,fontSize:Math.min(48,t.fontSize+1)}),className:"p-3 bg-white/10 hover:bg-white/20 rounded-xl transition-all shadow-sm",children:ye.jsx(WE,{className:"w-5 h-5"})})]})]}),ye.jsxs("div",{children:[ye.jsx("p",{className:"text-[10px] font-bold opacity-40 uppercase tracking-widest mb-4",children:"Interlineado"}),ye.jsx("div",{className:`flex gap-2 p-1 rounded-2xl ${o[t.theme]}`,children:[1.25,1.5,2].map(c=>ye.jsx("button",{onClick:()=>n({...t,lineHeight:c}),className:`flex-1 py-3 rounded-xl text-xs transition-all duration-300 ${t.lineHeight===c?"bg-blue-500 text-white shadow-lg font-bold":"hover:bg-black/5 opacity-70 hover:opacity-100"}`,children:c===1.25?"Compacto":c===1.5?"Normal":"Amplio"},c))})]})]})})]})},ng=(r,e)=>e.some(t=>r instanceof t);let Ow,Lw;function MI(){return Ow||(Ow=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function BI(){return Lw||(Lw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const rg=new WeakMap,Im=new WeakMap,Md=new WeakMap;function zI(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",o),r.removeEventListener("error",u)},o=()=>{t(Wo(r.result)),i()},u=()=>{n(r.error),i()};r.addEventListener("success",o),r.addEventListener("error",u)});return Md.set(e,r),e}function UI(r){if(rg.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",o),r.removeEventListener("error",u),r.removeEventListener("abort",u)},o=()=>{t(),i()},u=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",o),r.addEventListener("error",u),r.addEventListener("abort",u)});rg.set(r,e)}let ig={get(r,e,t){if(r instanceof IDBTransaction){if(e==="done")return rg.get(r);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Wo(r[e])},set(r,e,t){return r[e]=t,!0},has(r,e){return r instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in r}};function y1(r){ig=r(ig)}function jI(r){return BI().includes(r)?function(...e){return r.apply(sg(this),e),Wo(this.request)}:function(...e){return Wo(r.apply(sg(this),e))}}function qI(r){return typeof r=="function"?jI(r):(r instanceof IDBTransaction&&UI(r),ng(r,MI())?new Proxy(r,ig):r)}function Wo(r){if(r instanceof IDBRequest)return zI(r);if(Im.has(r))return Im.get(r);const e=qI(r);return e!==r&&(Im.set(r,e),Md.set(e,r)),e}const sg=r=>Md.get(r);function _1(r,e,{blocked:t,upgrade:n,blocking:i,terminated:o}={}){const u=indexedDB.open(r,e),l=Wo(u);return n&&u.addEventListener("upgradeneeded",c=>{n(Wo(u.result),c.oldVersion,c.newVersion,Wo(u.transaction),c)}),t&&u.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),l.then(c=>{o&&c.addEventListener("close",()=>o()),i&&c.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),l}const WI=["get","getKey","getAll","getAllKeys","count"],$I=["put","add","delete","clear"],Cm=new Map;function Vw(r,e){if(!(r instanceof IDBDatabase&&!(e in r)&&typeof e=="string"))return;if(Cm.get(e))return Cm.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=$I.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(i||WI.includes(t)))return;const o=async function(u,...l){const c=this.transaction(u,i?"readwrite":"readonly");let d=c.store;return n&&(d=d.index(l.shift())),(await Promise.all([d[t](...l),i&&c.done]))[0]};return Cm.set(e,o),o}y1(r=>({...r,get:(e,t,n)=>Vw(e,t)||r.get(e,t,n),has:(e,t)=>!!Vw(e,t)||r.has(e,t)}));const HI=["continue","continuePrimaryKey","advance"],Fw={},og=new WeakMap,w1=new WeakMap,GI={get(r,e){if(!HI.includes(e))return r[e];let t=Fw[e];return t||(t=Fw[e]=function(...n){og.set(this,w1.get(this)[e](...n))}),t}};async function*KI(...r){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...r)),!e)return;e=e;const t=new Proxy(e,GI);for(w1.set(t,e),Md.set(t,sg(e));e;)yield t,e=await(og.get(t)||e.continue()),og.delete(t)}function Mw(r,e){return e===Symbol.asyncIterator&&ng(r,[IDBIndex,IDBObjectStore,IDBCursor])||e==="iterate"&&ng(r,[IDBIndex,IDBObjectStore])}y1(r=>({...r,get(e,t,n){return Mw(e,t)?KI:r.get(e,t,n)},has(e,t){return Mw(e,t)||r.has(e,t)}}));const QI="epub-reader-db",zl="books",YI=1;let Dm=null;const tv=()=>(Dm||(Dm=_1(QI,YI,{upgrade(r){r.objectStoreNames.contains(zl)||r.createObjectStore(zl,{keyPath:"id"})}})),Dm),Bw=async r=>{await(await tv()).put(zl,r)},zw=async()=>(await tv()).getAll(zl),XI=async r=>{await(await tv()).delete(zl,r)},ZI=()=>{};var Uw={};const E1=function(r){const e=[];let t=0;for(let n=0;n<r.length;n++){let i=r.charCodeAt(n);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&n+1<r.length&&(r.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(r.charCodeAt(++n)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},JI=function(r){const e=[];let t=0,n=0;for(;t<r.length;){const i=r[t++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const o=r[t++];e[n++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=r[t++],u=r[t++],l=r[t++],c=((i&7)<<18|(o&63)<<12|(u&63)<<6|l&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const o=r[t++],u=r[t++];e[n++]=String.fromCharCode((i&15)<<12|(o&63)<<6|u&63)}}return e.join("")},b1={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<r.length;i+=3){const o=r[i],u=i+1<r.length,l=u?r[i+1]:0,c=i+2<r.length,d=c?r[i+2]:0,m=o>>2,g=(o&3)<<4|l>>4;let E=(l&15)<<2|d>>6,b=d&63;c||(b=64,u||(E=64)),n.push(t[m],t[g],t[E],t[b])}return n.join("")},encodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(r):this.encodeByteArray(E1(r),e)},decodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(r):JI(this.decodeStringToByteArray(r,e))},decodeStringToByteArray(r,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<r.length;){const o=t[r.charAt(i++)],l=i<r.length?t[r.charAt(i)]:0;++i;const d=i<r.length?t[r.charAt(i)]:64;++i;const g=i<r.length?t[r.charAt(i)]:64;if(++i,o==null||l==null||d==null||g==null)throw new eC;const E=o<<2|l>>4;if(n.push(E),d!==64){const b=l<<4&240|d>>2;if(n.push(b),g!==64){const M=d<<6&192|g;n.push(M)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class eC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const tC=function(r){const e=E1(r);return b1.encodeByteArray(e,!0)},od=function(r){return tC(r).replace(/\./g,"")},nC=function(r){try{return b1.decodeString(r,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function x1(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const rC=()=>x1().__FIREBASE_DEFAULTS__,iC=()=>{if(typeof process>"u"||typeof Uw>"u")return;const r=Uw.__FIREBASE_DEFAULTS__;if(r)return JSON.parse(r)},sC=()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=r&&nC(r[1]);return e&&JSON.parse(e)},nv=()=>{try{return ZI()||rC()||iC()||sC()}catch(r){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`);return}},oC=r=>nv()?.emulatorHosts?.[r],aC=r=>{const e=oC(r);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),n]:[e.substring(0,t),n]},T1=()=>nv()?.config;class uC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}function Bd(r){try{return(r.startsWith("http://")||r.startsWith("https://")?new URL(r).hostname:r).endsWith(".cloudworkstations.dev")}catch{return!1}}async function A1(r){return(await fetch(r,{credentials:"include"})).ok}function lC(r,e){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",i=r.iat||0,o=r.sub||r.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const u={iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...r};return[od(JSON.stringify(t)),od(JSON.stringify(u)),""].join(".")}const Al={};function cC(){const r={prod:[],emulator:[]};for(const e of Object.keys(Al))Al[e]?r.emulator.push(e):r.prod.push(e);return r}function hC(r){let e=document.getElementById(r),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",r),t=!0),{created:t,element:e}}let jw=!1;function dC(r,e){if(typeof window>"u"||typeof document>"u"||!Bd(window.location.host)||Al[r]===e||Al[r]||jw)return;Al[r]=e;function t(E){return`__firebase__banner__${E}`}const n="__firebase__banner",o=cC().prod.length>0;function u(){const E=document.getElementById(n);E&&E.remove()}function l(E){E.style.display="flex",E.style.background="#7faaf0",E.style.position="fixed",E.style.bottom="5px",E.style.left="5px",E.style.padding=".5em",E.style.borderRadius="5px",E.style.alignItems="center"}function c(E,b){E.setAttribute("width","24"),E.setAttribute("id",b),E.setAttribute("height","24"),E.setAttribute("viewBox","0 0 24 24"),E.setAttribute("fill","none"),E.style.marginLeft="-6px"}function d(){const E=document.createElement("span");return E.style.cursor="pointer",E.style.marginLeft="16px",E.style.fontSize="24px",E.innerHTML=" &times;",E.onclick=()=>{jw=!0,u()},E}function m(E,b){E.setAttribute("id",b),E.innerText="Learn more",E.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",E.setAttribute("target","__blank"),E.style.paddingLeft="5px",E.style.textDecoration="underline"}function g(){const E=hC(n),b=t("text"),M=document.getElementById(b)||document.createElement("span"),D=t("learnmore"),w=document.getElementById(D)||document.createElement("a"),A=t("preprendIcon"),I=document.getElementById(A)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(E.created){const V=E.element;l(V),m(w,D);const q=d();c(I,A),V.append(I,M,w,q),document.body.appendChild(V)}o?(M.innerText="Preview backend disconnected.",I.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(I.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,M.innerText="Preview backend running in this workspace."),M.setAttribute("id",b)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}function ad(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function S1(){const r=nv()?.forceEnvironment;if(r==="node")return!0;if(r==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function I1(){return!S1()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function C1(){return!S1()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function D1(){try{return typeof indexedDB=="object"}catch{return!1}}function fC(){return new Promise((r,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(n),r(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}const pC="FirebaseError";class ra extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=pC,Object.setPrototypeOf(this,ra.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,R1.prototype.create)}}class R1{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},i=`${this.service}/${e}`,o=this.errors[e],u=o?mC(o,n):"Error",l=`${this.serviceName}: ${u} (${i}).`;return new ra(i,l,n)}}function mC(r,e){return r.replace(gC,(t,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const gC=/\{\$([^}]+)}/g;function ud(r,e){if(r===e)return!0;const t=Object.keys(r),n=Object.keys(e);for(const i of t){if(!n.includes(i))return!1;const o=r[i],u=e[i];if(qw(o)&&qw(u)){if(!ud(o,u))return!1}else if(o!==u)return!1}for(const i of n)if(!t.includes(i))return!1;return!0}function qw(r){return r!==null&&typeof r=="object"}function Ti(r){return r&&r._delegate?r._delegate:r}class su{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Lo="[DEFAULT]";class vC{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new uC;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(n)return null;throw i}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(_C(e))try{this.getOrInitializeService({instanceIdentifier:Lo})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:i});n.resolve(o)}catch{}}}}clearInstance(e=Lo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Lo){return this.instances.has(e)}getOptions(e=Lo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[o,u]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(o);n===l&&u.resolve(i)}return i}onInit(e,t){const n=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(n)??new Set;i.add(e),this.onInitCallbacks.set(n,i);const o=this.instances.get(n);return o&&e(o,n),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:yC(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Lo){return this.component?this.component.multipleInstances?e:Lo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function yC(r){return r===Lo?void 0:r}function _C(r){return r.instantiationMode==="EAGER"}class wC{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new vC(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var $t;(function(r){r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT"})($t||($t={}));const EC={debug:$t.DEBUG,verbose:$t.VERBOSE,info:$t.INFO,warn:$t.WARN,error:$t.ERROR,silent:$t.SILENT},bC=$t.INFO,xC={[$t.DEBUG]:"log",[$t.VERBOSE]:"log",[$t.INFO]:"info",[$t.WARN]:"warn",[$t.ERROR]:"error"},TC=(r,e,...t)=>{if(e<r.logLevel)return;const n=new Date().toISOString(),i=xC[e];if(i)console[i](`[${n}]  ${r.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class k1{constructor(e){this.name=e,this._logLevel=bC,this._logHandler=TC,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in $t))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?EC[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,$t.DEBUG,...e),this._logHandler(this,$t.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,$t.VERBOSE,...e),this._logHandler(this,$t.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,$t.INFO,...e),this._logHandler(this,$t.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,$t.WARN,...e),this._logHandler(this,$t.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,$t.ERROR,...e),this._logHandler(this,$t.ERROR,...e)}}const AC=(r,e)=>e.some(t=>r instanceof t);let Ww,$w;function SC(){return Ww||(Ww=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function IC(){return $w||($w=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const N1=new WeakMap,ag=new WeakMap,P1=new WeakMap,Rm=new WeakMap,rv=new WeakMap;function CC(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",o),r.removeEventListener("error",u)},o=()=>{t(Zs(r.result)),i()},u=()=>{n(r.error),i()};r.addEventListener("success",o),r.addEventListener("error",u)});return e.then(t=>{t instanceof IDBCursor&&N1.set(t,r)}).catch(()=>{}),rv.set(e,r),e}function DC(r){if(ag.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",o),r.removeEventListener("error",u),r.removeEventListener("abort",u)},o=()=>{t(),i()},u=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",o),r.addEventListener("error",u),r.addEventListener("abort",u)});ag.set(r,e)}let ug={get(r,e,t){if(r instanceof IDBTransaction){if(e==="done")return ag.get(r);if(e==="objectStoreNames")return r.objectStoreNames||P1.get(r);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Zs(r[e])},set(r,e,t){return r[e]=t,!0},has(r,e){return r instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in r}};function RC(r){ug=r(ug)}function kC(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=r.call(km(this),e,...t);return P1.set(n,e.sort?e.sort():[e]),Zs(n)}:IC().includes(r)?function(...e){return r.apply(km(this),e),Zs(N1.get(this))}:function(...e){return Zs(r.apply(km(this),e))}}function NC(r){return typeof r=="function"?kC(r):(r instanceof IDBTransaction&&DC(r),AC(r,SC())?new Proxy(r,ug):r)}function Zs(r){if(r instanceof IDBRequest)return CC(r);if(Rm.has(r))return Rm.get(r);const e=NC(r);return e!==r&&(Rm.set(r,e),rv.set(e,r)),e}const km=r=>rv.get(r);function PC(r,e,{blocked:t,upgrade:n,blocking:i,terminated:o}={}){const u=indexedDB.open(r,e),l=Zs(u);return n&&u.addEventListener("upgradeneeded",c=>{n(Zs(u.result),c.oldVersion,c.newVersion,Zs(u.transaction),c)}),t&&u.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),l.then(c=>{o&&c.addEventListener("close",()=>o()),i&&c.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),l}const OC=["get","getKey","getAll","getAllKeys","count"],LC=["put","add","delete","clear"],Nm=new Map;function Hw(r,e){if(!(r instanceof IDBDatabase&&!(e in r)&&typeof e=="string"))return;if(Nm.get(e))return Nm.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=LC.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(i||OC.includes(t)))return;const o=async function(u,...l){const c=this.transaction(u,i?"readwrite":"readonly");let d=c.store;return n&&(d=d.index(l.shift())),(await Promise.all([d[t](...l),i&&c.done]))[0]};return Nm.set(e,o),o}RC(r=>({...r,get:(e,t,n)=>Hw(e,t)||r.get(e,t,n),has:(e,t)=>!!Hw(e,t)||r.has(e,t)}));class VC{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(FC(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function FC(r){return r.getComponent()?.type==="VERSION"}const lg="@firebase/app",Gw="0.14.7";const vs=new k1("@firebase/app"),MC="@firebase/app-compat",BC="@firebase/analytics-compat",zC="@firebase/analytics",UC="@firebase/app-check-compat",jC="@firebase/app-check",qC="@firebase/auth",WC="@firebase/auth-compat",$C="@firebase/database",HC="@firebase/data-connect",GC="@firebase/database-compat",KC="@firebase/functions",QC="@firebase/functions-compat",YC="@firebase/installations",XC="@firebase/installations-compat",ZC="@firebase/messaging",JC="@firebase/messaging-compat",eD="@firebase/performance",tD="@firebase/performance-compat",nD="@firebase/remote-config",rD="@firebase/remote-config-compat",iD="@firebase/storage",sD="@firebase/storage-compat",oD="@firebase/firestore",aD="@firebase/ai",uD="@firebase/firestore-compat",lD="firebase",cD="12.8.0";const cg="[DEFAULT]",hD={[lg]:"fire-core",[MC]:"fire-core-compat",[zC]:"fire-analytics",[BC]:"fire-analytics-compat",[jC]:"fire-app-check",[UC]:"fire-app-check-compat",[qC]:"fire-auth",[WC]:"fire-auth-compat",[$C]:"fire-rtdb",[HC]:"fire-data-connect",[GC]:"fire-rtdb-compat",[KC]:"fire-fn",[QC]:"fire-fn-compat",[YC]:"fire-iid",[XC]:"fire-iid-compat",[ZC]:"fire-fcm",[JC]:"fire-fcm-compat",[eD]:"fire-perf",[tD]:"fire-perf-compat",[nD]:"fire-rc",[rD]:"fire-rc-compat",[iD]:"fire-gcs",[sD]:"fire-gcs-compat",[oD]:"fire-fst",[uD]:"fire-fst-compat",[aD]:"fire-vertex","fire-js":"fire-js",[lD]:"fire-js-all"};const ld=new Map,dD=new Map,hg=new Map;function Kw(r,e){try{r.container.addComponent(e)}catch(t){vs.debug(`Component ${e.name} failed to register with FirebaseApp ${r.name}`,t)}}function Ul(r){const e=r.name;if(hg.has(e))return vs.debug(`There were multiple attempts to register component ${e}.`),!1;hg.set(e,r);for(const t of ld.values())Kw(t,r);for(const t of dD.values())Kw(t,r);return!0}function O1(r,e){const t=r.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),r.container.getProvider(e)}function L1(r){return r==null?!1:r.settings!==void 0}const fD={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Js=new R1("app","Firebase",fD);class pD{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new su("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Js.create("app-deleted",{appName:this._name})}}const V1=cD;function F1(r,e={}){let t=r;typeof e!="object"&&(e={name:e});const n={name:cg,automaticDataCollectionEnabled:!0,...e},i=n.name;if(typeof i!="string"||!i)throw Js.create("bad-app-name",{appName:String(i)});if(t||(t=T1()),!t)throw Js.create("no-options");const o=ld.get(i);if(o){if(ud(t,o.options)&&ud(n,o.config))return o;throw Js.create("duplicate-app",{appName:i})}const u=new wC(i);for(const c of hg.values())u.addComponent(c);const l=new pD(t,n,u);return ld.set(i,l),l}function mD(r=cg){const e=ld.get(r);if(!e&&r===cg&&T1())return F1();if(!e)throw Js.create("no-app",{appName:r});return e}function eo(r,e,t){let n=hD[r]??r;t&&(n+=`-${t}`);const i=n.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const u=[`Unable to register library "${n}" with version "${e}":`];i&&u.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&o&&u.push("and"),o&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),vs.warn(u.join(" "));return}Ul(new su(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}const gD="firebase-heartbeat-database",vD=1,jl="firebase-heartbeat-store";let Pm=null;function M1(){return Pm||(Pm=PC(gD,vD,{upgrade:(r,e)=>{switch(e){case 0:try{r.createObjectStore(jl)}catch(t){console.warn(t)}}}}).catch(r=>{throw Js.create("idb-open",{originalErrorMessage:r.message})})),Pm}async function yD(r){try{const t=(await M1()).transaction(jl),n=await t.objectStore(jl).get(B1(r));return await t.done,n}catch(e){if(e instanceof ra)vs.warn(e.message);else{const t=Js.create("idb-get",{originalErrorMessage:e?.message});vs.warn(t.message)}}}async function Qw(r,e){try{const n=(await M1()).transaction(jl,"readwrite");await n.objectStore(jl).put(e,B1(r)),await n.done}catch(t){if(t instanceof ra)vs.warn(t.message);else{const n=Js.create("idb-set",{originalErrorMessage:t?.message});vs.warn(n.message)}}}function B1(r){return`${r.name}!${r.options.appId}`}const _D=1024,wD=30;class ED{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new xD(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=Yw();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(i=>i.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:t}),this._heartbeatsCache.heartbeats.length>wD){const i=TD(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){vs.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Yw(),{heartbeatsToSend:t,unsentEntries:n}=bD(this._heartbeatsCache.heartbeats),i=od(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return vs.warn(e),""}}}function Yw(){return new Date().toISOString().substring(0,10)}function bD(r,e=_D){const t=[];let n=r.slice();for(const i of r){const o=t.find(u=>u.agent===i.agent);if(o){if(o.dates.push(i.date),Xw(t)>e){o.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),Xw(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class xD{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return D1()?fC().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await yD(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Qw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Qw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function Xw(r){return od(JSON.stringify({version:2,heartbeats:r})).length}function TD(r){if(r.length===0)return-1;let e=0,t=r[0].date;for(let n=1;n<r.length;n++)r[n].date<t&&(t=r[n].date,e=n);return e}function AD(r){Ul(new su("platform-logger",e=>new VC(e),"PRIVATE")),Ul(new su("heartbeat",e=>new ED(e),"PRIVATE")),eo(lg,Gw,r),eo(lg,Gw,"esm2020"),eo("fire-js","")}AD("");var SD="firebase",ID="12.8.0";eo(SD,ID,"app");var Zw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var to,z1;(function(){var r;function e(R,S){function C(){}C.prototype=S.prototype,R.F=S.prototype,R.prototype=new C,R.prototype.constructor=R,R.D=function(N,z,j){for(var L=Array(arguments.length-2),he=2;he<arguments.length;he++)L[he-2]=arguments[he];return S.prototype[z].apply(N,L)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(n,t),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(R,S,C){C||(C=0);const N=Array(16);if(typeof S=="string")for(var z=0;z<16;++z)N[z]=S.charCodeAt(C++)|S.charCodeAt(C++)<<8|S.charCodeAt(C++)<<16|S.charCodeAt(C++)<<24;else for(z=0;z<16;++z)N[z]=S[C++]|S[C++]<<8|S[C++]<<16|S[C++]<<24;S=R.g[0],C=R.g[1],z=R.g[2];let j=R.g[3],L;L=S+(j^C&(z^j))+N[0]+3614090360&4294967295,S=C+(L<<7&4294967295|L>>>25),L=j+(z^S&(C^z))+N[1]+3905402710&4294967295,j=S+(L<<12&4294967295|L>>>20),L=z+(C^j&(S^C))+N[2]+606105819&4294967295,z=j+(L<<17&4294967295|L>>>15),L=C+(S^z&(j^S))+N[3]+3250441966&4294967295,C=z+(L<<22&4294967295|L>>>10),L=S+(j^C&(z^j))+N[4]+4118548399&4294967295,S=C+(L<<7&4294967295|L>>>25),L=j+(z^S&(C^z))+N[5]+1200080426&4294967295,j=S+(L<<12&4294967295|L>>>20),L=z+(C^j&(S^C))+N[6]+2821735955&4294967295,z=j+(L<<17&4294967295|L>>>15),L=C+(S^z&(j^S))+N[7]+4249261313&4294967295,C=z+(L<<22&4294967295|L>>>10),L=S+(j^C&(z^j))+N[8]+1770035416&4294967295,S=C+(L<<7&4294967295|L>>>25),L=j+(z^S&(C^z))+N[9]+2336552879&4294967295,j=S+(L<<12&4294967295|L>>>20),L=z+(C^j&(S^C))+N[10]+4294925233&4294967295,z=j+(L<<17&4294967295|L>>>15),L=C+(S^z&(j^S))+N[11]+2304563134&4294967295,C=z+(L<<22&4294967295|L>>>10),L=S+(j^C&(z^j))+N[12]+1804603682&4294967295,S=C+(L<<7&4294967295|L>>>25),L=j+(z^S&(C^z))+N[13]+4254626195&4294967295,j=S+(L<<12&4294967295|L>>>20),L=z+(C^j&(S^C))+N[14]+2792965006&4294967295,z=j+(L<<17&4294967295|L>>>15),L=C+(S^z&(j^S))+N[15]+1236535329&4294967295,C=z+(L<<22&4294967295|L>>>10),L=S+(z^j&(C^z))+N[1]+4129170786&4294967295,S=C+(L<<5&4294967295|L>>>27),L=j+(C^z&(S^C))+N[6]+3225465664&4294967295,j=S+(L<<9&4294967295|L>>>23),L=z+(S^C&(j^S))+N[11]+643717713&4294967295,z=j+(L<<14&4294967295|L>>>18),L=C+(j^S&(z^j))+N[0]+3921069994&4294967295,C=z+(L<<20&4294967295|L>>>12),L=S+(z^j&(C^z))+N[5]+3593408605&4294967295,S=C+(L<<5&4294967295|L>>>27),L=j+(C^z&(S^C))+N[10]+38016083&4294967295,j=S+(L<<9&4294967295|L>>>23),L=z+(S^C&(j^S))+N[15]+3634488961&4294967295,z=j+(L<<14&4294967295|L>>>18),L=C+(j^S&(z^j))+N[4]+3889429448&4294967295,C=z+(L<<20&4294967295|L>>>12),L=S+(z^j&(C^z))+N[9]+568446438&4294967295,S=C+(L<<5&4294967295|L>>>27),L=j+(C^z&(S^C))+N[14]+3275163606&4294967295,j=S+(L<<9&4294967295|L>>>23),L=z+(S^C&(j^S))+N[3]+4107603335&4294967295,z=j+(L<<14&4294967295|L>>>18),L=C+(j^S&(z^j))+N[8]+1163531501&4294967295,C=z+(L<<20&4294967295|L>>>12),L=S+(z^j&(C^z))+N[13]+2850285829&4294967295,S=C+(L<<5&4294967295|L>>>27),L=j+(C^z&(S^C))+N[2]+4243563512&4294967295,j=S+(L<<9&4294967295|L>>>23),L=z+(S^C&(j^S))+N[7]+1735328473&4294967295,z=j+(L<<14&4294967295|L>>>18),L=C+(j^S&(z^j))+N[12]+2368359562&4294967295,C=z+(L<<20&4294967295|L>>>12),L=S+(C^z^j)+N[5]+4294588738&4294967295,S=C+(L<<4&4294967295|L>>>28),L=j+(S^C^z)+N[8]+2272392833&4294967295,j=S+(L<<11&4294967295|L>>>21),L=z+(j^S^C)+N[11]+1839030562&4294967295,z=j+(L<<16&4294967295|L>>>16),L=C+(z^j^S)+N[14]+4259657740&4294967295,C=z+(L<<23&4294967295|L>>>9),L=S+(C^z^j)+N[1]+2763975236&4294967295,S=C+(L<<4&4294967295|L>>>28),L=j+(S^C^z)+N[4]+1272893353&4294967295,j=S+(L<<11&4294967295|L>>>21),L=z+(j^S^C)+N[7]+4139469664&4294967295,z=j+(L<<16&4294967295|L>>>16),L=C+(z^j^S)+N[10]+3200236656&4294967295,C=z+(L<<23&4294967295|L>>>9),L=S+(C^z^j)+N[13]+681279174&4294967295,S=C+(L<<4&4294967295|L>>>28),L=j+(S^C^z)+N[0]+3936430074&4294967295,j=S+(L<<11&4294967295|L>>>21),L=z+(j^S^C)+N[3]+3572445317&4294967295,z=j+(L<<16&4294967295|L>>>16),L=C+(z^j^S)+N[6]+76029189&4294967295,C=z+(L<<23&4294967295|L>>>9),L=S+(C^z^j)+N[9]+3654602809&4294967295,S=C+(L<<4&4294967295|L>>>28),L=j+(S^C^z)+N[12]+3873151461&4294967295,j=S+(L<<11&4294967295|L>>>21),L=z+(j^S^C)+N[15]+530742520&4294967295,z=j+(L<<16&4294967295|L>>>16),L=C+(z^j^S)+N[2]+3299628645&4294967295,C=z+(L<<23&4294967295|L>>>9),L=S+(z^(C|~j))+N[0]+4096336452&4294967295,S=C+(L<<6&4294967295|L>>>26),L=j+(C^(S|~z))+N[7]+1126891415&4294967295,j=S+(L<<10&4294967295|L>>>22),L=z+(S^(j|~C))+N[14]+2878612391&4294967295,z=j+(L<<15&4294967295|L>>>17),L=C+(j^(z|~S))+N[5]+4237533241&4294967295,C=z+(L<<21&4294967295|L>>>11),L=S+(z^(C|~j))+N[12]+1700485571&4294967295,S=C+(L<<6&4294967295|L>>>26),L=j+(C^(S|~z))+N[3]+2399980690&4294967295,j=S+(L<<10&4294967295|L>>>22),L=z+(S^(j|~C))+N[10]+4293915773&4294967295,z=j+(L<<15&4294967295|L>>>17),L=C+(j^(z|~S))+N[1]+2240044497&4294967295,C=z+(L<<21&4294967295|L>>>11),L=S+(z^(C|~j))+N[8]+1873313359&4294967295,S=C+(L<<6&4294967295|L>>>26),L=j+(C^(S|~z))+N[15]+4264355552&4294967295,j=S+(L<<10&4294967295|L>>>22),L=z+(S^(j|~C))+N[6]+2734768916&4294967295,z=j+(L<<15&4294967295|L>>>17),L=C+(j^(z|~S))+N[13]+1309151649&4294967295,C=z+(L<<21&4294967295|L>>>11),L=S+(z^(C|~j))+N[4]+4149444226&4294967295,S=C+(L<<6&4294967295|L>>>26),L=j+(C^(S|~z))+N[11]+3174756917&4294967295,j=S+(L<<10&4294967295|L>>>22),L=z+(S^(j|~C))+N[2]+718787259&4294967295,z=j+(L<<15&4294967295|L>>>17),L=C+(j^(z|~S))+N[9]+3951481745&4294967295,R.g[0]=R.g[0]+S&4294967295,R.g[1]=R.g[1]+(z+(L<<21&4294967295|L>>>11))&4294967295,R.g[2]=R.g[2]+z&4294967295,R.g[3]=R.g[3]+j&4294967295}n.prototype.v=function(R,S){S===void 0&&(S=R.length);const C=S-this.blockSize,N=this.C;let z=this.h,j=0;for(;j<S;){if(z==0)for(;j<=C;)i(this,R,j),j+=this.blockSize;if(typeof R=="string"){for(;j<S;)if(N[z++]=R.charCodeAt(j++),z==this.blockSize){i(this,N),z=0;break}}else for(;j<S;)if(N[z++]=R[j++],z==this.blockSize){i(this,N),z=0;break}}this.h=z,this.o+=S},n.prototype.A=function(){var R=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);R[0]=128;for(var S=1;S<R.length-8;++S)R[S]=0;S=this.o*8;for(var C=R.length-8;C<R.length;++C)R[C]=S&255,S/=256;for(this.v(R),R=Array(16),S=0,C=0;C<4;++C)for(let N=0;N<32;N+=8)R[S++]=this.g[C]>>>N&255;return R};function o(R,S){var C=l;return Object.prototype.hasOwnProperty.call(C,R)?C[R]:C[R]=S(R)}function u(R,S){this.h=S;const C=[];let N=!0;for(let z=R.length-1;z>=0;z--){const j=R[z]|0;N&&j==S||(C[z]=j,N=!1)}this.g=C}var l={};function c(R){return-128<=R&&R<128?o(R,function(S){return new u([S|0],S<0?-1:0)}):new u([R|0],R<0?-1:0)}function d(R){if(isNaN(R)||!isFinite(R))return g;if(R<0)return w(d(-R));const S=[];let C=1;for(let N=0;R>=C;N++)S[N]=R/C|0,C*=4294967296;return new u(S,0)}function m(R,S){if(R.length==0)throw Error("number format error: empty string");if(S=S||10,S<2||36<S)throw Error("radix out of range: "+S);if(R.charAt(0)=="-")return w(m(R.substring(1),S));if(R.indexOf("-")>=0)throw Error('number format error: interior "-" character');const C=d(Math.pow(S,8));let N=g;for(let j=0;j<R.length;j+=8){var z=Math.min(8,R.length-j);const L=parseInt(R.substring(j,j+z),S);z<8?(z=d(Math.pow(S,z)),N=N.j(z).add(d(L))):(N=N.j(C),N=N.add(d(L)))}return N}var g=c(0),E=c(1),b=c(16777216);r=u.prototype,r.m=function(){if(D(this))return-w(this).m();let R=0,S=1;for(let C=0;C<this.g.length;C++){const N=this.i(C);R+=(N>=0?N:4294967296+N)*S,S*=4294967296}return R},r.toString=function(R){if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(M(this))return"0";if(D(this))return"-"+w(this).toString(R);const S=d(Math.pow(R,6));var C=this;let N="";for(;;){const z=q(C,S).g;C=A(C,z.j(S));let j=((C.g.length>0?C.g[0]:C.h)>>>0).toString(R);if(C=z,M(C))return j+N;for(;j.length<6;)j="0"+j;N=j+N}},r.i=function(R){return R<0?0:R<this.g.length?this.g[R]:this.h};function M(R){if(R.h!=0)return!1;for(let S=0;S<R.g.length;S++)if(R.g[S]!=0)return!1;return!0}function D(R){return R.h==-1}r.l=function(R){return R=A(this,R),D(R)?-1:M(R)?0:1};function w(R){const S=R.g.length,C=[];for(let N=0;N<S;N++)C[N]=~R.g[N];return new u(C,~R.h).add(E)}r.abs=function(){return D(this)?w(this):this},r.add=function(R){const S=Math.max(this.g.length,R.g.length),C=[];let N=0;for(let z=0;z<=S;z++){let j=N+(this.i(z)&65535)+(R.i(z)&65535),L=(j>>>16)+(this.i(z)>>>16)+(R.i(z)>>>16);N=L>>>16,j&=65535,L&=65535,C[z]=L<<16|j}return new u(C,C[C.length-1]&-2147483648?-1:0)};function A(R,S){return R.add(w(S))}r.j=function(R){if(M(this)||M(R))return g;if(D(this))return D(R)?w(this).j(w(R)):w(w(this).j(R));if(D(R))return w(this.j(w(R)));if(this.l(b)<0&&R.l(b)<0)return d(this.m()*R.m());const S=this.g.length+R.g.length,C=[];for(var N=0;N<2*S;N++)C[N]=0;for(N=0;N<this.g.length;N++)for(let z=0;z<R.g.length;z++){const j=this.i(N)>>>16,L=this.i(N)&65535,he=R.i(z)>>>16,_e=R.i(z)&65535;C[2*N+2*z]+=L*_e,I(C,2*N+2*z),C[2*N+2*z+1]+=j*_e,I(C,2*N+2*z+1),C[2*N+2*z+1]+=L*he,I(C,2*N+2*z+1),C[2*N+2*z+2]+=j*he,I(C,2*N+2*z+2)}for(R=0;R<S;R++)C[R]=C[2*R+1]<<16|C[2*R];for(R=S;R<2*S;R++)C[R]=0;return new u(C,0)};function I(R,S){for(;(R[S]&65535)!=R[S];)R[S+1]+=R[S]>>>16,R[S]&=65535,S++}function V(R,S){this.g=R,this.h=S}function q(R,S){if(M(S))throw Error("division by zero");if(M(R))return new V(g,g);if(D(R))return S=q(w(R),S),new V(w(S.g),w(S.h));if(D(S))return S=q(R,w(S)),new V(w(S.g),S.h);if(R.g.length>30){if(D(R)||D(S))throw Error("slowDivide_ only works with positive integers.");for(var C=E,N=S;N.l(R)<=0;)C=P(C),N=P(N);var z=U(C,1),j=U(N,1);for(N=U(N,2),C=U(C,2);!M(N);){var L=j.add(N);L.l(R)<=0&&(z=z.add(C),j=L),N=U(N,1),C=U(C,1)}return S=A(R,z.j(S)),new V(z,S)}for(z=g;R.l(S)>=0;){for(C=Math.max(1,Math.floor(R.m()/S.m())),N=Math.ceil(Math.log(C)/Math.LN2),N=N<=48?1:Math.pow(2,N-48),j=d(C),L=j.j(S);D(L)||L.l(R)>0;)C-=N,j=d(C),L=j.j(S);M(j)&&(j=E),z=z.add(j),R=A(R,L)}return new V(z,R)}r.B=function(R){return q(this,R).h},r.and=function(R){const S=Math.max(this.g.length,R.g.length),C=[];for(let N=0;N<S;N++)C[N]=this.i(N)&R.i(N);return new u(C,this.h&R.h)},r.or=function(R){const S=Math.max(this.g.length,R.g.length),C=[];for(let N=0;N<S;N++)C[N]=this.i(N)|R.i(N);return new u(C,this.h|R.h)},r.xor=function(R){const S=Math.max(this.g.length,R.g.length),C=[];for(let N=0;N<S;N++)C[N]=this.i(N)^R.i(N);return new u(C,this.h^R.h)};function P(R){const S=R.g.length+1,C=[];for(let N=0;N<S;N++)C[N]=R.i(N)<<1|R.i(N-1)>>>31;return new u(C,R.h)}function U(R,S){const C=S>>5;S%=32;const N=R.g.length-C,z=[];for(let j=0;j<N;j++)z[j]=S>0?R.i(j+C)>>>S|R.i(j+C+1)<<32-S:R.i(j+C);return new u(z,R.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,z1=n,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.B,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=d,u.fromString=m,to=u}).apply(typeof Zw<"u"?Zw:typeof self<"u"?self:typeof window<"u"?window:{});var Sh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var U1,_l,j1,Bh,dg,q1,W1,$1;(function(){var r,e=Object.defineProperty;function t(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof Sh=="object"&&Sh];for(var T=0;T<f.length;++T){var k=f[T];if(k&&k.Math==Math)return k}throw Error("Cannot find global object")}var n=t(this);function i(f,T){if(T)e:{var k=n;f=f.split(".");for(var H=0;H<f.length-1;H++){var me=f[H];if(!(me in k))break e;k=k[me]}f=f[f.length-1],H=k[f],T=T(H),T!=H&&T!=null&&e(k,f,{configurable:!0,writable:!0,value:T})}}i("Symbol.dispose",function(f){return f||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(f){return f||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(f){return f||function(T){var k=[],H;for(H in T)Object.prototype.hasOwnProperty.call(T,H)&&k.push([H,T[H]]);return k}});var o=o||{},u=this||self;function l(f){var T=typeof f;return T=="object"&&f!=null||T=="function"}function c(f,T,k){return f.call.apply(f.bind,arguments)}function d(f,T,k){return d=c,d.apply(null,arguments)}function m(f,T){var k=Array.prototype.slice.call(arguments,1);return function(){var H=k.slice();return H.push.apply(H,arguments),f.apply(this,H)}}function g(f,T){function k(){}k.prototype=T.prototype,f.Z=T.prototype,f.prototype=new k,f.prototype.constructor=f,f.Ob=function(H,me,Ee){for(var $e=Array(arguments.length-2),Rt=2;Rt<arguments.length;Rt++)$e[Rt-2]=arguments[Rt];return T.prototype[me].apply(H,$e)}}var E=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?f=>f&&AsyncContext.Snapshot.wrap(f):f=>f;function b(f){const T=f.length;if(T>0){const k=Array(T);for(let H=0;H<T;H++)k[H]=f[H];return k}return[]}function M(f,T){for(let H=1;H<arguments.length;H++){const me=arguments[H];var k=typeof me;if(k=k!="object"?k:me?Array.isArray(me)?"array":k:"null",k=="array"||k=="object"&&typeof me.length=="number"){k=f.length||0;const Ee=me.length||0;f.length=k+Ee;for(let $e=0;$e<Ee;$e++)f[k+$e]=me[$e]}else f.push(me)}}class D{constructor(T,k){this.i=T,this.j=k,this.h=0,this.g=null}get(){let T;return this.h>0?(this.h--,T=this.g,this.g=T.next,T.next=null):T=this.i(),T}}function w(f){u.setTimeout(()=>{throw f},0)}function A(){var f=R;let T=null;return f.g&&(T=f.g,f.g=f.g.next,f.g||(f.h=null),T.next=null),T}class I{constructor(){this.h=this.g=null}add(T,k){const H=V.get();H.set(T,k),this.h?this.h.next=H:this.g=H,this.h=H}}var V=new D(()=>new q,f=>f.reset());class q{constructor(){this.next=this.g=this.h=null}set(T,k){this.h=T,this.g=k,this.next=null}reset(){this.next=this.g=this.h=null}}let P,U=!1,R=new I,S=()=>{const f=Promise.resolve(void 0);P=()=>{f.then(C)}};function C(){for(var f;f=A();){try{f.h.call(f.g)}catch(k){w(k)}var T=V;T.j(f),T.h<100&&(T.h++,f.next=T.g,T.g=f)}U=!1}function N(){this.u=this.u,this.C=this.C}N.prototype.u=!1,N.prototype.dispose=function(){this.u||(this.u=!0,this.N())},N.prototype[Symbol.dispose]=function(){this.dispose()},N.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function z(f,T){this.type=f,this.g=this.target=T,this.defaultPrevented=!1}z.prototype.h=function(){this.defaultPrevented=!0};var j=(function(){if(!u.addEventListener||!Object.defineProperty)return!1;var f=!1,T=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const k=()=>{};u.addEventListener("test",k,T),u.removeEventListener("test",k,T)}catch{}return f})();function L(f){return/^[\s\xa0]*$/.test(f)}function he(f,T){z.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f&&this.init(f,T)}g(he,z),he.prototype.init=function(f,T){const k=this.type=f.type,H=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;this.target=f.target||f.srcElement,this.g=T,T=f.relatedTarget,T||(k=="mouseover"?T=f.fromElement:k=="mouseout"&&(T=f.toElement)),this.relatedTarget=T,H?(this.clientX=H.clientX!==void 0?H.clientX:H.pageX,this.clientY=H.clientY!==void 0?H.clientY:H.pageY,this.screenX=H.screenX||0,this.screenY=H.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=f.pointerType,this.state=f.state,this.i=f,f.defaultPrevented&&he.Z.h.call(this)},he.prototype.h=function(){he.Z.h.call(this);const f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var _e="closure_listenable_"+(Math.random()*1e6|0),De=0;function de(f,T,k,H,me){this.listener=f,this.proxy=null,this.src=T,this.type=k,this.capture=!!H,this.ha=me,this.key=++De,this.da=this.fa=!1}function J(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function ce(f,T,k){for(const H in f)T.call(k,f[H],H,f)}function xe(f,T){for(const k in f)T.call(void 0,f[k],k,f)}function Q(f){const T={};for(const k in f)T[k]=f[k];return T}const se="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ce(f,T){let k,H;for(let me=1;me<arguments.length;me++){H=arguments[me];for(k in H)f[k]=H[k];for(let Ee=0;Ee<se.length;Ee++)k=se[Ee],Object.prototype.hasOwnProperty.call(H,k)&&(f[k]=H[k])}}function Ie(f){this.src=f,this.g={},this.h=0}Ie.prototype.add=function(f,T,k,H,me){const Ee=f.toString();f=this.g[Ee],f||(f=this.g[Ee]=[],this.h++);const $e=Ke(f,T,H,me);return $e>-1?(T=f[$e],k||(T.fa=!1)):(T=new de(T,this.src,Ee,!!H,me),T.fa=k,f.push(T)),T};function He(f,T){const k=T.type;if(k in f.g){var H=f.g[k],me=Array.prototype.indexOf.call(H,T,void 0),Ee;(Ee=me>=0)&&Array.prototype.splice.call(H,me,1),Ee&&(J(T),f.g[k].length==0&&(delete f.g[k],f.h--))}}function Ke(f,T,k,H){for(let me=0;me<f.length;++me){const Ee=f[me];if(!Ee.da&&Ee.listener==T&&Ee.capture==!!k&&Ee.ha==H)return me}return-1}var et="closure_lm_"+(Math.random()*1e6|0),Fe={};function Je(f,T,k,H,me){if(Array.isArray(T)){for(let Ee=0;Ee<T.length;Ee++)Je(f,T[Ee],k,H,me);return null}return k=Ht(k),f&&f[_e]?f.J(T,k,l(H)?!!H.capture:!1,me):Xe(f,T,k,!1,H,me)}function Xe(f,T,k,H,me,Ee){if(!T)throw Error("Invalid event type");const $e=l(me)?!!me.capture:!!me;let Rt=St(f);if(Rt||(f[et]=Rt=new Ie(f)),k=Rt.add(T,k,H,$e,Ee),k.proxy)return k;if(H=ft(),k.proxy=H,H.src=f,H.listener=k,f.addEventListener)j||(me=$e),me===void 0&&(me=!1),f.addEventListener(T.toString(),H,me);else if(f.attachEvent)f.attachEvent(_t(T.toString()),H);else if(f.addListener&&f.removeListener)f.addListener(H);else throw Error("addEventListener and attachEvent are unavailable.");return k}function ft(){function f(k){return T.call(f.src,f.listener,k)}const T=kt;return f}function yt(f,T,k,H,me){if(Array.isArray(T))for(var Ee=0;Ee<T.length;Ee++)yt(f,T[Ee],k,H,me);else H=l(H)?!!H.capture:!!H,k=Ht(k),f&&f[_e]?(f=f.i,Ee=String(T).toString(),Ee in f.g&&(T=f.g[Ee],k=Ke(T,k,H,me),k>-1&&(J(T[k]),Array.prototype.splice.call(T,k,1),T.length==0&&(delete f.g[Ee],f.h--)))):f&&(f=St(f))&&(T=f.g[T.toString()],f=-1,T&&(f=Ke(T,k,H,me)),(k=f>-1?T[f]:null)&&mt(k))}function mt(f){if(typeof f!="number"&&f&&!f.da){var T=f.src;if(T&&T[_e])He(T.i,f);else{var k=f.type,H=f.proxy;T.removeEventListener?T.removeEventListener(k,H,f.capture):T.detachEvent?T.detachEvent(_t(k),H):T.addListener&&T.removeListener&&T.removeListener(H),(k=St(T))?(He(k,f),k.h==0&&(k.src=null,T[et]=null)):J(f)}}}function _t(f){return f in Fe?Fe[f]:Fe[f]="on"+f}function kt(f,T){if(f.da)f=!0;else{T=new he(T,this);const k=f.listener,H=f.ha||f.src;f.fa&&mt(f),f=k.call(H,T)}return f}function St(f){return f=f[et],f instanceof Ie?f:null}var Tt="__closure_events_fn_"+(Math.random()*1e9>>>0);function Ht(f){return typeof f=="function"?f:(f[Tt]||(f[Tt]=function(T){return f.handleEvent(T)}),f[Tt])}function Dt(){N.call(this),this.i=new Ie(this),this.M=this,this.G=null}g(Dt,N),Dt.prototype[_e]=!0,Dt.prototype.removeEventListener=function(f,T,k,H){yt(this,f,T,k,H)};function wt(f,T){var k,H=f.G;if(H)for(k=[];H;H=H.G)k.push(H);if(f=f.M,H=T.type||T,typeof T=="string")T=new z(T,f);else if(T instanceof z)T.target=T.target||f;else{var me=T;T=new z(H,f),Ce(T,me)}me=!0;let Ee,$e;if(k)for($e=k.length-1;$e>=0;$e--)Ee=T.g=k[$e],me=it(Ee,H,!0,T)&&me;if(Ee=T.g=f,me=it(Ee,H,!0,T)&&me,me=it(Ee,H,!1,T)&&me,k)for($e=0;$e<k.length;$e++)Ee=T.g=k[$e],me=it(Ee,H,!1,T)&&me}Dt.prototype.N=function(){if(Dt.Z.N.call(this),this.i){var f=this.i;for(const T in f.g){const k=f.g[T];for(let H=0;H<k.length;H++)J(k[H]);delete f.g[T],f.h--}}this.G=null},Dt.prototype.J=function(f,T,k,H){return this.i.add(String(f),T,!1,k,H)},Dt.prototype.K=function(f,T,k,H){return this.i.add(String(f),T,!0,k,H)};function it(f,T,k,H){if(T=f.i.g[String(T)],!T)return!0;T=T.concat();let me=!0;for(let Ee=0;Ee<T.length;++Ee){const $e=T[Ee];if($e&&!$e.da&&$e.capture==k){const Rt=$e.listener,On=$e.ha||$e.src;$e.fa&&He(f.i,$e),me=Rt.call(On,H)!==!1&&me}}return me&&!H.defaultPrevented}function gt(f,T){if(typeof f!="function")if(f&&typeof f.handleEvent=="function")f=d(f.handleEvent,f);else throw Error("Invalid listener argument");return Number(T)>2147483647?-1:u.setTimeout(f,T||0)}function dt(f){f.g=gt(()=>{f.g=null,f.i&&(f.i=!1,dt(f))},f.l);const T=f.h;f.h=null,f.m.apply(null,T)}class an extends N{constructor(T,k){super(),this.m=T,this.l=k,this.h=null,this.i=!1,this.g=null}j(T){this.h=arguments,this.g?this.i=!0:dt(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function _n(f){N.call(this),this.h=f,this.g={}}g(_n,N);var xn=[];function jt(f){ce(f.g,function(T,k){this.g.hasOwnProperty(k)&&mt(T)},f),f.g={}}_n.prototype.N=function(){_n.Z.N.call(this),jt(this)},_n.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var on=u.JSON.stringify,pn=u.JSON.parse,en=class{stringify(f){return u.JSON.stringify(f,void 0)}parse(f){return u.JSON.parse(f,void 0)}};function Qt(){}function Tn(){}var Gt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function hn(){z.call(this,"d")}g(hn,z);function Pn(){z.call(this,"c")}g(Pn,z);var $={},Se=null;function Re(){return Se=Se||new Dt}$.Ia="serverreachability";function Ge(f){z.call(this,$.Ia,f)}g(Ge,z);function ne(f){const T=Re();wt(T,new Ge(T))}$.STAT_EVENT="statevent";function be(f,T){z.call(this,$.STAT_EVENT,f),this.stat=T}g(be,z);function v(f){const T=Re();wt(T,new be(T,f))}$.Ja="timingevent";function O(f,T){z.call(this,$.Ja,f),this.size=T}g(O,z);function G(f,T){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){f()},T)}function y(){this.g=!0}y.prototype.ua=function(){this.g=!1};function X(f,T,k,H,me,Ee){f.info(function(){if(f.g)if(Ee){var $e="",Rt=Ee.split("&");for(let tn=0;tn<Rt.length;tn++){var On=Rt[tn].split("=");if(On.length>1){const Mn=On[0];On=On[1];const Br=Mn.split("_");$e=Br.length>=2&&Br[1]=="type"?$e+(Mn+"="+On+"&"):$e+(Mn+"=redacted&")}}}else $e=null;else $e=Ee;return"XMLHTTP REQ ("+H+") [attempt "+me+"]: "+T+`
`+k+`
`+$e})}function ie(f,T,k,H,me,Ee,$e){f.info(function(){return"XMLHTTP RESP ("+H+") [ attempt "+me+"]: "+T+`
`+k+`
`+Ee+" "+$e})}function F(f,T,k,H){f.info(function(){return"XMLHTTP TEXT ("+T+"): "+ue(f,k)+(H?" "+H:"")})}function Z(f,T){f.info(function(){return"TIMEOUT: "+T})}y.prototype.info=function(){};function ue(f,T){if(!f.g)return T;if(!T)return null;try{const Ee=JSON.parse(T);if(Ee){for(f=0;f<Ee.length;f++)if(Array.isArray(Ee[f])){var k=Ee[f];if(!(k.length<2)){var H=k[1];if(Array.isArray(H)&&!(H.length<1)){var me=H[0];if(me!="noop"&&me!="stop"&&me!="close")for(let $e=1;$e<H.length;$e++)H[$e]=""}}}}return on(Ee)}catch{return T}}var Ue={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Ne={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},ze;function lt(){}g(lt,Qt),lt.prototype.g=function(){return new XMLHttpRequest},ze=new lt;function Lt(f){return encodeURIComponent(String(f))}function xt(f){var T=1;f=f.split(":");const k=[];for(;T>0&&f.length;)k.push(f.shift()),T--;return f.length&&k.push(f.join(":")),k}function at(f,T,k,H){this.j=f,this.i=T,this.l=k,this.S=H||1,this.V=new _n(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Vt}function Vt(){this.i=null,this.g="",this.h=!1}var Nt={},mn={};function gn(f,T,k){f.M=1,f.A=Ae(ee(T)),f.u=k,f.R=!0,yr(f,null)}function yr(f,T){f.F=Date.now(),qn(f),f.B=ee(f.A);var k=f.B,H=f.S;Array.isArray(H)||(H=[String(H)]),vo(k.i,"t",H),f.C=0,k=f.j.L,f.h=new Vt,f.g=Sc(f.j,k?T:null,!f.u),f.P>0&&(f.O=new an(d(f.Y,f,f.g),f.P)),T=f.V,k=f.g,H=f.ba;var me="readystatechange";Array.isArray(me)||(me&&(xn[0]=me.toString()),me=xn);for(let Ee=0;Ee<me.length;Ee++){const $e=Je(k,me[Ee],H||T.handleEvent,!1,T.h||T);if(!$e)break;T.g[$e.key]=$e}T=f.J?Q(f.J):{},f.u?(f.v||(f.v="POST"),T["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.B,f.v,f.u,T)):(f.v="GET",f.g.ea(f.B,f.v,null,T)),ne(),X(f.i,f.v,f.B,f.l,f.S,f.u)}at.prototype.ba=function(f){f=f.target;const T=this.O;T&&Si(f)==3?T.j():this.Y(f)},at.prototype.Y=function(f){try{if(f==this.g)e:{const Rt=Si(this.g),On=this.g.ya(),tn=this.g.ca();if(!(Rt<3)&&(Rt!=3||this.g&&(this.h.h||this.g.la()||Tc(this.g)))){this.K||Rt!=4||On==7||(On==8||tn<=0?ne(3):ne(2)),ui(this);var T=this.g.ca();this.X=T;var k=un(this);if(this.o=T==200,ie(this.i,this.v,this.B,this.l,this.S,Rt,T),this.o){if(this.U&&!this.L){t:{if(this.g){var H,me=this.g;if((H=me.g?me.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!L(H)){var Ee=H;break t}}Ee=null}if(f=Ee)F(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Zt(this,f);else{this.o=!1,this.m=3,v(12),Qr(this),Ki(this);break e}}if(this.R){f=!0;let Mn;for(;!this.K&&this.C<k.length;)if(Mn=wn(this,k),Mn==mn){Rt==4&&(this.m=4,v(14),f=!1),F(this.i,this.l,null,"[Incomplete Response]");break}else if(Mn==Nt){this.m=4,v(15),F(this.i,this.l,k,"[Invalid Chunk]"),f=!1;break}else F(this.i,this.l,Mn,null),Zt(this,Mn);if(jn(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Rt!=4||k.length!=0||this.h.h||(this.m=1,v(16),f=!1),this.o=this.o&&f,!f)F(this.i,this.l,k,"[Invalid Chunked Response]"),Qr(this),Ki(this);else if(k.length>0&&!this.W){this.W=!0;var $e=this.j;$e.g==this&&$e.aa&&!$e.P&&($e.j.info("Great, no buffering proxy detected. Bytes received: "+k.length),wo($e),$e.P=!0,v(11))}}else F(this.i,this.l,k,null),Zt(this,k);Rt==4&&Qr(this),this.o&&!this.K&&(Rt==4?da(this.j,this):(this.o=!1,qn(this)))}else Lu(this.g),T==400&&k.indexOf("Unknown SID")>0?(this.m=3,v(12)):(this.m=0,v(13)),Qr(this),Ki(this)}}}catch{}};function un(f){if(!jn(f))return f.g.la();const T=Tc(f.g);if(T==="")return"";let k="";const H=T.length,me=Si(f.g)==4;if(!f.h.i){if(typeof TextDecoder>"u")return Qr(f),Ki(f),"";f.h.i=new u.TextDecoder}for(let Ee=0;Ee<H;Ee++)f.h.h=!0,k+=f.h.i.decode(T[Ee],{stream:!(me&&Ee==H-1)});return T.length=0,f.h.g+=k,f.C=0,f.h.g}function jn(f){return f.g?f.v=="GET"&&f.M!=2&&f.j.Aa:!1}function wn(f,T){var k=f.C,H=T.indexOf(`
`,k);return H==-1?mn:(k=Number(T.substring(k,H)),isNaN(k)?Nt:(H+=1,H+k>T.length?mn:(T=T.slice(H,H+k),f.C=H+k,T)))}at.prototype.cancel=function(){this.K=!0,Qr(this)};function qn(f){f.T=Date.now()+f.H,Kn(f,f.H)}function Kn(f,T){if(f.D!=null)throw Error("WatchDog timer not null");f.D=G(d(f.aa,f),T)}function ui(f){f.D&&(u.clearTimeout(f.D),f.D=null)}at.prototype.aa=function(){this.D=null;const f=Date.now();f-this.T>=0?(Z(this.i,this.B),this.M!=2&&(ne(),v(17)),Qr(this),this.m=2,Ki(this)):Kn(this,this.T-f)};function Ki(f){f.j.I==0||f.K||da(f.j,f)}function Qr(f){ui(f);var T=f.O;T&&typeof T.dispose=="function"&&T.dispose(),f.O=null,jt(f.V),f.g&&(T=f.g,f.g=null,T.abort(),T.dispose())}function Zt(f,T){try{var k=f.j;if(k.I!=0&&(k.g==f||Qi(k.h,f))){if(!f.L&&Qi(k.h,f)&&k.I==3){try{var H=k.Ba.g.parse(T)}catch{H=null}if(Array.isArray(H)&&H.length==3){var me=H;if(me[0]==0){e:if(!k.v){if(k.g)if(k.g.F+3e3<f.F)ha(k),Fr(k);else break e;Di(k),v(18)}}else k.xa=me[1],0<k.xa-k.K&&me[2]<37500&&k.F&&k.A==0&&!k.C&&(k.C=G(d(k.Va,k),6e3));Yr(k.h)<=1&&k.ta&&(k.ta=void 0)}else Mr(k,11)}else if((f.L||k.g==f)&&ha(k),!L(T))for(me=k.Ba.g.parse(T),T=0;T<me.length;T++){let tn=me[T];const Mn=tn[0];if(!(Mn<=k.K))if(k.K=Mn,tn=tn[1],k.I==2)if(tn[0]=="c"){k.M=tn[1],k.ba=tn[2];const Br=tn[3];Br!=null&&(k.ka=Br,k.j.info("VER="+k.ka));const rs=tn[4];rs!=null&&(k.za=rs,k.j.info("SVER="+k.za));const Ri=tn[5];Ri!=null&&typeof Ri=="number"&&Ri>0&&(H=1.5*Ri,k.O=H,k.j.info("backChannelRequestTimeoutMs_="+H)),H=k;const ki=f.g;if(ki){const ma=ki.g?ki.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ma){var Ee=H.h;Ee.g||ma.indexOf("spdy")==-1&&ma.indexOf("quic")==-1&&ma.indexOf("h2")==-1||(Ee.j=Ee.l,Ee.g=new Set,Ee.h&&(xs(Ee,Ee.h),Ee.h=null))}if(H.G){const Mu=ki.g?ki.g.getResponseHeader("X-HTTP-Session-Id"):null;Mu&&(H.wa=Mu,te(H.J,H.G,Mu))}}k.I=3,k.l&&k.l.ra(),k.aa&&(k.T=Date.now()-f.F,k.j.info("Handshake RTT: "+k.T+"ms")),H=k;var $e=f;if(H.na=Fu(H,H.L?H.ba:null,H.W),$e.L){Yi(H.h,$e);var Rt=$e,On=H.O;On&&(Rt.H=On),Rt.D&&(ui(Rt),qn(Rt)),H.g=$e}else ur(H);k.i.length>0&&ns(k)}else tn[0]!="stop"&&tn[0]!="close"||Mr(k,7);else k.I==3&&(tn[0]=="stop"||tn[0]=="close"?tn[0]=="stop"?Mr(k,7):la(k):tn[0]!="noop"&&k.l&&k.l.qa(tn),k.A=0)}}ne(4)}catch{}}var sa=class{constructor(f,T){this.g=f,this.map=T}};function Or(f){this.l=f||10,u.PerformanceNavigationTiming?(f=u.performance.getEntriesByType("navigation"),f=f.length>0&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function go(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function Yr(f){return f.h?1:f.g?f.g.size:0}function Qi(f,T){return f.h?f.h==T:f.g?f.g.has(T):!1}function xs(f,T){f.g?f.g.add(T):f.h=T}function Yi(f,T){f.h&&f.h==T?f.h=null:f.g&&f.g.has(T)&&f.g.delete(T)}Or.prototype.cancel=function(){if(this.i=tr(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function tr(f){if(f.h!=null)return f.i.concat(f.h.G);if(f.g!=null&&f.g.size!==0){let T=f.i;for(const k of f.g.values())T=T.concat(k.G);return T}return b(f.i)}var oa=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function _r(f,T){if(f){f=f.split("&");for(let k=0;k<f.length;k++){const H=f[k].indexOf("=");let me,Ee=null;H>=0?(me=f[k].substring(0,H),Ee=f[k].substring(H+1)):me=f[k],T(me,Ee?decodeURIComponent(Ee.replace(/\+/g," ")):"")}}}function W(f){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let T;f instanceof W?(this.l=f.l,K(this,f.j),this.o=f.o,this.g=f.g,oe(this,f.u),this.h=f.h,le(this,Zi(f.i)),this.m=f.m):f&&(T=String(f).match(oa))?(this.l=!1,K(this,T[1]||"",!0),this.o=ke(T[2]||""),this.g=ke(T[3]||"",!0),oe(this,T[4]),this.h=ke(T[5]||"",!0),le(this,T[6]||"",!0),this.m=ke(T[7]||"")):(this.l=!1,this.i=new pt(null,this.l))}W.prototype.toString=function(){const f=[];var T=this.j;T&&f.push(Ve(T,je,!0),":");var k=this.g;return(k||T=="file")&&(f.push("//"),(T=this.o)&&f.push(Ve(T,je,!0),"@"),f.push(Lt(k).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),k=this.u,k!=null&&f.push(":",String(k))),(k=this.h)&&(this.g&&k.charAt(0)!="/"&&f.push("/"),f.push(Ve(k,k.charAt(0)=="/"?It:tt,!0))),(k=this.i.toString())&&f.push("?",k),(k=this.m)&&f.push("#",Ve(k,Mt)),f.join("")},W.prototype.resolve=function(f){const T=ee(this);let k=!!f.j;k?K(T,f.j):k=!!f.o,k?T.o=f.o:k=!!f.g,k?T.g=f.g:k=f.u!=null;var H=f.h;if(k)oe(T,f.u);else if(k=!!f.h){if(H.charAt(0)!="/")if(this.g&&!this.h)H="/"+H;else{var me=T.h.lastIndexOf("/");me!=-1&&(H=T.h.slice(0,me+1)+H)}if(me=H,me==".."||me==".")H="";else if(me.indexOf("./")!=-1||me.indexOf("/.")!=-1){H=me.lastIndexOf("/",0)==0,me=me.split("/");const Ee=[];for(let $e=0;$e<me.length;){const Rt=me[$e++];Rt=="."?H&&$e==me.length&&Ee.push(""):Rt==".."?((Ee.length>1||Ee.length==1&&Ee[0]!="")&&Ee.pop(),H&&$e==me.length&&Ee.push("")):(Ee.push(Rt),H=!0)}H=Ee.join("/")}else H=me}return k?T.h=H:k=f.i.toString()!=="",k?le(T,Zi(f.i)):k=!!f.m,k&&(T.m=f.m),T};function ee(f){return new W(f)}function K(f,T,k){f.j=k?ke(T,!0):T,f.j&&(f.j=f.j.replace(/:$/,""))}function oe(f,T){if(T){if(T=Number(T),isNaN(T)||T<0)throw Error("Bad port number "+T);f.u=T}else f.u=null}function le(f,T,k){T instanceof pt?(f.i=T,Ts(f.i,f.l)):(k||(T=Ve(T,qt)),f.i=new pt(T,f.l))}function te(f,T,k){f.i.set(T,k)}function Ae(f){return te(f,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),f}function ke(f,T){return f?T?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function Ve(f,T,k){return typeof f=="string"?(f=encodeURI(f).replace(T,Be),k&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function Be(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var je=/[#\/\?@]/g,tt=/[#\?:]/g,It=/[#\?]/g,qt=/[#\?@]/g,Mt=/#/g;function pt(f,T){this.h=this.g=null,this.i=f||null,this.j=!!T}function Yt(f){f.g||(f.g=new Map,f.h=0,f.i&&_r(f.i,function(T,k){f.add(decodeURIComponent(T.replace(/\+/g," ")),k)}))}r=pt.prototype,r.add=function(f,T){Yt(this),this.i=null,f=li(this,f);let k=this.g.get(f);return k||this.g.set(f,k=[]),k.push(T),this.h+=1,this};function Qn(f,T){Yt(f),T=li(f,T),f.g.has(T)&&(f.i=null,f.h-=f.g.get(T).length,f.g.delete(T))}function Xr(f,T){return Yt(f),T=li(f,T),f.g.has(T)}r.forEach=function(f,T){Yt(this),this.g.forEach(function(k,H){k.forEach(function(me){f.call(T,me,H,this)},this)},this)};function Xi(f,T){Yt(f);let k=[];if(typeof T=="string")Xr(f,T)&&(k=k.concat(f.g.get(li(f,T))));else for(f=Array.from(f.g.values()),T=0;T<f.length;T++)k=k.concat(f[T]);return k}r.set=function(f,T){return Yt(this),this.i=null,f=li(this,f),Xr(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[T]),this.h+=1,this},r.get=function(f,T){return f?(f=Xi(this,f),f.length>0?String(f[0]):T):T};function vo(f,T,k){Qn(f,T),k.length>0&&(f.i=null,f.g.set(li(f,T),b(k)),f.h+=k.length)}r.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],T=Array.from(this.g.keys());for(let H=0;H<T.length;H++){var k=T[H];const me=Lt(k);k=Xi(this,k);for(let Ee=0;Ee<k.length;Ee++){let $e=me;k[Ee]!==""&&($e+="="+Lt(k[Ee])),f.push($e)}}return this.i=f.join("&")};function Zi(f){const T=new pt;return T.i=f.i,f.g&&(T.g=new Map(f.g),T.h=f.h),T}function li(f,T){return T=String(T),f.j&&(T=T.toLowerCase()),T}function Ts(f,T){T&&!f.j&&(Yt(f),f.i=null,f.g.forEach(function(k,H){const me=H.toLowerCase();H!=me&&(Qn(this,H),vo(this,me,k))},f)),f.j=T}function Zr(f,T){const k=new y;if(u.Image){const H=new Image;H.onload=m(nr,k,"TestLoadImage: loaded",!0,T,H),H.onerror=m(nr,k,"TestLoadImage: error",!1,T,H),H.onabort=m(nr,k,"TestLoadImage: abort",!1,T,H),H.ontimeout=m(nr,k,"TestLoadImage: timeout",!1,T,H),u.setTimeout(function(){H.ontimeout&&H.ontimeout()},1e4),H.src=f}else T(!1)}function Lr(f,T){const k=new y,H=new AbortController,me=setTimeout(()=>{H.abort(),nr(k,"TestPingServer: timeout",!1,T)},1e4);fetch(f,{signal:H.signal}).then(Ee=>{clearTimeout(me),Ee.ok?nr(k,"TestPingServer: ok",!0,T):nr(k,"TestPingServer: server error",!1,T)}).catch(()=>{clearTimeout(me),nr(k,"TestPingServer: error",!1,T)})}function nr(f,T,k,H,me){try{me&&(me.onload=null,me.onerror=null,me.onabort=null,me.ontimeout=null),H(k)}catch{}}function yo(){this.g=new en}function Ji(f){this.i=f.Sb||null,this.h=f.ab||!1}g(Ji,Qt),Ji.prototype.g=function(){return new Vr(this.i,this.h)};function Vr(f,T){Dt.call(this),this.H=f,this.o=T,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}g(Vr,Dt),r=Vr.prototype,r.open=function(f,T){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=f,this.D=T,this.readyState=1,ci(this)},r.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const T={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};f&&(T.body=f),(this.H||u).fetch(new Request(this.D,T)).then(this.Pa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,As(this)),this.readyState=0},r.Pa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,ci(this)),this.g&&(this.readyState=3,ci(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Ec(this)}else f.text().then(this.Oa.bind(this),this.ga.bind(this))};function Ec(f){f.j.read().then(f.Ma.bind(f)).catch(f.ga.bind(f))}r.Ma=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var T=f.value?f.value:new Uint8Array(0);(T=this.B.decode(T,{stream:!f.done}))&&(this.response=this.responseText+=T)}f.done?As(this):ci(this),this.readyState==3&&Ec(this)}},r.Oa=function(f){this.g&&(this.response=this.responseText=f,As(this))},r.Na=function(f){this.g&&(this.response=f,As(this))},r.ga=function(){this.g&&As(this)};function As(f){f.readyState=4,f.l=null,f.j=null,f.B=null,ci(f)}r.setRequestHeader=function(f,T){this.A.append(f,T)},r.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],T=this.h.entries();for(var k=T.next();!k.done;)k=k.value,f.push(k[0]+": "+k[1]),k=T.next();return f.join(`\r
`)};function ci(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(Vr.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function bc(f){let T="";return ce(f,function(k,H){T+=H,T+=":",T+=k,T+=`\r
`}),T}function aa(f,T,k){e:{for(H in k){var H=!1;break e}H=!0}H||(k=bc(k),typeof f=="string"?k!=null&&Lt(k):te(f,T,k))}function ln(f){Dt.call(this),this.headers=new Map,this.L=f||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}g(ln,Dt);var xc=/^https?$/i,df=["POST","PUT"];r=ln.prototype,r.Fa=function(f){this.H=f},r.ea=function(f,T,k,H){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);T=T?T.toUpperCase():"GET",this.D=f,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():ze.g(),this.g.onreadystatechange=E(d(this.Ca,this));try{this.B=!0,this.g.open(T,String(f),!0),this.B=!1}catch(Ee){Ss(this,Ee);return}if(f=k||"",k=new Map(this.headers),H)if(Object.getPrototypeOf(H)===Object.prototype)for(var me in H)k.set(me,H[me]);else if(typeof H.keys=="function"&&typeof H.get=="function")for(const Ee of H.keys())k.set(Ee,H.get(Ee));else throw Error("Unknown input type for opt_headers: "+String(H));H=Array.from(k.keys()).find(Ee=>Ee.toLowerCase()=="content-type"),me=u.FormData&&f instanceof u.FormData,!(Array.prototype.indexOf.call(df,T,void 0)>=0)||H||me||k.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Ee,$e]of k)this.g.setRequestHeader(Ee,$e);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(f),this.v=!1}catch(Ee){Ss(this,Ee)}};function Ss(f,T){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=T,f.o=5,Is(f),ts(f)}function Is(f){f.A||(f.A=!0,wt(f,"complete"),wt(f,"error"))}r.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=f||7,wt(this,"complete"),wt(this,"abort"),ts(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ts(this,!0)),ln.Z.N.call(this)},r.Ca=function(){this.u||(this.B||this.v||this.j?es(this):this.Xa())},r.Xa=function(){es(this)};function es(f){if(f.h&&typeof o<"u"){if(f.v&&Si(f)==4)setTimeout(f.Ca.bind(f),0);else if(wt(f,"readystatechange"),Si(f)==4){f.h=!1;try{const Ee=f.ca();e:switch(Ee){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var T=!0;break e;default:T=!1}var k;if(!(k=T)){var H;if(H=Ee===0){let $e=String(f.D).match(oa)[1]||null;!$e&&u.self&&u.self.location&&($e=u.self.location.protocol.slice(0,-1)),H=!xc.test($e?$e.toLowerCase():"")}k=H}if(k)wt(f,"complete"),wt(f,"success");else{f.o=6;try{var me=Si(f)>2?f.g.statusText:""}catch{me=""}f.l=me+" ["+f.ca()+"]",Is(f)}}finally{ts(f)}}}}function ts(f,T){if(f.g){f.m&&(clearTimeout(f.m),f.m=null);const k=f.g;f.g=null,T||wt(f,"ready");try{k.onreadystatechange=null}catch{}}}r.isActive=function(){return!!this.g};function Si(f){return f.g?f.g.readyState:0}r.ca=function(){try{return Si(this)>2?this.g.status:-1}catch{return-1}},r.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.La=function(f){if(this.g){var T=this.g.responseText;return f&&T.indexOf(f)==0&&(T=T.substring(f.length)),pn(T)}};function Tc(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.F){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function Lu(f){const T={};f=(f.g&&Si(f)>=2&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let H=0;H<f.length;H++){if(L(f[H]))continue;var k=xt(f[H]);const me=k[0];if(k=k[1],typeof k!="string")continue;k=k.trim();const Ee=T[me]||[];T[me]=Ee,Ee.push(k)}xe(T,function(H){return H.join(", ")})}r.ya=function(){return this.o},r.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ii(f,T,k){return k&&k.internalChannelParams&&k.internalChannelParams[f]||T}function ua(f){this.za=0,this.i=[],this.j=new y,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ii("failFast",!1,f),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ii("baseRetryDelayMs",5e3,f),this.Za=Ii("retryDelaySeedMs",1e4,f),this.Ta=Ii("forwardChannelMaxRetries",2,f),this.va=Ii("forwardChannelRequestTimeoutMs",2e4,f),this.ma=f&&f.xmlHttpFactory||void 0,this.Ua=f&&f.Rb||void 0,this.Aa=f&&f.useFetchStreams||!1,this.O=void 0,this.L=f&&f.supportsCrossDomainXhr||!1,this.M="",this.h=new Or(f&&f.concurrentRequestLimit),this.Ba=new yo,this.S=f&&f.fastHandshake||!1,this.R=f&&f.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=f&&f.Pb||!1,f&&f.ua&&this.j.ua(),f&&f.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&f&&f.detectBufferingProxy||!1,this.ia=void 0,f&&f.longPollingTimeout&&f.longPollingTimeout>0&&(this.ia=f.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}r=ua.prototype,r.ka=8,r.I=1,r.connect=function(f,T,k,H){v(0),this.W=f,this.H=T||{},k&&H!==void 0&&(this.H.OSID=k,this.H.OAID=H),this.F=this.X,this.J=Fu(this,null,this.W),ns(this)};function la(f){if(ca(f),f.I==3){var T=f.V++,k=ee(f.J);if(te(k,"SID",f.M),te(k,"RID",T),te(k,"TYPE","terminate"),Ci(f,k),T=new at(f,f.j,T),T.M=2,T.A=Ae(ee(k)),k=!1,u.navigator&&u.navigator.sendBeacon)try{k=u.navigator.sendBeacon(T.A.toString(),"")}catch{}!k&&u.Image&&(new Image().src=T.A,k=!0),k||(T.g=Sc(T.j,null),T.g.ea(T.A)),T.F=Date.now(),qn(T)}Eo(f)}function Fr(f){f.g&&(wo(f),f.g.cancel(),f.g=null)}function ca(f){Fr(f),f.v&&(u.clearTimeout(f.v),f.v=null),ha(f),f.h.cancel(),f.m&&(typeof f.m=="number"&&u.clearTimeout(f.m),f.m=null)}function ns(f){if(!go(f.h)&&!f.m){f.m=!0;var T=f.Ea;P||S(),U||(P(),U=!0),R.add(T,f),f.D=0}}function Ac(f,T){return Yr(f.h)>=f.h.j-(f.m?1:0)?!1:f.m?(f.i=T.G.concat(f.i),!0):f.I==1||f.I==2||f.D>=(f.Sa?0:f.Ta)?!1:(f.m=G(d(f.Ea,f,T),fa(f,f.D)),f.D++,!0)}r.Ea=function(f){if(this.m)if(this.m=null,this.I==1){if(!f){this.V=Math.floor(Math.random()*1e5),f=this.V++;const me=new at(this,this.j,f);let Ee=this.o;if(this.U&&(Ee?(Ee=Q(Ee),Ce(Ee,this.U)):Ee=this.U),this.u!==null||this.R||(me.J=Ee,Ee=null),this.S)e:{for(var T=0,k=0;k<this.i.length;k++){t:{var H=this.i[k];if("__data__"in H.map&&(H=H.map.__data__,typeof H=="string")){H=H.length;break t}H=void 0}if(H===void 0)break;if(T+=H,T>4096){T=k;break e}if(T===4096||k===this.i.length-1){T=k+1;break e}}T=1e3}else T=1e3;T=Vu(this,me,T),k=ee(this.J),te(k,"RID",f),te(k,"CVER",22),this.G&&te(k,"X-HTTP-Session-Id",this.G),Ci(this,k),Ee&&(this.R?T="headers="+Lt(bc(Ee))+"&"+T:this.u&&aa(k,this.u,Ee)),xs(this.h,me),this.Ra&&te(k,"TYPE","init"),this.S?(te(k,"$req",T),te(k,"SID","null"),me.U=!0,gn(me,k,null)):gn(me,k,T),this.I=2}}else this.I==3&&(f?_o(this,f):this.i.length==0||go(this.h)||_o(this))};function _o(f,T){var k;T?k=T.l:k=f.V++;const H=ee(f.J);te(H,"SID",f.M),te(H,"RID",k),te(H,"AID",f.K),Ci(f,H),f.u&&f.o&&aa(H,f.u,f.o),k=new at(f,f.j,k,f.D+1),f.u===null&&(k.J=f.o),T&&(f.i=T.G.concat(f.i)),T=Vu(f,k,1e3),k.H=Math.round(f.va*.5)+Math.round(f.va*.5*Math.random()),xs(f.h,k),gn(k,H,T)}function Ci(f,T){f.H&&ce(f.H,function(k,H){te(T,H,k)}),f.l&&ce({},function(k,H){te(T,H,k)})}function Vu(f,T,k){k=Math.min(f.i.length,k);const H=f.l?d(f.l.Ka,f.l,f):null;e:{var me=f.i;let Rt=-1;for(;;){const On=["count="+k];Rt==-1?k>0?(Rt=me[0].g,On.push("ofs="+Rt)):Rt=0:On.push("ofs="+Rt);let tn=!0;for(let Mn=0;Mn<k;Mn++){var Ee=me[Mn].g;const Br=me[Mn].map;if(Ee-=Rt,Ee<0)Rt=Math.max(0,me[Mn].g-100),tn=!1;else try{Ee="req"+Ee+"_"||"";try{var $e=Br instanceof Map?Br:Object.entries(Br);for(const[rs,Ri]of $e){let ki=Ri;l(Ri)&&(ki=on(Ri)),On.push(Ee+rs+"="+encodeURIComponent(ki))}}catch(rs){throw On.push(Ee+"type="+encodeURIComponent("_badmap")),rs}}catch{H&&H(Br)}}if(tn){$e=On.join("&");break e}}$e=void 0}return f=f.i.splice(0,k),T.G=f,$e}function ur(f){if(!f.g&&!f.v){f.Y=1;var T=f.Da;P||S(),U||(P(),U=!0),R.add(T,f),f.A=0}}function Di(f){return f.g||f.v||f.A>=3?!1:(f.Y++,f.v=G(d(f.Da,f),fa(f,f.A)),f.A++,!0)}r.Da=function(){if(this.v=null,Cs(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var f=4*this.T;this.j.info("BP detection timer enabled: "+f),this.B=G(d(this.Wa,this),f)}},r.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,v(10),Fr(this),Cs(this))};function wo(f){f.B!=null&&(u.clearTimeout(f.B),f.B=null)}function Cs(f){f.g=new at(f,f.j,"rpc",f.Y),f.u===null&&(f.g.J=f.o),f.g.P=0;var T=ee(f.na);te(T,"RID","rpc"),te(T,"SID",f.M),te(T,"AID",f.K),te(T,"CI",f.F?"0":"1"),!f.F&&f.ia&&te(T,"TO",f.ia),te(T,"TYPE","xmlhttp"),Ci(f,T),f.u&&f.o&&aa(T,f.u,f.o),f.O&&(f.g.H=f.O);var k=f.g;f=f.ba,k.M=1,k.A=Ae(ee(T)),k.u=null,k.R=!0,yr(k,f)}r.Va=function(){this.C!=null&&(this.C=null,Fr(this),Di(this),v(19))};function ha(f){f.C!=null&&(u.clearTimeout(f.C),f.C=null)}function da(f,T){var k=null;if(f.g==T){ha(f),wo(f),f.g=null;var H=2}else if(Qi(f.h,T))k=T.G,Yi(f.h,T),H=1;else return;if(f.I!=0){if(T.o)if(H==1){k=T.u?T.u.length:0,T=Date.now()-T.F;var me=f.D;H=Re(),wt(H,new O(H,k)),ns(f)}else ur(f);else if(me=T.m,me==3||me==0&&T.X>0||!(H==1&&Ac(f,T)||H==2&&Di(f)))switch(k&&k.length>0&&(T=f.h,T.i=T.i.concat(k)),me){case 1:Mr(f,5);break;case 4:Mr(f,10);break;case 3:Mr(f,6);break;default:Mr(f,2)}}}function fa(f,T){let k=f.Qa+Math.floor(Math.random()*f.Za);return f.isActive()||(k*=2),k*T}function Mr(f,T){if(f.j.info("Error code "+T),T==2){var k=d(f.bb,f),H=f.Ua;const me=!H;H=new W(H||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||K(H,"https"),Ae(H),me?Zr(H.toString(),k):Lr(H.toString(),k)}else v(2);f.I=0,f.l&&f.l.pa(T),Eo(f),ca(f)}r.bb=function(f){f?(this.j.info("Successfully pinged google.com"),v(2)):(this.j.info("Failed to ping google.com"),v(1))};function Eo(f){if(f.I=0,f.ja=[],f.l){const T=tr(f.h);(T.length!=0||f.i.length!=0)&&(M(f.ja,T),M(f.ja,f.i),f.h.i.length=0,b(f.i),f.i.length=0),f.l.oa()}}function Fu(f,T,k){var H=k instanceof W?ee(k):new W(k);if(H.g!="")T&&(H.g=T+"."+H.g),oe(H,H.u);else{var me=u.location;H=me.protocol,T=T?T+"."+me.hostname:me.hostname,me=+me.port;const Ee=new W(null);H&&K(Ee,H),T&&(Ee.g=T),me&&oe(Ee,me),k&&(Ee.h=k),H=Ee}return k=f.G,T=f.wa,k&&T&&te(H,k,T),te(H,"VER",f.ka),Ci(f,H),H}function Sc(f,T,k){if(T&&!f.L)throw Error("Can't create secondary domain capable XhrIo object.");return T=f.Aa&&!f.ma?new ln(new Ji({ab:k})):new ln(f.ma),T.Fa(f.L),T}r.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ic(){}r=Ic.prototype,r.ra=function(){},r.qa=function(){},r.pa=function(){},r.oa=function(){},r.isActive=function(){return!0},r.Ka=function(){};function pa(){}pa.prototype.g=function(f,T){return new rr(f,T)};function rr(f,T){Dt.call(this),this.g=new ua(T),this.l=f,this.h=T&&T.messageUrlParams||null,f=T&&T.messageHeaders||null,T&&T.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=T&&T.initMessageHeaders||null,T&&T.messageContentType&&(f?f["X-WebChannel-Content-Type"]=T.messageContentType:f={"X-WebChannel-Content-Type":T.messageContentType}),T&&T.sa&&(f?f["X-WebChannel-Client-Profile"]=T.sa:f={"X-WebChannel-Client-Profile":T.sa}),this.g.U=f,(f=T&&T.Qb)&&!L(f)&&(this.g.u=f),this.A=T&&T.supportsCrossDomainXhr||!1,this.v=T&&T.sendRawJson||!1,(T=T&&T.httpSessionIdParam)&&!L(T)&&(this.g.G=T,f=this.h,f!==null&&T in f&&(f=this.h,T in f&&delete f[T])),this.j=new Ds(this)}g(rr,Dt),rr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},rr.prototype.close=function(){la(this.g)},rr.prototype.o=function(f){var T=this.g;if(typeof f=="string"){var k={};k.__data__=f,f=k}else this.v&&(k={},k.__data__=on(f),f=k);T.i.push(new sa(T.Ya++,f)),T.I==3&&ns(T)},rr.prototype.N=function(){this.g.l=null,delete this.j,la(this.g),delete this.g,rr.Z.N.call(this)};function Cc(f){hn.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var T=f.__sm__;if(T){e:{for(const k in T){f=k;break e}f=void 0}(this.i=f)&&(f=this.i,T=T!==null&&f in T?T[f]:void 0),this.data=T}else this.data=f}g(Cc,hn);function Dc(){Pn.call(this),this.status=1}g(Dc,Pn);function Ds(f){this.g=f}g(Ds,Ic),Ds.prototype.ra=function(){wt(this.g,"a")},Ds.prototype.qa=function(f){wt(this.g,new Cc(f))},Ds.prototype.pa=function(f){wt(this.g,new Dc)},Ds.prototype.oa=function(){wt(this.g,"b")},pa.prototype.createWebChannel=pa.prototype.g,rr.prototype.send=rr.prototype.o,rr.prototype.open=rr.prototype.m,rr.prototype.close=rr.prototype.close,$1=function(){return new pa},W1=function(){return Re()},q1=$,dg={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Ue.NO_ERROR=0,Ue.TIMEOUT=8,Ue.HTTP_ERROR=6,Bh=Ue,Ne.COMPLETE="complete",j1=Ne,Tn.EventType=Gt,Gt.OPEN="a",Gt.CLOSE="b",Gt.ERROR="c",Gt.MESSAGE="d",Dt.prototype.listen=Dt.prototype.J,_l=Tn,ln.prototype.listenOnce=ln.prototype.K,ln.prototype.getLastError=ln.prototype.Ha,ln.prototype.getLastErrorCode=ln.prototype.ya,ln.prototype.getStatus=ln.prototype.ca,ln.prototype.getResponseJson=ln.prototype.La,ln.prototype.getResponseText=ln.prototype.la,ln.prototype.send=ln.prototype.ea,ln.prototype.setWithCredentials=ln.prototype.Fa,U1=ln}).apply(typeof Sh<"u"?Sh:typeof self<"u"?self:typeof window<"u"?window:{});class pr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}pr.UNAUTHENTICATED=new pr(null),pr.GOOGLE_CREDENTIALS=new pr("google-credentials-uid"),pr.FIRST_PARTY=new pr("first-party-uid"),pr.MOCK_USER=new pr("mock-user");let Su="12.8.0";function CD(r){Su=r}const Yo=new k1("@firebase/firestore");function Qa(){return Yo.logLevel}function Oe(r,...e){if(Yo.logLevel<=$t.DEBUG){const t=e.map(iv);Yo.debug(`Firestore (${Su}): ${r}`,...t)}}function Vn(r,...e){if(Yo.logLevel<=$t.ERROR){const t=e.map(iv);Yo.error(`Firestore (${Su}): ${r}`,...t)}}function ql(r,...e){if(Yo.logLevel<=$t.WARN){const t=e.map(iv);Yo.warn(`Firestore (${Su}): ${r}`,...t)}}function iv(r){if(typeof r=="string")return r;try{return(function(t){return JSON.stringify(t)})(r)}catch{return r}}function rt(r,e,t){let n="Unexpected state";typeof e=="string"?n=e:t=e,H1(r,n,t)}function H1(r,e,t){let n=`FIRESTORE (${Su}) INTERNAL ASSERTION FAILED: ${e} (ID: ${r.toString(16)})`;if(t!==void 0)try{n+=" CONTEXT: "+JSON.stringify(t)}catch{n+=" CONTEXT: "+t}throw Vn(n),new Error(n)}function ht(r,e,t,n){let i="Unexpected state";typeof t=="string"?i=t:n=t,r||H1(e,i,n)}function ot(r,e){return r}const Te={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class We extends ra{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Ui{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class DD{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class RD{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(pr.UNAUTHENTICATED)))}shutdown(){}}class kD{constructor(e){this.t=e,this.currentUser=pr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ht(this.o===void 0,42304);let n=this.i;const i=c=>this.i!==n?(n=this.i,t(c)):Promise.resolve();let o=new Ui;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Ui,e.enqueueRetryable((()=>i(this.currentUser)))};const u=()=>{const c=o;e.enqueueRetryable((async()=>{await c.promise,await i(this.currentUser)}))},l=c=>{Oe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),u())};this.t.onInit((c=>l(c))),setTimeout((()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(Oe("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Ui)}}),0),u()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((n=>this.i!==e?(Oe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(ht(typeof n.accessToken=="string",31837,{l:n}),new DD(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ht(e===null||typeof e=="string",2055,{h:e}),new pr(e)}}class ND{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=pr.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class PD{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new ND(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(pr.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Jw{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class OD{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,L1(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){ht(this.o===void 0,3512);const n=o=>{o.error!=null&&Oe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const u=o.token!==this.m;return this.m=o.token,Oe("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable((()=>n(o)))};const i=o=>{Oe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((o=>i(o))),setTimeout((()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?i(o):Oe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Jw(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(ht(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Jw(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function LD(r){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<r;n++)t[n]=Math.floor(256*Math.random());return t}class sv{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=LD(40);for(let o=0;o<i.length;++o)n.length<20&&i[o]<t&&(n+=e.charAt(i[o]%62))}return n}}function Ct(r,e){return r<e?-1:r>e?1:0}function fg(r,e){const t=Math.min(r.length,e.length);for(let n=0;n<t;n++){const i=r.charAt(n),o=e.charAt(n);if(i!==o)return Om(i)===Om(o)?Ct(i,o):Om(i)?1:-1}return Ct(r.length,e.length)}const VD=55296,FD=57343;function Om(r){const e=r.charCodeAt(0);return e>=VD&&e<=FD}function ou(r,e,t){return r.length===e.length&&r.every(((n,i)=>t(n,e[i])))}function G1(r){return r+"\0"}const e2="__name__";class Vi{constructor(e,t,n){t===void 0?t=0:t>e.length&&rt(637,{offset:t,range:e.length}),n===void 0?n=e.length-t:n>e.length-t&&rt(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return Vi.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Vi?e.forEach((n=>{t.push(n)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const o=Vi.compareSegments(e.get(i),t.get(i));if(o!==0)return o}return Ct(e.length,t.length)}static compareSegments(e,t){const n=Vi.isNumericId(e),i=Vi.isNumericId(t);return n&&!i?-1:!n&&i?1:n&&i?Vi.extractNumericId(e).compare(Vi.extractNumericId(t)):fg(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return to.fromString(e.substring(4,e.length-2))}}class Jt extends Vi{construct(e,t,n){return new Jt(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new We(Te.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((i=>i.length>0)))}return new Jt(t)}static emptyPath(){return new Jt([])}}const MD=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class In extends Vi{construct(e,t,n){return new In(e,t,n)}static isValidIdentifier(e){return MD.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),In.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===e2}static keyField(){return new In([e2])}static fromServerFormat(e){const t=[];let n="",i=0;const o=()=>{if(n.length===0)throw new We(Te.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let u=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new We(Te.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new We(Te.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,i+=2}else l==="`"?(u=!u,i++):l!=="."||u?(n+=l,i++):(o(),i++)}if(o(),u)throw new We(Te.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new In(t)}static emptyPath(){return new In([])}}class Qe{constructor(e){this.path=e}static fromPath(e){return new Qe(Jt.fromString(e))}static fromName(e){return new Qe(Jt.fromString(e).popFirst(5))}static empty(){return new Qe(Jt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Jt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Jt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Qe(new Jt(e.slice()))}}function K1(r,e,t){if(!t)throw new We(Te.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function BD(r,e,t,n){if(e===!0&&n===!0)throw new We(Te.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)}function t2(r){if(!Qe.isDocumentKey(r))throw new We(Te.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function n2(r){if(Qe.isDocumentKey(r))throw new We(Te.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function Q1(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}function zd(r){if(r===void 0)return"undefined";if(r===null)return"null";if(typeof r=="string")return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if(typeof r=="number"||typeof r=="boolean")return""+r;if(typeof r=="object"){if(r instanceof Array)return"an array";{const e=(function(n){return n.constructor?n.constructor.name:null})(r);return e?`a custom ${e} object`:"an object"}}return typeof r=="function"?"a function":rt(12329,{type:typeof r})}function Hr(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new We(Te.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=zd(r);throw new We(Te.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}function Un(r,e){const t={typeString:r};return e&&(t.value=e),t}function uc(r,e){if(!Q1(r))throw new We(Te.INVALID_ARGUMENT,"JSON must be an object");let t;for(const n in e)if(e[n]){const i=e[n].typeString,o="value"in e[n]?{value:e[n].value}:void 0;if(!(n in r)){t=`JSON missing required field: '${n}'`;break}const u=r[n];if(i&&typeof u!==i){t=`JSON field '${n}' must be a ${i}.`;break}if(o!==void 0&&u!==o.value){t=`Expected '${n}' field to equal '${o.value}'`;break}}if(t)throw new We(Te.INVALID_ARGUMENT,t);return!0}const r2=-62135596800,i2=1e6;class nn{static now(){return nn.fromMillis(Date.now())}static fromDate(e){return nn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*i2);return new nn(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new We(Te.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new We(Te.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<r2)throw new We(Te.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new We(Te.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/i2}_compareTo(e){return this.seconds===e.seconds?Ct(this.nanoseconds,e.nanoseconds):Ct(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:nn._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(uc(e,nn._jsonSchema))return new nn(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-r2;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}nn._jsonSchemaVersion="firestore/timestamp/1.0",nn._jsonSchema={type:Un("string",nn._jsonSchemaVersion),seconds:Un("number"),nanoseconds:Un("number")};class vt{static fromTimestamp(e){return new vt(e)}static min(){return new vt(new nn(0,0))}static max(){return new vt(new nn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const au=-1;class cd{constructor(e,t,n,i){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=i}}function pg(r){return r.fields.find((e=>e.kind===2))}function Vo(r){return r.fields.filter((e=>e.kind!==2))}cd.UNKNOWN_ID=-1;class zh{constructor(e,t){this.fieldPath=e,this.kind=t}}class Wl{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Wl(0,Kr.min())}}function Y1(r,e){const t=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,i=vt.fromTimestamp(n===1e9?new nn(t+1,0):new nn(t,n));return new Kr(i,Qe.empty(),e)}function X1(r){return new Kr(r.readTime,r.key,au)}class Kr{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Kr(vt.min(),Qe.empty(),au)}static max(){return new Kr(vt.max(),Qe.empty(),au)}}function ov(r,e){let t=r.readTime.compareTo(e.readTime);return t!==0?t:(t=Qe.comparator(r.documentKey,e.documentKey),t!==0?t:Ct(r.largestBatchId,e.largestBatchId))}const Z1="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class J1{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function co(r){if(r.code!==Te.FAILED_PRECONDITION||r.message!==Z1)throw r;Oe("LocalStore","Unexpectedly lost primary lease")}class fe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&rt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new fe(((n,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(n,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(n,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof fe?t:fe.resolve(t)}catch(t){return fe.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):fe.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):fe.reject(t)}static resolve(e){return new fe(((t,n)=>{t(e)}))}static reject(e){return new fe(((t,n)=>{n(e)}))}static waitFor(e){return new fe(((t,n)=>{let i=0,o=0,u=!1;e.forEach((l=>{++i,l.next((()=>{++o,u&&o===i&&t()}),(c=>n(c)))})),u=!0,o===i&&t()}))}static or(e){let t=fe.resolve(!1);for(const n of e)t=t.next((i=>i?fe.resolve(i):n()));return t}static forEach(e,t){const n=[];return e.forEach(((i,o)=>{n.push(t.call(this,i,o))})),this.waitFor(n)}static mapArray(e,t){return new fe(((n,i)=>{const o=e.length,u=new Array(o);let l=0;for(let c=0;c<o;c++){const d=c;t(e[d]).next((m=>{u[d]=m,++l,l===o&&n(u)}),(m=>i(m)))}}))}static doWhile(e,t){return new fe(((n,i)=>{const o=()=>{e()===!0?t().next((()=>{o()}),i):n()};o()}))}}const qr="SimpleDb";class Ud{static open(e,t,n,i){try{return new Ud(t,e.transaction(i,n))}catch(o){throw new Sl(t,o)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Ui,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new Sl(e,t.error)):this.S.resolve()},this.transaction.onerror=n=>{const i=av(n.target.error);this.S.reject(new Sl(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Oe(qr,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new UD(t)}}class no{static delete(e){return Oe(qr,"Removing database:",e),Mo(x1().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!D1())return!1;if(no.F())return!0;const e=ad(),t=no.M(e),n=0<t&&t<10,i=eb(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||o)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}constructor(e,t,n){this.name=e,this.version=t,this.N=n,this.B=null,no.M(ad())===12.2&&Vn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(Oe(qr,"Opening database:",this.name),this.db=await new Promise(((t,n)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=o=>{const u=o.target.result;t(u)},i.onblocked=()=>{n(new Sl(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=o=>{const u=o.target.error;u.name==="VersionError"?n(new We(Te.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):u.name==="InvalidStateError"?n(new We(Te.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+u)):n(new Sl(e,u))},i.onupgradeneeded=o=>{Oe(qr,'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);const u=o.target.result;this.N.k(u,i.transaction,o.oldVersion,this.version).next((()=>{Oe(qr,"Database upgrade to version "+this.version+" complete")}))}}))),this.K&&(this.db.onversionchange=t=>this.K(t)),this.db}q(e){this.K=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,i){const o=t==="readonly";let u=0;for(;;){++u;try{this.db=await this.L(e);const l=Ud.open(this.db,e,o?"readonly":"readwrite",n),c=i(l).next((d=>(l.C(),d))).catch((d=>(l.abort(d),fe.reject(d)))).toPromise();return c.catch((()=>{})),await l.D,c}catch(l){const c=l,d=c.name!=="FirebaseError"&&u<3;if(Oe(qr,"Transaction failed with error:",c.message,"Retrying:",d),this.close(),!d)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function eb(r){const e=r.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class zD{constructor(e){this.U=e,this.$=!1,this.W=null}get isDone(){return this.$}get G(){return this.W}set cursor(e){this.U=e}done(){this.$=!0}j(e){this.W=e}delete(){return Mo(this.U.delete())}}class Sl extends We{constructor(e,t){super(Te.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function ho(r){return r.name==="IndexedDbTransactionError"}class UD{constructor(e){this.store=e}put(e,t){let n;return t!==void 0?(Oe(qr,"PUT",this.store.name,e,t),n=this.store.put(t,e)):(Oe(qr,"PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Mo(n)}add(e){return Oe(qr,"ADD",this.store.name,e,e),Mo(this.store.add(e))}get(e){return Mo(this.store.get(e)).next((t=>(t===void 0&&(t=null),Oe(qr,"GET",this.store.name,e,t),t)))}delete(e){return Oe(qr,"DELETE",this.store.name,e),Mo(this.store.delete(e))}count(){return Oe(qr,"COUNT",this.store.name),Mo(this.store.count())}H(e,t){const n=this.options(e,t),i=n.index?this.store.index(n.index):this.store;if(typeof i.getAll=="function"){const o=i.getAll(n.range);return new fe(((u,l)=>{o.onerror=c=>{l(c.target.error)},o.onsuccess=c=>{u(c.target.result)}}))}{const o=this.cursor(n),u=[];return this.J(o,((l,c)=>{u.push(c)})).next((()=>u))}}Z(e,t){const n=this.store.getAll(e,t===null?void 0:t);return new fe(((i,o)=>{n.onerror=u=>{o(u.target.error)},n.onsuccess=u=>{i(u.target.result)}}))}X(e,t){Oe(qr,"DELETE ALL",this.store.name);const n=this.options(e,t);n.Y=!1;const i=this.cursor(n);return this.J(i,((o,u,l)=>l.delete()))}ee(e,t){let n;t?n=e:(n={},t=e);const i=this.cursor(n);return this.J(i,t)}te(e){const t=this.cursor({});return new fe(((n,i)=>{t.onerror=o=>{const u=av(o.target.error);i(u)},t.onsuccess=o=>{const u=o.target.result;u?e(u.primaryKey,u.value).next((l=>{l?u.continue():n()})):n()}}))}J(e,t){const n=[];return new fe(((i,o)=>{e.onerror=u=>{o(u.target.error)},e.onsuccess=u=>{const l=u.target.result;if(!l)return void i();const c=new zD(l),d=t(l.primaryKey,l.value,c);if(d instanceof fe){const m=d.catch((g=>(c.done(),fe.reject(g))));n.push(m)}c.isDone?i():c.G===null?l.continue():l.continue(c.G)}})).next((()=>fe.waitFor(n)))}options(e,t){let n;return e!==void 0&&(typeof e=="string"?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.Y?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Mo(r){return new fe(((e,t)=>{r.onsuccess=n=>{const i=n.target.result;e(i)},r.onerror=n=>{const i=av(n.target.error);t(i)}}))}let s2=!1;function av(r){const e=no.M(ad());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(r.message.indexOf(t)>=0){const n=new We("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return s2||(s2=!0,setTimeout((()=>{throw n}),0)),n}}return r}const Il="IndexBackfiller";class jD{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){Oe(Il,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();Oe(Il,`Documents written: ${t}`)}catch(t){ho(t)?Oe(Il,"Ignoring IndexedDB error during index backfill: ",t):await co(t)}await this.re(6e4)}))}}class qD{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const n=new Set;let i=t,o=!0;return fe.doWhile((()=>o===!0&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((u=>{if(u!==null&&!n.has(u))return Oe(Il,`Processing collection: ${u}`),this.oe(e,u,i).next((l=>{i-=l,n.add(u)}));o=!1})))).next((()=>t-i))}oe(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((i=>this.localStore.localDocuments.getNextDocuments(e,t,i,n).next((o=>{const u=o.changes;return this.localStore.indexManager.updateIndexEntries(e,u).next((()=>this._e(i,o))).next((l=>(Oe(Il,`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,t,l)))).next((()=>u.size))}))))}_e(e,t){let n=e;return t.changes.forEach(((i,o)=>{const u=X1(o);ov(u,n)>0&&(n=u)})),new Kr(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}class kr{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>t.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}kr.ce=-1;const $o=-1;function jd(r){return r==null}function $l(r){return r===0&&1/r==-1/0}function tb(r){return typeof r=="number"&&Number.isInteger(r)&&!$l(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}const hd="";function vr(r){let e="";for(let t=0;t<r.length;t++)e.length>0&&(e=o2(e)),e=WD(r.get(t),e);return o2(e)}function WD(r,e){let t=e;const n=r.length;for(let i=0;i<n;i++){const o=r.charAt(i);switch(o){case"\0":t+="";break;case hd:t+="";break;default:t+=o}}return t}function o2(r){return r+hd+""}function Mi(r){const e=r.length;if(ht(e>=2,64408,{path:r}),e===2)return ht(r.charAt(0)===hd&&r.charAt(1)==="",56145,{path:r}),Jt.emptyPath();const t=e-2,n=[];let i="";for(let o=0;o<e;){const u=r.indexOf(hd,o);switch((u<0||u>t)&&rt(50515,{path:r}),r.charAt(u+1)){case"":const l=r.substring(o,u);let c;i.length===0?c=l:(i+=l,c=i,i=""),n.push(c);break;case"":i+=r.substring(o,u),i+="\0";break;case"":i+=r.substring(o,u+1);break;default:rt(61167,{path:r})}o=u+2}return new Jt(n)}const Fo="remoteDocuments",lc="owner",za="owner",Hl="mutationQueues",$D="userId",Ei="mutations",a2="batchId",jo="userMutationsIndex",u2=["userId","batchId"];function Uh(r,e){return[r,vr(e)]}function nb(r,e,t){return[r,vr(e),t]}const HD={},uu="documentMutations",dd="remoteDocumentsV14",GD=["prefixPath","collectionGroup","readTime","documentId"],jh="documentKeyIndex",KD=["prefixPath","collectionGroup","documentId"],rb="collectionGroupIndex",QD=["collectionGroup","readTime","prefixPath","documentId"],Gl="remoteDocumentGlobal",mg="remoteDocumentGlobalKey",lu="targets",ib="queryTargetsIndex",YD=["canonicalId","targetId"],cu="targetDocuments",XD=["targetId","path"],uv="documentTargetsIndex",ZD=["path","targetId"],fd="targetGlobalKey",Ho="targetGlobal",Kl="collectionParents",JD=["collectionId","parent"],hu="clientMetadata",eR="clientId",qd="bundles",tR="bundleId",Wd="namedQueries",nR="name",lv="indexConfiguration",rR="indexId",gg="collectionGroupIndex",iR="collectionGroup",Cl="indexState",sR=["indexId","uid"],sb="sequenceNumberIndex",oR=["uid","sequenceNumber"],Dl="indexEntries",aR=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],ob="documentKeyIndex",uR=["indexId","uid","orderedDocumentKey"],$d="documentOverlays",lR=["userId","collectionPath","documentId"],vg="collectionPathOverlayIndex",cR=["userId","collectionPath","largestBatchId"],ab="collectionGroupOverlayIndex",hR=["userId","collectionGroup","largestBatchId"],cv="globals",dR="name",ub=[Hl,Ei,uu,Fo,lu,lc,Ho,cu,hu,Gl,Kl,qd,Wd],fR=[...ub,$d],lb=[Hl,Ei,uu,dd,lu,lc,Ho,cu,hu,Gl,Kl,qd,Wd,$d],cb=lb,hv=[...cb,lv,Cl,Dl],pR=hv,hb=[...hv,cv],mR=hb;class yg extends J1{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function Gn(r,e){const t=ot(r);return no.O(t.le,e)}function l2(r){let e=0;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function fo(r,e){for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function db(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}class fn{constructor(e,t){this.comparator=e,this.root=t||or.EMPTY}insert(e,t){return new fn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,or.BLACK,null,null))}remove(e){return new fn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,or.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ih(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ih(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ih(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ih(this.root,e,this.comparator,!0)}}class Ih{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?n(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class or{constructor(e,t,n,i,o){this.key=e,this.value=t,this.color=n??or.RED,this.left=i??or.EMPTY,this.right=o??or.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,o){return new or(e??this.key,t??this.value,n??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const o=n(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,n),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return or.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return or.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,or.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,or.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw rt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw rt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw rt(27949);return e+(this.isRed()?0:1)}}or.EMPTY=null,or.RED=!0,or.BLACK=!1;or.EMPTY=new class{constructor(){this.size=0}get key(){throw rt(57766)}get value(){throw rt(16141)}get color(){throw rt(16727)}get left(){throw rt(29726)}get right(){throw rt(36894)}copy(e,t,n,i,o){return this}insert(e,t,n){return new or(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class sn{constructor(e){this.comparator=e,this.data=new fn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new c2(this.data.getIterator())}getIteratorFrom(e){return new c2(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((n=>{t=t.add(n)})),t}isEqual(e){if(!(e instanceof sn)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,o=n.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new sn(this.comparator);return t.data=e,t}}class c2{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Ua(r){return r.hasNext()?r.getNext():void 0}class Nr{constructor(e){this.fields=e,e.sort(In.comparator)}static empty(){return new Nr([])}unionWith(e){let t=new sn(In.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Nr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ou(this.fields,e.fields,((t,n)=>t.isEqual(n)))}}class fb extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Fn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new fb("Invalid base64 string: "+o):o}})(e);return new Fn(t)}static fromUint8Array(e){const t=(function(i){let o="";for(let u=0;u<i.length;++u)o+=String.fromCharCode(i[u]);return o})(e);return new Fn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ct(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Fn.EMPTY_BYTE_STRING=new Fn("");const gR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ys(r){if(ht(!!r,39018),typeof r=="string"){let e=0;const t=gR.exec(r);if(ht(!!t,46558,{timestamp:r}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:bn(r.seconds),nanos:bn(r.nanos)}}function bn(r){return typeof r=="number"?r:typeof r=="string"?Number(r):0}function _s(r){return typeof r=="string"?Fn.fromBase64String(r):Fn.fromUint8Array(r)}const pb="server_timestamp",mb="__type__",gb="__previous_value__",vb="__local_write_time__";function dv(r){return(r?.mapValue?.fields||{})[mb]?.stringValue===pb}function Hd(r){const e=r.mapValue.fields[gb];return dv(e)?Hd(e):e}function Ql(r){const e=ys(r.mapValue.fields[vb].timestampValue);return new nn(e.seconds,e.nanos)}class vR{constructor(e,t,n,i,o,u,l,c,d,m,g){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=o,this.forceLongPolling=u,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=d,this.isUsingEmulator=m,this.apiKey=g}}const pd="(default)";class Xo{constructor(e,t){this.projectId=e,this.database=t||pd}static empty(){return new Xo("","")}get isDefaultDatabase(){return this.database===pd}isEqual(e){return e instanceof Xo&&e.projectId===this.projectId&&e.database===this.database}}function yR(r,e){if(!Object.prototype.hasOwnProperty.apply(r.options,["projectId"]))throw new We(Te.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Xo(r.options.projectId,e)}const fv="__type__",yb="__max__",Xs={mapValue:{fields:{__type__:{stringValue:yb}}}},pv="__vector__",du="value",qh={nullValue:"NULL_VALUE"};function io(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?dv(r)?4:_b(r)?9007199254740991:Gd(r)?10:11:rt(28295,{value:r})}function qi(r,e){if(r===e)return!0;const t=io(r);if(t!==io(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return Ql(r).isEqual(Ql(e));case 3:return(function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const u=ys(i.timestampValue),l=ys(o.timestampValue);return u.seconds===l.seconds&&u.nanos===l.nanos})(r,e);case 5:return r.stringValue===e.stringValue;case 6:return(function(i,o){return _s(i.bytesValue).isEqual(_s(o.bytesValue))})(r,e);case 7:return r.referenceValue===e.referenceValue;case 8:return(function(i,o){return bn(i.geoPointValue.latitude)===bn(o.geoPointValue.latitude)&&bn(i.geoPointValue.longitude)===bn(o.geoPointValue.longitude)})(r,e);case 2:return(function(i,o){if("integerValue"in i&&"integerValue"in o)return bn(i.integerValue)===bn(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const u=bn(i.doubleValue),l=bn(o.doubleValue);return u===l?$l(u)===$l(l):isNaN(u)&&isNaN(l)}return!1})(r,e);case 9:return ou(r.arrayValue.values||[],e.arrayValue.values||[],qi);case 10:case 11:return(function(i,o){const u=i.mapValue.fields||{},l=o.mapValue.fields||{};if(l2(u)!==l2(l))return!1;for(const c in u)if(u.hasOwnProperty(c)&&(l[c]===void 0||!qi(u[c],l[c])))return!1;return!0})(r,e);default:return rt(52216,{left:r})}}function Yl(r,e){return(r.values||[]).find((t=>qi(t,e)))!==void 0}function so(r,e){if(r===e)return 0;const t=io(r),n=io(e);if(t!==n)return Ct(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ct(r.booleanValue,e.booleanValue);case 2:return(function(o,u){const l=bn(o.integerValue||o.doubleValue),c=bn(u.integerValue||u.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1})(r,e);case 3:return h2(r.timestampValue,e.timestampValue);case 4:return h2(Ql(r),Ql(e));case 5:return fg(r.stringValue,e.stringValue);case 6:return(function(o,u){const l=_s(o),c=_s(u);return l.compareTo(c)})(r.bytesValue,e.bytesValue);case 7:return(function(o,u){const l=o.split("/"),c=u.split("/");for(let d=0;d<l.length&&d<c.length;d++){const m=Ct(l[d],c[d]);if(m!==0)return m}return Ct(l.length,c.length)})(r.referenceValue,e.referenceValue);case 8:return(function(o,u){const l=Ct(bn(o.latitude),bn(u.latitude));return l!==0?l:Ct(bn(o.longitude),bn(u.longitude))})(r.geoPointValue,e.geoPointValue);case 9:return d2(r.arrayValue,e.arrayValue);case 10:return(function(o,u){const l=o.fields||{},c=u.fields||{},d=l[du]?.arrayValue,m=c[du]?.arrayValue,g=Ct(d?.values?.length||0,m?.values?.length||0);return g!==0?g:d2(d,m)})(r.mapValue,e.mapValue);case 11:return(function(o,u){if(o===Xs.mapValue&&u===Xs.mapValue)return 0;if(o===Xs.mapValue)return 1;if(u===Xs.mapValue)return-1;const l=o.fields||{},c=Object.keys(l),d=u.fields||{},m=Object.keys(d);c.sort(),m.sort();for(let g=0;g<c.length&&g<m.length;++g){const E=fg(c[g],m[g]);if(E!==0)return E;const b=so(l[c[g]],d[m[g]]);if(b!==0)return b}return Ct(c.length,m.length)})(r.mapValue,e.mapValue);default:throw rt(23264,{he:t})}}function h2(r,e){if(typeof r=="string"&&typeof e=="string"&&r.length===e.length)return Ct(r,e);const t=ys(r),n=ys(e),i=Ct(t.seconds,n.seconds);return i!==0?i:Ct(t.nanos,n.nanos)}function d2(r,e){const t=r.values||[],n=e.values||[];for(let i=0;i<t.length&&i<n.length;++i){const o=so(t[i],n[i]);if(o)return o}return Ct(t.length,n.length)}function fu(r){return _g(r)}function _g(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?(function(t){const n=ys(t);return`time(${n.seconds},${n.nanos})`})(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?(function(t){return _s(t).toBase64()})(r.bytesValue):"referenceValue"in r?(function(t){return Qe.fromName(t).toString()})(r.referenceValue):"geoPointValue"in r?(function(t){return`geo(${t.latitude},${t.longitude})`})(r.geoPointValue):"arrayValue"in r?(function(t){let n="[",i=!0;for(const o of t.values||[])i?i=!1:n+=",",n+=_g(o);return n+"]"})(r.arrayValue):"mapValue"in r?(function(t){const n=Object.keys(t.fields||{}).sort();let i="{",o=!0;for(const u of n)o?o=!1:i+=",",i+=`${u}:${_g(t.fields[u])}`;return i+"}"})(r.mapValue):rt(61005,{value:r})}function Wh(r){switch(io(r)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Hd(r);return e?16+Wh(e):16;case 5:return 2*r.stringValue.length;case 6:return _s(r.bytesValue).approximateByteSize();case 7:return r.referenceValue.length;case 9:return(function(n){return(n.values||[]).reduce(((i,o)=>i+Wh(o)),0)})(r.arrayValue);case 10:case 11:return(function(n){let i=0;return fo(n.fields,((o,u)=>{i+=o.length+Wh(u)})),i})(r.mapValue);default:throw rt(13486,{value:r})}}function Xl(r,e){return{referenceValue:`projects/${r.projectId}/databases/${r.database}/documents/${e.path.canonicalString()}`}}function wg(r){return!!r&&"integerValue"in r}function Zl(r){return!!r&&"arrayValue"in r}function f2(r){return!!r&&"nullValue"in r}function p2(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function $h(r){return!!r&&"mapValue"in r}function Gd(r){return(r?.mapValue?.fields||{})[fv]?.stringValue===pv}function Rl(r){if(r.geoPointValue)return{geoPointValue:{...r.geoPointValue}};if(r.timestampValue&&typeof r.timestampValue=="object")return{timestampValue:{...r.timestampValue}};if(r.mapValue){const e={mapValue:{fields:{}}};return fo(r.mapValue.fields,((t,n)=>e.mapValue.fields[t]=Rl(n))),e}if(r.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Rl(r.arrayValue.values[t]);return e}return{...r}}function _b(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue===yb}const wb={mapValue:{fields:{[fv]:{stringValue:pv},[du]:{arrayValue:{}}}}};function _R(r){return"nullValue"in r?qh:"booleanValue"in r?{booleanValue:!1}:"integerValue"in r||"doubleValue"in r?{doubleValue:NaN}:"timestampValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in r?{stringValue:""}:"bytesValue"in r?{bytesValue:""}:"referenceValue"in r?Xl(Xo.empty(),Qe.empty()):"geoPointValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in r?{arrayValue:{}}:"mapValue"in r?Gd(r)?wb:{mapValue:{}}:rt(35942,{value:r})}function wR(r){return"nullValue"in r?{booleanValue:!1}:"booleanValue"in r?{doubleValue:NaN}:"integerValue"in r||"doubleValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in r?{stringValue:""}:"stringValue"in r?{bytesValue:""}:"bytesValue"in r?Xl(Xo.empty(),Qe.empty()):"referenceValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in r?{arrayValue:{}}:"arrayValue"in r?wb:"mapValue"in r?Gd(r)?{mapValue:{}}:Xs:rt(61959,{value:r})}function m2(r,e){const t=so(r.value,e.value);return t!==0?t:r.inclusive&&!e.inclusive?-1:!r.inclusive&&e.inclusive?1:0}function g2(r,e){const t=so(r.value,e.value);return t!==0?t:r.inclusive&&!e.inclusive?1:!r.inclusive&&e.inclusive?-1:0}class gr{constructor(e){this.value=e}static empty(){return new gr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!$h(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Rl(t)}setAll(e){let t=In.emptyPath(),n={},i=[];e.forEach(((u,l)=>{if(!t.isImmediateParentOf(l)){const c=this.getFieldsMap(t);this.applyChanges(c,n,i),n={},i=[],t=l.popLast()}u?n[l.lastSegment()]=Rl(u):i.push(l.lastSegment())}));const o=this.getFieldsMap(t);this.applyChanges(o,n,i)}delete(e){const t=this.field(e.popLast());$h(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return qi(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];$h(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){fo(t,((i,o)=>e[i]=o));for(const i of n)delete e[i]}clone(){return new gr(Rl(this.value))}}function Eb(r){const e=[];return fo(r.fields,((t,n)=>{const i=new In([t]);if($h(n)){const o=Eb(n.mapValue).fields;if(o.length===0)e.push(i);else for(const u of o)e.push(i.child(u))}else e.push(i)})),new Nr(e)}class Rn{constructor(e,t,n,i,o,u,l){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=o,this.data=u,this.documentState=l}static newInvalidDocument(e){return new Rn(e,0,vt.min(),vt.min(),vt.min(),gr.empty(),0)}static newFoundDocument(e,t,n,i){return new Rn(e,1,t,vt.min(),n,i,0)}static newNoDocument(e,t){return new Rn(e,2,t,vt.min(),vt.min(),gr.empty(),0)}static newUnknownDocument(e,t){return new Rn(e,3,t,vt.min(),vt.min(),gr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(vt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=gr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=gr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=vt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Rn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Rn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class pu{constructor(e,t){this.position=e,this.inclusive=t}}function v2(r,e,t){let n=0;for(let i=0;i<r.position.length;i++){const o=e[i],u=r.position[i];if(o.field.isKeyField()?n=Qe.comparator(Qe.fromName(u.referenceValue),t.key):n=so(u,t.data.field(o.field)),o.dir==="desc"&&(n*=-1),n!==0)break}return n}function y2(r,e){if(r===null)return e===null;if(e===null||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!qi(r.position[t],e.position[t]))return!1;return!0}class Jl{constructor(e,t="asc"){this.field=e,this.dir=t}}function ER(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}class bb{}class Ft extends bb{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new bR(e,t,n):t==="array-contains"?new AR(e,n):t==="in"?new Cb(e,n):t==="not-in"?new SR(e,n):t==="array-contains-any"?new IR(e,n):new Ft(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new xR(e,n):new TR(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(so(t,this.value)):t!==null&&io(this.value)===io(t)&&this.matchesComparison(so(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return rt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class rn extends bb{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new rn(e,t)}matches(e){return mu(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function mu(r){return r.op==="and"}function Eg(r){return r.op==="or"}function mv(r){return xb(r)&&mu(r)}function xb(r){for(const e of r.filters)if(e instanceof rn)return!1;return!0}function bg(r){if(r instanceof Ft)return r.field.canonicalString()+r.op.toString()+fu(r.value);if(mv(r))return r.filters.map((e=>bg(e))).join(",");{const e=r.filters.map((t=>bg(t))).join(",");return`${r.op}(${e})`}}function Tb(r,e){return r instanceof Ft?(function(n,i){return i instanceof Ft&&n.op===i.op&&n.field.isEqual(i.field)&&qi(n.value,i.value)})(r,e):r instanceof rn?(function(n,i){return i instanceof rn&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce(((o,u,l)=>o&&Tb(u,i.filters[l])),!0):!1})(r,e):void rt(19439)}function Ab(r,e){const t=r.filters.concat(e);return rn.create(t,r.op)}function Sb(r){return r instanceof Ft?(function(t){return`${t.field.canonicalString()} ${t.op} ${fu(t.value)}`})(r):r instanceof rn?(function(t){return t.op.toString()+" {"+t.getFilters().map(Sb).join(" ,")+"}"})(r):"Filter"}class bR extends Ft{constructor(e,t,n){super(e,t,n),this.key=Qe.fromName(n.referenceValue)}matches(e){const t=Qe.comparator(e.key,this.key);return this.matchesComparison(t)}}class xR extends Ft{constructor(e,t){super(e,"in",t),this.keys=Ib("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class TR extends Ft{constructor(e,t){super(e,"not-in",t),this.keys=Ib("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Ib(r,e){return(e.arrayValue?.values||[]).map((t=>Qe.fromName(t.referenceValue)))}class AR extends Ft{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Zl(t)&&Yl(t.arrayValue,this.value)}}class Cb extends Ft{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Yl(this.value.arrayValue,t)}}class SR extends Ft{constructor(e,t){super(e,"not-in",t)}matches(e){if(Yl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Yl(this.value.arrayValue,t)}}class IR extends Ft{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Zl(t)||!t.arrayValue.values)&&t.arrayValue.values.some((n=>Yl(this.value.arrayValue,n)))}}class CR{constructor(e,t=null,n=[],i=[],o=null,u=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=o,this.startAt=u,this.endAt=l,this.Te=null}}function xg(r,e=null,t=[],n=[],i=null,o=null,u=null){return new CR(r,e,t,n,i,o,u)}function Zo(r){const e=ot(r);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((n=>bg(n))).join(","),t+="|ob:",t+=e.orderBy.map((n=>(function(o){return o.field.canonicalString()+o.dir})(n))).join(","),jd(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((n=>fu(n))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((n=>fu(n))).join(",")),e.Te=t}return e.Te}function cc(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!ER(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!Tb(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!y2(r.startAt,e.startAt)&&y2(r.endAt,e.endAt)}function md(r){return Qe.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}function gd(r,e){return r.filters.filter((t=>t instanceof Ft&&t.field.isEqual(e)))}function _2(r,e,t){let n=qh,i=!0;for(const o of gd(r,e)){let u=qh,l=!0;switch(o.op){case"<":case"<=":u=_R(o.value);break;case"==":case"in":case">=":u=o.value;break;case">":u=o.value,l=!1;break;case"!=":case"not-in":u=qh}m2({value:n,inclusive:i},{value:u,inclusive:l})<0&&(n=u,i=l)}if(t!==null){for(let o=0;o<r.orderBy.length;++o)if(r.orderBy[o].field.isEqual(e)){const u=t.position[o];m2({value:n,inclusive:i},{value:u,inclusive:t.inclusive})<0&&(n=u,i=t.inclusive);break}}return{value:n,inclusive:i}}function w2(r,e,t){let n=Xs,i=!0;for(const o of gd(r,e)){let u=Xs,l=!0;switch(o.op){case">=":case">":u=wR(o.value),l=!1;break;case"==":case"in":case"<=":u=o.value;break;case"<":u=o.value,l=!1;break;case"!=":case"not-in":u=Xs}g2({value:n,inclusive:i},{value:u,inclusive:l})>0&&(n=u,i=l)}if(t!==null){for(let o=0;o<r.orderBy.length;++o)if(r.orderBy[o].field.isEqual(e)){const u=t.position[o];g2({value:n,inclusive:i},{value:u,inclusive:t.inclusive})>0&&(n=u,i=t.inclusive);break}}return{value:n,inclusive:i}}class Iu{constructor(e,t=null,n=[],i=[],o=null,u="F",l=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=o,this.limitType=u,this.startAt=l,this.endAt=c,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function Db(r,e,t,n,i,o,u,l){return new Iu(r,e,t,n,i,o,u,l)}function hc(r){return new Iu(r)}function E2(r){return r.filters.length===0&&r.limit===null&&r.startAt==null&&r.endAt==null&&(r.explicitOrderBy.length===0||r.explicitOrderBy.length===1&&r.explicitOrderBy[0].field.isKeyField())}function DR(r){return Qe.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}function Rb(r){return r.collectionGroup!==null}function kl(r){const e=ot(r);if(e.Ie===null){e.Ie=[];const t=new Set;for(const o of e.explicitOrderBy)e.Ie.push(o),t.add(o.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(u){let l=new sn(In.comparator);return u.filters.forEach((c=>{c.getFlattenedFilters().forEach((d=>{d.isInequality()&&(l=l.add(d.field))}))})),l})(e).forEach((o=>{t.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new Jl(o,n))})),t.has(In.keyField().canonicalString())||e.Ie.push(new Jl(In.keyField(),n))}return e.Ie}function Gr(r){const e=ot(r);return e.Ee||(e.Ee=RR(e,kl(r))),e.Ee}function RR(r,e){if(r.limitType==="F")return xg(r.path,r.collectionGroup,e,r.filters,r.limit,r.startAt,r.endAt);{e=e.map((i=>{const o=i.dir==="desc"?"asc":"desc";return new Jl(i.field,o)}));const t=r.endAt?new pu(r.endAt.position,r.endAt.inclusive):null,n=r.startAt?new pu(r.startAt.position,r.startAt.inclusive):null;return xg(r.path,r.collectionGroup,e,r.filters,r.limit,t,n)}}function Tg(r,e){const t=r.filters.concat([e]);return new Iu(r.path,r.collectionGroup,r.explicitOrderBy.slice(),t,r.limit,r.limitType,r.startAt,r.endAt)}function kR(r,e){const t=r.explicitOrderBy.concat([e]);return new Iu(r.path,r.collectionGroup,t,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}function Ag(r,e,t){return new Iu(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function Kd(r,e){return cc(Gr(r),Gr(e))&&r.limitType===e.limitType}function kb(r){return`${Zo(Gr(r))}|lt:${r.limitType}`}function Ya(r){return`Query(target=${(function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map((i=>Sb(i))).join(", ")}]`),jd(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map((i=>(function(u){return`${u.field.canonicalString()} (${u.dir})`})(i))).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map((i=>fu(i))).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map((i=>fu(i))).join(",")),`Target(${n})`})(Gr(r))}; limitType=${r.limitType})`}function dc(r,e){return e.isFoundDocument()&&(function(n,i){const o=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(o):Qe.isDocumentKey(n.path)?n.path.isEqual(o):n.path.isImmediateParentOf(o)})(r,e)&&(function(n,i){for(const o of kl(n))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0})(r,e)&&(function(n,i){for(const o of n.filters)if(!o.matches(i))return!1;return!0})(r,e)&&(function(n,i){return!(n.startAt&&!(function(u,l,c){const d=v2(u,l,c);return u.inclusive?d<=0:d<0})(n.startAt,kl(n),i)||n.endAt&&!(function(u,l,c){const d=v2(u,l,c);return u.inclusive?d>=0:d>0})(n.endAt,kl(n),i))})(r,e)}function Nb(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}function Pb(r){return(e,t)=>{let n=!1;for(const i of kl(r)){const o=NR(i,e,t);if(o!==0)return o;n=n||i.field.isKeyField()}return 0}}function NR(r,e,t){const n=r.field.isKeyField()?Qe.comparator(e.key,t.key):(function(o,u,l){const c=u.data.field(o),d=l.data.field(o);return c!==null&&d!==null?so(c,d):rt(42886)})(r.field,e,t);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return rt(19790,{direction:r.dir})}}class Es{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[i,o]of n)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){fo(this.inner,((t,n)=>{for(const[i,o]of n)e(i,o)}))}isEmpty(){return db(this.inner)}size(){return this.innerSize}}const PR=new fn(Qe.comparator);function $r(){return PR}const Ob=new fn(Qe.comparator);function wl(...r){let e=Ob;for(const t of r)e=e.insert(t.key,t);return e}function Lb(r){let e=Ob;return r.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function Bi(){return Nl()}function Vb(){return Nl()}function Nl(){return new Es((r=>r.toString()),((r,e)=>r.isEqual(e)))}const OR=new fn(Qe.comparator),LR=new sn(Qe.comparator);function Pt(...r){let e=LR;for(const t of r)e=e.add(t);return e}const VR=new sn(Ct);function gv(){return VR}function vv(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:$l(e)?"-0":e}}function Fb(r){return{integerValue:""+r}}function FR(r,e){return tb(e)?Fb(e):vv(r,e)}class Qd{constructor(){this._=void 0}}function MR(r,e,t){return r instanceof ec?(function(i,o){const u={fields:{[mb]:{stringValue:pb},[vb]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&dv(o)&&(o=Hd(o)),o&&(u.fields[gb]=o),{mapValue:u}})(t,e):r instanceof gu?Bb(r,e):r instanceof vu?zb(r,e):(function(i,o){const u=Mb(i,o),l=b2(u)+b2(i.Ae);return wg(u)&&wg(i.Ae)?Fb(l):vv(i.serializer,l)})(r,e)}function BR(r,e,t){return r instanceof gu?Bb(r,e):r instanceof vu?zb(r,e):t}function Mb(r,e){return r instanceof tc?(function(n){return wg(n)||(function(o){return!!o&&"doubleValue"in o})(n)})(e)?e:{integerValue:0}:null}class ec extends Qd{}class gu extends Qd{constructor(e){super(),this.elements=e}}function Bb(r,e){const t=Ub(e);for(const n of r.elements)t.some((i=>qi(i,n)))||t.push(n);return{arrayValue:{values:t}}}class vu extends Qd{constructor(e){super(),this.elements=e}}function zb(r,e){let t=Ub(e);for(const n of r.elements)t=t.filter((i=>!qi(i,n)));return{arrayValue:{values:t}}}class tc extends Qd{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function b2(r){return bn(r.integerValue||r.doubleValue)}function Ub(r){return Zl(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}class zR{constructor(e,t){this.field=e,this.transform=t}}function UR(r,e){return r.field.isEqual(e.field)&&(function(n,i){return n instanceof gu&&i instanceof gu||n instanceof vu&&i instanceof vu?ou(n.elements,i.elements,qi):n instanceof tc&&i instanceof tc?qi(n.Ae,i.Ae):n instanceof ec&&i instanceof ec})(r.transform,e.transform)}class jR{constructor(e,t){this.version=e,this.transformResults=t}}class xr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new xr}static exists(e){return new xr(void 0,e)}static updateTime(e){return new xr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Hh(r,e){return r.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(r.updateTime):r.exists===void 0||r.exists===e.isFoundDocument()}class Yd{}function jb(r,e){if(!r.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return r.isNoDocument()?new Xd(r.key,xr.none()):new Cu(r.key,r.data,xr.none());{const t=r.data,n=gr.empty();let i=new sn(In.comparator);for(let o of e.fields)if(!i.has(o)){let u=t.field(o);u===null&&o.length>1&&(o=o.popLast(),u=t.field(o)),u===null?n.delete(o):n.set(o,u),i=i.add(o)}return new bs(r.key,n,new Nr(i.toArray()),xr.none())}}function qR(r,e,t){r instanceof Cu?(function(i,o,u){const l=i.value.clone(),c=T2(i.fieldTransforms,o,u.transformResults);l.setAll(c),o.convertToFoundDocument(u.version,l).setHasCommittedMutations()})(r,e,t):r instanceof bs?(function(i,o,u){if(!Hh(i.precondition,o))return void o.convertToUnknownDocument(u.version);const l=T2(i.fieldTransforms,o,u.transformResults),c=o.data;c.setAll(qb(i)),c.setAll(l),o.convertToFoundDocument(u.version,c).setHasCommittedMutations()})(r,e,t):(function(i,o,u){o.convertToNoDocument(u.version).setHasCommittedMutations()})(0,e,t)}function Pl(r,e,t,n){return r instanceof Cu?(function(o,u,l,c){if(!Hh(o.precondition,u))return l;const d=o.value.clone(),m=A2(o.fieldTransforms,c,u);return d.setAll(m),u.convertToFoundDocument(u.version,d).setHasLocalMutations(),null})(r,e,t,n):r instanceof bs?(function(o,u,l,c){if(!Hh(o.precondition,u))return l;const d=A2(o.fieldTransforms,c,u),m=u.data;return m.setAll(qb(o)),m.setAll(d),u.convertToFoundDocument(u.version,m).setHasLocalMutations(),l===null?null:l.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map((g=>g.field)))})(r,e,t,n):(function(o,u,l){return Hh(o.precondition,u)?(u.convertToNoDocument(u.version).setHasLocalMutations(),null):l})(r,e,t)}function WR(r,e){let t=null;for(const n of r.fieldTransforms){const i=e.data.field(n.field),o=Mb(n.transform,i||null);o!=null&&(t===null&&(t=gr.empty()),t.set(n.field,o))}return t||null}function x2(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&!!(function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&ou(n,i,((o,u)=>UR(o,u)))})(r.fieldTransforms,e.fieldTransforms)&&(r.type===0?r.value.isEqual(e.value):r.type!==1||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask))}class Cu extends Yd{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class bs extends Yd{constructor(e,t,n,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function qb(r){const e=new Map;return r.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const n=r.data.field(t);e.set(t,n)}})),e}function T2(r,e,t){const n=new Map;ht(r.length===t.length,32656,{Ve:t.length,de:r.length});for(let i=0;i<t.length;i++){const o=r[i],u=o.transform,l=e.data.field(o.field);n.set(o.field,BR(u,l,t[i]))}return n}function A2(r,e,t){const n=new Map;for(const i of r){const o=i.transform,u=t.data.field(i.field);n.set(i.field,MR(o,u,e))}return n}class Xd extends Yd{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Wb extends Yd{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class yv{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(e.key)&&qR(o,e,n[i])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Pl(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Pl(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Vb();return this.mutations.forEach((i=>{const o=e.get(i.key),u=o.overlayedDocument;let l=this.applyToLocalView(u,o.mutatedFields);l=t.has(i.key)?null:l;const c=jb(u,l);c!==null&&n.set(i.key,c),u.isValidDocument()||u.convertToNoDocument(vt.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Pt())}isEqual(e){return this.batchId===e.batchId&&ou(this.mutations,e.mutations,((t,n)=>x2(t,n)))&&ou(this.baseMutations,e.baseMutations,((t,n)=>x2(t,n)))}}class _v{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){ht(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let i=(function(){return OR})();const o=e.mutations;for(let u=0;u<o.length;u++)i=i.insert(o[u].key,n[u].version);return new _v(e,t,n,i)}}class wv{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class $R{constructor(e,t){this.count=e,this.unchangedNames=t}}var zn,Wt;function HR(r){switch(r){case Te.OK:return rt(64938);case Te.CANCELLED:case Te.UNKNOWN:case Te.DEADLINE_EXCEEDED:case Te.RESOURCE_EXHAUSTED:case Te.INTERNAL:case Te.UNAVAILABLE:case Te.UNAUTHENTICATED:return!1;case Te.INVALID_ARGUMENT:case Te.NOT_FOUND:case Te.ALREADY_EXISTS:case Te.PERMISSION_DENIED:case Te.FAILED_PRECONDITION:case Te.ABORTED:case Te.OUT_OF_RANGE:case Te.UNIMPLEMENTED:case Te.DATA_LOSS:return!0;default:return rt(15467,{code:r})}}function $b(r){if(r===void 0)return Vn("GRPC error has no .code"),Te.UNKNOWN;switch(r){case zn.OK:return Te.OK;case zn.CANCELLED:return Te.CANCELLED;case zn.UNKNOWN:return Te.UNKNOWN;case zn.DEADLINE_EXCEEDED:return Te.DEADLINE_EXCEEDED;case zn.RESOURCE_EXHAUSTED:return Te.RESOURCE_EXHAUSTED;case zn.INTERNAL:return Te.INTERNAL;case zn.UNAVAILABLE:return Te.UNAVAILABLE;case zn.UNAUTHENTICATED:return Te.UNAUTHENTICATED;case zn.INVALID_ARGUMENT:return Te.INVALID_ARGUMENT;case zn.NOT_FOUND:return Te.NOT_FOUND;case zn.ALREADY_EXISTS:return Te.ALREADY_EXISTS;case zn.PERMISSION_DENIED:return Te.PERMISSION_DENIED;case zn.FAILED_PRECONDITION:return Te.FAILED_PRECONDITION;case zn.ABORTED:return Te.ABORTED;case zn.OUT_OF_RANGE:return Te.OUT_OF_RANGE;case zn.UNIMPLEMENTED:return Te.UNIMPLEMENTED;case zn.DATA_LOSS:return Te.DATA_LOSS;default:return rt(39323,{code:r})}}(Wt=zn||(zn={}))[Wt.OK=0]="OK",Wt[Wt.CANCELLED=1]="CANCELLED",Wt[Wt.UNKNOWN=2]="UNKNOWN",Wt[Wt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Wt[Wt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Wt[Wt.NOT_FOUND=5]="NOT_FOUND",Wt[Wt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Wt[Wt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Wt[Wt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Wt[Wt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Wt[Wt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Wt[Wt.ABORTED=10]="ABORTED",Wt[Wt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Wt[Wt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Wt[Wt.INTERNAL=13]="INTERNAL",Wt[Wt.UNAVAILABLE=14]="UNAVAILABLE",Wt[Wt.DATA_LOSS=15]="DATA_LOSS";function GR(){return new TextEncoder}const KR=new to([4294967295,4294967295],0);function S2(r){const e=GR().encode(r),t=new z1;return t.update(e),new Uint8Array(t.digest())}function I2(r){const e=new DataView(r.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new to([t,n],0),new to([i,o],0)]}class Ev{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new El(`Invalid padding: ${t}`);if(n<0)throw new El(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new El(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new El(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=to.fromNumber(this.ge)}ye(e,t,n){let i=e.add(t.multiply(to.fromNumber(n)));return i.compare(KR)===1&&(i=new to([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=S2(e),[n,i]=I2(t);for(let o=0;o<this.hashCount;o++){const u=this.ye(n,i,o);if(!this.we(u))return!1}return!0}static create(e,t,n){const i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),u=new Ev(o,i,t);return n.forEach((l=>u.insert(l))),u}insert(e){if(this.ge===0)return;const t=S2(e),[n,i]=I2(t);for(let o=0;o<this.hashCount;o++){const u=this.ye(n,i,o);this.be(u)}}be(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class El extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class fc{constructor(e,t,n,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const i=new Map;return i.set(e,pc.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new fc(vt.min(),i,new fn(Ct),$r(),Pt())}}class pc{constructor(e,t,n,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new pc(n,t,Pt(),Pt(),Pt())}}class Gh{constructor(e,t,n,i){this.Se=e,this.removedTargetIds=t,this.key=n,this.De=i}}class Hb{constructor(e,t){this.targetId=e,this.Ce=t}}class Gb{constructor(e,t,n=Fn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}}class C2{constructor(){this.ve=0,this.Fe=D2(),this.Me=Fn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Pt(),t=Pt(),n=Pt();return this.Fe.forEach(((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:rt(38017,{changeType:o})}})),new pc(this.Me,this.xe,e,t,n)}Ke(){this.Oe=!1,this.Fe=D2()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,ht(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class QR{constructor(e){this.Ge=e,this.ze=new Map,this.je=$r(),this.He=Ch(),this.Je=Ch(),this.Ze=new fn(Ct)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.We(),n.Ne||n.Ke(),n.Le(e.resumeToken);break;case 2:n.We(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.Qe(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:rt(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((n,i)=>{this.rt(i)&&t(i)}))}st(e){const t=e.targetId,n=e.Ce.count,i=this.ot(t);if(i){const o=i.target;if(md(o))if(n===0){const u=new Qe(o.path);this.et(t,u,Rn.newNoDocument(u,vt.min()))}else ht(n===1,20013,{expectedCount:n});else{const u=this._t(t);if(u!==n){const l=this.ut(e),c=l?this.ct(l,e,u):1;if(c!==0){this.it(t);const d=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,d)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:o=0}=t;let u,l;try{u=_s(n).toUint8Array()}catch(c){if(c instanceof fb)return ql("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new Ev(u,i,o)}catch(c){return ql(c instanceof El?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.ge===0?null:l}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let i=0;return n.forEach((o=>{const u=this.Ge.ht(),l=`projects/${u.projectId}/databases/${u.database}/documents/${o.path.canonicalString()}`;e.mightContain(l)||(this.et(t,o,null),i++)})),i}Tt(e){const t=new Map;this.ze.forEach(((o,u)=>{const l=this.ot(u);if(l){if(o.current&&md(l.target)){const c=new Qe(l.target.path);this.It(c).has(u)||this.Et(u,c)||this.et(u,c,Rn.newNoDocument(c,e))}o.Be&&(t.set(u,o.ke()),o.Ke())}}));let n=Pt();this.Je.forEach(((o,u)=>{let l=!0;u.forEachWhile((c=>{const d=this.ot(c);return!d||d.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)})),l&&(n=n.add(o))})),this.je.forEach(((o,u)=>u.setReadTime(e)));const i=new fc(e,t,this.Ze,this.je,n);return this.je=$r(),this.He=Ch(),this.Je=Ch(),this.Ze=new fn(Ct),i}Ye(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,n),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.qe(t,1):i.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new C2,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new sn(Ct),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new sn(Ct),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Oe("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new C2),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Ch(){return new fn(Qe.comparator)}function D2(){return new fn(Qe.comparator)}const YR={asc:"ASCENDING",desc:"DESCENDING"},XR={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ZR={and:"AND",or:"OR"};class JR{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Sg(r,e){return r.useProto3Json||jd(e)?e:{value:e}}function yu(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Kb(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function ek(r,e){return yu(r,e.toTimestamp())}function Tr(r){return ht(!!r,49232),vt.fromTimestamp((function(t){const n=ys(t);return new nn(n.seconds,n.nanos)})(r))}function bv(r,e){return Ig(r,e).canonicalString()}function Ig(r,e){const t=(function(i){return new Jt(["projects",i.projectId,"databases",i.database])})(r).child("documents");return e===void 0?t:t.child(e)}function Qb(r){const e=Jt.fromString(r);return ht(ix(e),10190,{key:e.toString()}),e}function vd(r,e){return bv(r.databaseId,e.path)}function Go(r,e){const t=Qb(e);if(t.get(1)!==r.databaseId.projectId)throw new We(Te.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new We(Te.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new Qe(Zb(t))}function Yb(r,e){return bv(r.databaseId,e)}function Xb(r){const e=Qb(r);return e.length===4?Jt.emptyPath():Zb(e)}function Cg(r){return new Jt(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function Zb(r){return ht(r.length>4&&r.get(4)==="documents",29091,{key:r.toString()}),r.popFirst(5)}function R2(r,e,t){return{name:vd(r,e),fields:t.value.mapValue.fields}}function tk(r,e,t){const n=Go(r,e.name),i=Tr(e.updateTime),o=e.createTime?Tr(e.createTime):vt.min(),u=new gr({mapValue:{fields:e.fields}}),l=Rn.newFoundDocument(n,i,o,u);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function nk(r,e){let t;if("targetChange"in e){e.targetChange;const n=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:rt(39313,{state:d})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=(function(d,m){return d.useProto3Json?(ht(m===void 0||typeof m=="string",58123),Fn.fromBase64String(m||"")):(ht(m===void 0||m instanceof Buffer||m instanceof Uint8Array,16193),Fn.fromUint8Array(m||new Uint8Array))})(r,e.targetChange.resumeToken),u=e.targetChange.cause,l=u&&(function(d){const m=d.code===void 0?Te.UNKNOWN:$b(d.code);return new We(m,d.message||"")})(u);t=new Gb(n,i,o,l||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=Go(r,n.document.name),o=Tr(n.document.updateTime),u=n.document.createTime?Tr(n.document.createTime):vt.min(),l=new gr({mapValue:{fields:n.document.fields}}),c=Rn.newFoundDocument(i,o,u,l),d=n.targetIds||[],m=n.removedTargetIds||[];t=new Gh(d,m,c.key,c)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=Go(r,n.document),o=n.readTime?Tr(n.readTime):vt.min(),u=Rn.newNoDocument(i,o),l=n.removedTargetIds||[];t=new Gh([],l,u.key,u)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=Go(r,n.document),o=n.removedTargetIds||[];t=new Gh([],o,i,null)}else{if(!("filter"in e))return rt(11601,{Vt:e});{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:o}=n,u=new $R(i,o),l=n.targetId;t=new Hb(l,u)}}return t}function yd(r,e){let t;if(e instanceof Cu)t={update:R2(r,e.key,e.value)};else if(e instanceof Xd)t={delete:vd(r,e.key)};else if(e instanceof bs)t={update:R2(r,e.key,e.data),updateMask:uk(e.fieldMask)};else{if(!(e instanceof Wb))return rt(16599,{dt:e.type});t={verify:vd(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((n=>(function(o,u){const l=u.transform;if(l instanceof ec)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof gu)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof vu)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof tc)return{fieldPath:u.field.canonicalString(),increment:l.Ae};throw rt(20930,{transform:u.transform})})(0,n)))),e.precondition.isNone||(t.currentDocument=(function(i,o){return o.updateTime!==void 0?{updateTime:ek(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:rt(27497)})(r,e.precondition)),t}function Dg(r,e){const t=e.currentDocument?(function(o){return o.updateTime!==void 0?xr.updateTime(Tr(o.updateTime)):o.exists!==void 0?xr.exists(o.exists):xr.none()})(e.currentDocument):xr.none(),n=e.updateTransforms?e.updateTransforms.map((i=>(function(u,l){let c=null;if("setToServerValue"in l)ht(l.setToServerValue==="REQUEST_TIME",16630,{proto:l}),c=new ec;else if("appendMissingElements"in l){const m=l.appendMissingElements.values||[];c=new gu(m)}else if("removeAllFromArray"in l){const m=l.removeAllFromArray.values||[];c=new vu(m)}else"increment"in l?c=new tc(u,l.increment):rt(16584,{proto:l});const d=In.fromServerFormat(l.fieldPath);return new zR(d,c)})(r,i))):[];if(e.update){e.update.name;const i=Go(r,e.update.name),o=new gr({mapValue:{fields:e.update.fields}});if(e.updateMask){const u=(function(c){const d=c.fieldPaths||[];return new Nr(d.map((m=>In.fromServerFormat(m))))})(e.updateMask);return new bs(i,o,u,t,n)}return new Cu(i,o,t,n)}if(e.delete){const i=Go(r,e.delete);return new Xd(i,t)}if(e.verify){const i=Go(r,e.verify);return new Wb(i,t)}return rt(1463,{proto:e})}function rk(r,e){return r&&r.length>0?(ht(e!==void 0,14353),r.map((t=>(function(i,o){let u=i.updateTime?Tr(i.updateTime):Tr(o);return u.isEqual(vt.min())&&(u=Tr(o)),new jR(u,i.transformResults||[])})(t,e)))):[]}function Jb(r,e){return{documents:[Yb(r,e.path)]}}function ex(r,e){const t={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=Yb(r,i);const o=(function(d){if(d.length!==0)return rx(rn.create(d,"and"))})(e.filters);o&&(t.structuredQuery.where=o);const u=(function(d){if(d.length!==0)return d.map((m=>(function(E){return{field:Xa(E.field),direction:sk(E.dir)}})(m)))})(e.orderBy);u&&(t.structuredQuery.orderBy=u);const l=Sg(r,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(e.endAt)),{ft:t,parent:i}}function tx(r){let e=Xb(r.parent);const t=r.structuredQuery,n=t.from?t.from.length:0;let i=null;if(n>0){ht(n===1,65062);const m=t.from[0];m.allDescendants?i=m.collectionId:e=e.child(m.collectionId)}let o=[];t.where&&(o=(function(g){const E=nx(g);return E instanceof rn&&mv(E)?E.getFilters():[E]})(t.where));let u=[];t.orderBy&&(u=(function(g){return g.map((E=>(function(M){return new Jl(Za(M.field),(function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(M.direction))})(E)))})(t.orderBy));let l=null;t.limit&&(l=(function(g){let E;return E=typeof g=="object"?g.value:g,jd(E)?null:E})(t.limit));let c=null;t.startAt&&(c=(function(g){const E=!!g.before,b=g.values||[];return new pu(b,E)})(t.startAt));let d=null;return t.endAt&&(d=(function(g){const E=!g.before,b=g.values||[];return new pu(b,E)})(t.endAt)),Db(e,i,u,o,l,"F",c,d)}function ik(r,e){const t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return rt(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function nx(r){return r.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=Za(t.unaryFilter.field);return Ft.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=Za(t.unaryFilter.field);return Ft.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=Za(t.unaryFilter.field);return Ft.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const u=Za(t.unaryFilter.field);return Ft.create(u,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return rt(61313);default:return rt(60726)}})(r):r.fieldFilter!==void 0?(function(t){return Ft.create(Za(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return rt(58110);default:return rt(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(r):r.compositeFilter!==void 0?(function(t){return rn.create(t.compositeFilter.filters.map((n=>nx(n))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return rt(1026)}})(t.compositeFilter.op))})(r):rt(30097,{filter:r})}function sk(r){return YR[r]}function ok(r){return XR[r]}function ak(r){return ZR[r]}function Xa(r){return{fieldPath:r.canonicalString()}}function Za(r){return In.fromServerFormat(r.fieldPath)}function rx(r){return r instanceof Ft?(function(t){if(t.op==="=="){if(p2(t.value))return{unaryFilter:{field:Xa(t.field),op:"IS_NAN"}};if(f2(t.value))return{unaryFilter:{field:Xa(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(p2(t.value))return{unaryFilter:{field:Xa(t.field),op:"IS_NOT_NAN"}};if(f2(t.value))return{unaryFilter:{field:Xa(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Xa(t.field),op:ok(t.op),value:t.value}}})(r):r instanceof rn?(function(t){const n=t.getFilters().map((i=>rx(i)));return n.length===1?n[0]:{compositeFilter:{op:ak(t.op),filters:n}}})(r):rt(54877,{filter:r})}function uk(r){const e=[];return r.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function ix(r){return r.length>=4&&r.get(0)==="projects"&&r.get(2)==="databases"}function sx(r){return!!r&&typeof r._toProto=="function"&&r._protoValueType==="ProtoValue"}class fs{constructor(e,t,n,i,o=vt.min(),u=vt.min(),l=Fn.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new fs(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new fs(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new fs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new fs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class ox{constructor(e){this.yt=e}}function lk(r,e){let t;if(e.document)t=tk(r.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const n=Qe.fromSegments(e.noDocument.path),i=ea(e.noDocument.readTime);t=Rn.newNoDocument(n,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return rt(56709);{const n=Qe.fromSegments(e.unknownDocument.path),i=ea(e.unknownDocument.version);t=Rn.newUnknownDocument(n,i)}}return e.readTime&&t.setReadTime((function(i){const o=new nn(i[0],i[1]);return vt.fromTimestamp(o)})(e.readTime)),t}function k2(r,e){const t=e.key,n={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:_d(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=(function(o,u){return{name:vd(o,u.key),fields:u.data.value.mapValue.fields,updateTime:yu(o,u.version.toTimestamp()),createTime:yu(o,u.createTime.toTimestamp())}})(r.yt,e);else if(e.isNoDocument())n.noDocument={path:t.path.toArray(),readTime:Jo(e.version)};else{if(!e.isUnknownDocument())return rt(57904,{document:e});n.unknownDocument={path:t.path.toArray(),version:Jo(e.version)}}return n}function _d(r){const e=r.toTimestamp();return[e.seconds,e.nanoseconds]}function Jo(r){const e=r.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function ea(r){const e=new nn(r.seconds,r.nanoseconds);return vt.fromTimestamp(e)}function Bo(r,e){const t=(e.baseMutations||[]).map((o=>Dg(r.yt,o)));for(let o=0;o<e.mutations.length-1;++o){const u=e.mutations[o];if(o+1<e.mutations.length&&e.mutations[o+1].transform!==void 0){const l=e.mutations[o+1];u.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(o+1,1),++o}}const n=e.mutations.map((o=>Dg(r.yt,o))),i=nn.fromMillis(e.localWriteTimeMs);return new yv(e.batchId,i,t,n)}function bl(r){const e=ea(r.readTime),t=r.lastLimboFreeSnapshotVersion!==void 0?ea(r.lastLimboFreeSnapshotVersion):vt.min();let n;return n=(function(o){return o.documents!==void 0})(r.query)?(function(o){const u=o.documents.length;return ht(u===1,1966,{count:u}),Gr(hc(Xb(o.documents[0])))})(r.query):(function(o){return Gr(tx(o))})(r.query),new fs(n,r.targetId,"TargetPurposeListen",r.lastListenSequenceNumber,e,t,Fn.fromBase64String(r.resumeToken))}function ax(r,e){const t=Jo(e.snapshotVersion),n=Jo(e.lastLimboFreeSnapshotVersion);let i;i=md(e.target)?Jb(r.yt,e.target):ex(r.yt,e.target).ft;const o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Zo(e.target),readTime:t,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:i}}function ux(r){const e=tx({parent:r.parent,structuredQuery:r.structuredQuery});return r.limitType==="LAST"?Ag(e,e.limit,"L"):e}function Lm(r,e){return new wv(e.largestBatchId,Dg(r.yt,e.overlayMutation))}function N2(r,e){const t=e.path.lastSegment();return[r,vr(e.path.popLast()),t]}function P2(r,e,t,n){return{indexId:r,uid:e,sequenceNumber:t,readTime:Jo(n.readTime),documentKey:vr(n.documentKey.path),largestBatchId:n.largestBatchId}}class ck{getBundleMetadata(e,t){return O2(e).get(t).next((n=>{if(n)return(function(o){return{id:o.bundleId,createTime:ea(o.createTime),version:o.version}})(n)}))}saveBundleMetadata(e,t){return O2(e).put((function(i){return{bundleId:i.id,createTime:Jo(Tr(i.createTime)),version:i.version}})(t))}getNamedQuery(e,t){return L2(e).get(t).next((n=>{if(n)return(function(o){return{name:o.name,query:ux(o.bundledQuery),readTime:ea(o.readTime)}})(n)}))}saveNamedQuery(e,t){return L2(e).put((function(i){return{name:i.name,readTime:Jo(Tr(i.readTime)),bundledQuery:i.bundledQuery}})(t))}}function O2(r){return Gn(r,qd)}function L2(r){return Gn(r,Wd)}class Zd{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const n=t.uid||"";return new Zd(e,n)}getOverlay(e,t){return fl(e).get(N2(this.userId,t)).next((n=>n?Lm(this.serializer,n):null))}getOverlays(e,t){const n=Bi();return fe.forEach(t,(i=>this.getOverlay(e,i).next((o=>{o!==null&&n.set(i,o)})))).next((()=>n))}saveOverlays(e,t,n){const i=[];return n.forEach(((o,u)=>{const l=new wv(t,u);i.push(this.bt(e,l))})),fe.waitFor(i)}removeOverlaysForBatchId(e,t,n){const i=new Set;t.forEach((u=>i.add(vr(u.getCollectionPath()))));const o=[];return i.forEach((u=>{const l=IDBKeyRange.bound([this.userId,u,n],[this.userId,u,n+1],!1,!0);o.push(fl(e).X(vg,l))})),fe.waitFor(o)}getOverlaysForCollection(e,t,n){const i=Bi(),o=vr(t),u=IDBKeyRange.bound([this.userId,o,n],[this.userId,o,Number.POSITIVE_INFINITY],!0);return fl(e).H(vg,u).next((l=>{for(const c of l){const d=Lm(this.serializer,c);i.set(d.getKey(),d)}return i}))}getOverlaysForCollectionGroup(e,t,n,i){const o=Bi();let u;const l=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return fl(e).ee({index:ab,range:l},((c,d,m)=>{const g=Lm(this.serializer,d);o.size()<i||g.largestBatchId===u?(o.set(g.getKey(),g),u=g.largestBatchId):m.done()})).next((()=>o))}bt(e,t){return fl(e).put((function(i,o,u){const[l,c,d]=N2(o,u.mutation.key);return{userId:o,collectionPath:c,documentId:d,collectionGroup:u.mutation.key.getCollectionGroup(),largestBatchId:u.largestBatchId,overlayMutation:yd(i.yt,u.mutation)}})(this.serializer,this.userId,t))}}function fl(r){return Gn(r,$d)}class hk{St(e){return Gn(e,cv)}getSessionToken(e){return this.St(e).get("sessionToken").next((t=>{const n=t?.value;return n?Fn.fromUint8Array(n):Fn.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.St(e).put({name:"sessionToken",value:t.toUint8Array()})}}class zo{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(bn(e.integerValue));else if("doubleValue"in e){const n=bn(e.doubleValue);isNaN(n)?this.Ft(t,13):(this.Ft(t,15),$l(n)?t.Mt(0):t.Mt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Ft(t,20),typeof n=="string"&&(n=ys(n)),t.xt(`${n.seconds||""}`),t.Mt(n.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(_s(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Ft(t,45),t.Mt(n.latitude||0),t.Mt(n.longitude||0)}else"mapValue"in e?_b(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Gd(e)?this.kt(e.mapValue,t):(this.Kt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Nt(t)):rt(19022,{Ut:e})}Ot(e,t){this.Ft(t,25),this.$t(e,t)}$t(e,t){t.xt(e)}Kt(e,t){const n=e.fields||{};this.Ft(t,55);for(const i of Object.keys(n))this.Ot(i,t),this.Ct(n[i],t)}kt(e,t){const n=e.fields||{};this.Ft(t,53);const i=du,o=n[i].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(bn(o)),this.Ot(i,t),this.Ct(n[i],t)}qt(e,t){const n=e.values||[];this.Ft(t,50);for(const i of n)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),Qe.fromName(e).path.forEach((n=>{this.Ft(t,60),this.$t(n,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}zo.Wt=new zo;const ja=255;function dk(r){if(r===0)return 8;let e=0;return r>>4||(e+=4,r<<=4),r>>6||(e+=2,r<<=2),r>>7||(e+=1),e}function V2(r){const e=64-(function(n){let i=0;for(let o=0;o<8;++o){const u=dk(255&n[o]);if(i+=u,u!==8)break}return i})(r);return Math.ceil(e/8)}class fk{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Qt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Gt(n.value),n=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Ht(n.value),n=t.next();this.Jt()}Zt(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.Gt(n);else if(n<2048)this.Gt(960|n>>>6),this.Gt(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|n>>>12),this.Gt(128|63&n>>>6),this.Gt(128|63&n);else{const i=t.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Xt(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.Ht(n);else if(n<2048)this.Ht(960|n>>>6),this.Ht(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Ht(480|n>>>12),this.Ht(128|63&n>>>6),this.Ht(128|63&n);else{const i=t.codePointAt(0);this.Ht(240|i>>>18),this.Ht(128|63&i>>>12),this.Ht(128|63&i>>>6),this.Ht(128|63&i)}}this.Jt()}Yt(e){const t=this.en(e),n=V2(t);this.tn(1+n),this.buffer[this.position++]=255&n;for(let i=t.length-n;i<t.length;++i)this.buffer[this.position++]=255&t[i]}nn(e){const t=this.en(e),n=V2(t);this.tn(1+n),this.buffer[this.position++]=~(255&n);for(let i=t.length-n;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}rn(){this.sn(ja),this.sn(255)}_n(){this.an(ja),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(o){const u=new DataView(new ArrayBuffer(8));return u.setFloat64(0,o,!1),new Uint8Array(u.buffer)})(e),n=!!(128&t[0]);t[0]^=n?255:128;for(let i=1;i<t.length;++i)t[i]^=n?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===ja?(this.sn(ja),this.sn(0)):this.sn(t)}Ht(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===ja?(this.an(ja),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Jt(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const i=new Uint8Array(n);i.set(this.buffer),this.buffer=i}}class pk{constructor(e){this.cn=e}Bt(e){this.cn.Qt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.Yt(e)}vt(){this.cn.rn()}}class mk{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Xt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class pl{constructor(){this.cn=new fk,this.ascending=new pk(this.cn),this.descending=new mk(this.cn)}seed(e){this.cn.seed(e)}ln(e){return e===0?this.ascending:this.descending}un(){return this.cn.un()}reset(){this.cn.reset()}}class Uo{constructor(e,t,n,i){this.hn=e,this.Pn=t,this.Tn=n,this.In=i}En(){const e=this.In.length,t=e===0||this.In[e-1]===255?e+1:e,n=new Uint8Array(t);return n.set(this.In,0),t!==e?n.set([0],this.In.length):++n[n.length-1],new Uo(this.hn,this.Pn,this.Tn,n)}Rn(e,t,n){return{indexId:this.hn,uid:e,arrayValue:Kh(this.Tn),directionalValue:Kh(this.In),orderedDocumentKey:Kh(t),documentKey:n.path.toArray()}}An(e,t,n){const i=this.Rn(e,t,n);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function Ws(r,e){let t=r.hn-e.hn;return t!==0?t:(t=F2(r.Tn,e.Tn),t!==0?t:(t=F2(r.In,e.In),t!==0?t:Qe.comparator(r.Pn,e.Pn)))}function F2(r,e){for(let t=0;t<r.length&&t<e.length;++t){const n=r[t]-e[t];if(n!==0)return n}return r.length-e.length}function Kh(r){return C1()?(function(t){let n="";for(let i=0;i<t.length;i++)n+=String.fromCharCode(t[i]);return n})(r):r}function M2(r){return typeof r!="string"?r:(function(t){const n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n})(r)}class B2{constructor(e){this.Vn=new sn(((t,n)=>In.comparator(t.field,n.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.dn=e.orderBy,this.mn=[];for(const t of e.filters){const n=t;n.isInequality()?this.Vn=this.Vn.add(n):this.mn.push(n)}}get fn(){return this.Vn.size>1}gn(e){if(ht(e.collectionGroup===this.collectionId,49279),this.fn)return!1;const t=pg(e);if(t!==void 0&&!this.pn(t))return!1;const n=Vo(e);let i=new Set,o=0,u=0;for(;o<n.length&&this.pn(n[o]);++o)i=i.add(n[o].fieldPath.canonicalString());if(o===n.length)return!0;if(this.Vn.size>0){const l=this.Vn.getIterator().getNext();if(!i.has(l.field.canonicalString())){const c=n[o];if(!this.yn(l,c)||!this.wn(this.dn[u++],c))return!1}++o}for(;o<n.length;++o){const l=n[o];if(u>=this.dn.length||!this.wn(this.dn[u++],l))return!1}return!0}bn(){if(this.fn)return null;let e=new sn(In.comparator);const t=[];for(const n of this.mn)if(!n.field.isKeyField())if(n.op==="array-contains"||n.op==="array-contains-any")t.push(new zh(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new zh(n.field,0))}for(const n of this.dn)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new zh(n.field,n.dir==="asc"?0:1)));return new cd(cd.UNKNOWN_ID,this.collectionId,t,Wl.empty())}pn(e){for(const t of this.mn)if(this.yn(t,e))return!0;return!1}yn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const n=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===n}wn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function lx(r){if(ht(r instanceof Ft||r instanceof rn,20012),r instanceof Ft){if(r instanceof Cb){const t=r.value.arrayValue?.values?.map((n=>Ft.create(r.field,"==",n)))||[];return rn.create(t,"or")}return r}const e=r.filters.map((t=>lx(t)));return rn.create(e,r.op)}function gk(r){if(r.getFilters().length===0)return[];const e=Ng(lx(r));return ht(cx(e),7391),Rg(e)||kg(e)?[e]:e.getFilters()}function Rg(r){return r instanceof Ft}function kg(r){return r instanceof rn&&mv(r)}function cx(r){return Rg(r)||kg(r)||(function(t){if(t instanceof rn&&Eg(t)){for(const n of t.getFilters())if(!Rg(n)&&!kg(n))return!1;return!0}return!1})(r)}function Ng(r){if(ht(r instanceof Ft||r instanceof rn,34018),r instanceof Ft)return r;if(r.filters.length===1)return Ng(r.filters[0]);const e=r.filters.map((n=>Ng(n)));let t=rn.create(e,r.op);return t=wd(t),cx(t)?t:(ht(t instanceof rn,64498),ht(mu(t),40251),ht(t.filters.length>1,57927),t.filters.reduce(((n,i)=>xv(n,i))))}function xv(r,e){let t;return ht(r instanceof Ft||r instanceof rn,38388),ht(e instanceof Ft||e instanceof rn,25473),t=r instanceof Ft?e instanceof Ft?(function(i,o){return rn.create([i,o],"and")})(r,e):z2(r,e):e instanceof Ft?z2(e,r):(function(i,o){if(ht(i.filters.length>0&&o.filters.length>0,48005),mu(i)&&mu(o))return Ab(i,o.getFilters());const u=Eg(i)?i:o,l=Eg(i)?o:i,c=u.filters.map((d=>xv(d,l)));return rn.create(c,"or")})(r,e),wd(t)}function z2(r,e){if(mu(e))return Ab(e,r.getFilters());{const t=e.filters.map((n=>xv(r,n)));return rn.create(t,"or")}}function wd(r){if(ht(r instanceof Ft||r instanceof rn,11850),r instanceof Ft)return r;const e=r.getFilters();if(e.length===1)return wd(e[0]);if(xb(r))return r;const t=e.map((i=>wd(i))),n=[];return t.forEach((i=>{i instanceof Ft?n.push(i):i instanceof rn&&(i.op===r.op?n.push(...i.filters):n.push(i))})),n.length===1?n[0]:rn.create(n,r.op)}class vk{constructor(){this.Sn=new Tv}addToCollectionParentIndex(e,t){return this.Sn.add(t),fe.resolve()}getCollectionParents(e,t){return fe.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return fe.resolve()}deleteFieldIndex(e,t){return fe.resolve()}deleteAllFieldIndexes(e){return fe.resolve()}createTargetIndexes(e,t){return fe.resolve()}getDocumentsMatchingTarget(e,t){return fe.resolve(null)}getIndexType(e,t){return fe.resolve(0)}getFieldIndexes(e,t){return fe.resolve([])}getNextCollectionGroupToUpdate(e){return fe.resolve(null)}getMinOffset(e,t){return fe.resolve(Kr.min())}getMinOffsetFromCollectionGroup(e,t){return fe.resolve(Kr.min())}updateCollectionGroup(e,t,n){return fe.resolve()}updateIndexEntries(e,t){return fe.resolve()}}class Tv{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new sn(Jt.comparator),o=!i.has(n);return this.index[t]=i.add(n),o}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new sn(Jt.comparator)).toArray()}}const U2="IndexedDbIndexManager",Dh=new Uint8Array(0);class yk{constructor(e,t){this.databaseId=t,this.Dn=new Tv,this.Cn=new Es((n=>Zo(n)),((n,i)=>cc(n,i))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Dn.has(t)){const n=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((()=>{this.Dn.add(t)}));const o={collectionId:n,parent:vr(i)};return j2(e).put(o)}return fe.resolve()}getCollectionParents(e,t){const n=[],i=IDBKeyRange.bound([t,""],[G1(t),""],!1,!0);return j2(e).H(i).next((o=>{for(const u of o){if(u.collectionId!==t)break;n.push(Mi(u.parent))}return n}))}addFieldIndex(e,t){const n=ml(e),i=(function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map((c=>[c.fieldPath.canonicalString(),c.kind]))}})(t);delete i.indexId;const o=n.add(i);if(t.indexState){const u=Wa(e);return o.next((l=>{u.put(P2(l,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return o.next()}deleteFieldIndex(e,t){const n=ml(e),i=Wa(e),o=qa(e);return n.delete(t.indexId).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>o.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=ml(e),n=qa(e),i=Wa(e);return t.X().next((()=>n.X())).next((()=>i.X()))}createTargetIndexes(e,t){return fe.forEach(this.vn(t),(n=>this.getIndexType(e,n).next((i=>{if(i===0||i===1){const o=new B2(n).bn();if(o!=null)return this.addFieldIndex(e,o)}}))))}getDocumentsMatchingTarget(e,t){const n=qa(e);let i=!0;const o=new Map;return fe.forEach(this.vn(t),(u=>this.Fn(e,u).next((l=>{i&&(i=!!l),o.set(u,l)})))).next((()=>{if(i){let u=Pt();const l=[];return fe.forEach(o,((c,d)=>{Oe(U2,`Using index ${(function(V){return`id=${V.indexId}|cg=${V.collectionGroup}|f=${V.fields.map((q=>`${q.fieldPath}:${q.kind}`)).join(",")}`})(c)} to execute ${Zo(t)}`);const m=(function(V,q){const P=pg(q);if(P===void 0)return null;for(const U of gd(V,P.fieldPath))switch(U.op){case"array-contains-any":return U.value.arrayValue.values||[];case"array-contains":return[U.value]}return null})(d,c),g=(function(V,q){const P=new Map;for(const U of Vo(q))for(const R of gd(V,U.fieldPath))switch(R.op){case"==":case"in":P.set(U.fieldPath.canonicalString(),R.value);break;case"not-in":case"!=":return P.set(U.fieldPath.canonicalString(),R.value),Array.from(P.values())}return null})(d,c),E=(function(V,q){const P=[];let U=!0;for(const R of Vo(q)){const S=R.kind===0?_2(V,R.fieldPath,V.startAt):w2(V,R.fieldPath,V.startAt);P.push(S.value),U&&(U=S.inclusive)}return new pu(P,U)})(d,c),b=(function(V,q){const P=[];let U=!0;for(const R of Vo(q)){const S=R.kind===0?w2(V,R.fieldPath,V.endAt):_2(V,R.fieldPath,V.endAt);P.push(S.value),U&&(U=S.inclusive)}return new pu(P,U)})(d,c),M=this.Mn(c,d,E),D=this.Mn(c,d,b),w=this.xn(c,d,g),A=this.On(c.indexId,m,M,E.inclusive,D,b.inclusive,w);return fe.forEach(A,(I=>n.Z(I,t.limit).next((V=>{V.forEach((q=>{const P=Qe.fromSegments(q.documentKey);u.has(P)||(u=u.add(P),l.push(P))}))}))))})).next((()=>l))}return fe.resolve(null)}))}vn(e){let t=this.Cn.get(e);return t||(e.filters.length===0?t=[e]:t=gk(rn.create(e.filters,"and")).map((n=>xg(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt))),this.Cn.set(e,t),t)}On(e,t,n,i,o,u,l){const c=(t!=null?t.length:1)*Math.max(n.length,o.length),d=c/(t!=null?t.length:1),m=[];for(let g=0;g<c;++g){const E=t?this.Nn(t[g/d]):Dh,b=this.Bn(e,E,n[g%d],i),M=this.Ln(e,E,o[g%d],u),D=l.map((w=>this.Bn(e,E,w,!0)));m.push(...this.createRange(b,M,D))}return m}Bn(e,t,n,i){const o=new Uo(e,Qe.empty(),t,n);return i?o:o.En()}Ln(e,t,n,i){const o=new Uo(e,Qe.empty(),t,n);return i?o.En():o}Fn(e,t){const n=new B2(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next((o=>{let u=null;for(const l of o)n.gn(l)&&(!u||l.fields.length>u.fields.length)&&(u=l);return u}))}getIndexType(e,t){let n=2;const i=this.vn(t);return fe.forEach(i,(o=>this.Fn(e,o).next((u=>{u?n!==0&&u.fields.length<(function(c){let d=new sn(In.comparator),m=!1;for(const g of c.filters)for(const E of g.getFlattenedFilters())E.field.isKeyField()||(E.op==="array-contains"||E.op==="array-contains-any"?m=!0:d=d.add(E.field));for(const g of c.orderBy)g.field.isKeyField()||(d=d.add(g.field));return d.size+(m?1:0)})(o)&&(n=1):n=0})))).next((()=>(function(u){return u.limit!==null})(t)&&i.length>1&&n===2?1:n))}kn(e,t){const n=new pl;for(const i of Vo(e)){const o=t.data.field(i.fieldPath);if(o==null)return null;const u=n.ln(i.kind);zo.Wt.Dt(o,u)}return n.un()}Nn(e){const t=new pl;return zo.Wt.Dt(e,t.ln(0)),t.un()}Kn(e,t){const n=new pl;return zo.Wt.Dt(Xl(this.databaseId,t),n.ln((function(o){const u=Vo(o);return u.length===0?0:u[u.length-1].kind})(e))),n.un()}xn(e,t,n){if(n===null)return[];let i=[];i.push(new pl);let o=0;for(const u of Vo(e)){const l=n[o++];for(const c of i)if(this.qn(t,u.fieldPath)&&Zl(l))i=this.Un(i,u,l);else{const d=c.ln(u.kind);zo.Wt.Dt(l,d)}}return this.$n(i)}Mn(e,t,n){return this.xn(e,t,n.position)}$n(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].un();return t}Un(e,t,n){const i=[...e],o=[];for(const u of n.arrayValue.values||[])for(const l of i){const c=new pl;c.seed(l.un()),zo.Wt.Dt(u,c.ln(t.kind)),o.push(c)}return o}qn(e,t){return!!e.filters.find((n=>n instanceof Ft&&n.field.isEqual(t)&&(n.op==="in"||n.op==="not-in")))}getFieldIndexes(e,t){const n=ml(e),i=Wa(e);return(t?n.H(gg,IDBKeyRange.bound(t,t)):n.H()).next((o=>{const u=[];return fe.forEach(o,(l=>i.get([l.indexId,this.uid]).next((c=>{u.push((function(m,g){const E=g?new Wl(g.sequenceNumber,new Kr(ea(g.readTime),new Qe(Mi(g.documentKey)),g.largestBatchId)):Wl.empty(),b=m.fields.map((([M,D])=>new zh(In.fromServerFormat(M),D)));return new cd(m.indexId,m.collectionGroup,b,E)})(l,c))})))).next((()=>u))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((n,i)=>{const o=n.indexState.sequenceNumber-i.indexState.sequenceNumber;return o!==0?o:Ct(n.collectionGroup,i.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,n){const i=ml(e),o=Wa(e);return this.Wn(e).next((u=>i.H(gg,IDBKeyRange.bound(t,t)).next((l=>fe.forEach(l,(c=>o.put(P2(c.indexId,this.uid,u,n))))))))}updateIndexEntries(e,t){const n=new Map;return fe.forEach(t,((i,o)=>{const u=n.get(i.collectionGroup);return(u?fe.resolve(u):this.getFieldIndexes(e,i.collectionGroup)).next((l=>(n.set(i.collectionGroup,l),fe.forEach(l,(c=>this.Qn(e,i,c).next((d=>{const m=this.Gn(o,c);return d.isEqual(m)?fe.resolve():this.zn(e,o,c,d,m)})))))))}))}jn(e,t,n,i){return qa(e).put(i.Rn(this.uid,this.Kn(n,t.key),t.key))}Hn(e,t,n,i){return qa(e).delete(i.An(this.uid,this.Kn(n,t.key),t.key))}Qn(e,t,n){const i=qa(e);let o=new sn(Ws);return i.ee({index:ob,range:IDBKeyRange.only([n.indexId,this.uid,Kh(this.Kn(n,t))])},((u,l)=>{o=o.add(new Uo(n.indexId,t,M2(l.arrayValue),M2(l.directionalValue)))})).next((()=>o))}Gn(e,t){let n=new sn(Ws);const i=this.kn(t,e);if(i==null)return n;const o=pg(t);if(o!=null){const u=e.data.field(o.fieldPath);if(Zl(u))for(const l of u.arrayValue.values||[])n=n.add(new Uo(t.indexId,e.key,this.Nn(l),i))}else n=n.add(new Uo(t.indexId,e.key,Dh,i));return n}zn(e,t,n,i,o){Oe(U2,"Updating index entries for document '%s'",t.key);const u=[];return(function(c,d,m,g,E){const b=c.getIterator(),M=d.getIterator();let D=Ua(b),w=Ua(M);for(;D||w;){let A=!1,I=!1;if(D&&w){const V=m(D,w);V<0?I=!0:V>0&&(A=!0)}else D!=null?I=!0:A=!0;A?(g(w),w=Ua(M)):I?(E(D),D=Ua(b)):(D=Ua(b),w=Ua(M))}})(i,o,Ws,(l=>{u.push(this.jn(e,t,n,l))}),(l=>{u.push(this.Hn(e,t,n,l))})),fe.waitFor(u)}Wn(e){let t=1;return Wa(e).ee({index:sb,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((n,i,o)=>{o.done(),t=i.sequenceNumber+1})).next((()=>t))}createRange(e,t,n){n=n.sort(((u,l)=>Ws(u,l))).filter(((u,l,c)=>!l||Ws(u,c[l-1])!==0));const i=[];i.push(e);for(const u of n){const l=Ws(u,e),c=Ws(u,t);if(l===0)i[0]=e.En();else if(l>0&&c<0)i.push(u),i.push(u.En());else if(c>0)break}i.push(t);const o=[];for(let u=0;u<i.length;u+=2){if(this.Jn(i[u],i[u+1]))return[];const l=i[u].An(this.uid,Dh,Qe.empty()),c=i[u+1].An(this.uid,Dh,Qe.empty());o.push(IDBKeyRange.bound(l,c))}return o}Jn(e,t){return Ws(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(q2)}getMinOffset(e,t){return fe.mapArray(this.vn(t),(n=>this.Fn(e,n).next((i=>i||rt(44426))))).next(q2)}}function j2(r){return Gn(r,Kl)}function qa(r){return Gn(r,Dl)}function ml(r){return Gn(r,lv)}function Wa(r){return Gn(r,Cl)}function q2(r){ht(r.length!==0,28825);let e=r[0].indexState.offset,t=e.largestBatchId;for(let n=1;n<r.length;n++){const i=r[n].indexState.offset;ov(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Kr(e.readTime,e.documentKey,t)}const W2={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},hx=41943040;class mr{static withCacheSize(e){return new mr(e,mr.DEFAULT_COLLECTION_PERCENTILE,mr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}function dx(r,e,t){const n=r.store(Ei),i=r.store(uu),o=[],u=IDBKeyRange.only(t.batchId);let l=0;const c=n.ee({range:u},((m,g,E)=>(l++,E.delete())));o.push(c.next((()=>{ht(l===1,47070,{batchId:t.batchId})})));const d=[];for(const m of t.mutations){const g=nb(e,m.key.path,t.batchId);o.push(i.delete(g)),d.push(m.key)}return fe.waitFor(o).next((()=>d))}function Ed(r){if(!r)return 0;let e;if(r.document)e=r.document;else if(r.unknownDocument)e=r.unknownDocument;else{if(!r.noDocument)throw rt(14731);e=r.noDocument}return JSON.stringify(e).length}mr.DEFAULT_COLLECTION_PERCENTILE=10,mr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,mr.DEFAULT=new mr(hx,mr.DEFAULT_COLLECTION_PERCENTILE,mr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),mr.DISABLED=new mr(-1,0,0);class Jd{constructor(e,t,n,i){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=i,this.Zn={}}static wt(e,t,n,i){ht(e.uid!=="",64387);const o=e.isAuthenticated()?e.uid:"";return new Jd(o,t,n,i)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return $s(e).ee({index:jo,range:n},((i,o,u)=>{t=!1,u.done()})).next((()=>t))}addMutationBatch(e,t,n,i){const o=Ja(e),u=$s(e);return u.add({}).next((l=>{ht(typeof l=="number",49019);const c=new yv(l,t,n,i),d=(function(b,M,D){const w=D.baseMutations.map((I=>yd(b.yt,I))),A=D.mutations.map((I=>yd(b.yt,I)));return{userId:M,batchId:D.batchId,localWriteTimeMs:D.localWriteTime.toMillis(),baseMutations:w,mutations:A}})(this.serializer,this.userId,c),m=[];let g=new sn(((E,b)=>Ct(E.canonicalString(),b.canonicalString())));for(const E of i){const b=nb(this.userId,E.key.path,l);g=g.add(E.key.path.popLast()),m.push(u.put(d)),m.push(o.put(b,HD))}return g.forEach((E=>{m.push(this.indexManager.addToCollectionParentIndex(e,E))})),e.addOnCommittedListener((()=>{this.Zn[l]=c.keys()})),fe.waitFor(m).next((()=>c))}))}lookupMutationBatch(e,t){return $s(e).get(t).next((n=>n?(ht(n.userId===this.userId,48,"Unexpected user for mutation batch",{userId:n.userId,batchId:t}),Bo(this.serializer,n)):null))}Xn(e,t){return this.Zn[t]?fe.resolve(this.Zn[t]):this.lookupMutationBatch(e,t).next((n=>{if(n){const i=n.keys();return this.Zn[t]=i,i}return null}))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=IDBKeyRange.lowerBound([this.userId,n]);let o=null;return $s(e).ee({index:jo,range:i},((u,l,c)=>{l.userId===this.userId&&(ht(l.batchId>=n,47524,{Yn:n}),o=Bo(this.serializer,l)),c.done()})).next((()=>o))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=$o;return $s(e).ee({index:jo,range:t,reverse:!0},((i,o,u)=>{n=o.batchId,u.done()})).next((()=>n))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,$o],[this.userId,Number.POSITIVE_INFINITY]);return $s(e).H(jo,t).next((n=>n.map((i=>Bo(this.serializer,i)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=Uh(this.userId,t.path),i=IDBKeyRange.lowerBound(n),o=[];return Ja(e).ee({range:i},((u,l,c)=>{const[d,m,g]=u,E=Mi(m);if(d===this.userId&&t.path.isEqual(E))return $s(e).get(g).next((b=>{if(!b)throw rt(61480,{er:u,batchId:g});ht(b.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:b.userId,batchId:g}),o.push(Bo(this.serializer,b))}));c.done()})).next((()=>o))}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new sn(Ct);const i=[];return t.forEach((o=>{const u=Uh(this.userId,o.path),l=IDBKeyRange.lowerBound(u),c=Ja(e).ee({range:l},((d,m,g)=>{const[E,b,M]=d,D=Mi(b);E===this.userId&&o.path.isEqual(D)?n=n.add(M):g.done()}));i.push(c)})),fe.waitFor(i).next((()=>this.tr(e,n)))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1,o=Uh(this.userId,n),u=IDBKeyRange.lowerBound(o);let l=new sn(Ct);return Ja(e).ee({range:u},((c,d,m)=>{const[g,E,b]=c,M=Mi(E);g===this.userId&&n.isPrefixOf(M)?M.length===i&&(l=l.add(b)):m.done()})).next((()=>this.tr(e,l)))}tr(e,t){const n=[],i=[];return t.forEach((o=>{i.push($s(e).get(o).next((u=>{if(u===null)throw rt(35274,{batchId:o});ht(u.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:u.userId,batchId:o}),n.push(Bo(this.serializer,u))})))})),fe.waitFor(i).next((()=>n))}removeMutationBatch(e,t){return dx(e.le,this.userId,t).next((n=>(e.addOnCommittedListener((()=>{this.nr(t.batchId)})),fe.forEach(n,(i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))))}nr(e){delete this.Zn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return fe.resolve();const n=IDBKeyRange.lowerBound((function(u){return[u]})(this.userId)),i=[];return Ja(e).ee({range:n},((o,u,l)=>{if(o[0]===this.userId){const c=Mi(o[1]);i.push(c)}else l.done()})).next((()=>{ht(i.length===0,56720,{rr:i.map((o=>o.canonicalString()))})}))}))}containsKey(e,t){return fx(e,this.userId,t)}ir(e){return px(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:$o,lastStreamToken:""}))}}function fx(r,e,t){const n=Uh(e,t.path),i=n[1],o=IDBKeyRange.lowerBound(n);let u=!1;return Ja(r).ee({range:o,Y:!0},((l,c,d)=>{const[m,g,E]=l;m===e&&g===i&&(u=!0),d.done()})).next((()=>u))}function $s(r){return Gn(r,Ei)}function Ja(r){return Gn(r,uu)}function px(r){return Gn(r,Hl)}class ta{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new ta(0)}static ar(){return new ta(-1)}}class _k{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.ur(e).next((t=>{const n=new ta(t.highestTargetId);return t.highestTargetId=n.next(),this.cr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.ur(e).next((t=>vt.fromTimestamp(new nn(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.ur(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,n){return this.ur(e).next((i=>(i.highestListenSequenceNumber=t,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.cr(e,i))))}addTargetData(e,t){return this.lr(e,t).next((()=>this.ur(e).next((n=>(n.targetCount+=1,this.hr(t,n),this.cr(e,n))))))}updateTargetData(e,t){return this.lr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>$a(e).delete(t.targetId))).next((()=>this.ur(e))).next((n=>(ht(n.targetCount>0,8065),n.targetCount-=1,this.cr(e,n))))}removeTargets(e,t,n){let i=0;const o=[];return $a(e).ee(((u,l)=>{const c=bl(l);c.sequenceNumber<=t&&n.get(c.targetId)===null&&(i++,o.push(this.removeTargetData(e,c)))})).next((()=>fe.waitFor(o))).next((()=>i))}forEachTarget(e,t){return $a(e).ee(((n,i)=>{const o=bl(i);t(o)}))}ur(e){return $2(e).get(fd).next((t=>(ht(t!==null,2888),t)))}cr(e,t){return $2(e).put(fd,t)}lr(e,t){return $a(e).put(ax(this.serializer,t))}hr(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.ur(e).next((t=>t.targetCount))}getTargetData(e,t){const n=Zo(t),i=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let o=null;return $a(e).ee({range:i,index:ib},((u,l,c)=>{const d=bl(l);cc(t,d.target)&&(o=d,c.done())})).next((()=>o))}addMatchingKeys(e,t,n){const i=[],o=Ks(e);return t.forEach((u=>{const l=vr(u.path);i.push(o.put({targetId:n,path:l})),i.push(this.referenceDelegate.addReference(e,n,u))})),fe.waitFor(i)}removeMatchingKeys(e,t,n){const i=Ks(e);return fe.forEach(t,(o=>{const u=vr(o.path);return fe.waitFor([i.delete([n,u]),this.referenceDelegate.removeReference(e,n,o)])}))}removeMatchingKeysForTargetId(e,t){const n=Ks(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(i)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),i=Ks(e);let o=Pt();return i.ee({range:n,Y:!0},((u,l,c)=>{const d=Mi(u[1]),m=new Qe(d);o=o.add(m)})).next((()=>o))}containsKey(e,t){const n=vr(t.path),i=IDBKeyRange.bound([n],[G1(n)],!1,!0);let o=0;return Ks(e).ee({index:uv,Y:!0,range:i},(([u,l],c,d)=>{u!==0&&(o++,d.done())})).next((()=>o>0))}At(e,t){return $a(e).get(t).next((n=>n?bl(n):null))}}function $a(r){return Gn(r,lu)}function $2(r){return Gn(r,Ho)}function Ks(r){return Gn(r,cu)}const H2="LruGarbageCollector",mx=1048576;function G2([r,e],[t,n]){const i=Ct(r,t);return i===0?Ct(e,n):i}class wk{constructor(e){this.Pr=e,this.buffer=new sn(G2),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();G2(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class gx{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){Oe(H2,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ho(t)?Oe(H2,"Ignoring IndexedDB error during garbage collection: ",t):await co(t)}await this.Ar(3e5)}))}}class Ek{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((n=>Math.floor(t/100*n)))}nthSequenceNumber(e,t){if(t===0)return fe.resolve(kr.ce);const n=new wk(t);return this.Vr.forEachTarget(e,(i=>n.Er(i.sequenceNumber))).next((()=>this.Vr.mr(e,(i=>n.Er(i))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.Vr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Oe("LruGarbageCollector","Garbage collection skipped; disabled"),fe.resolve(W2)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(Oe("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),W2):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let n,i,o,u,l,c,d;const m=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((g=>(g>this.params.maximumSequenceNumbersToCollect?(Oe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),i=this.params.maximumSequenceNumbersToCollect):i=g,u=Date.now(),this.nthSequenceNumber(e,i)))).next((g=>(n=g,l=Date.now(),this.removeTargets(e,n,t)))).next((g=>(o=g,c=Date.now(),this.removeOrphanedDocuments(e,n)))).next((g=>(d=Date.now(),Qa()<=$t.DEBUG&&Oe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${u-m}ms
	Determined least recently used ${i} in `+(l-u)+`ms
	Removed ${o} targets in `+(c-l)+`ms
	Removed ${g} documents in `+(d-c)+`ms
Total Duration: ${d-m}ms`),fe.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:g}))))}}function vx(r,e){return new Ek(r,e)}class bk{constructor(e,t){this.db=e,this.garbageCollector=vx(this,t)}dr(e){const t=this.pr(e);return this.db.getTargetCache().getTargetCount(e).next((n=>t.next((i=>n+i))))}pr(e){let t=0;return this.mr(e,(n=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}mr(e,t){return this.yr(e,((n,i)=>t(i)))}addReference(e,t,n){return Rh(e,n)}removeReference(e,t,n){return Rh(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return Rh(e,t)}wr(e,t){return(function(i,o){let u=!1;return px(i).te((l=>fx(i,l,o).next((c=>(c&&(u=!0),fe.resolve(!c)))))).next((()=>u))})(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let o=0;return this.yr(e,((u,l)=>{if(l<=t){const c=this.wr(e,u).next((d=>{if(!d)return o++,n.getEntry(e,u).next((()=>(n.removeEntry(u,vt.min()),Ks(e).delete((function(g){return[0,vr(g.path)]})(u)))))}));i.push(c)}})).next((()=>fe.waitFor(i))).next((()=>n.apply(e))).next((()=>o))}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return Rh(e,t)}yr(e,t){const n=Ks(e);let i,o=kr.ce;return n.ee({index:uv},(([u,l],{path:c,sequenceNumber:d})=>{u===0?(o!==kr.ce&&t(new Qe(Mi(i)),o),o=d,i=c):o=kr.ce})).next((()=>{o!==kr.ce&&t(new Qe(Mi(i)),o)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Rh(r,e){return Ks(r).put((function(n,i){return{targetId:0,path:vr(n.path),sequenceNumber:i}})(e,r.currentSequenceNumber))}class yx{constructor(){this.changes=new Es((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Rn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?fe.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class xk{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return Oo(e).put(n)}removeEntry(e,t,n){return Oo(e).delete((function(o,u){const l=o.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],_d(u),l[l.length-1]]})(t,n))}updateMetadata(e,t){return this.getMetadata(e).next((n=>(n.byteSize+=t,this.br(e,n))))}getEntry(e,t){let n=Rn.newInvalidDocument(t);return Oo(e).ee({index:jh,range:IDBKeyRange.only(gl(t))},((i,o)=>{n=this.Sr(t,o)})).next((()=>n))}Dr(e,t){let n={size:0,document:Rn.newInvalidDocument(t)};return Oo(e).ee({index:jh,range:IDBKeyRange.only(gl(t))},((i,o)=>{n={document:this.Sr(t,o),size:Ed(o)}})).next((()=>n))}getEntries(e,t){let n=$r();return this.Cr(e,t,((i,o)=>{const u=this.Sr(i,o);n=n.insert(i,u)})).next((()=>n))}vr(e,t){let n=$r(),i=new fn(Qe.comparator);return this.Cr(e,t,((o,u)=>{const l=this.Sr(o,u);n=n.insert(o,l),i=i.insert(o,Ed(u))})).next((()=>({documents:n,Fr:i})))}Cr(e,t,n){if(t.isEmpty())return fe.resolve();let i=new sn(Y2);t.forEach((c=>i=i.add(c)));const o=IDBKeyRange.bound(gl(i.first()),gl(i.last())),u=i.getIterator();let l=u.getNext();return Oo(e).ee({index:jh,range:o},((c,d,m)=>{const g=Qe.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;l&&Y2(l,g)<0;)n(l,null),l=u.getNext();l&&l.isEqual(g)&&(n(l,d),l=u.hasNext()?u.getNext():null),l?m.j(gl(l)):m.done()})).next((()=>{for(;l;)n(l,null),l=u.hasNext()?u.getNext():null}))}getDocumentsMatchingQuery(e,t,n,i,o){const u=t.path,l=[u.popLast().toArray(),u.lastSegment(),_d(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],c=[u.popLast().toArray(),u.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Oo(e).H(IDBKeyRange.bound(l,c,!0)).next((d=>{o?.incrementDocumentReadCount(d.length);let m=$r();for(const g of d){const E=this.Sr(Qe.fromSegments(g.prefixPath.concat(g.collectionGroup,g.documentId)),g);E.isFoundDocument()&&(dc(t,E)||i.has(E.key))&&(m=m.insert(E.key,E))}return m}))}getAllFromCollectionGroup(e,t,n,i){let o=$r();const u=Q2(t,n),l=Q2(t,Kr.max());return Oo(e).ee({index:rb,range:IDBKeyRange.bound(u,l,!0)},((c,d,m)=>{const g=this.Sr(Qe.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);o=o.insert(g.key,g),o.size===i&&m.done()})).next((()=>o))}newChangeBuffer(e){return new Tk(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return K2(e).get(mg).next((t=>(ht(!!t,20021),t)))}br(e,t){return K2(e).put(mg,t)}Sr(e,t){if(t){const n=lk(this.serializer,t);if(!(n.isNoDocument()&&n.version.isEqual(vt.min())))return n}return Rn.newInvalidDocument(e)}}function _x(r){return new xk(r)}class Tk extends yx{constructor(e,t){super(),this.Mr=e,this.trackRemovals=t,this.Or=new Es((n=>n.toString()),((n,i)=>n.isEqual(i)))}applyChanges(e){const t=[];let n=0,i=new sn(((o,u)=>Ct(o.canonicalString(),u.canonicalString())));return this.changes.forEach(((o,u)=>{const l=this.Or.get(o);if(t.push(this.Mr.removeEntry(e,o,l.readTime)),u.isValidDocument()){const c=k2(this.Mr.serializer,u);i=i.add(o.path.popLast());const d=Ed(c);n+=d-l.size,t.push(this.Mr.addEntry(e,o,c))}else if(n-=l.size,this.trackRemovals){const c=k2(this.Mr.serializer,u.convertToNoDocument(vt.min()));t.push(this.Mr.addEntry(e,o,c))}})),i.forEach((o=>{t.push(this.Mr.indexManager.addToCollectionParentIndex(e,o))})),t.push(this.Mr.updateMetadata(e,n)),fe.waitFor(t)}getFromCache(e,t){return this.Mr.Dr(e,t).next((n=>(this.Or.set(t,{size:n.size,readTime:n.document.readTime}),n.document)))}getAllFromCache(e,t){return this.Mr.vr(e,t).next((({documents:n,Fr:i})=>(i.forEach(((o,u)=>{this.Or.set(o,{size:u,readTime:n.get(o).readTime})})),n)))}}function K2(r){return Gn(r,Gl)}function Oo(r){return Gn(r,dd)}function gl(r){const e=r.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Q2(r,e){const t=e.documentKey.path.toArray();return[r,_d(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function Y2(r,e){const t=r.path.toArray(),n=e.path.toArray();let i=0;for(let o=0;o<t.length-2&&o<n.length-2;++o)if(i=Ct(t[o],n[o]),i)return i;return i=Ct(t.length,n.length),i||(i=Ct(t[t.length-2],n[n.length-2]),i||Ct(t[t.length-1],n[n.length-1]))}class Ak{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class wx{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(n=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(n!==null&&Pl(n.mutation,i,Nr.empty(),nn.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((n=>this.getLocalViewOfDocuments(e,n,Pt()).next((()=>n))))}getLocalViewOfDocuments(e,t,n=Pt()){const i=Bi();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,n).next((o=>{let u=wl();return o.forEach(((l,c)=>{u=u.insert(l,c.overlayedDocument)})),u}))))}getOverlayedDocuments(e,t){const n=Bi();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,Pt())))}populateOverlays(e,t,n){const i=[];return n.forEach((o=>{t.has(o)||i.push(o)})),this.documentOverlayCache.getOverlays(e,i).next((o=>{o.forEach(((u,l)=>{t.set(u,l)}))}))}computeViews(e,t,n,i){let o=$r();const u=Nl(),l=(function(){return Nl()})();return t.forEach(((c,d)=>{const m=n.get(d.key);i.has(d.key)&&(m===void 0||m.mutation instanceof bs)?o=o.insert(d.key,d):m!==void 0?(u.set(d.key,m.mutation.getFieldMask()),Pl(m.mutation,d,m.mutation.getFieldMask(),nn.now())):u.set(d.key,Nr.empty())})),this.recalculateAndSaveOverlays(e,o).next((c=>(c.forEach(((d,m)=>u.set(d,m))),t.forEach(((d,m)=>l.set(d,new Ak(m,u.get(d)??null)))),l)))}recalculateAndSaveOverlays(e,t){const n=Nl();let i=new fn(((u,l)=>u-l)),o=Pt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((u=>{for(const l of u)l.keys().forEach((c=>{const d=t.get(c);if(d===null)return;let m=n.get(c)||Nr.empty();m=l.applyToLocalView(d,m),n.set(c,m);const g=(i.get(l.batchId)||Pt()).add(c);i=i.insert(l.batchId,g)}))})).next((()=>{const u=[],l=i.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),d=c.key,m=c.value,g=Vb();m.forEach((E=>{if(!o.has(E)){const b=jb(t.get(E),n.get(E));b!==null&&g.set(E,b),o=o.add(E)}})),u.push(this.documentOverlayCache.saveOverlays(e,d,g))}return fe.waitFor(u)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((n=>this.recalculateAndSaveOverlays(e,n)))}getDocumentsMatchingQuery(e,t,n,i){return DR(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Rb(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,i):this.getDocumentsMatchingCollectionQuery(e,t,n,i)}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next((o=>{const u=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-o.size):fe.resolve(Bi());let l=au,c=o;return u.next((d=>fe.forEach(d,((m,g)=>(l<g.largestBatchId&&(l=g.largestBatchId),o.get(m)?fe.resolve():this.remoteDocumentCache.getEntry(e,m).next((E=>{c=c.insert(m,E)}))))).next((()=>this.populateOverlays(e,d,o))).next((()=>this.computeViews(e,c,d,Pt()))).next((m=>({batchId:l,changes:Lb(m)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Qe(t)).next((n=>{let i=wl();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,i){const o=t.collectionGroup;let u=wl();return this.indexManager.getCollectionParents(e,o).next((l=>fe.forEach(l,(c=>{const d=(function(g,E){return new Iu(E,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)})(t,c.child(o));return this.getDocumentsMatchingCollectionQuery(e,d,n,i).next((m=>{m.forEach(((g,E)=>{u=u.insert(g,E)}))}))})).next((()=>u))))}getDocumentsMatchingCollectionQuery(e,t,n,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((u=>(o=u,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,o,i)))).next((u=>{o.forEach(((c,d)=>{const m=d.getKey();u.get(m)===null&&(u=u.insert(m,Rn.newInvalidDocument(m)))}));let l=wl();return u.forEach(((c,d)=>{const m=o.get(c);m!==void 0&&Pl(m.mutation,d,Nr.empty(),nn.now()),dc(t,d)&&(l=l.insert(c,d))})),l}))}}class Sk{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return fe.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:Tr(i.createTime)}})(t)),fe.resolve()}getNamedQuery(e,t){return fe.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(i){return{name:i.name,query:ux(i.bundledQuery),readTime:Tr(i.readTime)}})(t)),fe.resolve()}}class Ik{constructor(){this.overlays=new fn(Qe.comparator),this.Lr=new Map}getOverlay(e,t){return fe.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Bi();return fe.forEach(t,(i=>this.getOverlay(e,i).next((o=>{o!==null&&n.set(i,o)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((i,o)=>{this.bt(e,t,o)})),fe.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.Lr.get(n);return i!==void 0&&(i.forEach((o=>this.overlays=this.overlays.remove(o))),this.Lr.delete(n)),fe.resolve()}getOverlaysForCollection(e,t,n){const i=Bi(),o=t.length+1,u=new Qe(t.child("")),l=this.overlays.getIteratorFrom(u);for(;l.hasNext();){const c=l.getNext().value,d=c.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===o&&c.largestBatchId>n&&i.set(c.getKey(),c)}return fe.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let o=new fn(((d,m)=>d-m));const u=this.overlays.getIterator();for(;u.hasNext();){const d=u.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>n){let m=o.get(d.largestBatchId);m===null&&(m=Bi(),o=o.insert(d.largestBatchId,m)),m.set(d.getKey(),d)}}const l=Bi(),c=o.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach(((d,m)=>l.set(d,m))),!(l.size()>=i)););return fe.resolve(l)}bt(e,t,n){const i=this.overlays.get(n.key);if(i!==null){const u=this.Lr.get(i.largestBatchId).delete(n.key);this.Lr.set(i.largestBatchId,u)}this.overlays=this.overlays.insert(n.key,new wv(t,n));let o=this.Lr.get(t);o===void 0&&(o=Pt(),this.Lr.set(t,o)),this.Lr.set(t,o.add(n.key))}}class Ck{constructor(){this.sessionToken=Fn.EMPTY_BYTE_STRING}getSessionToken(e){return fe.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,fe.resolve()}}class Av{constructor(){this.kr=new sn(Jn.Kr),this.qr=new sn(Jn.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const n=new Jn(e,t);this.kr=this.kr.add(n),this.qr=this.qr.add(n)}$r(e,t){e.forEach((n=>this.addReference(n,t)))}removeReference(e,t){this.Wr(new Jn(e,t))}Qr(e,t){e.forEach((n=>this.removeReference(n,t)))}Gr(e){const t=new Qe(new Jt([])),n=new Jn(t,e),i=new Jn(t,e+1),o=[];return this.qr.forEachInRange([n,i],(u=>{this.Wr(u),o.push(u.key)})),o}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new Qe(new Jt([])),n=new Jn(t,e),i=new Jn(t,e+1);let o=Pt();return this.qr.forEachInRange([n,i],(u=>{o=o.add(u.key)})),o}containsKey(e){const t=new Jn(e,0),n=this.kr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class Jn{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return Qe.comparator(e.key,t.key)||Ct(e.Hr,t.Hr)}static Ur(e,t){return Ct(e.Hr,t.Hr)||Qe.comparator(e.key,t.key)}}class Dk{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new sn(Jn.Kr)}checkEmpty(e){return fe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,i){const o=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const u=new yv(o,t,n,i);this.mutationQueue.push(u);for(const l of i)this.Jr=this.Jr.add(new Jn(l.key,o)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return fe.resolve(u)}lookupMutationBatch(e,t){return fe.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=this.Xr(n),o=i<0?0:i;return fe.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return fe.resolve(this.mutationQueue.length===0?$o:this.Yn-1)}getAllMutationBatches(e){return fe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Jn(t,0),i=new Jn(t,Number.POSITIVE_INFINITY),o=[];return this.Jr.forEachInRange([n,i],(u=>{const l=this.Zr(u.Hr);o.push(l)})),fe.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new sn(Ct);return t.forEach((i=>{const o=new Jn(i,0),u=new Jn(i,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([o,u],(l=>{n=n.add(l.Hr)}))})),fe.resolve(this.Yr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let o=n;Qe.isDocumentKey(o)||(o=o.child(""));const u=new Jn(new Qe(o),0);let l=new sn(Ct);return this.Jr.forEachWhile((c=>{const d=c.key.path;return!!n.isPrefixOf(d)&&(d.length===i&&(l=l.add(c.Hr)),!0)}),u),fe.resolve(this.Yr(l))}Yr(e){const t=[];return e.forEach((n=>{const i=this.Zr(n);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){ht(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Jr;return fe.forEach(t.mutations,(i=>{const o=new Jn(i.key,t.batchId);return n=n.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Jr=n}))}nr(e){}containsKey(e,t){const n=new Jn(t,0),i=this.Jr.firstAfterOrEqual(n);return fe.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,fe.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Rk{constructor(e){this.ti=e,this.docs=(function(){return new fn(Qe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),o=i?i.size:0,u=this.ti(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:u}),this.size+=u-o,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return fe.resolve(n?n.document.mutableCopy():Rn.newInvalidDocument(t))}getEntries(e,t){let n=$r();return t.forEach((i=>{const o=this.docs.get(i);n=n.insert(i,o?o.document.mutableCopy():Rn.newInvalidDocument(i))})),fe.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let o=$r();const u=t.path,l=new Qe(u.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:d,value:{document:m}}=c.getNext();if(!u.isPrefixOf(d.path))break;d.path.length>u.length+1||ov(X1(m),n)<=0||(i.has(m.key)||dc(t,m))&&(o=o.insert(m.key,m.mutableCopy()))}return fe.resolve(o)}getAllFromCollectionGroup(e,t,n,i){rt(9500)}ni(e,t){return fe.forEach(this.docs,(n=>t(n)))}newChangeBuffer(e){return new kk(this)}getSize(e){return fe.resolve(this.size)}}class kk extends yx{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((n,i)=>{i.isValidDocument()?t.push(this.Mr.addEntry(e,i)):this.Mr.removeEntry(n)})),fe.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class Nk{constructor(e){this.persistence=e,this.ri=new Es((t=>Zo(t)),cc),this.lastRemoteSnapshotVersion=vt.min(),this.highestTargetId=0,this.ii=0,this.si=new Av,this.targetCount=0,this.oi=ta._r()}forEachTarget(e,t){return this.ri.forEach(((n,i)=>t(i))),fe.resolve()}getLastRemoteSnapshotVersion(e){return fe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return fe.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),fe.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.ii&&(this.ii=t),fe.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new ta(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,fe.resolve()}updateTargetData(e,t){return this.lr(t),fe.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,fe.resolve()}removeTargets(e,t,n){let i=0;const o=[];return this.ri.forEach(((u,l)=>{l.sequenceNumber<=t&&n.get(l.targetId)===null&&(this.ri.delete(u),o.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)})),fe.waitFor(o).next((()=>i))}getTargetCount(e){return fe.resolve(this.targetCount)}getTargetData(e,t){const n=this.ri.get(t)||null;return fe.resolve(n)}addMatchingKeys(e,t,n){return this.si.$r(t,n),fe.resolve()}removeMatchingKeys(e,t,n){this.si.Qr(t,n);const i=this.persistence.referenceDelegate,o=[];return i&&t.forEach((u=>{o.push(i.markPotentiallyOrphaned(e,u))})),fe.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),fe.resolve()}getMatchingKeysForTargetId(e,t){const n=this.si.jr(t);return fe.resolve(n)}containsKey(e,t){return fe.resolve(this.si.containsKey(t))}}class Sv{constructor(e,t){this._i={},this.overlays={},this.ai=new kr(0),this.ui=!1,this.ui=!0,this.ci=new Ck,this.referenceDelegate=e(this),this.li=new Nk(this),this.indexManager=new vk,this.remoteDocumentCache=(function(i){return new Rk(i)})((n=>this.referenceDelegate.hi(n))),this.serializer=new ox(t),this.Pi=new Sk(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Ik,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this._i[e.toKey()];return n||(n=new Dk(t,this.referenceDelegate),this._i[e.toKey()]=n),n}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,n){Oe("MemoryPersistence","Starting transaction:",e);const i=new Pk(this.ai.next());return this.referenceDelegate.Ti(),n(i).next((o=>this.referenceDelegate.Ii(i).next((()=>o)))).toPromise().then((o=>(i.raiseOnCommittedEvent(),o)))}Ei(e,t){return fe.or(Object.values(this._i).map((n=>()=>n.containsKey(e,t))))}}class Pk extends J1{constructor(e){super(),this.currentSequenceNumber=e}}class ef{constructor(e){this.persistence=e,this.Ri=new Av,this.Ai=null}static Vi(e){return new ef(e)}get di(){if(this.Ai)return this.Ai;throw rt(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.di.delete(n.toString()),fe.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.di.add(n.toString()),fe.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),fe.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((i=>this.di.add(i.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((o=>this.di.add(o.toString())))})).next((()=>n.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return fe.forEach(this.di,(n=>{const i=Qe.fromPath(n);return this.mi(e,i).next((o=>{o||t.removeEntry(i,vt.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((n=>{n?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return fe.or([()=>fe.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class bd{constructor(e,t){this.persistence=e,this.fi=new Es((n=>vr(n.path)),((n,i)=>n.isEqual(i))),this.garbageCollector=vx(this,t)}static Vi(e,t){return new bd(e,t)}Ti(){}Ii(e){return fe.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((n=>t.next((i=>n+i))))}pr(e){let t=0;return this.mr(e,(n=>{t++})).next((()=>t))}mr(e,t){return fe.forEach(this.fi,((n,i)=>this.wr(e,n,i).next((o=>o?fe.resolve():t(i)))))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ni(e,(u=>this.wr(e,u,t).next((l=>{l||(n++,o.removeEntry(u,vt.min()))})))).next((()=>o.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),fe.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.fi.set(n,e.currentSequenceNumber),fe.resolve()}removeReference(e,t,n){return this.fi.set(n,e.currentSequenceNumber),fe.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),fe.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Wh(e.data.value)),t}wr(e,t,n){return fe.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.fi.get(t);return fe.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Ok{constructor(e){this.serializer=e}k(e,t,n,i){const o=new Ud("createOrUpgrade",t);n<1&&i>=1&&((function(c){c.createObjectStore(lc)})(e),(function(c){c.createObjectStore(Hl,{keyPath:$D}),c.createObjectStore(Ei,{keyPath:a2,autoIncrement:!0}).createIndex(jo,u2,{unique:!0}),c.createObjectStore(uu)})(e),X2(e),(function(c){c.createObjectStore(Fo)})(e));let u=fe.resolve();return n<3&&i>=3&&(n!==0&&((function(c){c.deleteObjectStore(cu),c.deleteObjectStore(lu),c.deleteObjectStore(Ho)})(e),X2(e)),u=u.next((()=>(function(c){const d=c.store(Ho),m={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:vt.min().toTimestamp(),targetCount:0};return d.put(fd,m)})(o)))),n<4&&i>=4&&(n!==0&&(u=u.next((()=>(function(c,d){return d.store(Ei).H().next((g=>{c.deleteObjectStore(Ei),c.createObjectStore(Ei,{keyPath:a2,autoIncrement:!0}).createIndex(jo,u2,{unique:!0});const E=d.store(Ei),b=g.map((M=>E.put(M)));return fe.waitFor(b)}))})(e,o)))),u=u.next((()=>{(function(c){c.createObjectStore(hu,{keyPath:eR})})(e)}))),n<5&&i>=5&&(u=u.next((()=>this.gi(o)))),n<6&&i>=6&&(u=u.next((()=>((function(c){c.createObjectStore(Gl)})(e),this.pi(o))))),n<7&&i>=7&&(u=u.next((()=>this.yi(o)))),n<8&&i>=8&&(u=u.next((()=>this.wi(e,o)))),n<9&&i>=9&&(u=u.next((()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)}))),n<10&&i>=10&&(u=u.next((()=>this.bi(o)))),n<11&&i>=11&&(u=u.next((()=>{(function(c){c.createObjectStore(qd,{keyPath:tR})})(e),(function(c){c.createObjectStore(Wd,{keyPath:nR})})(e)}))),n<12&&i>=12&&(u=u.next((()=>{(function(c){const d=c.createObjectStore($d,{keyPath:lR});d.createIndex(vg,cR,{unique:!1}),d.createIndex(ab,hR,{unique:!1})})(e)}))),n<13&&i>=13&&(u=u.next((()=>(function(c){const d=c.createObjectStore(dd,{keyPath:GD});d.createIndex(jh,KD),d.createIndex(rb,QD)})(e))).next((()=>this.Si(e,o))).next((()=>e.deleteObjectStore(Fo)))),n<14&&i>=14&&(u=u.next((()=>this.Di(e,o)))),n<15&&i>=15&&(u=u.next((()=>(function(c){c.createObjectStore(lv,{keyPath:rR,autoIncrement:!0}).createIndex(gg,iR,{unique:!1}),c.createObjectStore(Cl,{keyPath:sR}).createIndex(sb,oR,{unique:!1}),c.createObjectStore(Dl,{keyPath:aR}).createIndex(ob,uR,{unique:!1})})(e)))),n<16&&i>=16&&(u=u.next((()=>{t.objectStore(Cl).clear()})).next((()=>{t.objectStore(Dl).clear()}))),n<17&&i>=17&&(u=u.next((()=>{(function(c){c.createObjectStore(cv,{keyPath:dR})})(e)}))),n<18&&i>=18&&C1()&&(u=u.next((()=>{t.objectStore(Cl).clear()})).next((()=>{t.objectStore(Dl).clear()}))),u}pi(e){let t=0;return e.store(Fo).ee(((n,i)=>{t+=Ed(i)})).next((()=>{const n={byteSize:t};return e.store(Gl).put(mg,n)}))}gi(e){const t=e.store(Hl),n=e.store(Ei);return t.H().next((i=>fe.forEach(i,(o=>{const u=IDBKeyRange.bound([o.userId,$o],[o.userId,o.lastAcknowledgedBatchId]);return n.H(jo,u).next((l=>fe.forEach(l,(c=>{ht(c.userId===o.userId,18650,"Cannot process batch from unexpected user",{batchId:c.batchId});const d=Bo(this.serializer,c);return dx(e,o.userId,d).next((()=>{}))}))))}))))}yi(e){const t=e.store(cu),n=e.store(Fo);return e.store(Ho).get(fd).next((i=>{const o=[];return n.ee(((u,l)=>{const c=new Jt(u),d=(function(g){return[0,vr(g)]})(c);o.push(t.get(d).next((m=>m?fe.resolve():(g=>t.put({targetId:0,path:vr(g),sequenceNumber:i.highestListenSequenceNumber}))(c))))})).next((()=>fe.waitFor(o)))}))}wi(e,t){e.createObjectStore(Kl,{keyPath:JD});const n=t.store(Kl),i=new Tv,o=u=>{if(i.add(u)){const l=u.lastSegment(),c=u.popLast();return n.put({collectionId:l,parent:vr(c)})}};return t.store(Fo).ee({Y:!0},((u,l)=>{const c=new Jt(u);return o(c.popLast())})).next((()=>t.store(uu).ee({Y:!0},(([u,l,c],d)=>{const m=Mi(l);return o(m.popLast())}))))}bi(e){const t=e.store(lu);return t.ee(((n,i)=>{const o=bl(i),u=ax(this.serializer,o);return t.put(u)}))}Si(e,t){const n=t.store(Fo),i=[];return n.ee(((o,u)=>{const l=t.store(dd),c=(function(g){return g.document?new Qe(Jt.fromString(g.document.name).popFirst(5)):g.noDocument?Qe.fromSegments(g.noDocument.path):g.unknownDocument?Qe.fromSegments(g.unknownDocument.path):rt(36783)})(u).path.toArray(),d={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:u.readTime||[0,0],unknownDocument:u.unknownDocument,noDocument:u.noDocument,document:u.document,hasCommittedMutations:!!u.hasCommittedMutations};i.push(l.put(d))})).next((()=>fe.waitFor(i)))}Di(e,t){const n=t.store(Ei),i=_x(this.serializer),o=new Sv(ef.Vi,this.serializer.yt);return n.H().next((u=>{const l=new Map;return u.forEach((c=>{let d=l.get(c.userId)??Pt();Bo(this.serializer,c).keys().forEach((m=>d=d.add(m))),l.set(c.userId,d)})),fe.forEach(l,((c,d)=>{const m=new pr(d),g=Zd.wt(this.serializer,m),E=o.getIndexManager(m),b=Jd.wt(m,this.serializer,E,o.referenceDelegate);return new wx(i,b,g,E).recalculateAndSaveOverlaysForDocumentKeys(new yg(t,kr.ce),c).next()}))}))}}function X2(r){r.createObjectStore(cu,{keyPath:XD}).createIndex(uv,ZD,{unique:!0}),r.createObjectStore(lu,{keyPath:"targetId"}).createIndex(ib,YD,{unique:!0}),r.createObjectStore(Ho)}const Hs="IndexedDbPersistence",Vm=18e5,Fm=5e3,Mm="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Lk="main";class Iv{constructor(e,t,n,i,o,u,l,c,d,m,g=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.Ci=o,this.window=u,this.document=l,this.Fi=d,this.Mi=m,this.xi=g,this.ai=null,this.ui=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Oi=null,this.inForeground=!1,this.Ni=null,this.Bi=null,this.Li=Number.NEGATIVE_INFINITY,this.ki=E=>Promise.resolve(),!Iv.v())throw new We(Te.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new bk(this,i),this.Ki=t+Lk,this.serializer=new ox(c),this.qi=new no(this.Ki,this.xi,new Ok(this.serializer)),this.ci=new hk,this.li=new _k(this.referenceDelegate,this.serializer),this.remoteDocumentCache=_x(this.serializer),this.Pi=new ck,this.window&&this.window.localStorage?this.Ui=this.window.localStorage:(this.Ui=null,m===!1&&Vn(Hs,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.$i().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new We(Te.FAILED_PRECONDITION,Mm);return this.Wi(),this.Qi(),this.Gi(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.li.getHighestSequenceNumber(e)))})).then((e=>{this.ai=new kr(e,this.Fi)})).then((()=>{this.ui=!0})).catch((e=>(this.qi&&this.qi.close(),Promise.reject(e))))}zi(e){return this.ki=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.qi.q((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Ci.enqueueAndForget((async()=>{this.started&&await this.$i()})))}$i(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>kh(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.ji(e).next((t=>{t||(this.isPrimary=!1,this.Ci.enqueueRetryable((()=>this.ki(!1))))}))})).next((()=>this.Hi(e))).next((t=>this.isPrimary&&!t?this.Ji(e).next((()=>!1)):!!t&&this.Zi(e).next((()=>!0)))))).catch((e=>{if(ho(e))return Oe(Hs,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Oe(Hs,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Ci.enqueueRetryable((()=>this.ki(e))),this.isPrimary=e}))}ji(e){return vl(e).get(za).next((t=>fe.resolve(this.Xi(t))))}Yi(e){return kh(e).delete(this.clientId)}async es(){if(this.isPrimary&&!this.ts(this.Li,Vm)){this.Li=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const n=Gn(t,hu);return n.H().next((i=>{const o=this.ns(i,Vm),u=i.filter((l=>o.indexOf(l)===-1));return fe.forEach(u,(l=>n.delete(l.clientId))).next((()=>u))}))})).catch((()=>[]));if(this.Ui)for(const t of e)this.Ui.removeItem(this.rs(t.clientId))}}Gi(){this.Bi=this.Ci.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.$i().then((()=>this.es())).then((()=>this.Gi()))))}Xi(e){return!!e&&e.ownerId===this.clientId}Hi(e){return this.Mi?fe.resolve(!0):vl(e).get(za).next((t=>{if(t!==null&&this.ts(t.leaseTimestampMs,Fm)&&!this.ss(t.ownerId)){if(this.Xi(t)&&this.networkEnabled)return!0;if(!this.Xi(t)){if(!t.allowTabSynchronization)throw new We(Te.FAILED_PRECONDITION,Mm);return!1}}return!(!this.networkEnabled||!this.inForeground)||kh(e).H().next((n=>this.ns(n,Fm).find((i=>{if(this.clientId!==i.clientId){const o=!this.networkEnabled&&i.networkEnabled,u=!this.inForeground&&i.inForeground,l=this.networkEnabled===i.networkEnabled;if(o||u&&l)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&Oe(Hs,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.ui=!1,this._s(),this.Bi&&(this.Bi.cancel(),this.Bi=null),this.us(),this.cs(),await this.qi.runTransaction("shutdown","readwrite",[lc,hu],(e=>{const t=new yg(e,kr.ce);return this.Ji(t).next((()=>this.Yi(t)))})),this.qi.close(),this.ls()}ns(e,t){return e.filter((n=>this.ts(n.updateTimeMs,t)&&!this.ss(n.clientId)))}hs(){return this.runTransaction("getActiveClients","readonly",(e=>kh(e).H().next((t=>this.ns(t,Vm).map((n=>n.clientId))))))}get started(){return this.ui}getGlobalsCache(){return this.ci}getMutationQueue(e,t){return Jd.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new yk(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Zd.wt(this.serializer,e)}getBundleCache(){return this.Pi}runTransaction(e,t,n){Oe(Hs,"Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",o=(function(c){return c===18?mR:c===17?hb:c===16?pR:c===15?hv:c===14?cb:c===13?lb:c===12?fR:c===11?ub:void rt(60245)})(this.xi);let u;return this.qi.runTransaction(e,i,o,(l=>(u=new yg(l,this.ai?this.ai.next():kr.ce),t==="readwrite-primary"?this.ji(u).next((c=>!!c||this.Hi(u))).next((c=>{if(!c)throw Vn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ci.enqueueRetryable((()=>this.ki(!1))),new We(Te.FAILED_PRECONDITION,Z1);return n(u)})).next((c=>this.Zi(u).next((()=>c)))):this.Ps(u).next((()=>n(u)))))).then((l=>(u.raiseOnCommittedEvent(),l)))}Ps(e){return vl(e).get(za).next((t=>{if(t!==null&&this.ts(t.leaseTimestampMs,Fm)&&!this.ss(t.ownerId)&&!this.Xi(t)&&!(this.Mi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new We(Te.FAILED_PRECONDITION,Mm)}))}Zi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return vl(e).put(za,t)}static v(){return no.v()}Ji(e){const t=vl(e);return t.get(za).next((n=>this.Xi(n)?(Oe(Hs,"Releasing primary lease."),t.delete(za)):fe.resolve()))}ts(e,t){const n=Date.now();return!(e<n-t)&&(!(e>n)||(Vn(`Detected an update time that is in the future: ${e} > ${n}`),!1))}Wi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ni=()=>{this.Ci.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.$i())))},this.document.addEventListener("visibilitychange",this.Ni),this.inForeground=this.document.visibilityState==="visible")}us(){this.Ni&&(this.document.removeEventListener("visibilitychange",this.Ni),this.Ni=null)}Qi(){typeof this.window?.addEventListener=="function"&&(this.Oi=()=>{this._s();const e=/(?:Version|Mobile)\/1[456]/;I1()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Ci.enterRestrictedMode(!0),this.Ci.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Oi))}cs(){this.Oi&&(this.window.removeEventListener("pagehide",this.Oi),this.Oi=null)}ss(e){try{const t=this.Ui?.getItem(this.rs(e))!==null;return Oe(Hs,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return Vn(Hs,"Failed to get zombied client id.",t),!1}}_s(){if(this.Ui)try{this.Ui.setItem(this.rs(this.clientId),String(Date.now()))}catch(e){Vn("Failed to set zombie client id.",e)}}ls(){if(this.Ui)try{this.Ui.removeItem(this.rs(this.clientId))}catch{}}rs(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function vl(r){return Gn(r,lc)}function kh(r){return Gn(r,hu)}function Ex(r,e){let t=r.projectId;return r.isDefaultDatabase||(t+="."+r.database),"firestore/"+e+"/"+t+"/"}class Cv{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.Ts=n,this.Is=i}static Es(e,t){let n=Pt(),i=Pt();for(const o of t.docChanges)switch(o.type){case 0:n=n.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new Cv(e,t.fromCache,n,i)}}class Vk{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class bx{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return I1()?8:eb(ad())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,i){const o={result:null};return this.gs(e,t).next((u=>{o.result=u})).next((()=>{if(!o.result)return this.ps(e,t,i,n).next((u=>{o.result=u}))})).next((()=>{if(o.result)return;const u=new Vk;return this.ys(e,t,u).next((l=>{if(o.result=l,this.As)return this.ws(e,t,u,l.size)}))})).next((()=>o.result))}ws(e,t,n,i){return n.documentReadCount<this.Vs?(Qa()<=$t.DEBUG&&Oe("QueryEngine","SDK will not create cache indexes for query:",Ya(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),fe.resolve()):(Qa()<=$t.DEBUG&&Oe("QueryEngine","Query:",Ya(t),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.ds*i?(Qa()<=$t.DEBUG&&Oe("QueryEngine","The SDK decides to create cache indexes for query:",Ya(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Gr(t))):fe.resolve())}gs(e,t){if(E2(t))return fe.resolve(null);let n=Gr(t);return this.indexManager.getIndexType(e,n).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=Ag(t,null,"F"),n=Gr(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((o=>{const u=Pt(...o);return this.fs.getDocuments(e,u).next((l=>this.indexManager.getMinOffset(e,n).next((c=>{const d=this.bs(t,l);return this.Ss(t,d,u,c.readTime)?this.gs(e,Ag(t,null,"F")):this.Ds(e,d,t,c)}))))})))))}ps(e,t,n,i){return E2(t)||i.isEqual(vt.min())?fe.resolve(null):this.fs.getDocuments(e,n).next((o=>{const u=this.bs(t,o);return this.Ss(t,u,n,i)?fe.resolve(null):(Qa()<=$t.DEBUG&&Oe("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ya(t)),this.Ds(e,u,t,Y1(i,au)).next((l=>l)))}))}bs(e,t){let n=new sn(Pb(e));return t.forEach(((i,o)=>{dc(e,o)&&(n=n.add(o))})),n}Ss(e,t,n,i){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}ys(e,t,n){return Qa()<=$t.DEBUG&&Oe("QueryEngine","Using full collection scan to execute query:",Ya(t)),this.fs.getDocumentsMatchingQuery(e,t,Kr.min(),n)}Ds(e,t,n,i){return this.fs.getDocumentsMatchingQuery(e,n,i).next((o=>(t.forEach((u=>{o=o.insert(u.key,u)})),o)))}}const Dv="LocalStore",Fk=3e8;class Mk{constructor(e,t,n,i){this.persistence=e,this.Cs=t,this.serializer=i,this.vs=new fn(Ct),this.Fs=new Es((o=>Zo(o)),cc),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(n)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new wx(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function xx(r,e,t,n){return new Mk(r,e,t,n)}async function Tx(r,e){const t=ot(r);return await t.persistence.runTransaction("Handle user change","readonly",(n=>{let i;return t.mutationQueue.getAllMutationBatches(n).next((o=>(i=o,t.Os(e),t.mutationQueue.getAllMutationBatches(n)))).next((o=>{const u=[],l=[];let c=Pt();for(const d of i){u.push(d.batchId);for(const m of d.mutations)c=c.add(m.key)}for(const d of o){l.push(d.batchId);for(const m of d.mutations)c=c.add(m.key)}return t.localDocuments.getDocuments(n,c).next((d=>({Ns:d,removedBatchIds:u,addedBatchIds:l})))}))}))}function Bk(r,e){const t=ot(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(n=>{const i=e.batch.keys(),o=t.xs.newChangeBuffer({trackRemovals:!0});return(function(l,c,d,m){const g=d.batch,E=g.keys();let b=fe.resolve();return E.forEach((M=>{b=b.next((()=>m.getEntry(c,M))).next((D=>{const w=d.docVersions.get(M);ht(w!==null,48541),D.version.compareTo(w)<0&&(g.applyToRemoteDocument(D,d),D.isValidDocument()&&(D.setReadTime(d.commitVersion),m.addEntry(D)))}))})),b.next((()=>l.mutationQueue.removeMutationBatch(c,g)))})(t,n,e,o).next((()=>o.apply(n))).next((()=>t.mutationQueue.performConsistencyCheck(n))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,(function(l){let c=Pt();for(let d=0;d<l.mutationResults.length;++d)l.mutationResults[d].transformResults.length>0&&(c=c.add(l.batch.mutations[d].key));return c})(e)))).next((()=>t.localDocuments.getDocuments(n,i)))}))}function Ax(r){const e=ot(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function zk(r,e){const t=ot(r),n=e.snapshotVersion;let i=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(o=>{const u=t.xs.newChangeBuffer({trackRemovals:!0});i=t.vs;const l=[];e.targetChanges.forEach(((m,g)=>{const E=i.get(g);if(!E)return;l.push(t.li.removeMatchingKeys(o,m.removedDocuments,g).next((()=>t.li.addMatchingKeys(o,m.addedDocuments,g))));let b=E.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(g)!==null?b=b.withResumeToken(Fn.EMPTY_BYTE_STRING,vt.min()).withLastLimboFreeSnapshotVersion(vt.min()):m.resumeToken.approximateByteSize()>0&&(b=b.withResumeToken(m.resumeToken,n)),i=i.insert(g,b),(function(D,w,A){return D.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-D.snapshotVersion.toMicroseconds()>=Fk?!0:A.addedDocuments.size+A.modifiedDocuments.size+A.removedDocuments.size>0})(E,b,m)&&l.push(t.li.updateTargetData(o,b))}));let c=$r(),d=Pt();if(e.documentUpdates.forEach((m=>{e.resolvedLimboDocuments.has(m)&&l.push(t.persistence.referenceDelegate.updateLimboDocument(o,m))})),l.push(Uk(o,u,e.documentUpdates).next((m=>{c=m.Bs,d=m.Ls}))),!n.isEqual(vt.min())){const m=t.li.getLastRemoteSnapshotVersion(o).next((g=>t.li.setTargetsMetadata(o,o.currentSequenceNumber,n)));l.push(m)}return fe.waitFor(l).next((()=>u.apply(o))).next((()=>t.localDocuments.getLocalViewOfDocuments(o,c,d))).next((()=>c))})).then((o=>(t.vs=i,o)))}function Uk(r,e,t){let n=Pt(),i=Pt();return t.forEach((o=>n=n.add(o))),e.getEntries(r,n).next((o=>{let u=$r();return t.forEach(((l,c)=>{const d=o.get(l);c.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(l)),c.isNoDocument()&&c.version.isEqual(vt.min())?(e.removeEntry(l,c.readTime),u=u.insert(l,c)):!d.isValidDocument()||c.version.compareTo(d.version)>0||c.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(c),u=u.insert(l,c)):Oe(Dv,"Ignoring outdated watch update for ",l,". Current version:",d.version," Watch version:",c.version)})),{Bs:u,Ls:i}}))}function jk(r,e){const t=ot(r);return t.persistence.runTransaction("Get next mutation batch","readonly",(n=>(e===void 0&&(e=$o),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e))))}function xd(r,e){const t=ot(r);return t.persistence.runTransaction("Allocate target","readwrite",(n=>{let i;return t.li.getTargetData(n,e).next((o=>o?(i=o,fe.resolve(i)):t.li.allocateTargetId(n).next((u=>(i=new fs(e,u,"TargetPurposeListen",n.currentSequenceNumber),t.li.addTargetData(n,i).next((()=>i)))))))})).then((n=>{const i=t.vs.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.vs=t.vs.insert(n.targetId,n),t.Fs.set(e,n.targetId)),n}))}async function _u(r,e,t){const n=ot(r),i=n.vs.get(e),o=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",o,(u=>n.persistence.referenceDelegate.removeTarget(u,i)))}catch(u){if(!ho(u))throw u;Oe(Dv,`Failed to update sequence numbers for target ${e}: ${u}`)}n.vs=n.vs.remove(e),n.Fs.delete(i.target)}function Pg(r,e,t){const n=ot(r);let i=vt.min(),o=Pt();return n.persistence.runTransaction("Execute query","readwrite",(u=>(function(c,d,m){const g=ot(c),E=g.Fs.get(m);return E!==void 0?fe.resolve(g.vs.get(E)):g.li.getTargetData(d,m)})(n,u,Gr(e)).next((l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,n.li.getMatchingKeysForTargetId(u,l.targetId).next((c=>{o=c}))})).next((()=>n.Cs.getDocumentsMatchingQuery(u,e,t?i:vt.min(),t?o:Pt()))).next((l=>(Cx(n,Nb(e),l),{documents:l,ks:o})))))}function Sx(r,e){const t=ot(r),n=ot(t.li),i=t.vs.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",(o=>n.At(o,e).next((u=>u?u.target:null))))}function Ix(r,e){const t=ot(r),n=t.Ms.get(e)||vt.min();return t.persistence.runTransaction("Get new document changes","readonly",(i=>t.xs.getAllFromCollectionGroup(i,e,Y1(n,au),Number.MAX_SAFE_INTEGER))).then((i=>(Cx(t,e,i),i)))}function Cx(r,e,t){let n=r.Ms.get(e)||vt.min();t.forEach(((i,o)=>{o.readTime.compareTo(n)>0&&(n=o.readTime)})),r.Ms.set(e,n)}const Dx="firestore_clients";function Z2(r,e){return`${Dx}_${r}_${e}`}const Rx="firestore_mutations";function J2(r,e,t){let n=`${Rx}_${r}_${t}`;return e.isAuthenticated()&&(n+=`_${e.uid}`),n}const kx="firestore_targets";function Bm(r,e){return`${kx}_${r}_${e}`}const Fi="SharedClientState";class Td{constructor(e,t,n,i){this.user=e,this.batchId=t,this.state=n,this.error=i}static $s(e,t,n){const i=JSON.parse(n);let o,u=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return u&&i.error&&(u=typeof i.error.message=="string"&&typeof i.error.code=="string",u&&(o=new We(i.error.code,i.error.message))),u?new Td(e,t,i.state,o):(Vn(Fi,`Failed to parse mutation state for ID '${t}': ${n}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Ol{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static $s(e,t){const n=JSON.parse(t);let i,o=typeof n=="object"&&["not-current","current","rejected"].indexOf(n.state)!==-1&&(n.error===void 0||typeof n.error=="object");return o&&n.error&&(o=typeof n.error.message=="string"&&typeof n.error.code=="string",o&&(i=new We(n.error.code,n.error.message))),o?new Ol(e,n.state,i):(Vn(Fi,`Failed to parse target state for ID '${e}': ${t}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Ad{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static $s(e,t){const n=JSON.parse(t);let i=typeof n=="object"&&n.activeTargetIds instanceof Array,o=gv();for(let u=0;i&&u<n.activeTargetIds.length;++u)i=tb(n.activeTargetIds[u]),o=o.add(n.activeTargetIds[u]);return i?new Ad(e,o):(Vn(Fi,`Failed to parse client data for instance '${e}': ${t}`),null)}}class Rv{constructor(e,t){this.clientId=e,this.onlineState=t}static $s(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new Rv(t.clientId,t.onlineState):(Vn(Fi,`Failed to parse online state: ${e}`),null)}}class Og{constructor(){this.activeTargetIds=gv()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class zm{constructor(e,t,n,i,o){this.window=e,this.Ci=t,this.persistenceKey=n,this.zs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.js=this.Hs.bind(this),this.Js=new fn(Ct),this.started=!1,this.Zs=[];const u=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.Xs=Z2(this.persistenceKey,this.zs),this.Ys=(function(c){return`firestore_sequence_number_${c}`})(this.persistenceKey),this.Js=this.Js.insert(this.zs,new Og),this.eo=new RegExp(`^${Dx}_${u}_([^_]*)$`),this.no=new RegExp(`^${Rx}_${u}_(\\d+)(?:_(.*))?$`),this.ro=new RegExp(`^${kx}_${u}_(\\d+)$`),this.io=(function(c){return`firestore_online_state_${c}`})(this.persistenceKey),this.so=(function(c){return`firestore_bundle_loaded_v2_${c}`})(this.persistenceKey),this.window.addEventListener("storage",this.js)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.hs();for(const n of e){if(n===this.zs)continue;const i=this.getItem(Z2(this.persistenceKey,n));if(i){const o=Ad.$s(n,i);o&&(this.Js=this.Js.insert(o.clientId,o))}}this.oo();const t=this.storage.getItem(this.io);if(t){const n=this._o(t);n&&this.ao(n)}for(const n of this.Zs)this.Hs(n);this.Zs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ys,JSON.stringify(e))}getAllActiveQueryTargets(){return this.uo(this.Js)}isActiveQueryTarget(e){let t=!1;return this.Js.forEach(((n,i)=>{i.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.co(e,"pending")}updateMutationState(e,t,n){this.co(e,t,n),this.lo(e)}addLocalQueryTarget(e,t=!0){let n="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(Bm(this.persistenceKey,e));if(i){const o=Ol.$s(e,i);o&&(n=o.state)}}return t&&this.ho.Qs(e),this.oo(),n}removeLocalQueryTarget(e){this.ho.Gs(e),this.oo()}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Bm(this.persistenceKey,e))}updateQueryState(e,t,n){this.Po(e,t,n)}handleUserChange(e,t,n){t.forEach((i=>{this.lo(i)})),this.currentUser=e,n.forEach((i=>{this.addPendingMutation(i)}))}setOnlineState(e){this.To(e)}notifyBundleLoaded(e){this.Io(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.js),this.removeItem(this.Xs),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return Oe(Fi,"READ",e,t),t}setItem(e,t){Oe(Fi,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){Oe(Fi,"REMOVE",e),this.storage.removeItem(e)}Hs(e){const t=e;if(t.storageArea===this.storage){if(Oe(Fi,"EVENT",t.key,t.newValue),t.key===this.Xs)return void Vn("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ci.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.eo.test(t.key)){if(t.newValue==null){const n=this.Eo(t.key);return this.Ro(n,null)}{const n=this.Ao(t.key,t.newValue);if(n)return this.Ro(n.clientId,n)}}else if(this.no.test(t.key)){if(t.newValue!==null){const n=this.Vo(t.key,t.newValue);if(n)return this.mo(n)}}else if(this.ro.test(t.key)){if(t.newValue!==null){const n=this.fo(t.key,t.newValue);if(n)return this.po(n)}}else if(t.key===this.io){if(t.newValue!==null){const n=this._o(t.newValue);if(n)return this.ao(n)}}else if(t.key===this.Ys){const n=(function(o){let u=kr.ce;if(o!=null)try{const l=JSON.parse(o);ht(typeof l=="number",30636,{yo:o}),u=l}catch(l){Vn(Fi,"Failed to read sequence number from WebStorage",l)}return u})(t.newValue);n!==kr.ce&&this.sequenceNumberHandler(n)}else if(t.key===this.so){const n=this.wo(t.newValue);await Promise.all(n.map((i=>this.syncEngine.bo(i))))}}}else this.Zs.push(t)}))}}get ho(){return this.Js.get(this.zs)}oo(){this.setItem(this.Xs,this.ho.Ws())}co(e,t,n){const i=new Td(this.currentUser,e,t,n),o=J2(this.persistenceKey,this.currentUser,e);this.setItem(o,i.Ws())}lo(e){const t=J2(this.persistenceKey,this.currentUser,e);this.removeItem(t)}To(e){const t={clientId:this.zs,onlineState:e};this.storage.setItem(this.io,JSON.stringify(t))}Po(e,t,n){const i=Bm(this.persistenceKey,e),o=new Ol(e,t,n);this.setItem(i,o.Ws())}Io(e){const t=JSON.stringify(Array.from(e));this.setItem(this.so,t)}Eo(e){const t=this.eo.exec(e);return t?t[1]:null}Ao(e,t){const n=this.Eo(e);return Ad.$s(n,t)}Vo(e,t){const n=this.no.exec(e),i=Number(n[1]),o=n[2]!==void 0?n[2]:null;return Td.$s(new pr(o),i,t)}fo(e,t){const n=this.ro.exec(e),i=Number(n[1]);return Ol.$s(i,t)}_o(e){return Rv.$s(e)}wo(e){return JSON.parse(e)}async mo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.So(e.batchId,e.state,e.error);Oe(Fi,`Ignoring mutation for non-active user ${e.user.uid}`)}po(e){return this.syncEngine.Do(e.targetId,e.state,e.error)}Ro(e,t){const n=t?this.Js.insert(e,t):this.Js.remove(e),i=this.uo(this.Js),o=this.uo(n),u=[],l=[];return o.forEach((c=>{i.has(c)||u.push(c)})),i.forEach((c=>{o.has(c)||l.push(c)})),this.syncEngine.Co(u,l).then((()=>{this.Js=n}))}ao(e){this.Js.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}uo(e){let t=gv();return e.forEach(((n,i)=>{t=t.unionWith(i.activeTargetIds)})),t}}class Nx{constructor(){this.vo=new Og,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,n){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new Og,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class qk{Mo(e){}shutdown(){}}const eE="ConnectivityMonitor";class tE{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){Oe(eE,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){Oe(eE,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Nh=null;function Lg(){return Nh===null?Nh=(function(){return 268435456+Math.round(2147483648*Math.random())})():Nh++,"0x"+Nh.toString(16)}const Um="RestConnection",Wk={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class $k{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${n}/databases/${i}`,this.$o=this.databaseId.database===pd?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Wo(e,t,n,i,o){const u=Lg(),l=this.Qo(e,t.toUriEncodedString());Oe(Um,`Sending RPC '${e}' ${u}:`,l,n);const c={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(c,i,o);const{host:d}=new URL(l),m=Bd(d);return this.zo(e,l,c,n,m).then((g=>(Oe(Um,`Received RPC '${e}' ${u}: `,g),g)),(g=>{throw ql(Um,`RPC '${e}' ${u} failed with error: `,g,"url: ",l,"request:",n),g}))}jo(e,t,n,i,o,u){return this.Wo(e,t,n,i,o)}Go(e,t,n){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Su})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,o)=>e[o]=i)),n&&n.headers.forEach(((i,o)=>e[o]=i))}Qo(e,t){const n=Wk[e];let i=`${this.qo}/v1/${t}:${n}`;return this.databaseInfo.apiKey&&(i=`${i}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),i}terminate(){}}class Hk{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const fr="WebChannelConnection",yl=(r,e,t)=>{r.listen(e,(n=>{try{t(n)}catch(i){setTimeout((()=>{throw i}),0)}}))};class tu extends $k{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!tu.c_){const e=W1();yl(e,q1.STAT_EVENT,(t=>{t.stat===dg.PROXY?Oe(fr,"STAT_EVENT: detected buffering proxy"):t.stat===dg.NOPROXY&&Oe(fr,"STAT_EVENT: detected no buffering proxy")})),tu.c_=!0}}zo(e,t,n,i,o){const u=Lg();return new Promise(((l,c)=>{const d=new U1;d.setWithCredentials(!0),d.listenOnce(j1.COMPLETE,(()=>{try{switch(d.getLastErrorCode()){case Bh.NO_ERROR:const g=d.getResponseJson();Oe(fr,`XHR for RPC '${e}' ${u} received:`,JSON.stringify(g)),l(g);break;case Bh.TIMEOUT:Oe(fr,`RPC '${e}' ${u} timed out`),c(new We(Te.DEADLINE_EXCEEDED,"Request time out"));break;case Bh.HTTP_ERROR:const E=d.getStatus();if(Oe(fr,`RPC '${e}' ${u} failed with status:`,E,"response text:",d.getResponseText()),E>0){let b=d.getResponseJson();Array.isArray(b)&&(b=b[0]);const M=b?.error;if(M&&M.status&&M.message){const D=(function(A){const I=A.toLowerCase().replace(/_/g,"-");return Object.values(Te).indexOf(I)>=0?I:Te.UNKNOWN})(M.status);c(new We(D,M.message))}else c(new We(Te.UNKNOWN,"Server responded with status "+d.getStatus()))}else c(new We(Te.UNAVAILABLE,"Connection failed."));break;default:rt(9055,{l_:e,streamId:u,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{Oe(fr,`RPC '${e}' ${u} completed.`)}}));const m=JSON.stringify(i);Oe(fr,`RPC '${e}' ${u} sending request:`,i),d.send(t,"POST",m,n,15)}))}T_(e,t,n){const i=Lg(),o=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=this.createWebChannelTransport(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Go(l.initMessageHeaders,t,n),l.encodeInitMessageHeaders=!0;const d=o.join("");Oe(fr,`Creating RPC '${e}' stream ${i}: ${d}`,l);const m=u.createWebChannel(d,l);this.I_(m);let g=!1,E=!1;const b=new Hk({Ho:M=>{E?Oe(fr,`Not sending because RPC '${e}' stream ${i} is closed:`,M):(g||(Oe(fr,`Opening RPC '${e}' stream ${i} transport.`),m.open(),g=!0),Oe(fr,`RPC '${e}' stream ${i} sending:`,M),m.send(M))},Jo:()=>m.close()});return yl(m,_l.EventType.OPEN,(()=>{E||(Oe(fr,`RPC '${e}' stream ${i} transport opened.`),b.i_())})),yl(m,_l.EventType.CLOSE,(()=>{E||(E=!0,Oe(fr,`RPC '${e}' stream ${i} transport closed`),b.o_(),this.E_(m))})),yl(m,_l.EventType.ERROR,(M=>{E||(E=!0,ql(fr,`RPC '${e}' stream ${i} transport errored. Name:`,M.name,"Message:",M.message),b.o_(new We(Te.UNAVAILABLE,"The operation could not be completed")))})),yl(m,_l.EventType.MESSAGE,(M=>{if(!E){const D=M.data[0];ht(!!D,16349);const w=D,A=w?.error||w[0]?.error;if(A){Oe(fr,`RPC '${e}' stream ${i} received error:`,A);const I=A.status;let V=(function(U){const R=zn[U];if(R!==void 0)return $b(R)})(I),q=A.message;V===void 0&&(V=Te.INTERNAL,q="Unknown error status: "+I+" with message "+A.message),E=!0,b.o_(new We(V,q)),m.close()}else Oe(fr,`RPC '${e}' stream ${i} received:`,D),b.__(D)}})),tu.u_(),setTimeout((()=>{b.s_()}),0),b}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,n){super.Go(e,t,n),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return $1()}}function Gk(r){return new tu(r)}function Px(){return typeof window<"u"?window:null}function Qh(){return typeof document<"u"?document:null}function tf(r){return new JR(r,!0)}tu.c_=!1;class Ox{constructor(e,t,n=1e3,i=1.5,o=6e4){this.Ci=e,this.timerId=t,this.R_=n,this.A_=i,this.V_=o,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),n=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-n);i>0&&Oe("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const nE="PersistentStream";class Lx{constructor(e,t,n,i,o,u,l,c){this.Ci=e,this.b_=n,this.S_=i,this.connection=o,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Ox(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===Te.RESOURCE_EXHAUSTED?(Vn(t.toString()),Vn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Te.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,i])=>{this.D_===t&&this.G_(n,i)}),(n=>{e((()=>{const i=new We(Te.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(i)}))}))}G_(e,t){const n=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{n((()=>this.listener.Zo()))})),this.stream.Yo((()=>{n((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((i=>{n((()=>this.z_(i)))})),this.stream.onMessage((i=>{n((()=>++this.F_==1?this.H_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Oe(nE,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(Oe(nE,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Kk extends Lx{constructor(e,t,n,i,o,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,u),this.serializer=o}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=nk(this.serializer,e),n=(function(o){if(!("targetChange"in o))return vt.min();const u=o.targetChange;return u.targetIds&&u.targetIds.length?vt.min():u.readTime?Tr(u.readTime):vt.min()})(e);return this.listener.J_(t,n)}Z_(e){const t={};t.database=Cg(this.serializer),t.addTarget=(function(o,u){let l;const c=u.target;if(l=md(c)?{documents:Jb(o,c)}:{query:ex(o,c).ft},l.targetId=u.targetId,u.resumeToken.approximateByteSize()>0){l.resumeToken=Kb(o,u.resumeToken);const d=Sg(o,u.expectedCount);d!==null&&(l.expectedCount=d)}else if(u.snapshotVersion.compareTo(vt.min())>0){l.readTime=yu(o,u.snapshotVersion.toTimestamp());const d=Sg(o,u.expectedCount);d!==null&&(l.expectedCount=d)}return l})(this.serializer,e);const n=ik(this.serializer,e);n&&(t.labels=n),this.K_(t)}X_(e){const t={};t.database=Cg(this.serializer),t.removeTarget=e,this.K_(t)}}class Qk extends Lx{constructor(e,t,n,i,o,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,u),this.serializer=o}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return ht(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ht(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ht(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=rk(e.writeResults,e.commitTime),n=Tr(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=Cg(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((n=>yd(this.serializer,n)))};this.K_(t)}}class Yk{}class Xk extends Yk{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new We(Te.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,n,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,u])=>this.connection.Wo(e,Ig(t,n),i,o,u))).catch((o=>{throw o.name==="FirebaseError"?(o.code===Te.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new We(Te.UNKNOWN,o.toString())}))}jo(e,t,n,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,l])=>this.connection.jo(e,Ig(t,n),i,u,l,o))).catch((u=>{throw u.name==="FirebaseError"?(u.code===Te.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new We(Te.UNKNOWN,u.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function Zk(r,e,t,n){return new Xk(r,e,t,n)}class Jk{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Vn(t),this.aa=!1):Oe("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const na="RemoteStore";class eN{constructor(e,t,n,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=o,this.Aa.Mo((u=>{n.enqueueAndForget((async()=>{ia(this)&&(Oe(na,"Restarting streams for network reachability change."),await(async function(c){const d=ot(c);d.Ea.add(4),await mc(d),d.Va.set("Unknown"),d.Ea.delete(4),await nf(d)})(this))}))})),this.Va=new Jk(n,i)}}async function nf(r){if(ia(r))for(const e of r.Ra)await e(!0)}async function mc(r){for(const e of r.Ra)await e(!1)}function rf(r,e){const t=ot(r);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Pv(t)?Nv(t):Ru(t).O_()&&kv(t,e))}function wu(r,e){const t=ot(r),n=Ru(t);t.Ia.delete(e),n.O_()&&Vx(t,e),t.Ia.size===0&&(n.O_()?n.L_():ia(t)&&t.Va.set("Unknown"))}function kv(r,e){if(r.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(vt.min())>0){const t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ru(r).Z_(e)}function Vx(r,e){r.da.$e(e),Ru(r).X_(e)}function Nv(r){r.da=new QR({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),At:e=>r.Ia.get(e)||null,ht:()=>r.datastore.serializer.databaseId}),Ru(r).start(),r.Va.ua()}function Pv(r){return ia(r)&&!Ru(r).x_()&&r.Ia.size>0}function ia(r){return ot(r).Ea.size===0}function Fx(r){r.da=void 0}async function tN(r){r.Va.set("Online")}async function nN(r){r.Ia.forEach(((e,t)=>{kv(r,e)}))}async function rN(r,e){Fx(r),Pv(r)?(r.Va.ha(e),Nv(r)):r.Va.set("Unknown")}async function iN(r,e,t){if(r.Va.set("Online"),e instanceof Gb&&e.state===2&&e.cause)try{await(async function(i,o){const u=o.cause;for(const l of o.targetIds)i.Ia.has(l)&&(await i.remoteSyncer.rejectListen(l,u),i.Ia.delete(l),i.da.removeTarget(l))})(r,e)}catch(n){Oe(na,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Sd(r,n)}else if(e instanceof Gh?r.da.Xe(e):e instanceof Hb?r.da.st(e):r.da.tt(e),!t.isEqual(vt.min()))try{const n=await Ax(r.localStore);t.compareTo(n)>=0&&await(function(o,u){const l=o.da.Tt(u);return l.targetChanges.forEach(((c,d)=>{if(c.resumeToken.approximateByteSize()>0){const m=o.Ia.get(d);m&&o.Ia.set(d,m.withResumeToken(c.resumeToken,u))}})),l.targetMismatches.forEach(((c,d)=>{const m=o.Ia.get(c);if(!m)return;o.Ia.set(c,m.withResumeToken(Fn.EMPTY_BYTE_STRING,m.snapshotVersion)),Vx(o,c);const g=new fs(m.target,c,d,m.sequenceNumber);kv(o,g)})),o.remoteSyncer.applyRemoteEvent(l)})(r,t)}catch(n){Oe(na,"Failed to raise snapshot:",n),await Sd(r,n)}}async function Sd(r,e,t){if(!ho(e))throw e;r.Ea.add(1),await mc(r),r.Va.set("Offline"),t||(t=()=>Ax(r.localStore)),r.asyncQueue.enqueueRetryable((async()=>{Oe(na,"Retrying IndexedDB access"),await t(),r.Ea.delete(1),await nf(r)}))}function Mx(r,e){return e().catch((t=>Sd(r,t,e)))}async function Du(r){const e=ot(r),t=oo(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:$o;for(;sN(e);)try{const i=await jk(e.localStore,n);if(i===null){e.Ta.length===0&&t.L_();break}n=i.batchId,oN(e,i)}catch(i){await Sd(e,i)}Bx(e)&&zx(e)}function sN(r){return ia(r)&&r.Ta.length<10}function oN(r,e){r.Ta.push(e);const t=oo(r);t.O_()&&t.Y_&&t.ea(e.mutations)}function Bx(r){return ia(r)&&!oo(r).x_()&&r.Ta.length>0}function zx(r){oo(r).start()}async function aN(r){oo(r).ra()}async function uN(r){const e=oo(r);for(const t of r.Ta)e.ea(t.mutations)}async function lN(r,e,t){const n=r.Ta.shift(),i=_v.from(n,e,t);await Mx(r,(()=>r.remoteSyncer.applySuccessfulWrite(i))),await Du(r)}async function cN(r,e){e&&oo(r).Y_&&await(async function(n,i){if((function(u){return HR(u)&&u!==Te.ABORTED})(i.code)){const o=n.Ta.shift();oo(n).B_(),await Mx(n,(()=>n.remoteSyncer.rejectFailedWrite(o.batchId,i))),await Du(n)}})(r,e),Bx(r)&&zx(r)}async function rE(r,e){const t=ot(r);t.asyncQueue.verifyOperationInProgress(),Oe(na,"RemoteStore received new credentials");const n=ia(t);t.Ea.add(3),await mc(t),n&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await nf(t)}async function Vg(r,e){const t=ot(r);e?(t.Ea.delete(2),await nf(t)):e||(t.Ea.add(2),await mc(t),t.Va.set("Unknown"))}function Ru(r){return r.ma||(r.ma=(function(t,n,i){const o=ot(t);return o.sa(),new Kk(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)})(r.datastore,r.asyncQueue,{Zo:tN.bind(null,r),Yo:nN.bind(null,r),t_:rN.bind(null,r),J_:iN.bind(null,r)}),r.Ra.push((async e=>{e?(r.ma.B_(),Pv(r)?Nv(r):r.Va.set("Unknown")):(await r.ma.stop(),Fx(r))}))),r.ma}function oo(r){return r.fa||(r.fa=(function(t,n,i){const o=ot(t);return o.sa(),new Qk(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)})(r.datastore,r.asyncQueue,{Zo:()=>Promise.resolve(),Yo:aN.bind(null,r),t_:cN.bind(null,r),ta:uN.bind(null,r),na:lN.bind(null,r)}),r.Ra.push((async e=>{e?(r.fa.B_(),await Du(r)):(await r.fa.stop(),r.Ta.length>0&&(Oe(na,`Stopping write stream with ${r.Ta.length} pending writes`),r.Ta=[]))}))),r.fa}class Ov{constructor(e,t,n,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=o,this.deferred=new Ui,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((u=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,i,o){const u=Date.now()+n,l=new Ov(e,t,u,i,o);return l.start(n),l}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new We(Te.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Lv(r,e){if(Vn("AsyncQueue",`${e}: ${r}`),ho(r))return new We(Te.UNAVAILABLE,`${e}: ${r}`);throw r}class nu{static emptySet(e){return new nu(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||Qe.comparator(t.key,n.key):(t,n)=>Qe.comparator(t.key,n.key),this.keyedMap=wl(),this.sortedSet=new fn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof nu)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,o=n.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new nu;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class iE{constructor(){this.ga=new fn(Qe.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(t,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(t):e.type===1&&n.type===2?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):rt(63341,{Vt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,n)=>{e.push(n)})),e}}class Eu{constructor(e,t,n,i,o,u,l,c,d){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=o,this.fromCache=u,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=d}static fromInitialDocuments(e,t,n,i,o){const u=[];return t.forEach((l=>{u.push({type:0,doc:l})})),new Eu(e,t,nu.emptySet(t),u,n,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Kd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==n[i].type||!t[i].doc.isEqual(n[i].doc))return!1;return!0}}class hN{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class dN{constructor(){this.queries=sE(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,n){const i=ot(t),o=i.queries;i.queries=sE(),o.forEach(((u,l)=>{for(const c of l.ba)c.onError(n)}))})(this,new We(Te.ABORTED,"Firestore shutting down"))}}function sE(){return new Es((r=>kb(r)),Kd)}async function Vv(r,e){const t=ot(r);let n=3;const i=e.query;let o=t.queries.get(i);o?!o.Sa()&&e.Da()&&(n=2):(o=new hN,n=e.Da()?0:1);try{switch(n){case 0:o.wa=await t.onListen(i,!0);break;case 1:o.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(u){const l=Lv(u,`Initialization of query '${Ya(e.query)}' failed`);return void e.onError(l)}t.queries.set(i,o),o.ba.push(e),e.va(t.onlineState),o.wa&&e.Fa(o.wa)&&Mv(t)}async function Fv(r,e){const t=ot(r),n=e.query;let i=3;const o=t.queries.get(n);if(o){const u=o.ba.indexOf(e);u>=0&&(o.ba.splice(u,1),o.ba.length===0?i=e.Da()?0:1:!o.Sa()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function fN(r,e){const t=ot(r);let n=!1;for(const i of e){const o=i.query,u=t.queries.get(o);if(u){for(const l of u.ba)l.Fa(i)&&(n=!0);u.wa=i}}n&&Mv(t)}function pN(r,e,t){const n=ot(r),i=n.queries.get(e);if(i)for(const o of i.ba)o.onError(t);n.queries.delete(e)}function Mv(r){r.Ca.forEach((e=>{e.next()}))}var Fg,oE;(oE=Fg||(Fg={})).Ma="default",oE.Cache="cache";class Bv{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new Eu(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const n=t!=="Offline";return(!this.options.Ka||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Eu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Fg.Cache}}class Ux{constructor(e){this.key=e}}class jx{constructor(e){this.key=e}}class mN{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Pt(),this.mutatedKeys=Pt(),this.eu=Pb(e),this.tu=new nu(this.eu)}get nu(){return this.Za}ru(e,t){const n=t?t.iu:new iE,i=t?t.tu:this.tu;let o=t?t.mutatedKeys:this.mutatedKeys,u=i,l=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((m,g)=>{const E=i.get(m),b=dc(this.query,g)?g:null,M=!!E&&this.mutatedKeys.has(E.key),D=!!b&&(b.hasLocalMutations||this.mutatedKeys.has(b.key)&&b.hasCommittedMutations);let w=!1;E&&b?E.data.isEqual(b.data)?M!==D&&(n.track({type:3,doc:b}),w=!0):this.su(E,b)||(n.track({type:2,doc:b}),w=!0,(c&&this.eu(b,c)>0||d&&this.eu(b,d)<0)&&(l=!0)):!E&&b?(n.track({type:0,doc:b}),w=!0):E&&!b&&(n.track({type:1,doc:E}),w=!0,(c||d)&&(l=!0)),w&&(b?(u=u.add(b),o=D?o.add(m):o.delete(m)):(u=u.delete(m),o=o.delete(m)))})),this.query.limit!==null)for(;u.size>this.query.limit;){const m=this.query.limitType==="F"?u.last():u.first();u=u.delete(m.key),o=o.delete(m.key),n.track({type:1,doc:m})}return{tu:u,iu:n,Ss:l,mutatedKeys:o}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,i){const o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const u=e.iu.ya();u.sort(((m,g)=>(function(b,M){const D=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return rt(20277,{Vt:w})}};return D(b)-D(M)})(m.type,g.type)||this.eu(m.doc,g.doc))),this.ou(n),i=i??!1;const l=t&&!i?this._u():[],c=this.Ya.size===0&&this.current&&!i?1:0,d=c!==this.Xa;return this.Xa=c,u.length!==0||d?{snapshot:new Eu(this.query,e.tu,o,u,e.mutatedKeys,c===0,d,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:l}:{au:l}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new iE,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=Pt(),this.tu.forEach((n=>{this.uu(n.key)&&(this.Ya=this.Ya.add(n.key))}));const t=[];return e.forEach((n=>{this.Ya.has(n)||t.push(new jx(n))})),this.Ya.forEach((n=>{e.has(n)||t.push(new Ux(n))})),t}cu(e){this.Za=e.ks,this.Ya=Pt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Eu.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const ku="SyncEngine";class gN{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class vN{constructor(e){this.key=e,this.hu=!1}}class yN{constructor(e,t,n,i,o,u){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=u,this.Pu={},this.Tu=new Es((l=>kb(l)),Kd),this.Iu=new Map,this.Eu=new Set,this.Ru=new fn(Qe.comparator),this.Au=new Map,this.Vu=new Av,this.du={},this.mu=new Map,this.fu=ta.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function _N(r,e,t=!0){const n=sf(r);let i;const o=n.Tu.get(e);return o?(n.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.lu()):i=await qx(n,e,t,!0),i}async function wN(r,e){const t=sf(r);await qx(t,e,!0,!1)}async function qx(r,e,t,n){const i=await xd(r.localStore,Gr(e)),o=i.targetId,u=r.sharedClientState.addLocalQueryTarget(o,t);let l;return n&&(l=await zv(r,e,o,u==="current",i.resumeToken)),r.isPrimaryClient&&t&&rf(r.remoteStore,i),l}async function zv(r,e,t,n,i){r.pu=(g,E,b)=>(async function(D,w,A,I){let V=w.view.ru(A);V.Ss&&(V=await Pg(D.localStore,w.query,!1).then((({documents:R})=>w.view.ru(R,V))));const q=I&&I.targetChanges.get(w.targetId),P=I&&I.targetMismatches.get(w.targetId)!=null,U=w.view.applyChanges(V,D.isPrimaryClient,q,P);return Mg(D,w.targetId,U.au),U.snapshot})(r,g,E,b);const o=await Pg(r.localStore,e,!0),u=new mN(e,o.ks),l=u.ru(o.documents),c=pc.createSynthesizedTargetChangeForCurrentChange(t,n&&r.onlineState!=="Offline",i),d=u.applyChanges(l,r.isPrimaryClient,c);Mg(r,t,d.au);const m=new gN(e,t,u);return r.Tu.set(e,m),r.Iu.has(t)?r.Iu.get(t).push(e):r.Iu.set(t,[e]),d.snapshot}async function EN(r,e,t){const n=ot(r),i=n.Tu.get(e),o=n.Iu.get(i.targetId);if(o.length>1)return n.Iu.set(i.targetId,o.filter((u=>!Kd(u,e)))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await _u(n.localStore,i.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(i.targetId),t&&wu(n.remoteStore,i.targetId),bu(n,i.targetId)})).catch(co)):(bu(n,i.targetId),await _u(n.localStore,i.targetId,!0))}async function bN(r,e){const t=ot(r),n=t.Tu.get(e),i=t.Iu.get(n.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),wu(t.remoteStore,n.targetId))}async function xN(r,e,t){const n=Wv(r);try{const i=await(function(u,l){const c=ot(u),d=nn.now(),m=l.reduce(((b,M)=>b.add(M.key)),Pt());let g,E;return c.persistence.runTransaction("Locally write mutations","readwrite",(b=>{let M=$r(),D=Pt();return c.xs.getEntries(b,m).next((w=>{M=w,M.forEach(((A,I)=>{I.isValidDocument()||(D=D.add(A))}))})).next((()=>c.localDocuments.getOverlayedDocuments(b,M))).next((w=>{g=w;const A=[];for(const I of l){const V=WR(I,g.get(I.key).overlayedDocument);V!=null&&A.push(new bs(I.key,V,Eb(V.value.mapValue),xr.exists(!0)))}return c.mutationQueue.addMutationBatch(b,d,A,l)})).next((w=>{E=w;const A=w.applyToLocalDocumentSet(g,D);return c.documentOverlayCache.saveOverlays(b,w.batchId,A)}))})).then((()=>({batchId:E.batchId,changes:Lb(g)})))})(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),(function(u,l,c){let d=u.du[u.currentUser.toKey()];d||(d=new fn(Ct)),d=d.insert(l,c),u.du[u.currentUser.toKey()]=d})(n,i.batchId,t),await po(n,i.changes),await Du(n.remoteStore)}catch(i){const o=Lv(i,"Failed to persist write");t.reject(o)}}async function Wx(r,e){const t=ot(r);try{const n=await zk(t.localStore,e);e.targetChanges.forEach(((i,o)=>{const u=t.Au.get(o);u&&(ht(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?u.hu=!0:i.modifiedDocuments.size>0?ht(u.hu,14607):i.removedDocuments.size>0&&(ht(u.hu,42227),u.hu=!1))})),await po(t,n,e)}catch(n){await co(n)}}function aE(r,e,t){const n=ot(r);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const i=[];n.Tu.forEach(((o,u)=>{const l=u.view.va(e);l.snapshot&&i.push(l.snapshot)})),(function(u,l){const c=ot(u);c.onlineState=l;let d=!1;c.queries.forEach(((m,g)=>{for(const E of g.ba)E.va(l)&&(d=!0)})),d&&Mv(c)})(n.eventManager,e),i.length&&n.Pu.J_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function TN(r,e,t){const n=ot(r);n.sharedClientState.updateQueryState(e,"rejected",t);const i=n.Au.get(e),o=i&&i.key;if(o){let u=new fn(Qe.comparator);u=u.insert(o,Rn.newNoDocument(o,vt.min()));const l=Pt().add(o),c=new fc(vt.min(),new Map,new fn(Ct),u,l);await Wx(n,c),n.Ru=n.Ru.remove(o),n.Au.delete(e),qv(n)}else await _u(n.localStore,e,!1).then((()=>bu(n,e,t))).catch(co)}async function AN(r,e){const t=ot(r),n=e.batch.batchId;try{const i=await Bk(t.localStore,e);jv(t,n,null),Uv(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await po(t,i)}catch(i){await co(i)}}async function SN(r,e,t){const n=ot(r);try{const i=await(function(u,l){const c=ot(u);return c.persistence.runTransaction("Reject batch","readwrite-primary",(d=>{let m;return c.mutationQueue.lookupMutationBatch(d,l).next((g=>(ht(g!==null,37113),m=g.keys(),c.mutationQueue.removeMutationBatch(d,g)))).next((()=>c.mutationQueue.performConsistencyCheck(d))).next((()=>c.documentOverlayCache.removeOverlaysForBatchId(d,m,l))).next((()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,m))).next((()=>c.localDocuments.getDocuments(d,m)))}))})(n.localStore,e);jv(n,e,t),Uv(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await po(n,i)}catch(i){await co(i)}}function Uv(r,e){(r.mu.get(e)||[]).forEach((t=>{t.resolve()})),r.mu.delete(e)}function jv(r,e,t){const n=ot(r);let i=n.du[n.currentUser.toKey()];if(i){const o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),n.du[n.currentUser.toKey()]=i}}function bu(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(const n of r.Iu.get(e))r.Tu.delete(n),t&&r.Pu.yu(n,t);r.Iu.delete(e),r.isPrimaryClient&&r.Vu.Gr(e).forEach((n=>{r.Vu.containsKey(n)||$x(r,n)}))}function $x(r,e){r.Eu.delete(e.path.canonicalString());const t=r.Ru.get(e);t!==null&&(wu(r.remoteStore,t),r.Ru=r.Ru.remove(e),r.Au.delete(t),qv(r))}function Mg(r,e,t){for(const n of t)n instanceof Ux?(r.Vu.addReference(n.key,e),IN(r,n)):n instanceof jx?(Oe(ku,"Document no longer in limbo: "+n.key),r.Vu.removeReference(n.key,e),r.Vu.containsKey(n.key)||$x(r,n.key)):rt(19791,{wu:n})}function IN(r,e){const t=e.key,n=t.path.canonicalString();r.Ru.get(t)||r.Eu.has(n)||(Oe(ku,"New document in limbo: "+t),r.Eu.add(n),qv(r))}function qv(r){for(;r.Eu.size>0&&r.Ru.size<r.maxConcurrentLimboResolutions;){const e=r.Eu.values().next().value;r.Eu.delete(e);const t=new Qe(Jt.fromString(e)),n=r.fu.next();r.Au.set(n,new vN(t)),r.Ru=r.Ru.insert(t,n),rf(r.remoteStore,new fs(Gr(hc(t.path)),n,"TargetPurposeLimboResolution",kr.ce))}}async function po(r,e,t){const n=ot(r),i=[],o=[],u=[];n.Tu.isEmpty()||(n.Tu.forEach(((l,c)=>{u.push(n.pu(c,e,t).then((d=>{if((d||t)&&n.isPrimaryClient){const m=d?!d.fromCache:t?.targetChanges.get(c.targetId)?.current;n.sharedClientState.updateQueryState(c.targetId,m?"current":"not-current")}if(d){i.push(d);const m=Cv.Es(c.targetId,d);o.push(m)}})))})),await Promise.all(u),n.Pu.J_(i),await(async function(c,d){const m=ot(c);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",(g=>fe.forEach(d,(E=>fe.forEach(E.Ts,(b=>m.persistence.referenceDelegate.addReference(g,E.targetId,b))).next((()=>fe.forEach(E.Is,(b=>m.persistence.referenceDelegate.removeReference(g,E.targetId,b)))))))))}catch(g){if(!ho(g))throw g;Oe(Dv,"Failed to update sequence numbers: "+g)}for(const g of d){const E=g.targetId;if(!g.fromCache){const b=m.vs.get(E),M=b.snapshotVersion,D=b.withLastLimboFreeSnapshotVersion(M);m.vs=m.vs.insert(E,D)}}})(n.localStore,o))}async function CN(r,e){const t=ot(r);if(!t.currentUser.isEqual(e)){Oe(ku,"User change. New user:",e.toKey());const n=await Tx(t.localStore,e);t.currentUser=e,(function(o,u){o.mu.forEach((l=>{l.forEach((c=>{c.reject(new We(Te.CANCELLED,u))}))})),o.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await po(t,n.Ns)}}function DN(r,e){const t=ot(r),n=t.Au.get(e);if(n&&n.hu)return Pt().add(n.key);{let i=Pt();const o=t.Iu.get(e);if(!o)return i;for(const u of o){const l=t.Tu.get(u);i=i.unionWith(l.view.nu)}return i}}async function RN(r,e){const t=ot(r),n=await Pg(t.localStore,e.query,!0),i=e.view.cu(n);return t.isPrimaryClient&&Mg(t,e.targetId,i.au),i}async function kN(r,e){const t=ot(r);return Ix(t.localStore,e).then((n=>po(t,n)))}async function NN(r,e,t,n){const i=ot(r),o=await(function(l,c){const d=ot(l),m=ot(d.mutationQueue);return d.persistence.runTransaction("Lookup mutation documents","readonly",(g=>m.Xn(g,c).next((E=>E?d.localDocuments.getDocuments(g,E):fe.resolve(null)))))})(i.localStore,e);o!==null?(t==="pending"?await Du(i.remoteStore):t==="acknowledged"||t==="rejected"?(jv(i,e,n||null),Uv(i,e),(function(l,c){ot(ot(l).mutationQueue).nr(c)})(i.localStore,e)):rt(6720,"Unknown batchState",{bu:t}),await po(i,o)):Oe(ku,"Cannot apply mutation batch with id: "+e)}async function PN(r,e){const t=ot(r);if(sf(t),Wv(t),e===!0&&t.gu!==!0){const n=t.sharedClientState.getAllActiveQueryTargets(),i=await uE(t,n.toArray());t.gu=!0,await Vg(t.remoteStore,!0);for(const o of i)rf(t.remoteStore,o)}else if(e===!1&&t.gu!==!1){const n=[];let i=Promise.resolve();t.Iu.forEach(((o,u)=>{t.sharedClientState.isLocalQueryTarget(u)?n.push(u):i=i.then((()=>(bu(t,u),_u(t.localStore,u,!0)))),wu(t.remoteStore,u)})),await i,await uE(t,n),(function(u){const l=ot(u);l.Au.forEach(((c,d)=>{wu(l.remoteStore,d)})),l.Vu.zr(),l.Au=new Map,l.Ru=new fn(Qe.comparator)})(t),t.gu=!1,await Vg(t.remoteStore,!1)}}async function uE(r,e,t){const n=ot(r),i=[],o=[];for(const u of e){let l;const c=n.Iu.get(u);if(c&&c.length!==0){l=await xd(n.localStore,Gr(c[0]));for(const d of c){const m=n.Tu.get(d),g=await RN(n,m);g.snapshot&&o.push(g.snapshot)}}else{const d=await Sx(n.localStore,u);l=await xd(n.localStore,d),await zv(n,Hx(d),u,!1,l.resumeToken)}i.push(l)}return n.Pu.J_(o),i}function Hx(r){return Db(r.path,r.collectionGroup,r.orderBy,r.filters,r.limit,"F",r.startAt,r.endAt)}function ON(r){return(function(t){return ot(ot(t).persistence).hs()})(ot(r).localStore)}async function LN(r,e,t,n){const i=ot(r);if(i.gu)return void Oe(ku,"Ignoring unexpected query state notification.");const o=i.Iu.get(e);if(o&&o.length>0)switch(t){case"current":case"not-current":{const u=await Ix(i.localStore,Nb(o[0])),l=fc.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Fn.EMPTY_BYTE_STRING);await po(i,u,l);break}case"rejected":await _u(i.localStore,e,!0),bu(i,e,n);break;default:rt(64155,t)}}async function VN(r,e,t){const n=sf(r);if(n.gu){for(const i of e){if(n.Iu.has(i)&&n.sharedClientState.isActiveQueryTarget(i)){Oe(ku,"Adding an already active target "+i);continue}const o=await Sx(n.localStore,i),u=await xd(n.localStore,o);await zv(n,Hx(o),u.targetId,!1,u.resumeToken),rf(n.remoteStore,u)}for(const i of t)n.Iu.has(i)&&await _u(n.localStore,i,!1).then((()=>{wu(n.remoteStore,i),bu(n,i)})).catch(co)}}function sf(r){const e=ot(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=Wx.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=DN.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=TN.bind(null,e),e.Pu.J_=fN.bind(null,e.eventManager),e.Pu.yu=pN.bind(null,e.eventManager),e}function Wv(r){const e=ot(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=AN.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=SN.bind(null,e),e}class nc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=tf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return xx(this.persistence,new bx,e.initialUser,this.serializer)}Cu(e){return new Sv(ef.Vi,this.serializer)}Du(e){return new Nx}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}nc.provider={build:()=>new nc};class FN extends nc{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){ht(this.persistence.referenceDelegate instanceof bd,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new gx(n,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?mr.withCacheSize(this.cacheSizeBytes):mr.DEFAULT;return new Sv((n=>bd.Vi(n,t)),this.serializer)}}class Gx extends nc{constructor(e,t,n){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await Wv(this.xu.syncEngine),await Du(this.xu.remoteStore),await this.persistence.zi((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return xx(this.persistence,new bx,e.initialUser,this.serializer)}Fu(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new gx(n,e.asyncQueue,t)}Mu(e,t){const n=new qD(t,this.persistence);return new jD(e.asyncQueue,n)}Cu(e){const t=Ex(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?mr.withCacheSize(this.cacheSizeBytes):mr.DEFAULT;return new Iv(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,Px(),Qh(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new Nx}}class MN extends Gx{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof zm&&(this.sharedClientState.syncEngine={So:NN.bind(null,t),Do:LN.bind(null,t),Co:VN.bind(null,t),hs:ON.bind(null,t),bo:kN.bind(null,t)},await this.sharedClientState.start()),await this.persistence.zi((async n=>{await PN(this.xu.syncEngine,n),this.gcScheduler&&(n&&!this.gcScheduler.started?this.gcScheduler.start():n||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(n&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():n||this.indexBackfillerScheduler.stop())}))}Du(e){const t=Px();if(!zm.v(t))throw new We(Te.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=Ex(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new zm(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class rc{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>aE(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=CN.bind(null,this.syncEngine),await Vg(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new dN})()}createDatastore(e){const t=tf(e.databaseInfo.databaseId),n=Gk(e.databaseInfo);return Zk(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return(function(n,i,o,u,l){return new eN(n,i,o,u,l)})(this.localStore,this.datastore,e.asyncQueue,(t=>aE(this.syncEngine,t,0)),(function(){return tE.v()?new tE:new qk})())}createSyncEngine(e,t){return(function(i,o,u,l,c,d,m){const g=new yN(i,o,u,l,c,d);return m&&(g.gu=!0),g})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const n=ot(t);Oe(na,"RemoteStore shutting down."),n.Ea.add(5),await mc(n),n.Aa.shutdown(),n.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}rc.provider={build:()=>new rc};class of{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Vn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const ao="FirestoreClient";class BN{constructor(e,t,n,i,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this._databaseInfo=i,this.user=pr.UNAUTHENTICATED,this.clientId=sv.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(n,(async u=>{Oe(ao,"Received user=",u.uid),await this.authCredentialListener(u),this.user=u})),this.appCheckCredentials.start(n,(u=>(Oe(ao,"Received new app check token=",u),this.appCheckCredentialListener(u,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ui;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=Lv(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function jm(r,e){r.asyncQueue.verifyOperationInProgress(),Oe(ao,"Initializing OfflineComponentProvider");const t=r.configuration;await e.initialize(t);let n=t.initialUser;r.setCredentialChangeListener((async i=>{n.isEqual(i)||(await Tx(e.localStore,i),n=i)})),e.persistence.setDatabaseDeletedListener((()=>r.terminate())),r._offlineComponents=e}async function lE(r,e){r.asyncQueue.verifyOperationInProgress();const t=await zN(r);Oe(ao,"Initializing OnlineComponentProvider"),await e.initialize(t,r.configuration),r.setCredentialChangeListener((n=>rE(e.remoteStore,n))),r.setAppCheckTokenChangeListener(((n,i)=>rE(e.remoteStore,i))),r._onlineComponents=e}async function zN(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){Oe(ao,"Using user provided OfflineComponentProvider");try{await jm(r,r._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===Te.FAILED_PRECONDITION||i.code===Te.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;ql("Error using user provided cache. Falling back to memory cache: "+t),await jm(r,new nc)}}else Oe(ao,"Using default OfflineComponentProvider"),await jm(r,new FN(void 0));return r._offlineComponents}async function Kx(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(Oe(ao,"Using user provided OnlineComponentProvider"),await lE(r,r._uninitializedComponentsProvider._online)):(Oe(ao,"Using default OnlineComponentProvider"),await lE(r,new rc))),r._onlineComponents}function UN(r){return Kx(r).then((e=>e.syncEngine))}async function xu(r){const e=await Kx(r),t=e.eventManager;return t.onListen=_N.bind(null,e.syncEngine),t.onUnlisten=EN.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=wN.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=bN.bind(null,e.syncEngine),t}function jN(r,e,t,n){const i=new of(n),o=new Bv(e,i,t);return r.asyncQueue.enqueueAndForget((async()=>Vv(await xu(r),o))),()=>{i.Nu(),r.asyncQueue.enqueueAndForget((async()=>Fv(await xu(r),o)))}}function qN(r,e,t={}){const n=new Ui;return r.asyncQueue.enqueueAndForget((async()=>(function(o,u,l,c,d){const m=new of({next:E=>{m.Nu(),u.enqueueAndForget((()=>Fv(o,g)));const b=E.docs.has(l);!b&&E.fromCache?d.reject(new We(Te.UNAVAILABLE,"Failed to get document because the client is offline.")):b&&E.fromCache&&c&&c.source==="server"?d.reject(new We(Te.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(E)},error:E=>d.reject(E)}),g=new Bv(hc(l.path),m,{includeMetadataChanges:!0,Ka:!0});return Vv(o,g)})(await xu(r),r.asyncQueue,e,t,n))),n.promise}function WN(r,e,t={}){const n=new Ui;return r.asyncQueue.enqueueAndForget((async()=>(function(o,u,l,c,d){const m=new of({next:E=>{m.Nu(),u.enqueueAndForget((()=>Fv(o,g))),E.fromCache&&c.source==="server"?d.reject(new We(Te.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(E)},error:E=>d.reject(E)}),g=new Bv(l,m,{includeMetadataChanges:!0,Ka:!0});return Vv(o,g)})(await xu(r),r.asyncQueue,e,t,n))),n.promise}function $N(r,e){const t=new Ui;return r.asyncQueue.enqueueAndForget((async()=>xN(await UN(r),e,t))),t.promise}function HN(r,e){const t=new of(e);return r.asyncQueue.enqueueAndForget((async()=>(function(i,o){ot(i).Ca.add(o),o.next()})(await xu(r),t))),()=>{t.Nu(),r.asyncQueue.enqueueAndForget((async()=>(function(i,o){ot(i).Ca.delete(o)})(await xu(r),t)))}}function Qx(r){const e={};return r.timeoutSeconds!==void 0&&(e.timeoutSeconds=r.timeoutSeconds),e}const GN="ComponentProvider",cE=new Map;function KN(r,e,t,n,i){return new vR(r,e,t,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,Qx(i.experimentalLongPollingOptions),i.useFetchStreams,i.isUsingEmulator,n)}const QN="firestore.googleapis.com",hE=!0;class dE{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new We(Te.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=QN,this.ssl=hE}else this.host=e.host,this.ssl=e.ssl??hE;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=hx;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<mx)throw new We(Te.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}BD("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Qx(e.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new We(Te.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new We(Te.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new We(Te.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(n,i){return n.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class $v{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new dE({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new We(Te.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new We(Te.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new dE(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new RD;switch(n.type){case"firstParty":return new PD(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new We(Te.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const n=cE.get(t);n&&(Oe(GN,"Removing Datastore"),cE.delete(t),n.terminate())})(this),Promise.resolve()}}class mo{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new mo(this.firestore,e,this._query)}}class kn{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ro(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new kn(this.firestore,e,this._key)}toJSON(){return{type:kn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(uc(t,kn._jsonSchema))return new kn(e,n||null,new Qe(Jt.fromString(t.referencePath)))}}kn._jsonSchemaVersion="firestore/documentReference/1.0",kn._jsonSchema={type:Un("string",kn._jsonSchemaVersion),referencePath:Un("string")};class ro extends mo{constructor(e,t,n){super(e,t,hc(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new kn(this.firestore,null,new Qe(e))}withConverter(e){return new ro(this.firestore,e,this._path)}}function Hv(r,e,...t){if(r=Ti(r),K1("collection","path",e),r instanceof $v){const n=Jt.fromString(e,...t);return n2(n),new ro(r,null,n)}{if(!(r instanceof kn||r instanceof ro))throw new We(Te.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(Jt.fromString(e,...t));return n2(n),new ro(r.firestore,null,n)}}function Tu(r,e,...t){if(r=Ti(r),arguments.length===1&&(e=sv.newId()),K1("doc","path",e),r instanceof $v){const n=Jt.fromString(e,...t);return t2(n),new kn(r,null,new Qe(n))}{if(!(r instanceof kn||r instanceof ro))throw new We(Te.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(Jt.fromString(e,...t));return t2(n),new kn(r.firestore,r instanceof ro?r.converter:null,new Qe(n))}}const fE="AsyncQueue";class pE{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Ox(this,"async_queue_retry"),this._c=()=>{const n=Qh();n&&Oe(fE,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const t=Qh();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Qh();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Ui;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!ho(e))throw e;Oe(fE,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((n=>{throw this.nc=n,this.rc=!1,Vn("INTERNAL UNHANDLED ERROR: ",mE(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=Ov.createAndSchedule(this,e,t,n,(o=>this.hc(o)));return this.tc.push(i),i}uc(){this.nc&&rt(47125,{Pc:mE(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,n)=>t.targetTimeMs-n.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function mE(r){let e=r.message||"";return r.stack&&(e=r.stack.includes(r.message)?r.stack:r.message+`
`+r.stack),e}class ws extends $v{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new pE,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new pE(e),this._firestoreClient=void 0,await e}}}function YN(r,e,t){t||(t=pd);const n=O1(r,"firestore");if(n.isInitialized(t)){const i=n.getImmediate({identifier:t}),o=n.getOptions(t);if(ud(o,e))return i;throw new We(Te.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new We(Te.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<mx)throw new We(Te.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&Bd(e.host)&&A1(e.host),n.initialize({options:e,instanceIdentifier:t})}function gc(r){if(r._terminated)throw new We(Te.FAILED_PRECONDITION,"The client has already been terminated.");return r._firestoreClient||XN(r),r._firestoreClient}function XN(r){const e=r._freezeSettings(),t=KN(r._databaseId,r._app?.options.appId||"",r._persistenceKey,r._app?.options.apiKey,e);r._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(r._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),r._firestoreClient=new BN(r._authCredentials,r._appCheckCredentials,r._queue,t,r._componentsProvider&&(function(i){const o=i?._online.build();return{_offline:i?._offline.build(o),_online:o}})(r._componentsProvider))}class Wr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Wr(Fn.fromBase64String(e))}catch(t){throw new We(Te.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Wr(Fn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Wr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(uc(e,Wr._jsonSchema))return Wr.fromBase64String(e.bytes)}}Wr._jsonSchemaVersion="firestore/bytes/1.0",Wr._jsonSchema={type:Un("string",Wr._jsonSchemaVersion),bytes:Un("string")};class Gv{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new We(Te.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new In(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Kv{constructor(e){this._methodName=e}}class ji{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new We(Te.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new We(Te.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ct(this._lat,e._lat)||Ct(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ji._jsonSchemaVersion}}static fromJSON(e){if(uc(e,ji._jsonSchema))return new ji(e.latitude,e.longitude)}}ji._jsonSchemaVersion="firestore/geoPoint/1.0",ji._jsonSchema={type:Un("string",ji._jsonSchemaVersion),latitude:Un("number"),longitude:Un("number")};class xi{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(n,i){if(n.length!==i.length)return!1;for(let o=0;o<n.length;++o)if(n[o]!==i[o])return!1;return!0})(this._values,e._values)}toJSON(){return{type:xi._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(uc(e,xi._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new xi(e.vectorValues);throw new We(Te.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}xi._jsonSchemaVersion="firestore/vectorValue/1.0",xi._jsonSchema={type:Un("string",xi._jsonSchemaVersion),vectorValues:Un("object")};const ZN=/^__.*__$/;class JN{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new bs(e,this.data,this.fieldMask,t,this.fieldTransforms):new Cu(e,this.data,t,this.fieldTransforms)}}class Yx{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new bs(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Xx(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw rt(40011,{dataSource:r})}}class Qv{constructor(e,t,n,i,o,u){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,o===void 0&&this.validatePath(),this.fieldTransforms=o||[],this.fieldMask=u||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new Qv({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),n=this.contextWith({path:t,arrayElement:!1});return n.validatePathSegment(e),n}childContextForFieldPath(e){const t=this.path?.child(e),n=this.contextWith({path:t,arrayElement:!1});return n.validatePath(),n}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Id(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(Xx(this.dataSource)&&ZN.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class eP{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||tf(e)}createContext(e,t,n,i=!1){return new Qv({dataSource:e,methodName:t,targetDoc:n,path:In.emptyPath(),arrayElement:!1,hasConverter:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Yv(r){const e=r._freezeSettings(),t=tf(r._databaseId);return new eP(r._databaseId,!!e.ignoreUndefinedProperties,t)}function tP(r,e,t,n,i,o={}){const u=r.createContext(o.merge||o.mergeFields?2:0,e,t,i);Xv("Data must be an object, but it was:",u,n);const l=Zx(n,u);let c,d;if(o.merge)c=new Nr(u.fieldMask),d=u.fieldTransforms;else if(o.mergeFields){const m=[];for(const g of o.mergeFields){const E=Au(e,g,t);if(!u.contains(E))throw new We(Te.INVALID_ARGUMENT,`Field '${E}' is specified in your field mask but missing from your input data.`);tT(m,E)||m.push(E)}c=new Nr(m),d=u.fieldTransforms.filter((g=>c.covers(g.field)))}else c=null,d=u.fieldTransforms;return new JN(new gr(l),c,d)}class af extends Kv{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof af}}function nP(r,e,t,n){const i=r.createContext(1,e,t);Xv("Data must be an object, but it was:",i,n);const o=[],u=gr.empty();fo(n,((c,d)=>{const m=eT(e,c,t);d=Ti(d);const g=i.childContextForFieldPath(m);if(d instanceof af)o.push(m);else{const E=vc(d,g);E!=null&&(o.push(m),u.set(m,E))}}));const l=new Nr(o);return new Yx(u,l,i.fieldTransforms)}function rP(r,e,t,n,i,o){const u=r.createContext(1,e,t),l=[Au(e,n,t)],c=[i];if(o.length%2!=0)throw new We(Te.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let E=0;E<o.length;E+=2)l.push(Au(e,o[E])),c.push(o[E+1]);const d=[],m=gr.empty();for(let E=l.length-1;E>=0;--E)if(!tT(d,l[E])){const b=l[E];let M=c[E];M=Ti(M);const D=u.childContextForFieldPath(b);if(M instanceof af)d.push(b);else{const w=vc(M,D);w!=null&&(d.push(b),m.set(b,w))}}const g=new Nr(d);return new Yx(m,g,u.fieldTransforms)}function iP(r,e,t,n=!1){return vc(t,r.createContext(n?4:3,e))}function vc(r,e){if(Jx(r=Ti(r)))return Xv("Unsupported field value:",e,r),Zx(r,e);if(r instanceof Kv)return(function(n,i){if(!Xx(i.dataSource))throw i.createError(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.createError(`${n._methodName}() is not currently supported inside arrays`);const o=n._toFieldTransform(i);o&&i.fieldTransforms.push(o)})(r,e),null;if(r===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),r instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(n,i){const o=[];let u=0;for(const l of n){let c=vc(l,i.childContextForArray(u));c==null&&(c={nullValue:"NULL_VALUE"}),o.push(c),u++}return{arrayValue:{values:o}}})(r,e)}return(function(n,i){if((n=Ti(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return FR(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const o=nn.fromDate(n);return{timestampValue:yu(i.serializer,o)}}if(n instanceof nn){const o=new nn(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:yu(i.serializer,o)}}if(n instanceof ji)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Wr)return{bytesValue:Kb(i.serializer,n._byteString)};if(n instanceof kn){const o=i.databaseId,u=n.firestore._databaseId;if(!u.isEqual(o))throw i.createError(`Document reference is for database ${u.projectId}/${u.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:bv(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof xi)return(function(u,l){const c=u instanceof xi?u.toArray():u;return{mapValue:{fields:{[fv]:{stringValue:pv},[du]:{arrayValue:{values:c.map((m=>{if(typeof m!="number")throw l.createError("VectorValues must only contain numeric values.");return vv(l.serializer,m)}))}}}}}})(n,i);if(sx(n))return n._toProto(i.serializer);throw i.createError(`Unsupported field value: ${zd(n)}`)})(r,e)}function Zx(r,e){const t={};return db(r)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):fo(r,((n,i)=>{const o=vc(i,e.childContextForField(n));o!=null&&(t[n]=o)})),{mapValue:{fields:t}}}function Jx(r){return!(typeof r!="object"||r===null||r instanceof Array||r instanceof Date||r instanceof nn||r instanceof ji||r instanceof Wr||r instanceof kn||r instanceof Kv||r instanceof xi||sx(r))}function Xv(r,e,t){if(!Jx(t)||!Q1(t)){const n=zd(t);throw n==="an object"?e.createError(r+" a custom object"):e.createError(r+" "+n)}}function Au(r,e,t){if((e=Ti(e))instanceof Gv)return e._internalPath;if(typeof e=="string")return eT(r,e);throw Id("Field path arguments must be of type string or ",r,!1,void 0,t)}const sP=new RegExp("[~\\*/\\[\\]]");function eT(r,e,t){if(e.search(sP)>=0)throw Id(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,t);try{return new Gv(...e.split("."))._internalPath}catch{throw Id(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,t)}}function Id(r,e,t,n,i){const o=n&&!n.isEmpty(),u=i!==void 0;let l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(o||u)&&(c+=" (found",o&&(c+=` in field ${n}`),u&&(c+=` in document ${i}`),c+=")"),new We(Te.INVALID_ARGUMENT,l+r+c)}function tT(r,e){return r.some((t=>t.isEqual(e)))}class oP{convertValue(e,t="none"){switch(io(e)){case 0:return null;case 1:return e.booleanValue;case 2:return bn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(_s(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw rt(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return fo(e,((i,o)=>{n[i]=this.convertValue(o,t)})),n}convertVectorValue(e){const t=e.fields?.[du].arrayValue?.values?.map((n=>bn(n.doubleValue)));return new xi(t)}convertGeoPoint(e){return new ji(bn(e.latitude),bn(e.longitude))}convertArray(e,t){return(e.values||[]).map((n=>this.convertValue(n,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Hd(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Ql(e));default:return null}}convertTimestamp(e){const t=ys(e);return new nn(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Jt.fromString(e);ht(ix(n),9688,{name:e});const i=new Xo(n.get(1),n.get(3)),o=new Qe(n.popFirst(5));return i.isEqual(t)||Vn(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}}class Zv extends oP{constructor(e){super(),this.firestore=e}convertBytes(e){return new Wr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new kn(this.firestore,null,t)}}const gE="@firebase/firestore",vE="4.10.0";function Bg(r){return(function(t,n){if(typeof t!="object"||t===null)return!1;const i=t;for(const o of n)if(o in i&&typeof i[o]=="function")return!0;return!1})(r,["next","error","complete"])}class nT{constructor(e,t,n,i,o){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new kn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new aP(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field(Au("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class aP extends nT{data(){return super.data()}}function rT(r){if(r.limitType==="L"&&r.explicitOrderBy.length===0)throw new We(Te.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Jv{}class iT extends Jv{}function sT(r,e,...t){let n=[];e instanceof Jv&&n.push(e),n=n.concat(t),(function(o){const u=o.filter((c=>c instanceof ty)).length,l=o.filter((c=>c instanceof ey)).length;if(u>1||u>0&&l>0)throw new We(Te.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(n);for(const i of n)r=i._apply(r);return r}class ey extends iT{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new ey(e,t,n)}_apply(e){const t=this._parse(e);return oT(e._query,t),new mo(e.firestore,e.converter,Tg(e._query,t))}_parse(e){const t=Yv(e.firestore);return(function(o,u,l,c,d,m,g){let E;if(d.isKeyField()){if(m==="array-contains"||m==="array-contains-any")throw new We(Te.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if(m==="in"||m==="not-in"){_E(g,m);const M=[];for(const D of g)M.push(yE(c,o,D));E={arrayValue:{values:M}}}else E=yE(c,o,g)}else m!=="in"&&m!=="not-in"&&m!=="array-contains-any"||_E(g,m),E=iP(l,u,g,m==="in"||m==="not-in");return Ft.create(d,m,E)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}class ty extends Jv{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new ty(e,t)}_parse(e){const t=this._queryConstraints.map((n=>n._parse(e))).filter((n=>n.getFilters().length>0));return t.length===1?t[0]:rn.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(i,o){let u=i;const l=o.getFlattenedFilters();for(const c of l)oT(u,c),u=Tg(u,c)})(e._query,t),new mo(e.firestore,e.converter,Tg(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class ny extends iT{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new ny(e,t)}_apply(e){const t=(function(i,o,u){if(i.startAt!==null)throw new We(Te.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new We(Te.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Jl(o,u)})(e._query,this._field,this._direction);return new mo(e.firestore,e.converter,kR(e._query,t))}}function uP(r,e="asc"){const t=e,n=Au("orderBy",r);return ny._create(n,t)}function yE(r,e,t){if(typeof(t=Ti(t))=="string"){if(t==="")throw new We(Te.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Rb(e)&&t.indexOf("/")!==-1)throw new We(Te.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child(Jt.fromString(t));if(!Qe.isDocumentKey(n))throw new We(Te.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return Xl(r,new Qe(n))}if(t instanceof kn)return Xl(r,t._key);throw new We(Te.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${zd(t)}.`)}function _E(r,e){if(!Array.isArray(r)||r.length===0)throw new We(Te.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function oT(r,e){const t=(function(i,o){for(const u of i)for(const l of u.getFlattenedFilters())if(o.indexOf(l.op)>=0)return l.op;return null})(r.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new We(Te.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new We(Te.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function lP(r,e,t){let n;return n=r?t&&(t.merge||t.mergeFields)?r.toFirestore(e,t):r.toFirestore(e):e,n}class cP{constructor(e){let t;this.kind="persistent",e?.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=pP(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}function hP(r){return new cP(r)}class dP{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=rc.provider,this._offlineComponentProvider={build:t=>new Gx(t,e?.cacheSizeBytes,this.forceOwnership)}}}class fP{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=rc.provider,this._offlineComponentProvider={build:t=>new MN(t,e?.cacheSizeBytes)}}}function pP(r){return new dP(r?.forceOwnership)}function mP(){return new fP}class xl{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ko extends nT{constructor(e,t,n,i,o,u){super(e,t,n,i,u),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Yh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(Au("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new We(Te.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Ko._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Ko._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ko._jsonSchema={type:Un("string",Ko._jsonSchemaVersion),bundleSource:Un("string","DocumentSnapshot"),bundleName:Un("string"),bundle:Un("string")};class Yh extends Ko{data(e={}){return super.data(e)}}class Qo{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new xl(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new Yh(this._firestore,this._userDataWriter,n.key,n,new xl(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new We(Te.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,o){if(i._snapshot.oldDocs.isEmpty()){let u=0;return i._snapshot.docChanges.map((l=>{const c=new Yh(i._firestore,i._userDataWriter,l.doc.key,l.doc,new xl(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:u++}}))}{let u=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((l=>o||l.type!==3)).map((l=>{const c=new Yh(i._firestore,i._userDataWriter,l.doc.key,l.doc,new xl(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,m=-1;return l.type!==0&&(d=u.indexOf(l.doc.key),u=u.delete(l.doc.key)),l.type!==1&&(u=u.add(l.doc),m=u.indexOf(l.doc.key)),{type:gP(l.type),doc:c,oldIndex:d,newIndex:m}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new We(Te.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Qo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=sv.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],i=[];return this.docs.forEach((o=>{o._document!==null&&(t.push(o._document),n.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),i.push(o.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function gP(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return rt(61501,{type:r})}}Qo._jsonSchemaVersion="firestore/querySnapshot/1.0",Qo._jsonSchema={type:Un("string",Qo._jsonSchemaVersion),bundleSource:Un("string","QuerySnapshot"),bundleName:Un("string"),bundle:Un("string")};function vP(r){r=Hr(r,kn);const e=Hr(r.firestore,ws),t=gc(e);return qN(t,r._key).then((n=>aT(e,r,n)))}function yP(r){r=Hr(r,mo);const e=Hr(r.firestore,ws),t=gc(e),n=new Zv(e);return rT(r._query),WN(t,r._query).then((i=>new Qo(e,n,r,i)))}function ry(r,e,t){r=Hr(r,kn);const n=Hr(r.firestore,ws),i=lP(r.converter,e,t),o=Yv(n);return iy(n,[tP(o,"setDoc",r._key,i,r.converter!==null,t).toMutation(r._key,xr.none())])}function _P(r,e,t,...n){r=Hr(r,kn);const i=Hr(r.firestore,ws),o=Yv(i);let u;return u=typeof(e=Ti(e))=="string"||e instanceof Gv?rP(o,"updateDoc",r._key,e,t,n):nP(o,"updateDoc",r._key,e),iy(i,[u.toMutation(r._key,xr.exists(!0))])}function wP(r){return iy(Hr(r.firestore,ws),[new Xd(r._key,xr.none())])}function EP(r,...e){r=Ti(r);let t={includeMetadataChanges:!1,source:"default"},n=0;typeof e[n]!="object"||Bg(e[n])||(t=e[n++]);const i={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Bg(e[n])){const d=e[n];e[n]=d.next?.bind(d),e[n+1]=d.error?.bind(d),e[n+2]=d.complete?.bind(d)}let o,u,l;if(r instanceof kn)u=Hr(r.firestore,ws),l=hc(r._key.path),o={next:d=>{e[n]&&e[n](aT(u,r,d))},error:e[n+1],complete:e[n+2]};else{const d=Hr(r,mo);u=Hr(d.firestore,ws),l=d._query;const m=new Zv(u);o={next:g=>{e[n]&&e[n](new Qo(u,m,d,g))},error:e[n+1],complete:e[n+2]},rT(r._query)}const c=gc(u);return jN(c,l,i,o)}function bP(r,e){r=Hr(r,ws);const t=gc(r),n=Bg(e)?e:{next:e};return HN(t,n)}function iy(r,e){const t=gc(r);return $N(t,e)}function aT(r,e,t){const n=t.docs.get(e._key),i=new Zv(r);return new Ko(r,i,e._key,n,new xl(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){CD(V1),Ul(new su("firestore",((n,{instanceIdentifier:i,options:o})=>{const u=n.getProvider("app").getImmediate(),l=new ws(new kD(n.getProvider("auth-internal")),new OD(u,n.getProvider("app-check-internal")),yR(u,i),u);return o={useFetchStreams:t,...o},l._setSettings(o),l}),"PUBLIC").setMultipleInstances(!0)),eo(gE,vE,e),eo(gE,vE,"esm2020")})();const uT="firebasestorage.googleapis.com",xP="storageBucket",TP=120*1e3,AP=600*1e3;class Gi extends ra{constructor(e,t,n=0){super(qm(e),`Firebase Storage: ${t} (${qm(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Gi.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return qm(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Wi;(function(r){r.UNKNOWN="unknown",r.OBJECT_NOT_FOUND="object-not-found",r.BUCKET_NOT_FOUND="bucket-not-found",r.PROJECT_NOT_FOUND="project-not-found",r.QUOTA_EXCEEDED="quota-exceeded",r.UNAUTHENTICATED="unauthenticated",r.UNAUTHORIZED="unauthorized",r.UNAUTHORIZED_APP="unauthorized-app",r.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",r.INVALID_CHECKSUM="invalid-checksum",r.CANCELED="canceled",r.INVALID_EVENT_NAME="invalid-event-name",r.INVALID_URL="invalid-url",r.INVALID_DEFAULT_BUCKET="invalid-default-bucket",r.NO_DEFAULT_BUCKET="no-default-bucket",r.CANNOT_SLICE_BLOB="cannot-slice-blob",r.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",r.NO_DOWNLOAD_URL="no-download-url",r.INVALID_ARGUMENT="invalid-argument",r.INVALID_ARGUMENT_COUNT="invalid-argument-count",r.APP_DELETED="app-deleted",r.INVALID_ROOT_OPERATION="invalid-root-operation",r.INVALID_FORMAT="invalid-format",r.INTERNAL_ERROR="internal-error",r.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Wi||(Wi={}));function qm(r){return"storage/"+r}function SP(){const r="An unknown error occurred, please check the error payload for server response.";return new Gi(Wi.UNKNOWN,r)}function IP(){return new Gi(Wi.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function CP(){return new Gi(Wi.CANCELED,"User canceled the upload/download.")}function DP(r){return new Gi(Wi.INVALID_URL,"Invalid URL '"+r+"'.")}function RP(r){return new Gi(Wi.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+r+"'.")}function wE(r){return new Gi(Wi.INVALID_ARGUMENT,r)}function lT(){return new Gi(Wi.APP_DELETED,"The Firebase app was deleted.")}function kP(r){return new Gi(Wi.INVALID_ROOT_OPERATION,"The operation '"+r+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class bi{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=bi.makeFromUrl(e,t)}catch{return new bi(e,"")}if(n.path==="")return n;throw RP(e)}static makeFromUrl(e,t){let n=null;const i="([A-Za-z0-9.\\-_]+)";function o(q){q.path.charAt(q.path.length-1)==="/"&&(q.path_=q.path_.slice(0,-1))}const u="(/(.*))?$",l=new RegExp("^gs://"+i+u,"i"),c={bucket:1,path:3};function d(q){q.path_=decodeURIComponent(q.path)}const m="v[A-Za-z0-9_]+",g=t.replace(/[.]/g,"\\."),E="(/([^?#]*).*)?$",b=new RegExp(`^https?://${g}/${m}/b/${i}/o${E}`,"i"),M={bucket:1,path:3},D=t===uT?"(?:storage.googleapis.com|storage.cloud.google.com)":t,w="([^?#]*)",A=new RegExp(`^https?://${D}/${i}/${w}`,"i"),V=[{regex:l,indices:c,postModify:o},{regex:b,indices:M,postModify:d},{regex:A,indices:{bucket:1,path:2},postModify:d}];for(let q=0;q<V.length;q++){const P=V[q],U=P.regex.exec(e);if(U){const R=U[P.indices.bucket];let S=U[P.indices.path];S||(S=""),n=new bi(R,S),P.postModify(n);break}}if(n==null)throw DP(e);return n}}class NP{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function PP(r,e,t){let n=1,i=null,o=null,u=!1,l=0;function c(){return l===2}let d=!1;function m(...w){d||(d=!0,e.apply(null,w))}function g(w){i=setTimeout(()=>{i=null,r(b,c())},w)}function E(){o&&clearTimeout(o)}function b(w,...A){if(d){E();return}if(w){E(),m.call(null,w,...A);return}if(c()||u){E(),m.call(null,w,...A);return}n<64&&(n*=2);let V;l===1?(l=2,V=0):V=(n+Math.random())*1e3,g(V)}let M=!1;function D(w){M||(M=!0,E(),!d&&(i!==null?(w||(l=2),clearTimeout(i),g(0)):w||(l=1)))}return g(0),o=setTimeout(()=>{u=!0,D(!0)},t),D}function OP(r){r(!1)}function LP(r){return r!==void 0}function EE(r,e,t,n){if(n<e)throw wE(`Invalid value for '${r}'. Expected ${e} or greater.`);if(n>t)throw wE(`Invalid value for '${r}'. Expected ${t} or less.`)}function VP(r){const e=encodeURIComponent;let t="?";for(const n in r)if(r.hasOwnProperty(n)){const i=e(n)+"="+e(r[n]);t=t+i+"&"}return t=t.slice(0,-1),t}var Cd;(function(r){r[r.NO_ERROR=0]="NO_ERROR",r[r.NETWORK_ERROR=1]="NETWORK_ERROR",r[r.ABORT=2]="ABORT"})(Cd||(Cd={}));function FP(r,e){const t=r>=500&&r<600,i=[408,429].indexOf(r)!==-1,o=e.indexOf(r)!==-1;return t||i||o}class MP{constructor(e,t,n,i,o,u,l,c,d,m,g,E=!0,b=!1){this.url_=e,this.method_=t,this.headers_=n,this.body_=i,this.successCodes_=o,this.additionalRetryCodes_=u,this.callback_=l,this.errorCallback_=c,this.timeout_=d,this.progressCallback_=m,this.connectionFactory_=g,this.retry=E,this.isUsingEmulator=b,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((M,D)=>{this.resolve_=M,this.reject_=D,this.start_()})}start_(){const e=(n,i)=>{if(i){n(!1,new Ph(!1,null,!0));return}const o=this.connectionFactory_();this.pendingConnection_=o;const u=l=>{const c=l.loaded,d=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,d)};this.progressCallback_!==null&&o.addUploadProgressListener(u),o.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&o.removeUploadProgressListener(u),this.pendingConnection_=null;const l=o.getErrorCode()===Cd.NO_ERROR,c=o.getStatus();if(!l||FP(c,this.additionalRetryCodes_)&&this.retry){const m=o.getErrorCode()===Cd.ABORT;n(!1,new Ph(!1,null,m));return}const d=this.successCodes_.indexOf(c)!==-1;n(!0,new Ph(d,o))})},t=(n,i)=>{const o=this.resolve_,u=this.reject_,l=i.connection;if(i.wasSuccessCode)try{const c=this.callback_(l,l.getResponse());LP(c)?o(c):o()}catch(c){u(c)}else if(l!==null){const c=SP();c.serverResponse=l.getErrorText(),this.errorCallback_?u(this.errorCallback_(l,c)):u(c)}else if(i.canceled){const c=this.appDelete_?lT():CP();u(c)}else{const c=IP();u(c)}};this.canceled_?t(!1,new Ph(!1,null,!0)):this.backoffId_=PP(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&OP(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Ph{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function BP(r,e){e!==null&&e.length>0&&(r.Authorization="Firebase "+e)}function zP(r,e){r["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function UP(r,e){e&&(r["X-Firebase-GMPID"]=e)}function jP(r,e){e!==null&&(r["X-Firebase-AppCheck"]=e)}function qP(r,e,t,n,i,o,u=!0,l=!1){const c=VP(r.urlParams),d=r.url+c,m=Object.assign({},r.headers);return UP(m,e),BP(m,t),zP(m,o),jP(m,n),new MP(d,r.method,m,r.body,r.successCodes,r.additionalRetryCodes,r.handler,r.errorHandler,r.timeout,r.progressCallback,i,u,l)}function WP(r){if(r.length===0)return null;const e=r.lastIndexOf("/");return e===-1?"":r.slice(0,e)}function $P(r){const e=r.lastIndexOf("/",r.length-2);return e===-1?r:r.slice(e+1)}class Dd{constructor(e,t){this._service=e,t instanceof bi?this._location=t:this._location=bi.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Dd(e,t)}get root(){const e=new bi(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return $P(this._location.path)}get storage(){return this._service}get parent(){const e=WP(this._location.path);if(e===null)return null;const t=new bi(this._location.bucket,e);return new Dd(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw kP(e)}}function bE(r,e){const t=e?.[xP];return t==null?null:bi.makeFromBucketSpec(t,r)}function HP(r,e,t,n={}){r.host=`${e}:${t}`;const i=Bd(e);i&&(A1(`https://${r.host}/b`),dC("Storage",!0)),r._isUsingEmulator=!0,r._protocol=i?"https":"http";const{mockUserToken:o}=n;o&&(r._overrideAuthToken=typeof o=="string"?o:lC(o,r.app.options.projectId))}class GP{constructor(e,t,n,i,o,u=!1){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=i,this._firebaseVersion=o,this._isUsingEmulator=u,this._bucket=null,this._host=uT,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=TP,this._maxUploadRetryTime=AP,this._requests=new Set,i!=null?this._bucket=bi.makeFromBucketSpec(i,this._host):this._bucket=bE(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=bi.makeFromBucketSpec(this._url,e):this._bucket=bE(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){EE("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){EE("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(L1(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Dd(this,e)}_makeRequest(e,t,n,i,o=!0){if(this._deleted)return new NP(lT());{const u=qP(e,this._appId,n,i,t,this._firebaseVersion,o,this._isUsingEmulator);return this._requests.add(u),u.getPromise().then(()=>this._requests.delete(u),()=>this._requests.delete(u)),u}}async makeRequestWithTokens(e,t){const[n,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,i).getPromise()}}const xE="@firebase/storage",TE="0.14.0";const cT="storage";function KP(r=mD(),e){r=Ti(r);const n=O1(r,cT).getImmediate({identifier:e}),i=aC("storage");return i&&QP(n,...i),n}function QP(r,e,t,n={}){HP(r,e,t,n)}function YP(r,{instanceIdentifier:e}){const t=r.getProvider("app").getImmediate(),n=r.getProvider("auth-internal"),i=r.getProvider("app-check-internal");return new GP(t,n,i,e,V1)}function XP(){Ul(new su(cT,YP,"PUBLIC").setMultipleInstances(!0)),eo(xE,TE,""),eo(xE,TE,"esm2020")}XP();const ZP={apiKey:"AIzaSyA5zek053bpwuwt4w_FevuiD-1bpG1C8yY",authDomain:"lector-epub-pwa.firebaseapp.com",projectId:"lector-epub-pwa",storageBucket:"lector-epub-pwa.firebasestorage.app",messagingSenderId:"860478707530",appId:"1:860478707530:web:2d896fe498d50b182c13b3"},hT=F1(ZP),ps=YN(hT,{localCache:hP({tabManager:mP()})});KP(hT);bP(ps,()=>{console.log("Firestore: Snapshots are in sync with server")});const Wm=512*1024,JP=async(r,e)=>{const t=new Uint8Array(e),n=Math.ceil(t.length/Wm),i=Hv(ps,"books",r,"chunks");for(let o=0;o<n;o++){const u=o*Wm,l=Math.min(u+Wm,t.length),c=t.slice(u,l),d=Tu(i,`chunk_${o}`);await ry(d,{index:o,data:Wr.fromUint8Array(new Uint8Array(c))}),console.log(`CloudStorage: Uploaded chunk ${o+1}/${n}`)}},e3=async r=>{const e=Hv(ps,"books",r,"chunks"),t=sT(e,uP("index")),n=await yP(t),i=[];n.forEach(c=>{const d=c.data().data;if(d&&typeof d.toUint8Array=="function")i.push(d.toUint8Array());else{const m=c.data().data;if(typeof m=="string"){const g=atob(m),E=new Uint8Array(g.length);for(let b=0;b<g.length;b++)E[b]=g.charCodeAt(b);i.push(E)}}});const o=i.reduce((c,d)=>c+d.length,0),u=new Uint8Array(o);let l=0;for(const c of i)u.set(c,l),l+=c.length;return u.buffer},t3=async r=>{await wP(Tu(ps,"books",r))},n3="epub-reader-db-v2",Oh="bookmarks",qo="readingState",r3=1;let $m=null;const sy=()=>($m||($m=_1(n3,r3,{upgrade(r,e,t){t&&e<t&&(r.objectStoreNames.contains(Oh)&&r.deleteObjectStore(Oh),r.objectStoreNames.contains(qo)&&r.deleteObjectStore(qo)),r.objectStoreNames.contains(Oh)||r.createObjectStore(Oh,{keyPath:"id"}),r.objectStoreNames.contains(qo)||r.createObjectStore(qo,{keyPath:"bookId"}).createIndex("lastRead","lastRead")}})),$m),Rd=async r=>{await(await sy()).put(qo,r);try{localStorage.setItem(`reading-state-${r.bookId}`,JSON.stringify(r))}catch(t){console.warn("Could not save reading state to localStorage:",t)}},oy=async r=>{try{const t=await(await sy()).get(qo,r);if(t)return t;const n=localStorage.getItem(`reading-state-${r}`);return n?JSON.parse(n):null}catch(e){return console.error("Error getting reading state:",e),null}},AE=async()=>{try{return await(await sy()).getAll(qo)||[]}catch(r){return console.error("Error getting all reading states:",r),[]}},i3=async r=>{const e=await oy(r);e?await Rd({...e,isFinished:!0,progress:1}):await Rd({bookId:r,lastLocation:"",progress:1,lastRead:Date.now(),isFinished:!0})},s3=async r=>{const e=await oy(r);e&&await Rd({...e,isFinished:!1,progress:Math.min(e.progress,.95)})};var Tl=zE();function o3(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];return ge.useMemo(()=>n=>{e.forEach(i=>i(n))},e)}const uf=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Nu(r){const e=Object.prototype.toString.call(r);return e==="[object Window]"||e==="[object global]"}function ay(r){return"nodeType"in r}function Pr(r){var e,t;return r?Nu(r)?r:ay(r)&&(e=(t=r.ownerDocument)==null?void 0:t.defaultView)!=null?e:window:window}function uy(r){const{Document:e}=Pr(r);return r instanceof e}function yc(r){return Nu(r)?!1:r instanceof Pr(r).HTMLElement}function dT(r){return r instanceof Pr(r).SVGElement}function Pu(r){return r?Nu(r)?r.document:ay(r)?uy(r)?r:yc(r)||dT(r)?r.ownerDocument:document:document:document}const $i=uf?ge.useLayoutEffect:ge.useEffect;function ly(r){const e=ge.useRef(r);return $i(()=>{e.current=r}),ge.useCallback(function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e.current==null?void 0:e.current(...n)},[])}function a3(){const r=ge.useRef(null),e=ge.useCallback((n,i)=>{r.current=setInterval(n,i)},[]),t=ge.useCallback(()=>{r.current!==null&&(clearInterval(r.current),r.current=null)},[]);return[e,t]}function ic(r,e){e===void 0&&(e=[r]);const t=ge.useRef(r);return $i(()=>{t.current!==r&&(t.current=r)},e),t}function _c(r,e){const t=ge.useRef();return ge.useMemo(()=>{const n=r(t.current);return t.current=n,n},[...e])}function kd(r){const e=ly(r),t=ge.useRef(null),n=ge.useCallback(i=>{i!==t.current&&e?.(i,t.current),t.current=i},[]);return[t,n]}function zg(r){const e=ge.useRef();return ge.useEffect(()=>{e.current=r},[r]),e.current}let Hm={};function wc(r,e){return ge.useMemo(()=>{if(e)return e;const t=Hm[r]==null?0:Hm[r]+1;return Hm[r]=t,r+"-"+t},[r,e])}function fT(r){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return n.reduce((o,u)=>{const l=Object.entries(u);for(const[c,d]of l){const m=o[c];m!=null&&(o[c]=m+r*d)}return o},{...e})}}const ru=fT(1),sc=fT(-1);function u3(r){return"clientX"in r&&"clientY"in r}function cy(r){if(!r)return!1;const{KeyboardEvent:e}=Pr(r.target);return e&&r instanceof e}function l3(r){if(!r)return!1;const{TouchEvent:e}=Pr(r.target);return e&&r instanceof e}function Ug(r){if(l3(r)){if(r.touches&&r.touches.length){const{clientX:e,clientY:t}=r.touches[0];return{x:e,y:t}}else if(r.changedTouches&&r.changedTouches.length){const{clientX:e,clientY:t}=r.changedTouches[0];return{x:e,y:t}}}return u3(r)?{x:r.clientX,y:r.clientY}:null}const oc=Object.freeze({Translate:{toString(r){if(!r)return;const{x:e,y:t}=r;return"translate3d("+(e?Math.round(e):0)+"px, "+(t?Math.round(t):0)+"px, 0)"}},Scale:{toString(r){if(!r)return;const{scaleX:e,scaleY:t}=r;return"scaleX("+e+") scaleY("+t+")"}},Transform:{toString(r){if(r)return[oc.Translate.toString(r),oc.Scale.toString(r)].join(" ")}},Transition:{toString(r){let{property:e,duration:t,easing:n}=r;return e+" "+t+"ms "+n}}}),SE="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function c3(r){return r.matches(SE)?r:r.querySelector(SE)}const h3={display:"none"};function d3(r){let{id:e,value:t}=r;return br.createElement("div",{id:e,style:h3},t)}function f3(r){let{id:e,announcement:t,ariaLiveType:n="assertive"}=r;const i={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return br.createElement("div",{id:e,style:i,role:"status","aria-live":n,"aria-atomic":!0},t)}function p3(){const[r,e]=ge.useState("");return{announce:ge.useCallback(n=>{n!=null&&e(n)},[]),announcement:r}}const pT=ge.createContext(null);function m3(r){const e=ge.useContext(pT);ge.useEffect(()=>{if(!e)throw new Error("useDndMonitor must be used within a children of <DndContext>");return e(r)},[r,e])}function g3(){const[r]=ge.useState(()=>new Set),e=ge.useCallback(n=>(r.add(n),()=>r.delete(n)),[r]);return[ge.useCallback(n=>{let{type:i,event:o}=n;r.forEach(u=>{var l;return(l=u[i])==null?void 0:l.call(u,o)})},[r]),e]}const v3={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},y3={onDragStart(r){let{active:e}=r;return"Picked up draggable item "+e.id+"."},onDragOver(r){let{active:e,over:t}=r;return t?"Draggable item "+e.id+" was moved over droppable area "+t.id+".":"Draggable item "+e.id+" is no longer over a droppable area."},onDragEnd(r){let{active:e,over:t}=r;return t?"Draggable item "+e.id+" was dropped over droppable area "+t.id:"Draggable item "+e.id+" was dropped."},onDragCancel(r){let{active:e}=r;return"Dragging was cancelled. Draggable item "+e.id+" was dropped."}};function _3(r){let{announcements:e=y3,container:t,hiddenTextDescribedById:n,screenReaderInstructions:i=v3}=r;const{announce:o,announcement:u}=p3(),l=wc("DndLiveRegion"),[c,d]=ge.useState(!1);if(ge.useEffect(()=>{d(!0)},[]),m3(ge.useMemo(()=>({onDragStart(g){let{active:E}=g;o(e.onDragStart({active:E}))},onDragMove(g){let{active:E,over:b}=g;e.onDragMove&&o(e.onDragMove({active:E,over:b}))},onDragOver(g){let{active:E,over:b}=g;o(e.onDragOver({active:E,over:b}))},onDragEnd(g){let{active:E,over:b}=g;o(e.onDragEnd({active:E,over:b}))},onDragCancel(g){let{active:E,over:b}=g;o(e.onDragCancel({active:E,over:b}))}}),[o,e])),!c)return null;const m=br.createElement(br.Fragment,null,br.createElement(d3,{id:n,value:i.draggable}),br.createElement(f3,{id:l,announcement:u}));return t?Tl.createPortal(m,t):m}var Hn;(function(r){r.DragStart="dragStart",r.DragMove="dragMove",r.DragEnd="dragEnd",r.DragCancel="dragCancel",r.DragOver="dragOver",r.RegisterDroppable="registerDroppable",r.SetDroppableDisabled="setDroppableDisabled",r.UnregisterDroppable="unregisterDroppable"})(Hn||(Hn={}));function Nd(){}function Gm(r,e){return ge.useMemo(()=>({sensor:r,options:e??{}}),[r,e])}function w3(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];return ge.useMemo(()=>[...e].filter(n=>n!=null),[...e])}const Ai=Object.freeze({x:0,y:0});function mT(r,e){return Math.sqrt(Math.pow(r.x-e.x,2)+Math.pow(r.y-e.y,2))}function gT(r,e){let{data:{value:t}}=r,{data:{value:n}}=e;return t-n}function E3(r,e){let{data:{value:t}}=r,{data:{value:n}}=e;return n-t}function IE(r){let{left:e,top:t,height:n,width:i}=r;return[{x:e,y:t},{x:e+i,y:t},{x:e,y:t+n},{x:e+i,y:t+n}]}function vT(r,e){if(!r||r.length===0)return null;const[t]=r;return t[e]}function CE(r,e,t){return e===void 0&&(e=r.left),t===void 0&&(t=r.top),{x:e+r.width*.5,y:t+r.height*.5}}const b3=r=>{let{collisionRect:e,droppableRects:t,droppableContainers:n}=r;const i=CE(e,e.left,e.top),o=[];for(const u of n){const{id:l}=u,c=t.get(l);if(c){const d=mT(CE(c),i);o.push({id:l,data:{droppableContainer:u,value:d}})}}return o.sort(gT)},x3=r=>{let{collisionRect:e,droppableRects:t,droppableContainers:n}=r;const i=IE(e),o=[];for(const u of n){const{id:l}=u,c=t.get(l);if(c){const d=IE(c),m=i.reduce((E,b,M)=>E+mT(d[M],b),0),g=Number((m/4).toFixed(4));o.push({id:l,data:{droppableContainer:u,value:g}})}}return o.sort(gT)};function T3(r,e){const t=Math.max(e.top,r.top),n=Math.max(e.left,r.left),i=Math.min(e.left+e.width,r.left+r.width),o=Math.min(e.top+e.height,r.top+r.height),u=i-n,l=o-t;if(n<i&&t<o){const c=e.width*e.height,d=r.width*r.height,m=u*l,g=m/(c+d-m);return Number(g.toFixed(4))}return 0}const A3=r=>{let{collisionRect:e,droppableRects:t,droppableContainers:n}=r;const i=[];for(const o of n){const{id:u}=o,l=t.get(u);if(l){const c=T3(l,e);c>0&&i.push({id:u,data:{droppableContainer:o,value:c}})}}return i.sort(E3)};function S3(r,e,t){return{...r,scaleX:e&&t?e.width/t.width:1,scaleY:e&&t?e.height/t.height:1}}function yT(r,e){return r&&e?{x:r.left-e.left,y:r.top-e.top}:Ai}function I3(r){return function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return i.reduce((u,l)=>({...u,top:u.top+r*l.y,bottom:u.bottom+r*l.y,left:u.left+r*l.x,right:u.right+r*l.x}),{...t})}}const C3=I3(1);function D3(r){if(r.startsWith("matrix3d(")){const e=r.slice(9,-1).split(/, /);return{x:+e[12],y:+e[13],scaleX:+e[0],scaleY:+e[5]}}else if(r.startsWith("matrix(")){const e=r.slice(7,-1).split(/, /);return{x:+e[4],y:+e[5],scaleX:+e[0],scaleY:+e[3]}}return null}function R3(r,e,t){const n=D3(e);if(!n)return r;const{scaleX:i,scaleY:o,x:u,y:l}=n,c=r.left-u-(1-i)*parseFloat(t),d=r.top-l-(1-o)*parseFloat(t.slice(t.indexOf(" ")+1)),m=i?r.width/i:r.width,g=o?r.height/o:r.height;return{width:m,height:g,top:d,right:c+m,bottom:d+g,left:c}}const k3={ignoreTransform:!1};function Ou(r,e){e===void 0&&(e=k3);let t=r.getBoundingClientRect();if(e.ignoreTransform){const{transform:d,transformOrigin:m}=Pr(r).getComputedStyle(r);d&&(t=R3(t,d,m))}const{top:n,left:i,width:o,height:u,bottom:l,right:c}=t;return{top:n,left:i,width:o,height:u,bottom:l,right:c}}function DE(r){return Ou(r,{ignoreTransform:!0})}function N3(r){const e=r.innerWidth,t=r.innerHeight;return{top:0,left:0,right:e,bottom:t,width:e,height:t}}function P3(r,e){return e===void 0&&(e=Pr(r).getComputedStyle(r)),e.position==="fixed"}function O3(r,e){e===void 0&&(e=Pr(r).getComputedStyle(r));const t=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(i=>{const o=e[i];return typeof o=="string"?t.test(o):!1})}function lf(r,e){const t=[];function n(i){if(e!=null&&t.length>=e||!i)return t;if(uy(i)&&i.scrollingElement!=null&&!t.includes(i.scrollingElement))return t.push(i.scrollingElement),t;if(!yc(i)||dT(i)||t.includes(i))return t;const o=Pr(r).getComputedStyle(i);return i!==r&&O3(i,o)&&t.push(i),P3(i,o)?t:n(i.parentNode)}return r?n(r):t}function _T(r){const[e]=lf(r,1);return e??null}function Km(r){return!uf||!r?null:Nu(r)?r:ay(r)?uy(r)||r===Pu(r).scrollingElement?window:yc(r)?r:null:null}function wT(r){return Nu(r)?r.scrollX:r.scrollLeft}function ET(r){return Nu(r)?r.scrollY:r.scrollTop}function jg(r){return{x:wT(r),y:ET(r)}}var er;(function(r){r[r.Forward=1]="Forward",r[r.Backward=-1]="Backward"})(er||(er={}));function bT(r){return!uf||!r?!1:r===document.scrollingElement}function xT(r){const e={x:0,y:0},t=bT(r)?{height:window.innerHeight,width:window.innerWidth}:{height:r.clientHeight,width:r.clientWidth},n={x:r.scrollWidth-t.width,y:r.scrollHeight-t.height},i=r.scrollTop<=e.y,o=r.scrollLeft<=e.x,u=r.scrollTop>=n.y,l=r.scrollLeft>=n.x;return{isTop:i,isLeft:o,isBottom:u,isRight:l,maxScroll:n,minScroll:e}}const L3={x:.2,y:.2};function V3(r,e,t,n,i){let{top:o,left:u,right:l,bottom:c}=t;n===void 0&&(n=10),i===void 0&&(i=L3);const{isTop:d,isBottom:m,isLeft:g,isRight:E}=xT(r),b={x:0,y:0},M={x:0,y:0},D={height:e.height*i.y,width:e.width*i.x};return!d&&o<=e.top+D.height?(b.y=er.Backward,M.y=n*Math.abs((e.top+D.height-o)/D.height)):!m&&c>=e.bottom-D.height&&(b.y=er.Forward,M.y=n*Math.abs((e.bottom-D.height-c)/D.height)),!E&&l>=e.right-D.width?(b.x=er.Forward,M.x=n*Math.abs((e.right-D.width-l)/D.width)):!g&&u<=e.left+D.width&&(b.x=er.Backward,M.x=n*Math.abs((e.left+D.width-u)/D.width)),{direction:b,speed:M}}function F3(r){if(r===document.scrollingElement){const{innerWidth:o,innerHeight:u}=window;return{top:0,left:0,right:o,bottom:u,width:o,height:u}}const{top:e,left:t,right:n,bottom:i}=r.getBoundingClientRect();return{top:e,left:t,right:n,bottom:i,width:r.clientWidth,height:r.clientHeight}}function TT(r){return r.reduce((e,t)=>ru(e,jg(t)),Ai)}function M3(r){return r.reduce((e,t)=>e+wT(t),0)}function B3(r){return r.reduce((e,t)=>e+ET(t),0)}function z3(r,e){if(e===void 0&&(e=Ou),!r)return;const{top:t,left:n,bottom:i,right:o}=e(r);_T(r)&&(i<=0||o<=0||t>=window.innerHeight||n>=window.innerWidth)&&r.scrollIntoView({block:"center",inline:"center"})}const U3=[["x",["left","right"],M3],["y",["top","bottom"],B3]];class hy{constructor(e,t){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=lf(t),i=TT(n);this.rect={...e},this.width=e.width,this.height=e.height;for(const[o,u,l]of U3)for(const c of u)Object.defineProperty(this,c,{get:()=>{const d=l(n),m=i[o]-d;return this.rect[c]+m},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Ll{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(t=>{var n;return(n=this.target)==null?void 0:n.removeEventListener(...t)})},this.target=e}add(e,t,n){var i;(i=this.target)==null||i.addEventListener(e,t,n),this.listeners.push([e,t,n])}}function j3(r){const{EventTarget:e}=Pr(r);return r instanceof e?r:Pu(r)}function Qm(r,e){const t=Math.abs(r.x),n=Math.abs(r.y);return typeof e=="number"?Math.sqrt(t**2+n**2)>e:"x"in e&&"y"in e?t>e.x&&n>e.y:"x"in e?t>e.x:"y"in e?n>e.y:!1}var oi;(function(r){r.Click="click",r.DragStart="dragstart",r.Keydown="keydown",r.ContextMenu="contextmenu",r.Resize="resize",r.SelectionChange="selectionchange",r.VisibilityChange="visibilitychange"})(oi||(oi={}));function RE(r){r.preventDefault()}function q3(r){r.stopPropagation()}var Bt;(function(r){r.Space="Space",r.Down="ArrowDown",r.Right="ArrowRight",r.Left="ArrowLeft",r.Up="ArrowUp",r.Esc="Escape",r.Enter="Enter",r.Tab="Tab"})(Bt||(Bt={}));const AT={start:[Bt.Space,Bt.Enter],cancel:[Bt.Esc],end:[Bt.Space,Bt.Enter,Bt.Tab]},W3=(r,e)=>{let{currentCoordinates:t}=e;switch(r.code){case Bt.Right:return{...t,x:t.x+25};case Bt.Left:return{...t,x:t.x-25};case Bt.Down:return{...t,y:t.y+25};case Bt.Up:return{...t,y:t.y-25}}};class dy{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:t}}=e;this.props=e,this.listeners=new Ll(Pu(t)),this.windowListeners=new Ll(Pr(t)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(oi.Resize,this.handleCancel),this.windowListeners.add(oi.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(oi.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:t}=this.props,n=e.node.current;n&&z3(n),t(Ai)}handleKeyDown(e){if(cy(e)){const{active:t,context:n,options:i}=this.props,{keyboardCodes:o=AT,coordinateGetter:u=W3,scrollBehavior:l="smooth"}=i,{code:c}=e;if(o.end.includes(c)){this.handleEnd(e);return}if(o.cancel.includes(c)){this.handleCancel(e);return}const{collisionRect:d}=n.current,m=d?{x:d.left,y:d.top}:Ai;this.referenceCoordinates||(this.referenceCoordinates=m);const g=u(e,{active:t,context:n.current,currentCoordinates:m});if(g){const E=sc(g,m),b={x:0,y:0},{scrollableAncestors:M}=n.current;for(const D of M){const w=e.code,{isTop:A,isRight:I,isLeft:V,isBottom:q,maxScroll:P,minScroll:U}=xT(D),R=F3(D),S={x:Math.min(w===Bt.Right?R.right-R.width/2:R.right,Math.max(w===Bt.Right?R.left:R.left+R.width/2,g.x)),y:Math.min(w===Bt.Down?R.bottom-R.height/2:R.bottom,Math.max(w===Bt.Down?R.top:R.top+R.height/2,g.y))},C=w===Bt.Right&&!I||w===Bt.Left&&!V,N=w===Bt.Down&&!q||w===Bt.Up&&!A;if(C&&S.x!==g.x){const z=D.scrollLeft+E.x,j=w===Bt.Right&&z<=P.x||w===Bt.Left&&z>=U.x;if(j&&!E.y){D.scrollTo({left:z,behavior:l});return}j?b.x=D.scrollLeft-z:b.x=w===Bt.Right?D.scrollLeft-P.x:D.scrollLeft-U.x,b.x&&D.scrollBy({left:-b.x,behavior:l});break}else if(N&&S.y!==g.y){const z=D.scrollTop+E.y,j=w===Bt.Down&&z<=P.y||w===Bt.Up&&z>=U.y;if(j&&!E.x){D.scrollTo({top:z,behavior:l});return}j?b.y=D.scrollTop-z:b.y=w===Bt.Down?D.scrollTop-P.y:D.scrollTop-U.y,b.y&&D.scrollBy({top:-b.y,behavior:l});break}}this.handleMove(e,ru(sc(g,this.referenceCoordinates),b))}}}handleMove(e,t){const{onMove:n}=this.props;e.preventDefault(),n(t)}handleEnd(e){const{onEnd:t}=this.props;e.preventDefault(),this.detach(),t()}handleCancel(e){const{onCancel:t}=this.props;e.preventDefault(),this.detach(),t()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}dy.activators=[{eventName:"onKeyDown",handler:(r,e,t)=>{let{keyboardCodes:n=AT,onActivation:i}=e,{active:o}=t;const{code:u}=r.nativeEvent;if(n.start.includes(u)){const l=o.activatorNode.current;return l&&r.target!==l?!1:(r.preventDefault(),i?.({event:r.nativeEvent}),!0)}return!1}}];function kE(r){return!!(r&&"distance"in r)}function NE(r){return!!(r&&"delay"in r)}class fy{constructor(e,t,n){var i;n===void 0&&(n=j3(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=t;const{event:o}=e,{target:u}=o;this.props=e,this.events=t,this.document=Pu(u),this.documentListeners=new Ll(this.document),this.listeners=new Ll(n),this.windowListeners=new Ll(Pr(u)),this.initialCoordinates=(i=Ug(o))!=null?i:Ai,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:t,bypassActivationConstraint:n}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(oi.Resize,this.handleCancel),this.windowListeners.add(oi.DragStart,RE),this.windowListeners.add(oi.VisibilityChange,this.handleCancel),this.windowListeners.add(oi.ContextMenu,RE),this.documentListeners.add(oi.Keydown,this.handleKeydown),t){if(n!=null&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(NE(t)){this.timeoutId=setTimeout(this.handleStart,t.delay),this.handlePending(t);return}if(kE(t)){this.handlePending(t);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,t){const{active:n,onPending:i}=this.props;i(n,e,this.initialCoordinates,t)}handleStart(){const{initialCoordinates:e}=this,{onStart:t}=this.props;e&&(this.activated=!0,this.documentListeners.add(oi.Click,q3,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(oi.SelectionChange,this.removeTextSelection),t(e))}handleMove(e){var t;const{activated:n,initialCoordinates:i,props:o}=this,{onMove:u,options:{activationConstraint:l}}=o;if(!i)return;const c=(t=Ug(e))!=null?t:Ai,d=sc(i,c);if(!n&&l){if(kE(l)){if(l.tolerance!=null&&Qm(d,l.tolerance))return this.handleCancel();if(Qm(d,l.distance))return this.handleStart()}if(NE(l)&&Qm(d,l.tolerance))return this.handleCancel();this.handlePending(l,d);return}e.cancelable&&e.preventDefault(),u(c)}handleEnd(){const{onAbort:e,onEnd:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleCancel(){const{onAbort:e,onCancel:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleKeydown(e){e.code===Bt.Esc&&this.handleCancel()}removeTextSelection(){var e;(e=this.document.getSelection())==null||e.removeAllRanges()}}const $3={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class py extends fy{constructor(e){const{event:t}=e,n=Pu(t.target);super(e,$3,n)}}py.activators=[{eventName:"onPointerDown",handler:(r,e)=>{let{nativeEvent:t}=r,{onActivation:n}=e;return!t.isPrimary||t.button!==0?!1:(n?.({event:t}),!0)}}];const H3={move:{name:"mousemove"},end:{name:"mouseup"}};var qg;(function(r){r[r.RightClick=2]="RightClick"})(qg||(qg={}));class G3 extends fy{constructor(e){super(e,H3,Pu(e.event.target))}}G3.activators=[{eventName:"onMouseDown",handler:(r,e)=>{let{nativeEvent:t}=r,{onActivation:n}=e;return t.button===qg.RightClick?!1:(n?.({event:t}),!0)}}];const Ym={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class ST extends fy{constructor(e){super(e,Ym)}static setup(){return window.addEventListener(Ym.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(Ym.move.name,e)};function e(){}}}ST.activators=[{eventName:"onTouchStart",handler:(r,e)=>{let{nativeEvent:t}=r,{onActivation:n}=e;const{touches:i}=t;return i.length>1?!1:(n?.({event:t}),!0)}}];var Vl;(function(r){r[r.Pointer=0]="Pointer",r[r.DraggableRect=1]="DraggableRect"})(Vl||(Vl={}));var Pd;(function(r){r[r.TreeOrder=0]="TreeOrder",r[r.ReversedTreeOrder=1]="ReversedTreeOrder"})(Pd||(Pd={}));function K3(r){let{acceleration:e,activator:t=Vl.Pointer,canScroll:n,draggingRect:i,enabled:o,interval:u=5,order:l=Pd.TreeOrder,pointerCoordinates:c,scrollableAncestors:d,scrollableAncestorRects:m,delta:g,threshold:E}=r;const b=Y3({delta:g,disabled:!o}),[M,D]=a3(),w=ge.useRef({x:0,y:0}),A=ge.useRef({x:0,y:0}),I=ge.useMemo(()=>{switch(t){case Vl.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case Vl.DraggableRect:return i}},[t,i,c]),V=ge.useRef(null),q=ge.useCallback(()=>{const U=V.current;if(!U)return;const R=w.current.x*A.current.x,S=w.current.y*A.current.y;U.scrollBy(R,S)},[]),P=ge.useMemo(()=>l===Pd.TreeOrder?[...d].reverse():d,[l,d]);ge.useEffect(()=>{if(!o||!d.length||!I){D();return}for(const U of P){if(n?.(U)===!1)continue;const R=d.indexOf(U),S=m[R];if(!S)continue;const{direction:C,speed:N}=V3(U,S,I,e,E);for(const z of["x","y"])b[z][C[z]]||(N[z]=0,C[z]=0);if(N.x>0||N.y>0){D(),V.current=U,M(q,u),w.current=N,A.current=C;return}}w.current={x:0,y:0},A.current={x:0,y:0},D()},[e,q,n,D,o,u,JSON.stringify(I),JSON.stringify(b),M,d,P,m,JSON.stringify(E)])}const Q3={x:{[er.Backward]:!1,[er.Forward]:!1},y:{[er.Backward]:!1,[er.Forward]:!1}};function Y3(r){let{delta:e,disabled:t}=r;const n=zg(e);return _c(i=>{if(t||!n||!i)return Q3;const o={x:Math.sign(e.x-n.x),y:Math.sign(e.y-n.y)};return{x:{[er.Backward]:i.x[er.Backward]||o.x===-1,[er.Forward]:i.x[er.Forward]||o.x===1},y:{[er.Backward]:i.y[er.Backward]||o.y===-1,[er.Forward]:i.y[er.Forward]||o.y===1}}},[t,e,n])}function X3(r,e){const t=e!=null?r.get(e):void 0,n=t?t.node.current:null;return _c(i=>{var o;return e==null?null:(o=n??i)!=null?o:null},[n,e])}function Z3(r,e){return ge.useMemo(()=>r.reduce((t,n)=>{const{sensor:i}=n,o=i.activators.map(u=>({eventName:u.eventName,handler:e(u.handler,n)}));return[...t,...o]},[]),[r,e])}var ac;(function(r){r[r.Always=0]="Always",r[r.BeforeDragging=1]="BeforeDragging",r[r.WhileDragging=2]="WhileDragging"})(ac||(ac={}));var Wg;(function(r){r.Optimized="optimized"})(Wg||(Wg={}));const PE=new Map;function J3(r,e){let{dragging:t,dependencies:n,config:i}=e;const[o,u]=ge.useState(null),{frequency:l,measure:c,strategy:d}=i,m=ge.useRef(r),g=w(),E=ic(g),b=ge.useCallback(function(A){A===void 0&&(A=[]),!E.current&&u(I=>I===null?A:I.concat(A.filter(V=>!I.includes(V))))},[E]),M=ge.useRef(null),D=_c(A=>{if(g&&!t)return PE;if(!A||A===PE||m.current!==r||o!=null){const I=new Map;for(let V of r){if(!V)continue;if(o&&o.length>0&&!o.includes(V.id)&&V.rect.current){I.set(V.id,V.rect.current);continue}const q=V.node.current,P=q?new hy(c(q),q):null;V.rect.current=P,P&&I.set(V.id,P)}return I}return A},[r,o,t,g,c]);return ge.useEffect(()=>{m.current=r},[r]),ge.useEffect(()=>{g||b()},[t,g]),ge.useEffect(()=>{o&&o.length>0&&u(null)},[JSON.stringify(o)]),ge.useEffect(()=>{g||typeof l!="number"||M.current!==null||(M.current=setTimeout(()=>{b(),M.current=null},l))},[l,g,b,...n]),{droppableRects:D,measureDroppableContainers:b,measuringScheduled:o!=null};function w(){switch(d){case ac.Always:return!1;case ac.BeforeDragging:return t;default:return!t}}}function IT(r,e){return _c(t=>r?t||(typeof e=="function"?e(r):r):null,[e,r])}function eO(r,e){return IT(r,e)}function tO(r){let{callback:e,disabled:t}=r;const n=ly(e),i=ge.useMemo(()=>{if(t||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:o}=window;return new o(n)},[n,t]);return ge.useEffect(()=>()=>i?.disconnect(),[i]),i}function cf(r){let{callback:e,disabled:t}=r;const n=ly(e),i=ge.useMemo(()=>{if(t||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:o}=window;return new o(n)},[t]);return ge.useEffect(()=>()=>i?.disconnect(),[i]),i}function nO(r){return new hy(Ou(r),r)}function OE(r,e,t){e===void 0&&(e=nO);const[n,i]=ge.useState(null);function o(){i(c=>{if(!r)return null;if(r.isConnected===!1){var d;return(d=c??t)!=null?d:null}const m=e(r);return JSON.stringify(c)===JSON.stringify(m)?c:m})}const u=tO({callback(c){if(r)for(const d of c){const{type:m,target:g}=d;if(m==="childList"&&g instanceof HTMLElement&&g.contains(r)){o();break}}}}),l=cf({callback:o});return $i(()=>{o(),r?(l?.observe(r),u?.observe(document.body,{childList:!0,subtree:!0})):(l?.disconnect(),u?.disconnect())},[r]),n}function rO(r){const e=IT(r);return yT(r,e)}const LE=[];function iO(r){const e=ge.useRef(r),t=_c(n=>r?n&&n!==LE&&r&&e.current&&r.parentNode===e.current.parentNode?n:lf(r):LE,[r]);return ge.useEffect(()=>{e.current=r},[r]),t}function sO(r){const[e,t]=ge.useState(null),n=ge.useRef(r),i=ge.useCallback(o=>{const u=Km(o.target);u&&t(l=>l?(l.set(u,jg(u)),new Map(l)):null)},[]);return ge.useEffect(()=>{const o=n.current;if(r!==o){u(o);const l=r.map(c=>{const d=Km(c);return d?(d.addEventListener("scroll",i,{passive:!0}),[d,jg(d)]):null}).filter(c=>c!=null);t(l.length?new Map(l):null),n.current=r}return()=>{u(r),u(o)};function u(l){l.forEach(c=>{const d=Km(c);d?.removeEventListener("scroll",i)})}},[i,r]),ge.useMemo(()=>r.length?e?Array.from(e.values()).reduce((o,u)=>ru(o,u),Ai):TT(r):Ai,[r,e])}function VE(r,e){e===void 0&&(e=[]);const t=ge.useRef(null);return ge.useEffect(()=>{t.current=null},e),ge.useEffect(()=>{const n=r!==Ai;n&&!t.current&&(t.current=r),!n&&t.current&&(t.current=null)},[r]),t.current?sc(r,t.current):Ai}function oO(r){ge.useEffect(()=>{if(!uf)return;const e=r.map(t=>{let{sensor:n}=t;return n.setup==null?void 0:n.setup()});return()=>{for(const t of e)t?.()}},r.map(e=>{let{sensor:t}=e;return t}))}function aO(r,e){return ge.useMemo(()=>r.reduce((t,n)=>{let{eventName:i,handler:o}=n;return t[i]=u=>{o(u,e)},t},{}),[r,e])}function CT(r){return ge.useMemo(()=>r?N3(r):null,[r])}const FE=[];function uO(r,e){e===void 0&&(e=Ou);const[t]=r,n=CT(t?Pr(t):null),[i,o]=ge.useState(FE);function u(){o(()=>r.length?r.map(c=>bT(c)?n:new hy(e(c),c)):FE)}const l=cf({callback:u});return $i(()=>{l?.disconnect(),u(),r.forEach(c=>l?.observe(c))},[r]),i}function lO(r){if(!r)return null;if(r.children.length>1)return r;const e=r.children[0];return yc(e)?e:r}function cO(r){let{measure:e}=r;const[t,n]=ge.useState(null),i=ge.useCallback(d=>{for(const{target:m}of d)if(yc(m)){n(g=>{const E=e(m);return g?{...g,width:E.width,height:E.height}:E});break}},[e]),o=cf({callback:i}),u=ge.useCallback(d=>{const m=lO(d);o?.disconnect(),m&&o?.observe(m),n(m?e(m):null)},[e,o]),[l,c]=kd(u);return ge.useMemo(()=>({nodeRef:l,rect:t,setRef:c}),[t,l,c])}const hO=[{sensor:py,options:{}},{sensor:dy,options:{}}],dO={current:{}},Xh={draggable:{measure:DE},droppable:{measure:DE,strategy:ac.WhileDragging,frequency:Wg.Optimized},dragOverlay:{measure:Ou}};class Fl extends Map{get(e){var t;return e!=null&&(t=super.get(e))!=null?t:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:t}=e;return!t})}getNodeFor(e){var t,n;return(t=(n=this.get(e))==null?void 0:n.node.current)!=null?t:void 0}}const fO={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Fl,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Nd},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Xh,measureDroppableContainers:Nd,windowRect:null,measuringScheduled:!1},pO={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Nd,draggableNodes:new Map,over:null,measureDroppableContainers:Nd},hf=ge.createContext(pO),DT=ge.createContext(fO);function mO(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Fl}}}function gO(r,e){switch(e.type){case Hn.DragStart:return{...r,draggable:{...r.draggable,initialCoordinates:e.initialCoordinates,active:e.active}};case Hn.DragMove:return r.draggable.active==null?r:{...r,draggable:{...r.draggable,translate:{x:e.coordinates.x-r.draggable.initialCoordinates.x,y:e.coordinates.y-r.draggable.initialCoordinates.y}}};case Hn.DragEnd:case Hn.DragCancel:return{...r,draggable:{...r.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Hn.RegisterDroppable:{const{element:t}=e,{id:n}=t,i=new Fl(r.droppable.containers);return i.set(n,t),{...r,droppable:{...r.droppable,containers:i}}}case Hn.SetDroppableDisabled:{const{id:t,key:n,disabled:i}=e,o=r.droppable.containers.get(t);if(!o||n!==o.key)return r;const u=new Fl(r.droppable.containers);return u.set(t,{...o,disabled:i}),{...r,droppable:{...r.droppable,containers:u}}}case Hn.UnregisterDroppable:{const{id:t,key:n}=e,i=r.droppable.containers.get(t);if(!i||n!==i.key)return r;const o=new Fl(r.droppable.containers);return o.delete(t),{...r,droppable:{...r.droppable,containers:o}}}default:return r}}function vO(r){let{disabled:e}=r;const{active:t,activatorEvent:n,draggableNodes:i}=ge.useContext(hf),o=zg(n),u=zg(t?.id);return ge.useEffect(()=>{if(!e&&!n&&o&&u!=null){if(!cy(o)||document.activeElement===o.target)return;const l=i.get(u);if(!l)return;const{activatorNode:c,node:d}=l;if(!c.current&&!d.current)return;requestAnimationFrame(()=>{for(const m of[c.current,d.current]){if(!m)continue;const g=c3(m);if(g){g.focus();break}}})}},[n,e,i,u,o]),null}function yO(r,e){let{transform:t,...n}=e;return r!=null&&r.length?r.reduce((i,o)=>o({transform:i,...n}),t):t}function _O(r){return ge.useMemo(()=>({draggable:{...Xh.draggable,...r?.draggable},droppable:{...Xh.droppable,...r?.droppable},dragOverlay:{...Xh.dragOverlay,...r?.dragOverlay}}),[r?.draggable,r?.droppable,r?.dragOverlay])}function wO(r){let{activeNode:e,measure:t,initialRect:n,config:i=!0}=r;const o=ge.useRef(!1),{x:u,y:l}=typeof i=="boolean"?{x:i,y:i}:i;$i(()=>{if(!u&&!l||!e){o.current=!1;return}if(o.current||!n)return;const d=e?.node.current;if(!d||d.isConnected===!1)return;const m=t(d),g=yT(m,n);if(u||(g.x=0),l||(g.y=0),o.current=!0,Math.abs(g.x)>0||Math.abs(g.y)>0){const E=_T(d);E&&E.scrollBy({top:g.y,left:g.x})}},[e,u,l,n,t])}const RT=ge.createContext({...Ai,scaleX:1,scaleY:1});var Gs;(function(r){r[r.Uninitialized=0]="Uninitialized",r[r.Initializing=1]="Initializing",r[r.Initialized=2]="Initialized"})(Gs||(Gs={}));const EO=ge.memo(function(e){var t,n,i,o;let{id:u,accessibility:l,autoScroll:c=!0,children:d,sensors:m=hO,collisionDetection:g=A3,measuring:E,modifiers:b,...M}=e;const D=ge.useReducer(gO,void 0,mO),[w,A]=D,[I,V]=g3(),[q,P]=ge.useState(Gs.Uninitialized),U=q===Gs.Initialized,{draggable:{active:R,nodes:S,translate:C},droppable:{containers:N}}=w,z=R!=null?S.get(R):null,j=ge.useRef({initial:null,translated:null}),L=ge.useMemo(()=>{var v;return R!=null?{id:R,data:(v=z?.data)!=null?v:dO,rect:j}:null},[R,z]),he=ge.useRef(null),[_e,De]=ge.useState(null),[de,J]=ge.useState(null),ce=ic(M,Object.values(M)),xe=wc("DndDescribedBy",u),Q=ge.useMemo(()=>N.getEnabled(),[N]),se=_O(E),{droppableRects:Ce,measureDroppableContainers:Ie,measuringScheduled:He}=J3(Q,{dragging:U,dependencies:[C.x,C.y],config:se.droppable}),Ke=X3(S,R),et=ge.useMemo(()=>de?Ug(de):null,[de]),Fe=be(),Je=eO(Ke,se.draggable.measure);wO({activeNode:R!=null?S.get(R):null,config:Fe.layoutShiftCompensation,initialRect:Je,measure:se.draggable.measure});const Xe=OE(Ke,se.draggable.measure,Je),ft=OE(Ke?Ke.parentElement:null),yt=ge.useRef({activatorEvent:null,active:null,activeNode:Ke,collisionRect:null,collisions:null,droppableRects:Ce,draggableNodes:S,draggingNode:null,draggingNodeRect:null,droppableContainers:N,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),mt=N.getNodeFor((t=yt.current.over)==null?void 0:t.id),_t=cO({measure:se.dragOverlay.measure}),kt=(n=_t.nodeRef.current)!=null?n:Ke,St=U?(i=_t.rect)!=null?i:Xe:null,Tt=!!(_t.nodeRef.current&&_t.rect),Ht=rO(Tt?null:Xe),Dt=CT(kt?Pr(kt):null),wt=iO(U?mt??Ke:null),it=uO(wt),gt=yO(b,{transform:{x:C.x-Ht.x,y:C.y-Ht.y,scaleX:1,scaleY:1},activatorEvent:de,active:L,activeNodeRect:Xe,containerNodeRect:ft,draggingNodeRect:St,over:yt.current.over,overlayNodeRect:_t.rect,scrollableAncestors:wt,scrollableAncestorRects:it,windowRect:Dt}),dt=et?ru(et,C):null,an=sO(wt),_n=VE(an),xn=VE(an,[Xe]),jt=ru(gt,_n),on=St?C3(St,gt):null,pn=L&&on?g({active:L,collisionRect:on,droppableRects:Ce,droppableContainers:Q,pointerCoordinates:dt}):null,en=vT(pn,"id"),[Qt,Tn]=ge.useState(null),Gt=Tt?gt:ru(gt,xn),hn=S3(Gt,(o=Qt?.rect)!=null?o:null,Xe),Pn=ge.useRef(null),$=ge.useCallback((v,O)=>{let{sensor:G,options:y}=O;if(he.current==null)return;const X=S.get(he.current);if(!X)return;const ie=v.nativeEvent,F=new G({active:he.current,activeNode:X,event:ie,options:y,context:yt,onAbort(ue){if(!S.get(ue))return;const{onDragAbort:Ne}=ce.current,ze={id:ue};Ne?.(ze),I({type:"onDragAbort",event:ze})},onPending(ue,Ue,Ne,ze){if(!S.get(ue))return;const{onDragPending:Lt}=ce.current,xt={id:ue,constraint:Ue,initialCoordinates:Ne,offset:ze};Lt?.(xt),I({type:"onDragPending",event:xt})},onStart(ue){const Ue=he.current;if(Ue==null)return;const Ne=S.get(Ue);if(!Ne)return;const{onDragStart:ze}=ce.current,lt={activatorEvent:ie,active:{id:Ue,data:Ne.data,rect:j}};Tl.unstable_batchedUpdates(()=>{ze?.(lt),P(Gs.Initializing),A({type:Hn.DragStart,initialCoordinates:ue,active:Ue}),I({type:"onDragStart",event:lt}),De(Pn.current),J(ie)})},onMove(ue){A({type:Hn.DragMove,coordinates:ue})},onEnd:Z(Hn.DragEnd),onCancel:Z(Hn.DragCancel)});Pn.current=F;function Z(ue){return async function(){const{active:Ne,collisions:ze,over:lt,scrollAdjustedTranslate:Lt}=yt.current;let xt=null;if(Ne&&Lt){const{cancelDrop:at}=ce.current;xt={activatorEvent:ie,active:Ne,collisions:ze,delta:Lt,over:lt},ue===Hn.DragEnd&&typeof at=="function"&&await Promise.resolve(at(xt))&&(ue=Hn.DragCancel)}he.current=null,Tl.unstable_batchedUpdates(()=>{A({type:ue}),P(Gs.Uninitialized),Tn(null),De(null),J(null),Pn.current=null;const at=ue===Hn.DragEnd?"onDragEnd":"onDragCancel";if(xt){const Vt=ce.current[at];Vt?.(xt),I({type:at,event:xt})}})}}},[S]),Se=ge.useCallback((v,O)=>(G,y)=>{const X=G.nativeEvent,ie=S.get(y);if(he.current!==null||!ie||X.dndKit||X.defaultPrevented)return;const F={active:ie};v(G,O.options,F)===!0&&(X.dndKit={capturedBy:O.sensor},he.current=y,$(G,O))},[S,$]),Re=Z3(m,Se);oO(m),$i(()=>{Xe&&q===Gs.Initializing&&P(Gs.Initialized)},[Xe,q]),ge.useEffect(()=>{const{onDragMove:v}=ce.current,{active:O,activatorEvent:G,collisions:y,over:X}=yt.current;if(!O||!G)return;const ie={active:O,activatorEvent:G,collisions:y,delta:{x:jt.x,y:jt.y},over:X};Tl.unstable_batchedUpdates(()=>{v?.(ie),I({type:"onDragMove",event:ie})})},[jt.x,jt.y]),ge.useEffect(()=>{const{active:v,activatorEvent:O,collisions:G,droppableContainers:y,scrollAdjustedTranslate:X}=yt.current;if(!v||he.current==null||!O||!X)return;const{onDragOver:ie}=ce.current,F=y.get(en),Z=F&&F.rect.current?{id:F.id,rect:F.rect.current,data:F.data,disabled:F.disabled}:null,ue={active:v,activatorEvent:O,collisions:G,delta:{x:X.x,y:X.y},over:Z};Tl.unstable_batchedUpdates(()=>{Tn(Z),ie?.(ue),I({type:"onDragOver",event:ue})})},[en]),$i(()=>{yt.current={activatorEvent:de,active:L,activeNode:Ke,collisionRect:on,collisions:pn,droppableRects:Ce,draggableNodes:S,draggingNode:kt,draggingNodeRect:St,droppableContainers:N,over:Qt,scrollableAncestors:wt,scrollAdjustedTranslate:jt},j.current={initial:St,translated:on}},[L,Ke,pn,on,S,kt,St,Ce,N,Qt,wt,jt]),K3({...Fe,delta:C,draggingRect:on,pointerCoordinates:dt,scrollableAncestors:wt,scrollableAncestorRects:it});const Ge=ge.useMemo(()=>({active:L,activeNode:Ke,activeNodeRect:Xe,activatorEvent:de,collisions:pn,containerNodeRect:ft,dragOverlay:_t,draggableNodes:S,droppableContainers:N,droppableRects:Ce,over:Qt,measureDroppableContainers:Ie,scrollableAncestors:wt,scrollableAncestorRects:it,measuringConfiguration:se,measuringScheduled:He,windowRect:Dt}),[L,Ke,Xe,de,pn,ft,_t,S,N,Ce,Qt,Ie,wt,it,se,He,Dt]),ne=ge.useMemo(()=>({activatorEvent:de,activators:Re,active:L,activeNodeRect:Xe,ariaDescribedById:{draggable:xe},dispatch:A,draggableNodes:S,over:Qt,measureDroppableContainers:Ie}),[de,Re,L,Xe,A,xe,S,Qt,Ie]);return br.createElement(pT.Provider,{value:V},br.createElement(hf.Provider,{value:ne},br.createElement(DT.Provider,{value:Ge},br.createElement(RT.Provider,{value:hn},d)),br.createElement(vO,{disabled:l?.restoreFocus===!1})),br.createElement(_3,{...l,hiddenTextDescribedById:xe}));function be(){const v=_e?.autoScrollEnabled===!1,O=typeof c=="object"?c.enabled===!1:c===!1,G=U&&!v&&!O;return typeof c=="object"?{...c,enabled:G}:{enabled:G}}}),bO=ge.createContext(null),ME="button",xO="Draggable";function TO(r){let{id:e,data:t,disabled:n=!1,attributes:i}=r;const o=wc(xO),{activators:u,activatorEvent:l,active:c,activeNodeRect:d,ariaDescribedById:m,draggableNodes:g,over:E}=ge.useContext(hf),{role:b=ME,roleDescription:M="draggable",tabIndex:D=0}=i??{},w=c?.id===e,A=ge.useContext(w?RT:bO),[I,V]=kd(),[q,P]=kd(),U=aO(u,e),R=ic(t);$i(()=>(g.set(e,{id:e,key:o,node:I,activatorNode:q,data:R}),()=>{const C=g.get(e);C&&C.key===o&&g.delete(e)}),[g,e]);const S=ge.useMemo(()=>({role:b,tabIndex:D,"aria-disabled":n,"aria-pressed":w&&b===ME?!0:void 0,"aria-roledescription":M,"aria-describedby":m.draggable}),[n,b,D,w,M,m.draggable]);return{active:c,activatorEvent:l,activeNodeRect:d,attributes:S,isDragging:w,listeners:n?void 0:U,node:I,over:E,setNodeRef:V,setActivatorNodeRef:P,transform:A}}function AO(){return ge.useContext(DT)}const SO="Droppable",IO={timeout:25};function CO(r){let{data:e,disabled:t=!1,id:n,resizeObserverConfig:i}=r;const o=wc(SO),{active:u,dispatch:l,over:c,measureDroppableContainers:d}=ge.useContext(hf),m=ge.useRef({disabled:t}),g=ge.useRef(!1),E=ge.useRef(null),b=ge.useRef(null),{disabled:M,updateMeasurementsFor:D,timeout:w}={...IO,...i},A=ic(D??n),I=ge.useCallback(()=>{if(!g.current){g.current=!0;return}b.current!=null&&clearTimeout(b.current),b.current=setTimeout(()=>{d(Array.isArray(A.current)?A.current:[A.current]),b.current=null},w)},[w]),V=cf({callback:I,disabled:M||!u}),q=ge.useCallback((S,C)=>{V&&(C&&(V.unobserve(C),g.current=!1),S&&V.observe(S))},[V]),[P,U]=kd(q),R=ic(e);return ge.useEffect(()=>{!V||!P.current||(V.disconnect(),g.current=!1,V.observe(P.current))},[P,V]),ge.useEffect(()=>(l({type:Hn.RegisterDroppable,element:{id:n,key:o,disabled:t,node:P,rect:E,data:R}}),()=>l({type:Hn.UnregisterDroppable,key:o,id:n})),[n]),ge.useEffect(()=>{t!==m.current.disabled&&(l({type:Hn.SetDroppableDisabled,id:n,key:o,disabled:t}),m.current.disabled=t)},[n,o,t,l]),{active:u,rect:E,isOver:c?.id===n,node:P,over:c,setNodeRef:U}}function my(r,e,t){const n=r.slice();return n.splice(t<0?n.length+t:t,0,n.splice(e,1)[0]),n}function DO(r,e){return r.reduce((t,n,i)=>{const o=e.get(n);return o&&(t[i]=o),t},Array(r.length))}function Lh(r){return r!==null&&r>=0}function RO(r,e){if(r===e)return!0;if(r.length!==e.length)return!1;for(let t=0;t<r.length;t++)if(r[t]!==e[t])return!1;return!0}function kO(r){return typeof r=="boolean"?{draggable:r,droppable:r}:r}const gy=r=>{let{rects:e,activeIndex:t,overIndex:n,index:i}=r;const o=my(e,n,t),u=e[i],l=o[i];return!l||!u?null:{x:l.left-u.left,y:l.top-u.top,scaleX:l.width/u.width,scaleY:l.height/u.height}},kT="Sortable",NT=br.createContext({activeIndex:-1,containerId:kT,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:gy,disabled:{draggable:!1,droppable:!1}});function NO(r){let{children:e,id:t,items:n,strategy:i=gy,disabled:o=!1}=r;const{active:u,dragOverlay:l,droppableRects:c,over:d,measureDroppableContainers:m}=AO(),g=wc(kT,t),E=l.rect!==null,b=ge.useMemo(()=>n.map(U=>typeof U=="object"&&"id"in U?U.id:U),[n]),M=u!=null,D=u?b.indexOf(u.id):-1,w=d?b.indexOf(d.id):-1,A=ge.useRef(b),I=!RO(b,A.current),V=w!==-1&&D===-1||I,q=kO(o);$i(()=>{I&&M&&m(b)},[I,b,M,m]),ge.useEffect(()=>{A.current=b},[b]);const P=ge.useMemo(()=>({activeIndex:D,containerId:g,disabled:q,disableTransforms:V,items:b,overIndex:w,useDragOverlay:E,sortedRects:DO(b,c),strategy:i}),[D,g,q.draggable,q.droppable,V,b,w,c,E,i]);return br.createElement(NT.Provider,{value:P},e)}const PO=r=>{let{id:e,items:t,activeIndex:n,overIndex:i}=r;return my(t,n,i).indexOf(e)},OO=r=>{let{containerId:e,isSorting:t,wasDragging:n,index:i,items:o,newIndex:u,previousItems:l,previousContainerId:c,transition:d}=r;return!d||!n||l!==o&&i===u?!1:t?!0:u!==i&&e===c},LO={duration:200,easing:"ease"},PT="transform",VO=oc.Transition.toString({property:PT,duration:0,easing:"linear"}),FO={roleDescription:"sortable"};function MO(r){let{disabled:e,index:t,node:n,rect:i}=r;const[o,u]=ge.useState(null),l=ge.useRef(t);return $i(()=>{if(!e&&t!==l.current&&n.current){const c=i.current;if(c){const d=Ou(n.current,{ignoreTransform:!0}),m={x:c.left-d.left,y:c.top-d.top,scaleX:c.width/d.width,scaleY:c.height/d.height};(m.x||m.y)&&u(m)}}t!==l.current&&(l.current=t)},[e,t,n,i]),ge.useEffect(()=>{o&&u(null)},[o]),o}function BO(r){let{animateLayoutChanges:e=OO,attributes:t,disabled:n,data:i,getNewIndex:o=PO,id:u,strategy:l,resizeObserverConfig:c,transition:d=LO}=r;const{items:m,containerId:g,activeIndex:E,disabled:b,disableTransforms:M,sortedRects:D,overIndex:w,useDragOverlay:A,strategy:I}=ge.useContext(NT),V=zO(n,b),q=m.indexOf(u),P=ge.useMemo(()=>({sortable:{containerId:g,index:q,items:m},...i}),[g,i,q,m]),U=ge.useMemo(()=>m.slice(m.indexOf(u)),[m,u]),{rect:R,node:S,isOver:C,setNodeRef:N}=CO({id:u,data:P,disabled:V.droppable,resizeObserverConfig:{updateMeasurementsFor:U,...c}}),{active:z,activatorEvent:j,activeNodeRect:L,attributes:he,setNodeRef:_e,listeners:De,isDragging:de,over:J,setActivatorNodeRef:ce,transform:xe}=TO({id:u,data:P,attributes:{...FO,...t},disabled:V.draggable}),Q=o3(N,_e),se=!!z,Ce=se&&!M&&Lh(E)&&Lh(w),Ie=!A&&de,He=Ie&&Ce?xe:null,et=Ce?He??(l??I)({rects:D,activeNodeRect:L,activeIndex:E,overIndex:w,index:q}):null,Fe=Lh(E)&&Lh(w)?o({id:u,items:m,activeIndex:E,overIndex:w}):q,Je=z?.id,Xe=ge.useRef({activeId:Je,items:m,newIndex:Fe,containerId:g}),ft=m!==Xe.current.items,yt=e({active:z,containerId:g,isDragging:de,isSorting:se,id:u,index:q,items:m,newIndex:Xe.current.newIndex,previousItems:Xe.current.items,previousContainerId:Xe.current.containerId,transition:d,wasDragging:Xe.current.activeId!=null}),mt=MO({disabled:!yt,index:q,node:S,rect:R});return ge.useEffect(()=>{se&&Xe.current.newIndex!==Fe&&(Xe.current.newIndex=Fe),g!==Xe.current.containerId&&(Xe.current.containerId=g),m!==Xe.current.items&&(Xe.current.items=m)},[se,Fe,g,m]),ge.useEffect(()=>{if(Je===Xe.current.activeId)return;if(Je!=null&&Xe.current.activeId==null){Xe.current.activeId=Je;return}const kt=setTimeout(()=>{Xe.current.activeId=Je},50);return()=>clearTimeout(kt)},[Je]),{active:z,activeIndex:E,attributes:he,data:P,rect:R,index:q,newIndex:Fe,items:m,isOver:C,isSorting:se,isDragging:de,listeners:De,node:S,overIndex:w,over:J,setNodeRef:Q,setActivatorNodeRef:ce,setDroppableNodeRef:N,setDraggableNodeRef:_e,transform:mt??et,transition:_t()};function _t(){if(mt||ft&&Xe.current.newIndex===q)return VO;if(!(Ie&&!cy(j)||!d)&&(se||yt))return oc.Transition.toString({...d,property:PT})}}function zO(r,e){var t,n;return typeof r=="boolean"?{draggable:r,droppable:!1}:{draggable:(t=r?.draggable)!=null?t:e.draggable,droppable:(n=r?.droppable)!=null?n:e.droppable}}function Od(r){if(!r)return!1;const e=r.data.current;return!!(e&&"sortable"in e&&typeof e.sortable=="object"&&"containerId"in e.sortable&&"items"in e.sortable&&"index"in e.sortable)}const UO=[Bt.Down,Bt.Right,Bt.Up,Bt.Left],jO=(r,e)=>{let{context:{active:t,collisionRect:n,droppableRects:i,droppableContainers:o,over:u,scrollableAncestors:l}}=e;if(UO.includes(r.code)){if(r.preventDefault(),!t||!n)return;const c=[];o.getEnabled().forEach(g=>{if(!g||g!=null&&g.disabled)return;const E=i.get(g.id);if(E)switch(r.code){case Bt.Down:n.top<E.top&&c.push(g);break;case Bt.Up:n.top>E.top&&c.push(g);break;case Bt.Left:n.left>E.left&&c.push(g);break;case Bt.Right:n.left<E.left&&c.push(g);break}});const d=x3({collisionRect:n,droppableRects:i,droppableContainers:c});let m=vT(d,"id");if(m===u?.id&&d.length>1&&(m=d[1].id),m!=null){const g=o.get(t.id),E=o.get(m),b=E?i.get(E.id):null,M=E?.node.current;if(M&&b&&g&&E){const w=lf(M).some((U,R)=>l[R]!==U),A=OT(g,E),I=qO(g,E),V=w||!A?{x:0,y:0}:{x:I?n.width-b.width:0,y:I?n.height-b.height:0},q={x:b.left,y:b.top};return V.x&&V.y?q:sc(q,V)}}}};function OT(r,e){return!Od(r)||!Od(e)?!1:r.data.current.sortable.containerId===e.data.current.sortable.containerId}function qO(r,e){return!Od(r)||!Od(e)||!OT(r,e)?!1:r.data.current.sortable.index<e.data.current.sortable.index}const WO=({book:r,onSelect:e,onDelete:t,onDownload:n,onToggleFinished:i,cardClass:o})=>{const[u,l]=ge.useState(!1),{attributes:c,listeners:d,setNodeRef:m,transform:g,transition:E,isDragging:b}=BO({id:r.id}),M={transform:oc.Transform.toString(g),transition:E,zIndex:b?50:"auto",opacity:b?.5:1},D=w=>{if(r.isDownloading){w.stopPropagation();return}r.isDownloaded?e(r):n(w,r)};return ye.jsxs("div",{ref:m,style:M,onClick:D,className:`flex flex-col cursor-pointer transition-all duration-300 rounded-3xl p-3 border-2 group relative ${o}`,children:[ye.jsxs("div",{className:"aspect-[3/4] rounded-2xl overflow-hidden mb-4 shadow-md bg-black/5 relative",children:[r.coverUrl&&!u?ye.jsx("img",{src:r.coverUrl,alt:r.title,className:"w-full h-full object-cover",onError:()=>l(!0)}):ye.jsx("div",{className:"w-full h-full flex items-center justify-center opacity-20",children:ye.jsx(UE,{className:"w-10 h-10"})}),ye.jsx("div",{className:"absolute bottom-2 right-2 p-1.5 bg-black/50 text-white rounded-lg backdrop-blur-md",children:r.isDownloading?ye.jsx(Vh,{className:"w-3.5 h-3.5 animate-spin"}):r.isDownloaded?ye.jsx(aS,{className:"w-3.5 h-3.5 opacity-70"}):ye.jsx(eS,{className:"w-3.5 h-3.5 text-blue-400"})}),ye.jsx("div",{...c,...d,className:"absolute top-2 left-2 p-1.5 bg-black/50 text-white rounded-lg opacity-0 group-hover:opacity-100 transition-opacity cursor-grab active:cursor-grabbing",style:{touchAction:"none"},children:ye.jsx(tS,{className:"w-4 h-4"})})]}),ye.jsx("button",{onClick:w=>t(w,r.id),className:"absolute top-5 right-5 p-2 bg-red-500 text-white rounded-xl opacity-0 group-hover:opacity-100 transition-opacity shadow-lg hover:bg-red-600 z-10",children:ye.jsx(uS,{className:"w-4 h-4"})}),r.isFinished&&ye.jsx("div",{className:"absolute top-2 left-2 px-2 py-1 bg-green-500 text-white text-[8px] font-bold rounded-lg shadow-lg z-10",children:" LEDO"}),ye.jsx("h3",{className:"font-bold text-sm line-clamp-2 mb-1 px-1",children:r.title}),ye.jsx("p",{className:"text-[10px] opacity-50 font-bold uppercase tracking-wider px-1",children:r.author}),ye.jsx("button",{onClick:w=>{w.stopPropagation(),i(r.id,r.isFinished)},className:`mt-2 w-full px-2 py-1 rounded-lg text-[8px] font-bold transition-all ${r.isFinished?"bg-gray-200 text-gray-600 hover:bg-gray-300":"bg-blue-500 text-white hover:bg-blue-600"}`,children:r.isFinished?"Marcar como no ledo":"Marcar como ledo"})]})},$O=({onSelectBook:r,theme:e,onOpenSettings:t,onUpdateTheme:n})=>{const[i,o]=ge.useState([]),[u,l]=ge.useState(!0),[c,d]=ge.useState(!1),[m,g]=ge.useState(""),[E,b]=ge.useState(navigator.onLine),[M,D]=ge.useState(!0),[w,A]=ge.useState([]),[I,V]=ge.useState(null);ge.useEffect(()=>{const L=()=>b(!0),he=()=>b(!1);return window.addEventListener("online",L),window.addEventListener("offline",he),()=>{window.removeEventListener("online",L),window.removeEventListener("offline",he)}},[]);const q=w3(Gm(py,{activationConstraint:{distance:10}}),Gm(ST,{activationConstraint:{delay:250,tolerance:5}}),Gm(dy,{coordinateGetter:jO}));ge.useEffect(()=>{(async()=>{try{console.log("Loading reading states...");const he=await AE();console.log("Reading states loaded:",he.length),A(he)}catch(he){console.error("Error loading reading states:",he),A([])}})()},[]),ge.useEffect(()=>{(async()=>{try{const de=await zw();if(de.length>0){console.log("Loaded local books immediately:",de.length);const J=de.map(ce=>({...ce,isDownloaded:!0,isDownloading:!1,isFinished:!1}));o(ce=>ce.length===0?J:ce),l(!1)}}catch(de){console.error("Error loading local books:",de)}})();const he=setTimeout(()=>{u&&(console.log("Firestore sync timeout - Forcing UI load with what we have"),l(!1))},5e3),_e=sT(Hv(ps,"books"));D(!0),console.log("Setting up Firestore listener...");const De=EP(_e,{includeMetadataChanges:!0},async de=>{try{clearTimeout(he);const J=de.metadata.fromCache,ce=de.metadata.hasPendingWrites;console.log(`Firestore Sync: Received ${de.docs.length} books. Source: ${J?"CACHE":"SERVER"}. Pending writes: ${ce}`);const xe=de.docs.map(Ce=>({id:Ce.id,...Ce.data()})),Q=await zw(),se=xe.map(Ce=>{const Ie=Q.find(Ke=>Ke.id===Ce.id),He=w.find(Ke=>Ke.bookId===Ce.id);return{...Ce,isDownloaded:!!Ie,data:Ie?.data,isFinished:He?.isFinished||!1}});console.log("Merged books:",se.length),o(se.sort((Ce,Ie)=>(Ce.order??1/0)-(Ie.order??1/0)||(Ie.createdAt??0)-(Ce.createdAt??0)))}catch(J){console.error("Error processing Firestore data:",J),V(J.message)}finally{l(!1),D(!1)}},de=>{console.error("Firestore sync error:",de),V(de.message),l(!1),D(!1)});return()=>{console.log("Unsubscribing from Firestore..."),De(),clearTimeout(he)}},[w]);const P=async L=>{const he=L.target.files?.[0];if(!(!he||!he.name.endsWith(".epub"))){d(!0);try{const _e=await he.arrayBuffer(),De=lo(_e),de=await De.loaded.metadata;let J=await De.coverUrl();if(J&&J.startsWith("blob:")){const se=await(await fetch(J)).blob();J=await new Promise(Ce=>{const Ie=new FileReader;Ie.onloadend=()=>Ce(Ie.result),Ie.readAsDataURL(se)})}const ce=crypto.randomUUID(),xe={id:ce,title:de.title||he.name,author:de.creator||"Autor desconocido",coverUrl:J||null,createdAt:Date.now(),order:i.length};await Bw({...xe,data:_e}),console.log("Book saved locally:",xe.title),await ry(Tu(ps,"books",ce),xe),await JP(ce,_e),alert("Libro subido con xito a la nube!")}catch(_e){console.error("Upload error:",_e),alert("Error al subir el libro a la nube.")}finally{d(!1),L.target.value=""}}},U=async(L,he)=>{L.stopPropagation(),confirm("Eliminar este libro de la nube y de todos tus dispositivos?")&&(await XI(he),await t3(he))},R=async(L,he)=>{L.stopPropagation(),o(_e=>_e.map(De=>De.id===he.id?{...De,isDownloading:!0}:De));try{console.log("Starting download for book:",he.id,he.title);const _e=await e3(he.id);await Bw({...he,data:_e}),console.log("Download completed successfully for:",he.title),o(De=>De.map(de=>de.id===he.id?{...de,isDownloaded:!0,isDownloading:!1,data:_e}:de))}catch(_e){console.error("Download error:",_e),alert("Error al descargar el libro de la nube: "+_e),o(De=>De.map(de=>de.id===he.id?{...de,isDownloading:!1}:de))}},S=async L=>{const{active:he,over:_e}=L;if(_e&&he.id!==_e.id){const De=i.findIndex(ce=>ce.id===he.id),de=i.findIndex(ce=>ce.id===_e.id),J=my(i,De,de);o(J);try{const ce=J.map((xe,Q)=>_P(Tu(ps,"books",xe.id),{order:Q}));await Promise.all(ce)}catch(ce){console.error("Order sync error:",ce)}}},C=async(L,he)=>{try{he?await s3(L):await i3(L);const _e=await AE();A(_e),o(De=>De.map(de=>de.id===L?{...de,isFinished:!he}:de))}catch(_e){console.error("Error toggling finished status:",_e)}},N=i.filter(L=>L.title.toLowerCase().includes(m.toLowerCase())||L.author.toLowerCase().includes(m.toLowerCase())),z={white:"bg-[#f8fafc] text-slate-900",sepia:"bg-[#fbf0d9] text-[#5b4636]",dark:"bg-[#0f172a] text-slate-200"},j={white:"bg-white border-slate-200/50 hover:shadow-2xl hover:shadow-blue-500/10 hover:-translate-y-1",sepia:"bg-[#f7e7c3]/50 border-[#e1cd9f]/30 hover:shadow-2xl hover:shadow-[#5b4636]/10 hover:-translate-y-1",dark:"bg-slate-800/40 border-slate-700/50 hover:bg-slate-800/60 hover:shadow-2xl hover:shadow-black/40 hover:-translate-y-1"};return ye.jsx("div",{className:`min-h-screen p-4 sm:p-12 transition-colors duration-500 overflow-x-hidden ${z[e]} ${e==="dark"?"dark":""}`,children:ye.jsxs("div",{className:"max-w-7xl mx-auto",children:[ye.jsxs("div",{className:"flex items-center justify-between mb-8 sm:mb-12 gap-2",children:[ye.jsxs("div",{className:"flex items-center gap-3",children:[ye.jsx("div",{className:`p-2.5 rounded-2xl shadow-lg ${e==="dark"?"bg-blue-500 text-white":"bg-blue-600 text-white"}`,children:ye.jsx(ZA,{className:"w-6 h-6"})}),ye.jsxs("div",{children:[ye.jsx("h2",{className:"text-xl font-black tracking-tight leading-none mb-1",children:"LECTOR"}),ye.jsxs("div",{className:"flex flex-wrap gap-2",children:[ye.jsxs("div",{className:`flex items-center gap-1.5 px-2 py-0.5 rounded-full text-[8px] font-black uppercase tracking-widest ${E?"bg-green-500/10 text-green-500 border border-green-500/20":"bg-red-500/10 text-red-500 border border-red-500/20"}`,children:[E?"Online":"Offline",M&&ye.jsx(Vh,{className:"w-2 h-2 animate-spin ml-0.5"})]}),I&&ye.jsx("div",{className:"flex items-center gap-1.5 px-2 py-0.5 rounded-full text-[8px] font-black uppercase tracking-widest bg-red-500/10 text-red-500 border border-red-500/20",children:"Error de conexin"})]})]})]}),ye.jsxs("div",{className:"flex items-center gap-2",children:[ye.jsx("div",{className:`flex items-center p-1 rounded-2xl mr-1 sm:mr-2 ${e==="dark"?"bg-slate-800":"bg-slate-100"}`,children:[{id:"white",icon:ye.jsx(HE,{className:"w-4 h-4"})},{id:"sepia",icon:ye.jsx(jE,{className:"w-4 h-4"})},{id:"dark",icon:ye.jsx(qE,{className:"w-4 h-4"})}].map(L=>ye.jsx("button",{onClick:()=>n(L.id),className:`p-1.5 sm:p-2 rounded-xl transition-all ${e===L.id?"bg-blue-500 text-white shadow-md":"opacity-50 hover:opacity-100"}`,children:L.icon},L.id))}),ye.jsx("button",{onClick:t,className:`p-2.5 rounded-2xl transition-all border-2 ${e==="dark"?"bg-slate-800 border-slate-700 hover:bg-slate-700":"bg-white border-slate-100 hover:bg-slate-50"} shadow-sm active:scale-95`,children:ye.jsx($E,{className:"w-5 h-5 opacity-70"})}),ye.jsxs("label",{className:"flex items-center gap-2 px-3 sm:px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-2xl font-bold text-sm cursor-pointer transition-all shadow-lg shadow-blue-500/25 active:scale-95 whitespace-nowrap",children:[c?ye.jsx(Vh,{className:"w-4 h-4 animate-spin"}):ye.jsx(WE,{className:"w-4 h-4"}),ye.jsx("span",{className:"hidden sm:inline",children:c?"Subiendo...":"Aadir"}),ye.jsx("input",{type:"file",accept:".epub",onChange:P,className:"hidden",disabled:c})]})]})]}),ye.jsx("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6 mb-8",children:ye.jsxs("div",{className:"relative flex-1 md:max-w-md group",children:[ye.jsx(oS,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 opacity-30 group-focus-within:opacity-100 transition-opacity"}),ye.jsx("input",{type:"text",placeholder:"Buscar en tu biblioteca...",value:m,onChange:L=>g(L.target.value),className:`w-full pl-11 pr-4 py-3 rounded-2xl border-2 transition-all outline-none text-sm font-medium ${e==="dark"?"bg-slate-800/50 border-transparent focus:border-blue-500/30":"bg-slate-100/50 border-transparent focus:border-blue-500/30"}`})]})}),u?ye.jsxs("div",{className:"flex flex-col items-center justify-center py-32 opacity-20",children:[ye.jsx(Vh,{className:"w-12 h-12 animate-spin mb-4"}),ye.jsx("p",{className:"font-bold text-center",children:"Sincronizando con la nube..."})]}):N.length===0?ye.jsxs("div",{className:"text-center py-32 border-2 border-dashed border-current/10 rounded-3xl",children:[ye.jsx(UE,{className:"w-16 h-16 mx-auto mb-4 opacity-10"}),ye.jsx("p",{className:"text-xl font-bold opacity-30 px-4",children:m?"No se encontraron libros":I?`Error de conexin: ${I}`:"Tu biblioteca en la nube est vaca. Sube un EPUB!"})]}):ye.jsx(EO,{sensors:q,collisionDetection:b3,onDragEnd:S,children:ye.jsx(NO,{items:N.map(L=>L.id),strategy:gy,children:ye.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-6",children:N.map(L=>ye.jsx(WO,{book:L,onSelect:he=>r(he),onDelete:U,onDownload:R,onToggleFinished:C,cardClass:j[e]},L.id))})})})]})})},HO={theme:"white",fontSize:18,fontFamily:"serif",lineHeight:1.5};function GO(){const[r,e]=ge.useState("library"),[t,n]=ge.useState(null),[i,o]=ge.useState(null),[u,l]=ge.useState([]),[c,d]=ge.useState(null),[m,g]=ge.useState(0),[E,b]=ge.useState(!1),[M,D]=ge.useState(!1),[w,A]=ge.useState(!1),[I,V]=ge.useState(!1),[q,P]=ge.useState(()=>{const J=localStorage.getItem("epub-settings");return J?JSON.parse(J):HO});console.log("App: Version 2.0 (Fixed Sync) loaded"),ge.useEffect(()=>{localStorage.setItem("epub-settings",JSON.stringify(q))},[q]),ge.useEffect(()=>{const J=()=>{A(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",J),()=>document.removeEventListener("fullscreenchange",J)},[]),ge.useEffect(()=>{if(!w){V(!1),C.current&&(clearTimeout(C.current),C.current=null);return}return V(!0),C.current&&clearTimeout(C.current),C.current=setTimeout(()=>{V(!1)},2e3),()=>{C.current&&(clearTimeout(C.current),C.current=null)}},[w]);const U=J=>J.id,R=async J=>{try{const ce=await oy(J.id),xe=U(J),Q=Tu(ps,"progress",xe);console.log("App: Fetching initial position for book:",J.title);const se=await vP(Q);let Ce=null;ce?(Ce=ce.lastLocation,console.log("App: Local position found:",Ce)):se.exists()&&(Ce=se.data().lastLocation,console.log("App: Cloud position found:",Ce)),o(J.data),n(J),d(Ce),e("reader")}catch(ce){console.error("Error loading book:",ce),alert("No se pudo cargar el libro.")}},S=ge.useRef(null),C=ge.useRef(null),N=J=>{if(!t||!window.epubRendition)return;const ce=J.currentTarget.getBoundingClientRect(),Q=(J.clientX-ce.left)/ce.width,se=window.epubRendition,Ce=se.book;if(Ce.locations&&Ce.locations.length()>0){const Ie=Ce.locations.cfiFromPercentage(Q);se.display(Ie)}},z=J=>{c!==J&&(d(J),t&&(Rd({bookId:t.id,lastLocation:J,progress:m,lastRead:Date.now()}),S.current&&clearTimeout(S.current),S.current=setTimeout(async()=>{const ce=U(t),xe=Tu(ps,"progress",ce);console.log("App: Saving bookmark to cloud...",J);try{await ry(xe,{lastLocation:J,title:t.title,author:t.author,updatedAt:Date.now()},{merge:!0})}catch(Q){console.error("App: Failed to save bookmark to cloud:",Q)}},3e3)))},j=()=>{document.fullscreenElement?document.exitFullscreen&&document.exitFullscreen():document.documentElement.requestFullscreen()},L=()=>{w&&(V(!0),C.current&&clearTimeout(C.current),C.current=setTimeout(()=>{V(!1)},3e3))},he=async()=>{document.fullscreenElement&&document.exitFullscreen&&await document.exitFullscreen()},_e=async()=>{await he(),e("library"),o(null)},De={white:"bg-white text-gray-900 border-gray-100",sepia:"bg-[#fbf0d9] text-[#5b4636] border-[#e8dcc4]",dark:"bg-[#1a1a1a] text-gray-300 border-gray-800"},de=`transition-colors duration-500 border-opacity-50 ${q.theme==="dark"?"bg-[#0f172a] border-slate-800":q.theme==="sepia"?"bg-[#fbf0d9] border-[#e8dcc4]":"bg-slate-50/80 backdrop-blur-md border-slate-200"}`;return r==="library"?ye.jsx($O,{onSelectBook:R,theme:q.theme,onOpenSettings:()=>D(!0),onUpdateTheme:J=>P({...q,theme:J})}):ye.jsxs("div",{className:`fixed inset-0 flex flex-col transition-colors duration-500 ${De[q.theme]} ${q.theme==="dark"?"dark":""} reader-container`,children:[!w&&ye.jsxs("header",{className:`h-16 flex items-center justify-between px-4 sm:px-6 border-b z-30 ${de}`,children:[ye.jsxs("div",{className:"flex items-center gap-4",children:[ye.jsx("button",{onClick:()=>b(!0),className:"p-2 hover:bg-black/5 dark:hover:bg-white/5 rounded-full transition-colors",children:ye.jsx(iS,{className:"w-5 h-5"})}),ye.jsxs("button",{onClick:()=>{e("library"),o(null)},className:`px-4 py-2 rounded-xl transition-all text-[10px] font-black tracking-widest uppercase border-2 flex items-center gap-2 ${q.theme==="dark"?"bg-slate-800 border-slate-700 hover:bg-slate-700":"bg-white border-slate-100 hover:bg-slate-50"}`,children:[ye.jsx(Mp,{className:"w-4 h-4"}),"Biblioteca"]}),ye.jsx("div",{className:"hidden sm:block",children:ye.jsx("h1",{className:"text-sm font-bold tracking-tight opacity-70 truncate max-w-[200px]",children:t?.title||"Lector"})})]}),ye.jsxs("div",{className:"flex items-center gap-2",children:[ye.jsx("button",{onClick:j,className:"p-2 hover:bg-black/5 dark:hover:bg-white/5 rounded-full transition-colors",title:"Pantalla completa",children:w?ye.jsx(O_,{className:"w-5 h-5"}):ye.jsx(rS,{className:"w-5 h-5"})}),ye.jsx("button",{onClick:()=>D(!0),className:"p-2 hover:bg-black/5 dark:hover:bg-white/5 rounded-full transition-colors",children:ye.jsx($E,{className:"w-5 h-5"})})]})]}),w&&I&&ye.jsxs("div",{className:"absolute top-3 left-3 z-40 flex items-center gap-2",children:[ye.jsxs("button",{onClick:_e,className:`px-3 py-2 rounded-xl text-[10px] font-black tracking-widest uppercase border-2 backdrop-blur-md transition-all ${q.theme==="dark"?"bg-slate-900/80 border-slate-700 text-gray-200 hover:bg-slate-800":q.theme==="sepia"?"bg-[#fbf0d9]/80 border-[#e8dcc4] text-[#5b4636] hover:bg-[#fbf0d9]":"bg-white/80 border-slate-200 text-gray-900 hover:bg-white"}`,title:"Volver a la biblioteca",children:[ye.jsx(Mp,{className:"w-4 h-4 inline-block -mt-0.5"}),"Biblioteca"]}),ye.jsx("button",{onClick:he,className:`p-2 rounded-full border backdrop-blur-md transition-all ${q.theme==="dark"?"bg-slate-900/80 border-slate-700 text-gray-200 hover:bg-slate-800":q.theme==="sepia"?"bg-[#fbf0d9]/80 border-[#e8dcc4] text-[#5b4636] hover:bg-[#fbf0d9]":"bg-white/80 border-slate-200 text-gray-900 hover:bg-white"}`,title:"Salir de pantalla completa",children:ye.jsx(O_,{className:"w-5 h-5"})})]}),ye.jsxs("main",{className:"flex-1 relative overflow-hidden flex items-center justify-center",children:[ye.jsxs("div",{className:"absolute inset-0 flex",children:[ye.jsx("div",{className:"w-16 sm:w-24 h-full flex items-center justify-center cursor-pointer group z-20",onClick:()=>window.epubRendition?.prev(),children:ye.jsx("div",{className:"p-4 rounded-full bg-black/0 group-hover:bg-black/5 dark:group-hover:bg-white/5 transition-all text-transparent group-hover:text-current",children:ye.jsx(Mp,{className:"w-8 h-8"})})}),ye.jsx("div",{className:"flex-1 h-full cursor-pointer",onClick:L}),ye.jsx("div",{className:"w-16 sm:w-24 h-full flex items-center justify-center cursor-pointer group z-20",onClick:()=>window.epubRendition?.next(),children:ye.jsx("div",{className:"p-4 rounded-full bg-black/0 group-hover:bg-black/5 dark:group-hover:bg-white/5 transition-all text-transparent group-hover:text-current",children:ye.jsx(JA,{className:"w-8 h-8"})})})]}),ye.jsx("div",{className:`w-full h-full max-w-5xl mx-auto overflow-hidden transition-all duration-300 ${w?"px-4 py-2":"px-4 sm:px-16 py-6"}`,children:i&&ye.jsx(LI,{data:i,location:c,onLocationChange:z,onTocLoaded:J=>l(J),onProgress:J=>g(J),settings:q})})]}),ye.jsxs("footer",{className:`transition-all duration-300 z-30 flex flex-col justify-center px-4 sm:px-8 ${w?"fixed bottom-0 left-0 right-0 h-4 bg-transparent border-none opacity-50 hover:opacity-100":`h-14 border-t ${de}`}`,children:[!w&&ye.jsxs("div",{className:"flex justify-between items-center mb-2",children:[ye.jsx("span",{className:"text-[10px] font-bold opacity-40 uppercase tracking-widest leading-none",children:"Progreso de lectura"}),ye.jsxs("span",{className:"text-[10px] font-bold text-blue-500 leading-none",children:[(m*100).toFixed(1),"%"]})]}),ye.jsx("div",{className:`progress-bar-container relative w-full bg-black/10 dark:bg-white/10 rounded-full overflow-hidden cursor-pointer ${w?"h-1":"h-2"}`,onClick:N,children:ye.jsx("div",{className:"h-full bg-blue-500 transition-all duration-300 relative",style:{width:`${m*100}%`},children:ye.jsx("div",{className:`progress-bar-handle ${w?"scale-75":""}`,style:{left:`${m*100}%`}})})})]}),ye.jsx(VI,{isOpen:E,onClose:()=>b(!1),toc:u,theme:q.theme,onSelectChapter:J=>{window.epubRendition?.display(J)}}),ye.jsx(FI,{isOpen:M,onClose:()=>D(!1),settings:q,onUpdateSettings:P})]})}const KO="modulepreload",QO=function(r){return"/LectorEpub/"+r},BE={},YO=function(e,t,n){let i=Promise.resolve();if(t&&t.length>0){let d=function(m){return Promise.all(m.map(g=>Promise.resolve(g).then(E=>({status:"fulfilled",value:E}),E=>({status:"rejected",reason:E}))))};var u=d;document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=l?.nonce||l?.getAttribute("nonce");i=d(t.map(m=>{if(m=QO(m),m in BE)return;BE[m]=!0;const g=m.endsWith(".css"),E=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${E}`))return;const b=document.createElement("link");if(b.rel=g?"stylesheet":KO,g||(b.as="script"),b.crossOrigin="",b.href=m,c&&b.setAttribute("nonce",c),document.head.appendChild(b),g)return new Promise((M,D)=>{b.addEventListener("load",M),b.addEventListener("error",()=>D(new Error(`Unable to preload CSS for ${m}`)))})}))}function o(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return i.then(l=>{for(const c of l||[])c.status==="rejected"&&o(c.reason);return e().catch(o)})};function XO(r={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:n,onRegistered:i,onRegisteredSW:o,onRegisterError:u}=r;let l,c;const d=async(g=!0)=>{await c};async function m(){if("serviceWorker"in navigator){if(l=await YO(async()=>{const{Workbox:g}=await import("./workbox-window.prod.es5-BIl4cyR9.js");return{Workbox:g}},[]).then(({Workbox:g})=>new g("/LectorEpub/sw.js",{scope:"/LectorEpub/",type:"classic"})).catch(g=>{u?.(g)}),!l)return;l.addEventListener("activated",g=>{(g.isUpdate||g.isExternal)&&window.location.reload()}),l.addEventListener("installed",g=>{g.isUpdate||n?.()}),l.register({immediate:e}).then(g=>{o?o("/LectorEpub/sw.js",g):i?.(g)}).catch(g=>{u?.(g)})}}return c=m(),d}const ZO=async()=>{try{(await indexedDB.databases()).find(t=>t.name==="epub-reader-db")&&(console.log("Clearing old database version..."),await indexedDB.deleteDatabase("epub-reader-db"))}catch{console.log("No old databases to clear")}};ZO().then(()=>{QA.createRoot(document.getElementById("root")).render(ye.jsx(br.StrictMode,{children:ye.jsx(GO,{})}))});XO({immediate:!0});
